{% extends "%s/2019/base_ebook.html" % lang %} {% set metadata = {} %} {% block chapters %} {% set metadata = {"part_number":"I","chapter_number":1,"title":"JavaScript","description":"2019年のWeb AlmanacのJavaScriptの章では、Web上でどれだけJavaScriptを使用しているか、圧縮、ライブラリとフレームワーク、読み込み、ソースマップを網羅しています。","authors":["housseindjirdeh"],"reviewers":["obto","paulcalvano","mathiasbynens"],"translators":["ksakae"],"discuss":"1756","results":"https://docs.google.com/spreadsheets/d/1kBTglETN_V9UjKqK_EFmFjRexJnQOmLLr-I2Tkotvic/","queries":"01_JavaScript","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-07-20T00:00:00.000Z","chapter":"javascript"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="javascript-序章"><a href="#javascript-序章" class="anchor-link">序章</a></h2>
    <p>JavaScriptはウェブ上で、対話可能で複雑な体験を構築することを可能にするスクリプト言語です。これには、ユーザーの会話への応答、ページ上の動的コンテンツの更新などが含まれます。イベントが発生したときにウェブページがどのように振る舞うべきかに関係するものはすべて、JavaScriptが使用されています。</p>
    <p>言語の仕様自体は、世界中の開発者が利用している多くのコミュニティビルドのライブラリやフレームワークとともに、1995年に言語が作成されて以来、変化と進化を続けてきました。JavaScriptの実装やインタプリタも進歩を続けており、ブラウザだけでなく多くの環境で利用できるようになっています。</p>
    <p>
      <a href="https://httparchive.org/">HTTP Archive<span class="fn">https://httparchive.org/</span></a
      >は毎月<a href="https://httparchive.org/reports/state-of-the-web#numUrls">数百万ページ<span class="fn">https://httparchive.org/reports/state-of-the-web#numUrls</span></a
      >をクロールし、<a href="https://webpagetest.org/">WebPageTest<span class="fn">https://webpagetest.org/</span></a> のプライベートインスタンスを通して実行し、各ページのキー情報を保存しています（これについての詳細は<a href="#methodology">方法論</a> で学べます）。JavaScriptのコンテキストでは、HTTP Archiveはウェブ全体の言語の使用法に関する広範な情報を提供しています。この章では、これらの傾向の多くを集約して分析します。
    </p>
    <h2 id="javascript-どのくらいのjavascriptを使っているのか？"><a href="#javascript-どのくらいのjavascriptを使っているのか？" class="anchor-link">どのくらいのJavaScriptを使っているのか？</a></h2>
    <p>
      JavaScriptは、私たちがブラウザに送るリソースの中で最もコストのかかるものでダウンロード、解析、コンパイル、そして最終的に実行されなければなりません。ブラウザはスクリプトの解析とコンパイルにかかる時間を大幅に短縮しましたが、WebページでJavaScriptが処理される際には、<a href="https://v8.dev/blog/cost-of-javascript-2019">ダウンロードと実行が最もコストのかかる段階になっています<span class="fn">https://v8.dev/blog/cost-of-javascript-2019</span></a
      >。
    </p>
    <p>ブラウザに小さなJavaScriptのバンドルを送ることは、ダウンロード時間を短縮し、ひいてはページパフォーマンスを向上させるための最良の方法です。しかし、実際にどのくらいのJavaScriptを使っているのでしょうか？</p>
    <figure id="javascript-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig1.png">
        <img src="/static/images/2019/javascript/fig1.png" alt="図1. ページあたりのJavaScriptバイト数の分布" aria-labelledby="javascript-fig1-caption" aria-describedby="javascript-fig1-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=1974602890&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="javascript-fig1-description" class="visually-hidden">p10パーセンタイルで70バイト、p25で174バイト、p50で373バイト、p75で693バイト、p90で1,093バイトのJavaScriptを使用していることを示す棒グラフ</div>
      <figcaption id="javascript-fig1-caption"><a href="#javascript-fig-1" class="anchor-link">図 1.</a> ページあたりのJavaScriptバイト数の分布</figcaption>
    </figure>
    <p>上の図1を見ると、JavaScriptを373KB使用しているのは、50パーセンタイル（中央値）であることがわかります。つまり、全サイトの50％がこれだけのJavaScriptをユーザーに提供していることになります。</p>
    <p>この数字を見ると、これはJavaScriptの使いすぎではないかと思うのは当然のことです。しかし、ページのパフォーマンスに関しては、その影響はネットワーク接続や使用するデバイスに完全に依存します。モバイルクライアントとデスクトップクライアントを比較した場合、どのくらいのJavaScriptを提供しているのでしょうか？</p>
    <figure id="javascript-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig2.png">
        <img src="/static/images/2019/javascript/fig2.png" alt="図2. デバイス別のページあたりのJavaScriptの分布。" aria-labelledby="javascript-fig2-caption" aria-describedby="javascript-fig2-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=1914565673&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="javascript-fig2-description" class="visually-hidden">デスクトップとモバイルでそれぞれp10パーセンタイルで76バイト/65バイトのJavaScriptを使用していることを示す棒グラフで、p25で186/164バイト、p50で391/359バイト、p75で721/668バイト、p90で1,131/1,060バイトとなっています。</div>
      <figcaption id="javascript-fig2-caption"><a href="#javascript-fig-2" class="anchor-link">図 2.</a> デバイス別のページあたりのJavaScriptの分布。</figcaption>
    </figure>
    <p>どのパーセンタイルでも、モバイルよりもデスクトップデバイスに送信するJavaScriptの数がわずかに多くなっています。</p>
    <h3 id="javascript-処理時間"><a href="#javascript-処理時間" class="anchor-link">処理時間</a></h3>
    <p>解析とコンパイルが行われた後、ブラウザによって取得されたJavaScriptは、利用する前に処理（または実行）される必要があります。デバイスは様々であり、その計算能力はページ上でのJavaScriptの処理速度に大きく影響します。ウェブ上での現在の処理時間は？</p>
    <p>V8のメインスレッドの処理時間を異なるパーセンタイルで分析すると、アイデアを得ることができます。</p>
    <figure id="javascript-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig3.png">
        <img src="/static/images/2019/javascript/fig3.png" alt="図3. デバイス別のV8メインスレッド処理時間。" aria-labelledby="javascript-fig3-caption" aria-describedby="javascript-fig3-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=924000517&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="javascript-fig3-description" class="visually-hidden">処理時間をデスクトップとモバイルでそれぞれp10パーセンタイルで141ms/377ms、p25で352/988ms、p50で849/2,437ms、p75で1,850/5,518ms、p90で3,543/10,735msとした棒グラフ。</div>
      <figcaption id="javascript-fig3-caption"><a href="#javascript-fig-3" class="anchor-link">図 3.</a> デバイス別のV8メインスレッド処理時間。</figcaption>
    </figure>
    <p>すべてのパーセンタイルにおいて、処理時間はデスクトップよりもモバイルの方が長くなっています。メインスレッドの合計時間の中央値はデスクトップでは849msであるのに対し、モバイルでは2,437msと大きくなっています。</p>
    <p>このデータはモバイルデバイスがJavaScriptを処理するのにかかる時間が、より強力なデスクトップマシンに比べてどれだけ長いかを示していますが、モバイルデバイスは計算能力の点でも違いがあります。次の表は、1つのWebページの処理時間がモバイルデバイスのクラスによって大きく異なることを示しています。</p>
    <figure id="javascript-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/js-processing-reddit.png">
        <img src="/static/images/2019/javascript/js-processing-reddit.png" alt="Reddit.comのJavaScript処理時間" aria-labelledby="javascript-fig4-caption" aria-describedby="javascript-fig4-description" width="600" height="363" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="javascript-fig4-description" class="visually-hidden">3つの異なるデバイスを示す棒グラフ: 上部のPixel3は、メインスレッドとワーカースレッドの両方で400ms未満と量が少ないです。Moto G4の場合、メインスレッドで約900ms、ワーカースレッドでさらに300msです。そして最後のバーはAlcatel 1X 5059Dで、メインスレッドで2,000ms以上、ワーカースレッドで500ms以上となっています。</div>
      <figcaption id="javascript-fig4-caption">
        <a href="#javascript-fig-4" class="anchor-link">図 4.</a> reddit.comのJavaScript処理時間。<a href="https://v8.dev/blog/cost-of-javascript-2019">2019年のJavaScriptのコスト<span class="fn">https://v8.dev/blog/cost-of-javascript-2019</span></a
        >より。
      </figcaption>
    </figure>
    <h3 id="javascript-リクエスト数"><a href="#javascript-リクエスト数" class="anchor-link">リクエスト数</a></h3>
    <p>Webページで使用されているJavaScriptの量を分析しようとする場合、1つの方法として、送信されたリクエスト数を調べる価値があります。<a href="#http2">HTTP/2</a>では、複数の小さなチャンクを送信することで、より大きなモノリシックなバンドルを送信するよりもページの負荷を改善できます。また、デバイスクライアント別に分解してみると、どのくらいのリクエストがフェッチされているのでしょうか。</p>
    <figure id="javascript-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig5.png">
        <img src="/static/images/2019/javascript/fig5.png" alt="図5. 総JavaScriptリクエスト数の分布。" aria-labelledby="javascript-fig5-caption" aria-describedby="javascript-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=1632335480&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="javascript-fig5-description" class="visually-hidden">p10パーセンタイルではデスクトップとモバイルそれぞれ4/4のリクエストを示す棒グラフ、p25では10/9、p50では19/18、p75では33/32、p90では53/52が使用されています。</div>
      <figcaption id="javascript-fig5-caption"><a href="#javascript-fig-5" class="anchor-link">図 5.</a> 総JavaScriptリクエスト数の分布。</figcaption>
    </figure>
    <p>中央値では、デスクトップ用に19件、モバイル用に18件のリクエストが送信されています。</p>
    <h3 id="javascript-ファーストパーティ対サードパーティ"><a href="#javascript-ファーストパーティ対サードパーティ" class="anchor-link">ファーストパーティ対サードパーティ</a></h3>
    <p>これまでに分析した結果のうち、全体のサイズとリクエスト数が考慮されていました。しかし、大多数のウェブサイトでは、取得して使用しているJavaScriptコードのかなりの部分が<a href="#third-parties">サードパーティ</a>のソースから来ています。</p>
    <p>サードパーティのJavaScriptは、外部のサードパーティのソースから取得できます。広告、分析、ソーシャルメディアの埋め込みなどは、サードパーティのスクリプトを取得するための一般的なユースケースです。そこで当然のことながら、次の質問に移ります。</p>
    <figure id="javascript-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig6.png">
        <img src="/static/images/2019/javascript/fig6.png" alt="図6. デスクトップ上のファーストスクリプトとサードパーティスクリプトの分布。" aria-labelledby="javascript-fig6-caption" aria-describedby="javascript-fig6-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=1108490&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="javascript-fig6-description" class="visually-hidden">デスクトップ上でp10パーセンタイルでは0/1リクエストがファーストパーティとサードパーティであることを示す棒グラフが表示されています、p25では2/4、p50では6/10、p75では13/21、p90では24/38となっています。</div>
      <figcaption id="javascript-fig6-caption"><a href="#javascript-fig-6" class="anchor-link">図 6.</a> デスクトップ上のファーストスクリプトとサードパーティスクリプトの分布。</figcaption>
    </figure>
    <figure id="javascript-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig7.png">
        <img src="/static/images/2019/javascript/fig7.png" alt="図7. モバイル上のファーストパーティとサードパーティのスクリプトの分布。" aria-labelledby="javascript-fig7-caption" aria-describedby="javascript-fig7-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=998640509&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="javascript-fig7-description" class="visually-hidden">モバイルでp10パーセンタイルでは0/1リクエストがファーストパーティとサードパーティであることを示す棒グラフが表示されています、p25では2/3、p50では5/9、p75では13/20、p90では23/36となっています。</div>
      <figcaption id="javascript-fig7-caption"><a href="#javascript-fig-7" class="anchor-link">図 7.</a> モバイル上のファーストパーティとサードパーティのスクリプトの分布。</figcaption>
    </figure>
    <p>モバイルクライアントとデスクトップクライアントの両方において、すべてのパーセンタイルにおいて、ファーストパーティよりもサードパーティのリクエストの方が多く送信されています。これが意外に思える場合は、実際に提供されるコードのうち、サードパーティのベンダーからのものがどれくらいあるのかを調べてみましょう。</p>
    <figure id="javascript-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig8.png">
        <img src="/static/images/2019/javascript/fig8.png" alt="図8. デスクトップ上でダウンロードされたJavaScriptの総ダウンロード数の分布。" aria-labelledby="javascript-fig8-caption" aria-describedby="javascript-fig8-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=633945705&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="javascript-fig8-description" class="visually-hidden">p10パーセンタイルでは、ファーストパーティとサードパーティのリクエストに対してデスクトップ上で0/17バイトのJavaScriptがダウンロードされていることを示す棒グラフ、p25では11/62、p50では89/232、p75では200/525、p90では404/900である。</div>
      <figcaption id="javascript-fig8-caption"><a href="#javascript-fig-8" class="anchor-link">図 8.</a> デスクトップ上でダウンロードされたJavaScriptの総ダウンロード数の分布。</figcaption>
    </figure>
    <figure id="javascript-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig9.png">
        <img src="/static/images/2019/javascript/fig9.png" alt="図9. モバイルでダウンロードされたJavaScriptの総ダウンロード数の分布。" aria-labelledby="javascript-fig9-caption" aria-describedby="javascript-fig9-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=1611383649&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="javascript-fig9-description" class="visually-hidden">棒グラフは、p10パーセンタイルではファーストパーティとサードパーティのリクエストでそれぞれ0/17バイトの JavaScriptがモバイルでダウンロードされていることを示していますが、p25では6/54、p50では83/217、p75では189/477、p90では380/827です。</div>
      <figcaption id="javascript-fig9-caption"><a href="#javascript-fig-9" class="anchor-link">図 9.</a> モバイルでダウンロードされたJavaScriptの総ダウンロード数の分布。</figcaption>
    </figure>
    <p>中央値では、モバイルとデスクトップの両方で、開発者が作成したファーストパーティのコードよりもサードパーティのコードの方が89％多く使用されています。これは、サードパーティのコードが肥大化の最大の要因の1つであることを明確に示しています。サードパーティの影響についての詳細は、<a href="#third-parties">"サードパーティ"</a>の章を参照してください。</p>
    <h2 id="javascript-リソース圧縮"><a href="#javascript-リソース圧縮" class="anchor-link">リソース圧縮</a></h2>
    <p>ブラウザとサーバの会話のコンテキストで、リソース圧縮とは、データ圧縮アルゴリズムを使用して変更されたコードを指します。リソースは事前に静的に圧縮することも、ブラウザからの要求に応じて急ぎ圧縮することもでき、どちらの方法でも転送されるリソースサイズが大幅に削減されページパフォーマンスが向上します。</p>
    <p>テキスト圧縮アルゴリズムは複数ありますが、HTTPネットワークリクエストの圧縮（および解凍）に使われることが多いのはこの2つだけです。</p>
    <ul>
      <li>
        <a href="https://www.gzip.org/">Gzip<span class="fn">https://www.gzip.org/</span></a> (gzip): サーバーとクライアントの相互作用のために最も広く使われている圧縮フォーマット。
      </li>
      <li>
        <a href="https://github.com/google/brotli">Brotli<span class="fn">https://github.com/google/brotli</span></a> (br): 圧縮率のさらなる向上を目指した新しい圧縮アルゴリズム。<a href="https://caniuse.com/#feat=brotli">90%のブラウザ<span class="fn">https://caniuse.com/#feat=brotli</span></a
        >がBrotliエンコーディングをサポートしています。
      </li>
    </ul>
    <p>圧縮されたスクリプトは、一度転送されるとブラウザによって常に解凍される必要があります。これは、コンテンツの内容が変わらないことを意味し、実行時間が最適化されないことを意味します。しかし、リソース圧縮は常にダウンロード時間を改善しますが、これはJavaScriptの処理で最もコストのかかる段階の1つでもあります。JavaScriptファイルが正しく圧縮されていることを確認することは、サイトのパフォーマンスを向上させるための最も重要な要因の1つとなります。</p>
    <p>JavaScriptのリソースを圧縮しているサイトはどれくらいあるのでしょうか？</p>
    <figure id="javascript-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig10.png">
        <img src="/static/images/2019/javascript/fig10.png" alt="図10. JavaScript リソースをgzipまたはbrotliで圧縮しているサイトの割合。" aria-labelledby="javascript-fig10-caption" aria-describedby="javascript-fig10-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=241928028&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="javascript-fig10-description" class="visually-hidden">バーチャートを見ると、デスクトップとモバイルでそれぞれJavaScriptリソースの67%/65%がgzipで圧縮されており、15%/14%がBrotliで圧縮されていることがわかります。</div>
      <figcaption id="javascript-fig10-caption"><a href="#javascript-fig-10" class="anchor-link">図 10.</a> JavaScript リソースをgzipまたはbrotliで圧縮しているサイトの割合。</figcaption>
    </figure>
    <p>大多数のサイトではJavaScriptのリソースを圧縮しています。Gzipエンコーディングはサイトの〜64-67％で、Brotliは〜14％で使用されています。圧縮率はデスクトップとモバイルの両方でほぼ同じです。</p>
    <p>圧縮に関するより深い分析については、<a href="#compression">"圧縮"</a>の章を参照してください。</p>
    <h2 id="javascript-オープンソースのライブラリとフレームワーク"><a href="#javascript-オープンソースのライブラリとフレームワーク" class="anchor-link">オープンソースのライブラリとフレームワーク</a></h2>
    <p>
      オープンソースコード、または誰でもアクセス、閲覧、修正が可能な寛容なライセンスを持つコード。小さなライブラリから、<a href="https://www.chromium.org/Home">Chromium<span class="fn">https://www.chromium.org/Home</span></a
      >や<a href="https://www.openhub.net/p/firefox">Firefox<span class="fn">https://www.openhub.net/p/firefox</span></a
      >のようなブラウザ全体に至るまで、オープンソースコードはウェブ開発の世界で重要な役割を果たしています。JavaScriptの文脈では、開発者はオープンソースのツールに依存して、あらゆるタイプの機能をWebページに組み込んでいます。開発者が小さなユーティリティライブラリを使用するか、アプリケーション全体のアーキテクチャを決定する大規模なフレームワークを使用するかにかかわらずオープンソースのパッケージに依存することで、機能開発をより簡単かつ迅速にできます。では、どのJavaScriptオープンソースライブラリが最もよく使われているのでしょうか？
    </p>
    <figure id="javascript-fig-11">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ライブラリ</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>jQuery</td>
                <td class="numeric">85.03%</td>
                <td class="numeric">83.46%</td>
              </tr>
              <tr>
                <td>jQuery Migrate</td>
                <td class="numeric">31.26%</td>
                <td class="numeric">31.68%</td>
              </tr>
              <tr>
                <td>jQuery UI</td>
                <td class="numeric">23.60%</td>
                <td class="numeric">21.75%</td>
              </tr>
              <tr>
                <td>Modernizr</td>
                <td class="numeric">17.80%</td>
                <td class="numeric">16.76%</td>
              </tr>
              <tr>
                <td>FancyBox</td>
                <td class="numeric">7.04%</td>
                <td class="numeric">6.61%</td>
              </tr>
              <tr>
                <td>Lightbox</td>
                <td class="numeric">6.02%</td>
                <td class="numeric">5.93%</td>
              </tr>
              <tr>
                <td>Slick</td>
                <td class="numeric">5.53%</td>
                <td class="numeric">5.24%</td>
              </tr>
              <tr>
                <td>Moment.js</td>
                <td class="numeric">4.92%</td>
                <td class="numeric">4.29%</td>
              </tr>
              <tr>
                <td>Underscore.js</td>
                <td class="numeric">4.20%</td>
                <td class="numeric">3.82%</td>
              </tr>
              <tr>
                <td>prettyPhoto</td>
                <td class="numeric">2.89%</td>
                <td class="numeric">3.09%</td>
              </tr>
              <tr>
                <td>Select2</td>
                <td class="numeric">2.78%</td>
                <td class="numeric">2.48%</td>
              </tr>
              <tr>
                <td>Lodash</td>
                <td class="numeric">2.65%</td>
                <td class="numeric">2.68%</td>
              </tr>
              <tr>
                <td>Hammer.js</td>
                <td class="numeric">2.28%</td>
                <td class="numeric">2.70%</td>
              </tr>
              <tr>
                <td>YUI</td>
                <td class="numeric">1.84%</td>
                <td class="numeric">1.50%</td>
              </tr>
              <tr>
                <td>Lazy.js</td>
                <td class="numeric">1.26%</td>
                <td class="numeric">1.56%</td>
              </tr>
              <tr>
                <td>Fingerprintjs</td>
                <td class="numeric">1.21%</td>
                <td class="numeric">1.32%</td>
              </tr>
              <tr>
                <td>script.aculo.us</td>
                <td class="numeric">0.98%</td>
                <td class="numeric">0.85%</td>
              </tr>
              <tr>
                <td>Polyfill</td>
                <td class="numeric">0.97%</td>
                <td class="numeric">1.00%</td>
              </tr>
              <tr>
                <td>Flickity</td>
                <td class="numeric">0.83%</td>
                <td class="numeric">0.92%</td>
              </tr>
              <tr>
                <td>Zepto</td>
                <td class="numeric">0.78%</td>
                <td class="numeric">1.17%</td>
              </tr>
              <tr>
                <td>Dojo</td>
                <td class="numeric">0.70%</td>
                <td class="numeric">0.62%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#javascript-fig-11" class="anchor-link">図 11.</a> デスクトップとモバイルでのトップ JavaScript ライブラリ</figcaption>
    </figure>
    <p>
      これまでに作成された中で最も人気のあるJavaScriptライブラリである<a href="https://jquery.com/">jQuery<span class="fn">https://jquery.com/</span></a
      >は、デスクトップページの85.03％、モバイルページの83.46％で使用されています。<a href="https://developer.mozilla.org/ja/docs/Web/API/Fetch_API">Fetch<span class="fn">https://developer.mozilla.org/ja/docs/Web/API/Fetch_API</span></a
      >や<a href="https://developer.mozilla.org/ja/docs/Web/API/Document/querySelector">querySelector<span class="fn">https://developer.mozilla.org/ja/docs/Web/API/Document/querySelector</span></a
      >など、多くのブラウザAPIやメソッドの出現により、ライブラリが提供する機能の多くがネイティブ形式に標準化されました。jQueryの人気は衰退しているように見えるかもしれませんが、なぜ今でもウェブの大部分で使われているのでしょうか？
    </p>
    <p>理由はいくつか考えられます。</p>
    <ul>
      <li>
        <a href="https://wordpress.org/">WordPress<span class="fn">https://wordpress.org/</span></a
        >は、30％以上のサイトで使用されているため、デフォルトでjQueryが含まれています。
      </li>
      <li>アプリケーションの規模によってはjQueryから新しいクライアントサイドライブラリへの切り替えに時間を要する場合があり、多くのサイトでは新しいクライアントサイドライブラリに加えてjQueryで構成されている場合があります。</li>
    </ul>
    <p>
      他にもjQueryの亜種（jQuery migrate、jQuery UI）、<a href="https://modernizr.com/">Modernizr<span class="fn">https://modernizr.com/</span></a
      >、<a href="https://momentjs.com/">Moment.js<span class="fn">https://momentjs.com/</span></a
      >、<a href="https://underscorejs.org/">Underscore.js<span class="fn">https://underscorejs.org/</span></a
      >などがトップで使用されているJavaScriptライブラリです。
    </p>
    <h3 id="javascript-フレームワークとuiライブラリ"><a href="#javascript-フレームワークとuiライブラリ" class="anchor-link">フレームワークとUIライブラリ</a></h3>
    <p class="note">
      <a href="#methodology-wappalyzer">方法論</a>で述べたように、HTTP Archive(Wappalyzer)で使用されているサードパーティ製の検出ライブラリには、特定のツールを検出する方法に関して多くの制限があります。<a href="https://github.com/AliasIO/wappalyzer/issues/2450">JavaScriptライブラリやフレームワークの検出を改善するための未解決の問題があります<span class="fn">https://github.com/AliasIO/wappalyzer/issues/2450</span></a
      >、それがここで紹介した結果に影響を与えています。
    </p>
    <p>過去数年の間に、JavaScriptのエコシステムでは、<strong>シングルページアプリケーション</strong> (SPA) の構築を容易にするオープンソースのライブラリやフレームワークが増えてきました。シングルページアプリケーションとは、単一のHTMLページを読み込み、サーバーから新しいページを取得する代わりにJavaScriptを使用してユーザーの対話に応じてページを修正するWebページのことを指します。これはシングルページアプリケーションの大前提であることに変わりはありませんが、このようなサイトの体験を向上させるために、異なるサーバーレンダリングアプローチを使用できます。これらのタイプのフレームワークを使用しているサイトはどれくらいあるのでしょうか？</p>
    <figure id="javascript-fig-12">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig12.png">
        <img src="/static/images/2019/javascript/fig12.png" alt="図12. デスクトップで最もよく使われるフレームワーク" aria-labelledby="javascript-fig12-caption" aria-describedby="javascript-fig12-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=1699359221&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="javascript-fig12-description" class="visually-hidden">Reactを使用しているサイトは4.6％、AngularJSを使用しているサイトは2.0％、Backbone.jsを使用しているサイトは1.8％、Vue.jsを使用しているサイトは0.8％、Knockout.jsを使用しているサイトは0.4％、Zone.jsを使用しているサイトは0.3％、Angularを使用しているサイトは0.3％、AMPを使用しているサイトは0.1％、Ember.jsを使用しているサイトは0.1％という棒グラフになっています。</div>
      <figcaption id="javascript-fig12-caption"><a href="#javascript-fig-12" class="anchor-link">図 12.</a> デスクトップで最もよく使われるフレームワーク</figcaption>
    </figure>
    <p>ここでは人気のあるフレームワークのサブセットのみを分析していますが、これらのフレームワークはすべて、これら2つのアプローチのいずれかに従っていることに注意することが重要です。</p>
    <ul>
      <li>
        <a href="https://developer.chrome.com/apps/app_frameworks">モデルビューコントローラ<span class="fn">https://developer.chrome.com/apps/app_frameworks</span></a
        >（またはモデルビュービューモデル）アーキテクチャー
      </li>
      <li>コンポーネントベースアーキテクチャ</li>
    </ul>
    <p>
      コンポーネントベースモデルへの移行が進んでいるとはいえ、MVCパラダイムを踏襲した古いフレームワーク（<a href="https://angularjs.org/">AngularJS<span class="fn">https://angularjs.org/</span></a
      >、<a href="https://backbonejs.org/">Backbone.js<span class="fn">https://backbonejs.org/</span></a
      >、<a href="https://emberjs.com/">Ember<span class="fn">https://emberjs.com/</span></a
      >）は、いまだに何千ページにもわたって使われています。しかし、<a href="https://reactjs.org/">React<span class="fn">https://reactjs.org/</span></a
      >、<a href="https://vuejs.org/">Vue<span class="fn">https://vuejs.org/</span></a
      >、<a href="https://angular.io/">Angular<span class="fn">https://angular.io/</span></a
      >はコンポーネントベースのフレームワークが主流です（<a href="https://github.com/angular/zone.js">Zone.js<span class="fn">https://github.com/angular/zone.js</span></a
      >は現在Angular coreの一部となっているパッケージです）。
    </p>
    <h2 id="javascript-差分ロード"><a href="#javascript-差分ロード" class="anchor-link">差分ロード</a></h2>
    <p>
      <a href="https://v8.dev/features/modules">JavaScriptモジュール<span class="fn">https://v8.dev/features/modules</span></a
      >、またはESモジュールは、<a href="https://caniuse.com/#feat=es6-module">すべての主要ブラウザ<span class="fn">https://caniuse.com/#feat=es6-module</span></a
      >でサポートされています。モジュールは、他のモジュールからインポートおよびエクスポートできるスクリプトを作成する機能を提供します。これにより、サードパーティのモジュールローダーに頼ることなく、必要に応じてインポートとエクスポートを行い、モジュールパターンで構築されたアプリケーションを誰でも構築できます。
    </p>
    <p>スクリプトをモジュールとして宣言するには、スクリプトタグが<code>type="module"</code>属性を取得しなければなりません。</p>
    <pre><code class="html language-html">&lt;script type="module" src="main.mjs"&gt;&lt;/script&gt;</code></pre>
    <p>ページ上のスクリプトに<code>type="module'</code>を使用しているサイトはどれくらいあるでしょうか？</p>
    <figure id="javascript-fig-13">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig13.png">
        <img src="/static/images/2019/javascript/fig13.png" alt="図13. type=moduleを利用しているサイトの割合。" aria-labelledby="javascript-fig13-caption" aria-describedby="javascript-fig13-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=1409239029&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig13-description" data-show-text="{{ show_description(13) }}" data-hide-text="{{ hide_description(13) }}">{{ show_description(13) }}</button>
      <div id="javascript-fig13-description" class="visually-hidden">デスクトップでは0.6%のサイトが「type=module」を使用しており、モバイルでは0.8%のサイトが使用していることを示す棒グラフです。</div>
      <figcaption id="javascript-fig13-caption"><a href="#javascript-fig-13" class="anchor-link">図 13.</a> type=moduleを利用しているサイトの割合。</figcaption>
    </figure>
    <p>
      ブラウザレベルでのモジュールのサポートはまだ比較的新しく、ここでの数字は、現在スクリプトに<code>type="module"</code>を使用しているサイトが非常に少ないことを示しています。多くのサイトでは、コードベース内でモジュールを定義するためにモジュールローダー（全デスクトップサイトの2.37％が<a href="https://github.com/requirejs/requirejs">RequireJS<span class="fn">https://github.com/requirejs/requirejs</span></a
      >を使用しています）やバンドラー（<a href="https://webpack.js.org/">webpack<span class="fn">https://webpack.js.org/</span></a
      >を使用しています）にまだ依存しています。
    </p>
    <p>ネイティブモジュールを使用する場合は、モジュールをサポートしていないブラウザに対して適切なフォールバックスクリプトを使用することが重要です。これは、<code>nomodule</code>属性を持つ追加スクリプトを含めることで実現できます。</p>
    <pre><code class="html language-html">&lt;script nomodule src="fallback.js"&gt;&lt;/script&gt;</code></pre>
    <p>
      併用すると、モジュールをサポートしているブラウザは<code>nomodule</code>属性を含むスクリプトを完全に無視します。一方、モジュールをサポートしていないブラウザは ¥<code>type="module"</code>属性を持つスクリプトをダウンロードしません。ブラウザは<code>nomodule</code>も認識しないので、<code>type="module"</code>属性を持つスクリプトを普通にダウンロードします。このアプローチを使うことで、開発者は<a href="https://web.dev/serve-modern-code-to-modern-browsers/">最新のコードを最新のブラウザに送信してページ読み込みを高速化する<span class="fn">https://web.dev/serve-modern-code-to-modern-browsers/</span></a
      >できます。では、ページ上のスクリプトに<code>nomodule</code>を使っているサイトはどれくらいあるのだろうか。
    </p>
    <figure id="javascript-fig-14">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig14.png">
        <img src="/static/images/2019/javascript/fig14.png" alt="図14. nomoduleを使用しているサイトの割合。" aria-labelledby="javascript-fig14-caption" aria-describedby="javascript-fig14-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=781034243&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig14-description" data-show-text="{{ show_description(14) }}" data-hide-text="{{ hide_description(14) }}">{{ show_description(14) }}</button>
      <div id="javascript-fig14-description" class="visually-hidden">デスクトップでは0.8％のサイトが「nomobule」を利用しており、モバイルでは0.5％のサイトが利用していることを示す棒グラフ。</div>
      <figcaption id="javascript-fig14-caption"><a href="#javascript-fig-14" class="anchor-link">図 14.</a> nomoduleを使用しているサイトの割合。</figcaption>
    </figure>
    <p>同様に、スクリプトに<code>nomodule</code>属性を使用しているサイトはほとんどありません（0.50％-0.80％）。</p>
    <h2 id="javascript-プリロードとプリフェッチ"><a href="#javascript-プリロードとプリフェッチ" class="anchor-link">プリロードとプリフェッチ</a></h2>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/HTML/Preloading_content">プリロード<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Preloading_content</span></a> と <a href="https://developer.mozilla.org/ja/docs/Web/HTTP/Link_prefetching_FAQ">プリフェッチ<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTTP/Link_prefetching_FAQ</span></a
      >は<a href="#resource-hints">リソースヒント</a>であり、どのリソースをダウンロードする必要があるかを判断する際にブラウザを助けることができます。
    </p>
    <ul>
      <li><code>&lt;link rel="preload"&gt;</code>でリソースをプリロードすると、ブラウザはこのリソースをできるだけ早くダウンロードするように指示します。これは、ページの読み込みプロセスの後半に発見され、最後にダウンロードされてしまう重要なリソース（例えば、HTMLの下部にあるJavaScriptなど）に特に役立ちます。</li>
      <li><code>&lt;link rel="prefetch"&gt;</code>を使用することで、ブラウザが将来のナビゲーションに必要なリソースを取得するためのアイドル時間を利用できるようにします。</li>
    </ul>
    <p>では、プリロードやプリフェッチディレクティブを使っているサイトはどれくらいあるのでしょうか？</p>
    <figure id="javascript-fig-15">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig15.png">
        <img src="/static/images/2019/javascript/fig15.png" alt="図15. スクリプトにrel=preloadを使用しているサイトの割合。" aria-labelledby="javascript-fig15-caption" aria-describedby="javascript-fig15-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=2007534370&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig15-description" data-show-text="{{ show_description(15) }}" data-hide-text="{{ hide_description(15) }}">{{ show_description(15) }}</button>
      <div id="javascript-fig15-description" class="visually-hidden">バーチャートを見ると、デスクトップでは14%のサイトがスクリプトに'rel=preload'を使用しており、モバイルでは15%のサイトがスクリプトにrel=preloadを使用していることがわかります。</div>
      <figcaption id="javascript-fig15-caption"><a href="#javascript-fig-15" class="anchor-link">図 15.</a> スクリプトにrel=preloadを使用しているサイトの割合。</figcaption>
    </figure>
    <p>HTTP Archiveで測定したすべてのサイトで、デスクトップサイトの14.33％、モバイルサイトの14.84％が<code>&lt;link rel="preload"&gt;</code>をページ上のスクリプトに使用しています。</p>
    <p>プリフェッチについて以下のようなものがあります。</p>
    <figure id="javascript-fig-16">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig16.png">
        <img src="/static/images/2019/javascript/fig16.png" alt="図16. スクリプトにrel=prefetchを使用しているサイトの割合。" aria-labelledby="javascript-fig16-caption" aria-describedby="javascript-fig16-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=547807937&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig16-description" data-show-text="{{ show_description(16) }}" data-hide-text="{{ hide_description(16) }}">{{ show_description(16) }}</button>
      <div id="javascript-fig16-description" class="visually-hidden">デスクトップでは0.08%のサイトが「rel=prefetch」を使用しており、モバイルでは0.08%のサイトが使用していることを示す棒グラフ。</div>
      <figcaption id="javascript-fig16-caption"><a href="#javascript-fig-16" class="anchor-link">図 16.</a> スクリプトにrel=prefetchを使用しているサイトの割合。</figcaption>
    </figure>
    <p>モバイルとデスクトップの両方で、0.08％のページがスクリプトのいずれかでプリフェッチを利用しています。</p>
    <h2 id="javascript-新しいapi"><a href="#javascript-新しいapi" class="anchor-link">新しいAPI</a></h2>
    <p>JavaScriptは言語として進化を続けています。ECMAScriptと呼ばれる言語標準そのものの新バージョンが毎年リリースされ、新しいAPIや機能が提案段階を通過して言語そのものの一部となっています。</p>
    <p>HTTP Archiveを使用すると、サポートされている（あるいはこれからサポートされる）新しいAPIを調べて、その使用法がどの程度普及しているかを知ることができます。これらのAPIは、サポートしているブラウザで既に使用されているかもしれませんし、すべてのユーザに対応しているかどうかを確認するためにポリフィルを添付しています。</p>
    <p>以下のAPIを使用しているサイトはどれくらいありますか？</p>
    <ul>
      <li>
        <a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Atomics">Atomics<span class="fn">https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Atomics</span></a>
      </li>
      <li>
        <a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Intl">Intl<span class="fn">https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Intl</span></a>
      </li>
      <li>
        <a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Proxy">Proxy<span class="fn">https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Proxy</span></a>
      </li>
      <li>
        <a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer">SharedArrayBuffer<span class="fn">https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer</span></a>
      </li>
      <li>
        <a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/WeakMap">WeakMap<span class="fn">https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/WeakMap</span></a>
      </li>
      <li>
        <a href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/WeakSet">WeakSet<span class="fn">https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/WeakSet</span></a>
      </li>
    </ul>
    <figure id="javascript-fig-17">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig17.png">
        <img src="/static/images/2019/javascript/fig17.png" alt="図17. 新しいJavaScript APIの利用法" aria-labelledby="javascript-fig17-caption" aria-describedby="javascript-fig17-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=594315296&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig17-description" data-show-text="{{ show_description(17) }}" data-hide-text="{{ hide_description(17) }}">{{ show_description(17) }}</button>
      <div id="javascript-fig17-description" class="visually-hidden">バーチャートを見ると、デスクトップとモバイルのサイトの25.5%/36.2%がWeakMap、6.1%/17.2%がWeakSet、3.9%/14.0%がIntl、3.9%/4.4%がProxy、0.4%/0.4%がAtomics、0.2%/0.2%がSharedArrayBufferを使用していることがわかります。</div>
      <figcaption id="javascript-fig17-caption"><a href="#javascript-fig-17" class="anchor-link">図 17.</a> 新しいJavaScript APIの利用法</figcaption>
    </figure>
    <p>Atomics(0.38％)とSharedArrayBuffer(0.20％)は、使用されているページが少ないので、このチャートではほとんど見えません。</p>
    <p>
      ここでの数値は概算であり、機能の使用状況を測定するための<a href="https://chromium.googlesource.com/chromium/src.git/+/master/docs/use_counter_wiki.md">UseCounter<span class="fn">https://chromium.googlesource.com/chromium/src.git/+/master/docs/use_counter_wiki.md</span></a> を活用していないことに注意してください。
    </p>
    <h2 id="javascript-ソースマップ"><a href="#javascript-ソースマップ" class="anchor-link">ソースマップ</a></h2>
    <p>
      多くのビルドシステムでは、JavaScriptファイルはサイズを最小化し、多くのブラウザではまだサポートされていない新しい言語機能のためにトランスパイルされるようにミニ化されています。さらに、<a href="https://www.typescriptlang.org/">TypeScript<span class="fn">https://www.typescriptlang.org/</span></a
      >のような言語スーパーセットは、元のソースコードとは明らかに異なる出力へコンパイルされます。これらの理由から、ブラウザに提供される最終的なコードは読めず、解読が困難なものになることがあります。
    </p>
    <p><strong>ソースマップ</strong>とは、JavaScriptファイルに付随する追加ファイルで、ブラウザが最終的な出力を元のソースにマップできます。これにより、プロダクションバンドルのデバッグや分析をより簡単にできます。</p>
    <p>便利ではありますが多くのサイトが最終的な制作サイトにソースマップを入れたくない理由は、完全なソースコードを公開しないことを選択するなど、いくつかあります。では、実際にどれくらいのサイトがソースマップを含んでいるのでしょうか？</p>
    <figure id="javascript-fig-18">
      <a href="https://almanac.httparchive.org/static/images/2019/javascript/fig18.png">
        <img src="/static/images/2019/javascript/fig18.png" alt="図18. ソースマップを使用しているサイトの割合。" aria-labelledby="javascript-fig18-caption" aria-describedby="javascript-fig18-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vTpzDb9HGbdVvin6YPTOmw11qBVGGysltxmH545fUfnqIThAq878F_b-KxUo65IuXaeFVSnlmJ5K1Dm/pubchart?oid=906754154&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig18-description" data-show-text="{{ show_description(18) }}" data-hide-text="{{ hide_description(18) }}">{{ show_description(18) }}</button>
      <div id="javascript-fig18-description" class="visually-hidden">デスクトップサイトの18％、モバイルサイトの17％がソースマップを使用していることを示す棒グラフ。</div>
      <figcaption id="javascript-fig18-caption"><a href="#javascript-fig-18" class="anchor-link">図 18.</a> ソースマップを使用しているサイトの割合。</figcaption>
    </figure>
    <p>デスクトップページでもモバイルページでも、結果はほぼ同じです。17～18％は、ページ上に少なくとも1つのスクリプトのソースマップを含んでいます（<code>sourceMappingURL</code>を持つファーストパーティスクリプトとして検出されます）。</p>
    <h2 id="javascript-結論"><a href="#javascript-結論" class="anchor-link">結論</a></h2>
    <p>JavaScriptのエコシステムは毎年変化し続け、進化し続けています。新しいAPI、改良されたブラウザエンジン、新しいライブラリやフレームワークなど、私たちが期待していることは尽きることがありません。HTTP Archiveは、実際のサイトがどのようにJavaScriptを使用しているかについての貴重な洞察を提供してくれます。</p>
    <p>JavaScriptがなければ、ウェブは現在の場所にはなく、この記事のために集められたすべてのデータがそれを証明しているに過ぎません。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"I","chapter_number":2,"title":"CSS","description":"色、単位、セレクター、レイアウト、タイポグラフィとフォント、間隔、装飾、アニメーション、およびメディアクエリをカバーする2019 Web AlmanacのCSS章。","authors":["una","argyleink"],"reviewers":["meyerweb","huijing"],"translators":["ksakae"],"discuss":"1757","results":"https://docs.google.com/spreadsheets/d/1uFlkuSRetjBNEhGKWpkrXo4eEIsgYelxY-qR9Pd7QpM/","queries":"02_CSS","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-07-06T00:00:00.000Z","chapter":"css"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="css-導入"><a href="#css-導入" class="anchor-link">導入</a></h2>
    <p>カスケードスタイルシート（CSS）は、Webページの描画、書式設定、およびレイアウトに使用されます。それらの機能は、テキストの色から3Dパースペクティブまでの単純な概念に及びます。また、さまざまな画面サイズ、コンテキストの表示、印刷を処理する開発者を支援するフックもあります。 CSSは、開発者がコンテンツを絞り込み、ユーザーに適切に適合させることを支援します。</p>
    <p>CSSをWebテクノロジーに慣れていない人に説明するときは、CSSを家の壁にペイントする言語と考える事が役立ちます。窓やドアのサイズと位置、および壁紙や植物などが栄える装飾と説明できる。そのストーリーの面白いひねりは、ユーザーが家の中を歩いているかどうかに応じて、開発者はその特定のユーザーの好みやコンテキストに家を作り替えることができるということです！</p>
    <p>この章では、WebでのCSSの使用方法に関するデータを検査、集計、および抽出します。私たちの目標はどの機能が使用されているか、どのように使用されているか、CSSがどのように成長し採用されているかを全体的に理解することです。</p>
    <p>魅力的なデータを掘り下げる準備はできましたか?! 以下の数値の多くは小さい場合がありますが、重要ではないと誤解しないでください! 新しいものがウェブを飽和させるには何年もかかることがあります。</p>
    <h2 id="css-色"><a href="#css-色" class="anchor-link">色</a></h2>
    <p>色は、Webのテーマとスタイリングに不可欠な部分です。ウェブサイトが色を使用する傾向を見てみましょう。</p>
    <h3 id="css-色の種類"><a href="#css-色の種類" class="anchor-link">色の種類</a></h3>
    <p>
      16進数は、色を説明する最も一般的な方法であり93％の使用率、RGB、HSLが続きます。興味深いことに、開発者はこれらの色の種類に関してアルファ透明度の引数を最大限に活用しています。HSLAとRGBAは、HSLとRGBよりもはるかに人気があり、使用量はほぼ2倍です。アルファ透明度は後でWeb仕様に追加されましたが、HSLAとRGBAは<a href="https://caniuse.com/#feat=css3-colors">IE9までさかのぼって<span class="fn">https://caniuse.com/#feat=css3-colors</span></a
      >サポートされているため、先に進んで使用することもできます！
    </p>
    <figure id="css-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig1.png">
        <img src="/static/images/2019/css/fig1.png" alt="図1.カラー形式の人気。" aria-labelledby="css-fig1-caption" aria-describedby="css-fig1-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1946838030&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="css-fig1-description" class="visually-hidden">HSL、HSLA、RGB、RGBA、および16進カラー形式の採用を示す棒グラフ。 Hexはデスクトップページの93％、RGBAは83％、RGBは22％、HSLA 19％、HSL 1％で使用されています。デスクトップとモバイルの採用は、モバイルの採用が9％（9倍）であるHSLを除くすべてのカラー形式で類似しています。s</div>
      <figcaption id="css-fig1-caption"><a href="#css-fig-1" class="anchor-link">図 1.</a>カラー形式の人気。</figcaption>
    </figure>
    <h3 id="css-色の選択"><a href="#css-色の選択" class="anchor-link">色の選択</a></h3>
    <p>
      CSSの<a href="https://www.w3.org/TR/css-color-4/#named-colors">名前付きカラーは148個<span class="fn">https://www.w3.org/TR/css-color-4/#named-colors</span></a
      >あり、<code>transparent</code>および<code>currentcolor</code>の特別な値は含まれていません。これらを文字列名で使用して、読みやすくできます。最も人気がある名前の付いた色は<code>黒</code>と<code>白</code>であり、当然のことながら<code>赤</code>と<code>青</code>が続きます。
    </p>
    <figure id="css-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig2.png">
        <img src="/static/images/2019/css/fig2.png" alt="図2.上位の名前付き色。" aria-labelledby="css-fig2-caption" aria-describedby="css-fig2-description" width="600" height="415" data-width="600" data-height="415" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1985913808&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="css-fig2-description" class="visually-hidden">最も人気のある名前付きの色を示す円グラフ。白が40％で最も人気があり、次に黒が22％、赤が11％、青が5％です。</div>
      <figcaption id="css-fig2-caption"><a href="#css-fig-2" class="anchor-link">図 2.</a>上位の名前付き色。</figcaption>
    </figure>
    <p>
      言語は色によっても興味深いことに推測されます。イギリス式の「grey」よりもアメリカ式の「gray」の例が多くあります。<a href="https://www.rapidtables.com/web/color/gray-color.html">グレー色<span class="fn">https://www.rapidtables.com/web/color/gray-color.html</span></a
      >（<code>グレー</code>、<code>ライトグレー</code>、<code>ダークグレー</code>、<code>スレートグレー</code>など）のほぼすべてのインスタンスは、「e」ではなく「a」で綴ると、使用率がほぼ2倍になりました。 gr [a/e] ysが組み合わされた場合、それらは青よりも上位にランクされ、＃4スポットで固まります。これが、チャートで銀がグレーよりも高いランクになっている理由です。
    </p>
    <h3 id="css-色の数"><a href="#css-色の数" class="anchor-link">色の数</a></h3>
    <p>ウェブ全体でいくつの異なるフォントの色が使用されていますか？　これは一意の色の総数ではありません。むしろ、テキストに使用される色の数です。このグラフの数値は非常に高く、経験からCSS変数なしでは間隔、サイズ、色がすぐに離れて、スタイル全体で多くの小さな値に断片化することがわかります。これらの数値はスタイル管理の難しさを反映しており、あなたがチームやプロジェクトに持ち帰るための何らかの視点を作り出すのに役立つことを願っています。この数を管理可能かつ合理的な量に減らすにはどうすればよいですか？</p>
    <figure id="css-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig3.png">
        <img src="/static/images/2019/css/fig3.png" alt="図3.ページごとの色の分布。" aria-labelledby="css-fig3-caption" aria-describedby="css-fig3-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1361184636&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="css-fig3-description" class="visually-hidden">デスクトップおよびモバイルページごとの色の10、25、50、75、および90パーセンタイルを示す分布。デスクトップ分布は8、22、48、83、および131です。モバイルページは、1〜10までに色が増える傾向があります。</div>
      <figcaption id="css-fig3-caption"><a href="#css-fig-3" class="anchor-link">図 3.</a>ページごとの色の分布。</figcaption>
    </figure>
    <h3 id="css-色の複製"><a href="#css-色の複製" class="anchor-link">色の複製</a></h3>
    <p>さて、私たちはここで興味を持ち、ページにいくつの重複色が存在するかを調べたいと思いました。しっかり管理された再利用可能なクラスCSSシステムがなければ、複製はものすごく簡単に作成できます。中央値には十分な重複があるため、パスを実行してそれらをカスタムプロパティと統合する価値があるかもしれません。</p>
    <figure id="css-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig4.png">
        <img src="/static/images/2019/css/fig4.png" alt="図4.ページごとの複製色の分布。" aria-labelledby="css-fig4-caption" aria-describedby="css-fig4-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=326531498&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="css-fig4-description" class="visually-hidden">ページごとの色の分布を示す棒グラフ。中央のデスクトップページには24の重複した色があります。 10パーセンタイルは4つの重複色であり、90パーセンタイルは62です。デスクトップとモバイルの分布は似ています。</div>
      <figcaption id="css-fig4-caption"><a href="#css-fig-4" class="anchor-link">図 4.</a>ページごとの複製色の分布。</figcaption>
    </figure>
    <h2 id="css-ユニット"><a href="#css-ユニット" class="anchor-link">ユニット</a></h2>
    <p>CSSには、異なるユニットタイプ（<code>rem</code>、<code>px</code>、<code>em</code>、<code>ch</code>、または<code>cm</code>）を使用して同じ視覚的結果を達成するためのさまざまな方法があります！　それで、どのユニットタイプが最も人気ですか？</p>
    <figure id="css-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig5.png">
        <img src="/static/images/2019/css/fig5.png" alt="図5.ユニットタイプの人気。" aria-labelledby="css-fig5-caption" aria-describedby="css-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=540111393&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="css-fig5-description" class="visually-hidden">さまざまなユニットタイプの人気の棒グラフ。 pxとemは、ページの90％以上で使用されています。 remは、ページの40％で次に人気のあるユニットタイプであり、残りのユニットタイプの人気は急落します。</div>
      <figcaption id="css-fig5-caption"><a href="#css-fig-5" class="anchor-link">図 5.</a>ユニットタイプの人気。</figcaption>
    </figure>
    <h3 id="css-長さとサイズ"><a href="#css-長さとサイズ" class="anchor-link">長さとサイズ</a></h3>
    <p>当然のことながら、上の図5では、<code>px</code>が最もよく使用されるユニットタイプであり、Webページの約95％が何らかの形式のピクセルを使用しています（これは要素のサイズ、フォントサイズなどです）。ただし、<code>em</code>ユニットの使用率はほぼ同じで約90％です。これは、Webページで40％の頻度しかない<code>rem</code>ユニットよりも2倍以上人気があります。違いを知りたい場合は、<code>em</code>は親フォントサイズに基づいており、<code>rem</code>はページに設定されている基本フォントサイズに基づいています。 <code>em</code> のようにコンポーネントごとに変更されることはないため、すべての間隔を均等に調整できます。</p>
    <p>物理的な空間に基づいた単位となると、<code>cm</code>（またはセンチメートル）ユニットが最も人気であり、次に<code>in</code>（インチ）、<code>Q</code>が続きます。これらのタイプのユニットは、印刷スタイルシートに特に役立つことがわかっていますが、この調査まで<code>Q</code>ユニットが存在することさえ知りませんでした！　知ってましたか？</p>
    <p class="note">
      この章の以前のバージョンでは、<code>Q</code>ユニットの予想外の人気について説明しました。この章を取り巻く<a href="https://discuss.httparchive.org/t/chapter-2-css/1757/6">コミュニティの議論<span class="fn">https://discuss.httparchive.org/t/chapter-2-css/1757/6</span></a
      >のおかげで、これは分析のバグであることがわかり、それに応じて図5を更新しました。
    </p>
    <h3 id="css-ビューポートベースのユニット"><a href="#css-ビューポートベースのユニット" class="anchor-link">ビューポートベースのユニット</a></h3>
    <p>ビューポートベースのユニットのモバイルとデスクトップの使用に関しては、ユニットタイプに大きな違いが見られました。モバイルサイトは36.8％が<code>vh</code>（ビューポートの高さ）を使用していますが、デスクトップサイトは31％しか使用していません。また、<code>vh</code>は<code>vw</code>（ビューポートの幅）よりも約11％一般的です。 <code>vmin</code>（ビューポートの最小値）は<code>vmax</code>（ビューポートの最大値）よりも人気があり、モバイルでの<code>vmin</code>の使用率は約8％で、<code>vmax</code>はWebサイトの1％のみが使用しています。</p>
    <h3 id="css-カスタムプロパティ"><a href="#css-カスタムプロパティ" class="anchor-link">カスタムプロパティ</a></h3>
    <p>カスタムプロパティは、多くの場合CSS変数と呼ばれます。ただし、通常の静的変数よりも動的です！　CSS変数は非常に強力であり、コミュニティとして私たちはまだ彼らの可能性を発見しています。</p>
    <figure id="css-fig-6">
      <div class="big-number">5%</div>
      <figcaption><a href="#css-fig-6" class="anchor-link">図 6.</a>カスタムプロパティを使用しているページの割合。</figcaption>
    </figure>
    <p>私たちのお気に入りはCSS追加の1つが健全な成長を示しており、これは刺激的な情報だと感じました。これらは2016年または2017年以降、すべての主要なブラウザで利用可能であったため、かなり新しいと言っても過言ではありません。多くの人々は、CSSプリプロセッサ変数からCSSカスタムプロパティに移行しています。カスタムプロパティが標準になるまであと数年かかると推定されます。</p>
    <h2 id="css-セレクター"><a href="#css-セレクター" class="anchor-link">セレクター</a></h2>
    <h3 id="css-id-vs-クラスセレクター"><a href="#css-id-vs-クラスセレクター" class="anchor-link">ID vs クラスセレクター</a></h3>
    <p>CSSには、スタイリングのためにページ上の要素を見つける方法がいくつかあるのでIDとクラスを互いに比較して、どちらがより一般的であるかを確認しましょう。結果は驚くべきものでありません。クラスの方が人気です！</p>
    <figure id="css-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig7.png">
        <img src="/static/images/2019/css/fig7.png" alt="図7.ページごとのセレクタータイプの人気。" aria-labelledby="css-fig7-caption" aria-describedby="css-fig7-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1216272563&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="css-fig7-description" class="visually-hidden">IDおよびクラスセレクタータイプの採用を示す棒グラフ。クラスは、デスクトップおよびモバイルページの95％で使用されます。 IDは、デスクトップの89％とモバイルページの87％で使用されます。</div>
      <figcaption id="css-fig7-caption"><a href="#css-fig-7" class="anchor-link">図 7.</a>ページごとのセレクタータイプの人気。</figcaption>
    </figure>
    <p>素敵なフォローアップチャートはこれです。スタイルシートで見つかったセレクタの93％がクラスを占めることを示しています。</p>
    <figure id="css-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig8.png">
        <img src="/static/images/2019/css/fig8.png" alt="図8.セレクタごとのセレクタタイプの人気。" aria-labelledby="css-fig8-caption" aria-describedby="css-fig8-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=351006989&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="css-fig8-description" class="visually-hidden">セレクタの94％にデスクトップとモバイルのクラスセレクタが含まれていることを示す棒グラフ、一方デスクトップセレクターの7％にはIDセレクターが含まれます（モバイルの場合は8％）。</div>
      <figcaption id="css-fig8-caption"><a href="#css-fig-8" class="anchor-link">図 8.</a>セレクタごとのセレクタタイプの人気。</figcaption>
    </figure>
    <h3 id="css-属性セレクター"><a href="#css-属性セレクター" class="anchor-link">属性セレクター</a></h3>
    <p>CSSには、非常に強力な比較セレクターがいくつかあります。これらは、<code>[target="_blank"]</code>、<code>[attribute^="value"]</code>、<code>[title~="rad"]</code>、<code>[attribute$="-rad"]</code>または<code>[attribute*="value"]</code>などのセレクターです。それらを使用しますか？　よく使われていると思いますか？　それらがWeb全体でIDとクラスでどのように使用されるかを比較しましょう。</p>
    <figure id="css-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig9.png">
        <img src="/static/images/2019/css/fig9.png" alt="図9. ID属性セレクターごとの演算子の人気。" aria-labelledby="css-fig9-caption" aria-describedby="css-fig9-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=695879874&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="css-fig9-description" class="visually-hidden">ID属性セレクターで使用される演算子の人気を示す棒グラフ。デスクトップページとモバイルページの約4％は、スターイコールとキャレットイコールを使用しています。 1％のページで「イコール」と「ダラーイコール」を使用しています。 0％はチルダイコールを使用します。</div>
      <figcaption id="css-fig9-caption"><a href="#css-fig-9" class="anchor-link">図 9.</a> ID属性セレクターごとの演算子の人気。</figcaption>
    </figure>
    <figure id="css-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig10.png">
        <img src="/static/images/2019/css/fig10.png" alt="図10.クラス属性セレクタごとの演算子の人気。" aria-labelledby="css-fig10-caption" aria-describedby="css-fig10-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=377805296&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="css-fig10-description" class="visually-hidden">クラス属性セレクターで使用される演算子の人気を示す棒グラフ。 57％のページがスターイコールを使用しています。 36％がキャレットイコールを使用します。 1％はイコールおよびドルイコールを使用します。 0％はチルダイコールを使用します。</div>
      <figcaption id="css-fig10-caption"><a href="#css-fig-10" class="anchor-link">図 10.</a>クラス属性セレクタごとの演算子の人気。</figcaption>
    </figure>
    <p>スタイルシートのIDセレクターは通常クラスセレクターよりも少ないため、これらの演算子はIDよりもクラスセレクターではるかに人気がありますが、これらすべての組み合わせの使用法は見た目にも優れています。</p>
    <h3 id="css-要素ごとのクラス"><a href="#css-要素ごとのクラス" class="anchor-link">要素ごとのクラス</a></h3>
    <p>OOCSS、アトミック、および機能的なCSS戦略の登場により要素に10以上のクラスを構成してデザインの外観を実現できるため、おそらく興味深い結果が得られるでしょう。クエリは非常に刺激的でなく、モバイルとデスクトップの中央値は要素ごとに1クラスでした。</p>
    <figure id="css-fig-11">
      <div class="big-number">1</div>
      <figcaption><a href="#css-fig-11" class="anchor-link">図 11.</a>クラス属性ごとのクラス名の中央値数（デスクトップおよびモバイル）。</figcaption>
    </figure>
    <h2 id="css-レイアウト"><a href="#css-レイアウト" class="anchor-link">レイアウト</a></h2>
    <h3 id="css-flexbox"><a href="#css-flexbox" class="anchor-link">Flexbox</a></h3>
    <p>
      <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox">Flexbox<span class="fn">https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox</span></a
      >は、子を指示、整列するコンテナスタイルです。つまり制約ベースの方法でレイアウトを支援します。 2010年から2013年の間に仕様が2〜3の大幅な変更を経たため、Webでの開始は非常に困難でした。幸いなことに、2014年までにすべてのブラウザに落ち着き実装されました。その歴史を考えると採用率は低かったのですが、それから数年が経ちました！　今では非常に人気があり、それに関する多くの記事とそれを活用する方法がありますが、他のレイアウト戦術と比較してまだ新しいです。
    </p>
    <figure id="css-fig-12">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig12.png">
        <img src="/static/images/2019/css/fig12.png" alt="図12.フレックスボックスの採用。" aria-labelledby="css-fig12-caption" aria-describedby="css-fig12-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=2021161093&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="css-fig12-description" class="visually-hidden">フレックスボックスを使用したデスクトップページの49％とモバイルページの52％を示す棒グラフ。</div>
      <figcaption id="css-fig12-caption"><a href="#css-fig-12" class="anchor-link">図 12.</a>フレックスボックスの採用。</figcaption>
    </figure>
    <p>Webのほぼ50％がスタイルシートでflexboxを使用しているため、ここに示したかなりの成功事例です。</p>
    <h3 id="css-grid"><a href="#css-grid" class="anchor-link">Grid</a></h3>
    <p>
      flexboxと同様に、<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout">グリッド<span class="fn">https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout</span></a
      >も早い段階でいくつかの仕様変更を経ましたが、公的に展開されたブラウザの実装を変更することはありませんでした。 Microsoftは、水平方向にスクロールするデザインスタイルの主要なレイアウトエンジンとして、Windows 8の最初のバージョンにグリッドを備えていました。最初にそこで検証され、Webに移行し、その後、2017年の最終リリースまで他のブラウザーによって強化されました。ほぼすべてのブラウザーが同時に実装をリリースしたため、Web開発者はある日目覚めただけで優れたグリッドサポートを得ることができました。今日2019年の終わりに、グリッドはまだ子供のように感じています。人々がまだその力と能力に気付き始めているため。
    </p>
    <figure id="css-fig-13">
      <div class="big-number">2%</div>
      <figcaption><a href="#css-fig-13" class="anchor-link">図 13.</a>グリッドを使用するWebサイトの割合。</figcaption>
    </figure>
    <p>これは、Web開発コミュニティが最新のレイアウトツールを使用して調査したことがどれほど少ないかを示しています。主要なレイアウトエンジンの人々がサイトを構築する際に頼るので、グリッドの最終的な引継ぎを楽しみにしています。著者にとって、私たちはグリッドを書くのが大好きです。通常、最初にグリッドへ到達し、次にレイアウトを実現し、繰り返しながら複雑さをダイヤルバックします。今後数年間で、この強力なCSS機能を使用して他の地域がどうなるかは今後の課題です。</p>
    <h3 id="css-書き込みモード"><a href="#css-書き込みモード" class="anchor-link">書き込みモード</a></h3>
    <p>WebとCSSは国際的なプラットフォーム機能であり、書き込みモードはHTMLとCSSが要素内でユーザーの好みの読み取りと書き込みの方向を示す方法を提供します。</p>
    <figure id="css-fig-14">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig14.png">
        <img src="/static/images/2019/css/fig14.png" alt="図14.方向の値の人気。" aria-labelledby="css-fig14-caption" aria-describedby="css-fig14-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=136847988&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig14-description" data-show-text="{{ show_description(14) }}" data-hide-text="{{ hide_description(14) }}">{{ show_description(14) }}</button>
      <div id="css-fig14-description" class="visually-hidden">方向値ltrおよびrtlの人気を示す棒グラフ。 ltrは、デスクトップページの32％とモバイルページの40％で使用されています。 rtlは、デスクトップページの32％とモバイルページの36％で使用されています。</div>
      <figcaption id="css-fig14-caption"><a href="#css-fig-14" class="anchor-link">図 14.</a>方向の値の人気。</figcaption>
    </figure>
    <h2 id="css-タイポグラフィ"><a href="#css-タイポグラフィ" class="anchor-link">タイポグラフィ</a></h2>
    <h3 id="css-ページごとのwebフォント"><a href="#css-ページごとのwebフォント" class="anchor-link">ページごとのWebフォント</a></h3>
    <p>WebページにいくつのWebフォントをロードしていますか：0？　10？　1ページあたりのWebフォントの中央値は3です！</p>
    <figure id="css-fig-15">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig15.png">
        <img src="/static/images/2019/css/fig15.png" alt="図15.ページごとにロードされるWebフォントの数の分布。" aria-labelledby="css-fig15-caption" aria-describedby="css-fig15-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1453570774&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig15-description" data-show-text="{{ show_description(15) }}" data-hide-text="{{ hide_description(15) }}">{{ show_description(15) }}</button>
      <div id="css-fig15-description" class="visually-hidden">ページごとにロードされるWebフォントの数の分布。デスクトップでは、10、25、50、75、および90パーセンタイルは0、1、3、6、および9です。これは、75パーセンタイルと90パーセンタイルで1つ少ないフォントであるモバイル配布よりわずかに高くなっています。</div>
      <figcaption id="css-fig15-caption"><a href="#css-fig-15" class="anchor-link">図 15.</a>ページごとにロードされるWebフォントの数の分布。</figcaption>
    </figure>
    <h3 id="css-人気のあるフォントファミリー"><a href="#css-人気のあるフォントファミリー" class="anchor-link">人気のあるフォントファミリー</a></h3>
    <p>ページあたりのフォントの総数の問い合わせに対する自然な回答は、次のとおりです。それらはどのフォントですか?!　デザイナーは、あなたの選択が人気のあるものと一致しているかどうかを確認できるようになります。</p>
    <figure id="css-fig-16">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig16.png">
        <img src="/static/images/2019/css/fig16.png" alt="図16.上位のWebフォント。" aria-labelledby="css-fig16-caption" aria-describedby="css-fig16-description" width="600" height="450" data-width="600" data-height="450" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1883567922&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig16-description" data-show-text="{{ show_description(16) }}" data-hide-text="{{ hide_description(16) }}">{{ show_description(16) }}</button>
      <div id="css-fig16-description" class="visually-hidden">最も人気のあるフォントの棒グラフ。デスクトップページの中で、Open Sans（24％）、Roboto（15％）、Montserrat（5％）、Source Sans Pro（4％）、Noto Sans JP（3％）、Lato（3％）です。モバイルで最も顕著な違いは、Open Sansが時間の22％で使用され（24％から減少）、Robotoが時間の19％で使用される（15％から増加）ことです。</div>
      <figcaption id="css-fig16-caption"><a href="#css-fig-16" class="anchor-link">図 16.</a>上位のWebフォント。</figcaption>
    </figure>
    <p>ここではOpen Sansが大きな勝者であり、CSSの<code>@font-family</code>宣言の4分の1近くがそれを指定しています。私たちは間違いなく、プロジェクトでOpen Sansを使用しています。</p>
    <p>また、デスクトップ導入とモバイル導入の違いに注目することも興味深いです。たとえば、モバイルページはデスクトップよりもOpen Sansの使用頻度がわずかに低いです。一方、デスクトップはRobotoを少しだけ頻繁に使用します。</p>
    <h3 id="css-フォントサイズ"><a href="#css-フォントサイズ" class="anchor-link">フォントサイズ</a></h3>
    <p>これは楽しいものです。ユーザーがページ上にあると感じるフォントサイズの数をユーザーに尋ねた場合、通常5または10未満の数値が返されるからです。デザインシステムでフォントサイズはいくつありますか？　Webに問い合わせたところ、中央値はモバイルで40、デスクトップで38でした。タイプランプの配布に役立つカスタムプロパティや再利用可能なクラスの作成について真剣に考える時間になるかもしれません。</p>
    <figure id="css-fig-17">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig17.png">
        <img src="/static/images/2019/css/fig17.png" alt="図17.ページごとの異なるフォントサイズの数の分布。" aria-labelledby="css-fig17-caption" aria-describedby="css-fig17-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1695270216&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig17-description" data-show-text="{{ show_description(17) }}" data-hide-text="{{ hide_description(17) }}">{{ show_description(17) }}</button>
      <div id="css-fig17-description" class="visually-hidden">ページごとの異なるフォントサイズの分布を示す棒グラフ。デスクトップページの10、25、50、75、および90パーセンタイルは、8、20、40、66、および92のフォントサイズです。デスクトップディストリビューションは、75パーセンタイルでモバイルとは異なり、7〜13の異なるサイズで大きくなっています。</div>
      <figcaption id="css-fig17-caption"><a href="#css-fig-17" class="anchor-link">図 17.</a>ページごとの異なるフォントサイズの数の分布。</figcaption>
    </figure>
    <h2 id="css-間隔"><a href="#css-間隔" class="anchor-link">間隔</a></h2>
    <h3 id="css-マージン"><a href="#css-マージン" class="anchor-link">マージン</a></h3>
    <p>マージンとは、自分の腕を押し出すときに要求するスペースのような要素の外側のスペースです。これは多くの場合、要素間の間隔のように見えますが、その効果に限定されません。 Webサイトまたはアプリでは、間隔はUXとデザインで大きな役割を果たします。スタイルシートにどのくらいのマージン間隔コードが入るか見てみましょうか？</p>
    <figure id="css-fig-18">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig18.png">
        <img src="/static/images/2019/css/fig18.png" alt="図18.ページごとの異なるマージン値の数の分布。" aria-labelledby="css-fig18-caption" aria-describedby="css-fig18-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=4233531&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig18-description" data-show-text="{{ show_description(18) }}" data-hide-text="{{ hide_description(18) }}">{{ show_description(18) }}</button>
      <div id="css-fig18-description" class="visually-hidden">ページごとの明確なマージン値の分布を示す棒グラフ。デスクトップページの場合、10、25、50、75、および90パーセンタイルは、12、47、96、167、および248の異なるマージン値です。デスクトップディストリビューションは75パーセンタイルでモバイルとは異なり、12〜31の異なる値で小さくなっています。</div>
      <figcaption id="css-fig18-caption"><a href="#css-fig-18" class="anchor-link">図 18.</a>ページごとの異なるマージン値の数の分布。</figcaption>
    </figure>
    <p>かなりたくさんのようです！　デスクトップページの中央値には96の異なるマージン値があり、モバイルでは104です。これにより、デザインに多くのユニークな間隔が生まれます。あなたのサイトにいくつのマージンがあるか​​知りたい？　この空白をすべて管理しやすくするにはどうすればよいですか？</p>
    <h3 id="css-論理プロパティ"><a href="#css-論理プロパティ" class="anchor-link">論理プロパティ</a></h3>
    <figure id="css-fig-19">
      <div class="big-number">0.6%</div>
      <figcaption><a href="#css-fig-19" class="anchor-link">図 19.</a>論理プロパティを含むデスクトップおよびモバイルページの割合。</figcaption>
    </figure>
    <p><code>margin-left</code>と<code>padding-top</code>の覇権は限られた期間であり、書き込み方向に依存しない、連続した論理プロパティ構文によりまもなく補完されると推定します。楽観的ではありますが、現在の使用量は非常に低く、デスクトップページでの使用量は0.67％です。私たちにとって、これは業界として開発する必要がある習慣の変化のように感じられますが、新しいシンタックスを使用するために新しい開発者を訓練することを願っています。</p>
    <h3 id="css-z-index"><a href="#css-z-index" class="anchor-link">z-index</a></h3>
    <p>CSSの<code>z-index</code>を使用して、垂直の階層化またはスタックを管理できます。私たちは、人々が自分のサイトでどれだけ多くの価値を使用しているかに興味がありました。 <code>z-index</code>が受け入れる範囲は理論的には無限であり、ブラウザーの可変サイズの制限によってのみ制限されます。それらすべてのスタック位置が使用されていますか？　では見てみよう！</p>
    <figure id="css-fig-20">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig20.png">
        <img src="/static/images/2019/css/fig20.png" alt="図20.ページごとの個別の`z-index`値の数の分布。" aria-labelledby="css-fig20-caption" aria-describedby="css-fig20-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1320871189&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig20-description" data-show-text="{{ show_description(20) }}" data-hide-text="{{ hide_description(20) }}">{{ show_description(20) }}</button>
      <div id="css-fig20-description" class="visually-hidden">ページごとの異なるz-index値の分布を示す棒グラフ。デスクトップページの場合、10、25、50、75、および90パーセンタイルは、1、7、16、26、および36の異なるz-index値です。デスクトップの分布はモバイルよりもはるかに高く、90パーセンタイルで16もの異なる値があります。</div>
      <figcaption id="css-fig20-caption"><a href="#css-fig-20" class="anchor-link">図 20.</a>ページごとの個別の<code>z-index</code>値の数の分布。</figcaption>
    </figure>
    <h3 id="css-人気のあるz-index値"><a href="#css-人気のあるz-index値" class="anchor-link">人気のあるz-index値</a></h3>
    <p>私たちの仕事の経験から、9の任意の数が最も一般的な選択肢であると思われました。可能な限り少ない数を使用するように教えたにもかかわらず、それは共同の基準ではありません。じゃあ何ですか?!　人々が一番上のものを必要とする場合、最も人気のあるZインデックス番号は何ですか？　飲み物を置いてください。これはあなたがそれを失うかもしれないので十分面白いです。</p>
    <figure id="css-fig-21">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig21.png">
        <img src="/static/images/2019/css/fig21.png" alt="図21.最も頻繁に使用される`z-index`値。" aria-labelledby="css-fig21-caption" aria-describedby="css-fig21-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1169148473&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig21-description" data-show-text="{{ show_description(21) }}" data-hide-text="{{ hide_description(21) }}">{{ show_description(21) }}</button>
      <div id="css-fig21-description" class="visually-hidden">デスクトップとモバイルの両方について、すべての既知のz-index値とそれらが使用された回数の散布図。 1と2が最も頻繁に使用されますが、残りの人気のある値は数百桁の数字まで桁違いに爆発します：10、100、1,000など。</div>
      <figcaption id="css-fig21-caption"><a href="#css-fig-21" class="anchor-link">図 21.</a>最も頻繁に使用される<code>z-index</code>値。</figcaption>
    </figure>
    <figure id="css-fig-22">
      <div class="really-big-number">
        999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999 !important
      </div>
      <figcaption><a href="#css-fig-21" class="anchor-link">図 21.</a>最も頻繁に使用される<code>z-index</code>値。</figcaption>
    </figure>
    <h2 id="css-デコレーション"><a href="#css-デコレーション" class="anchor-link">デコレーション</a></h2>
    <h3 id="css-フィルター"><a href="#css-フィルター" class="anchor-link">フィルター</a></h3>
    <p>フィルターは、ブラウザーが画面に描画するピクセルを変更するための楽しくて素晴らしい方法です。これは、適用対象の要素、ノード、またはレイヤーのフラットバージョンに対して実行される後処理効果です。 Photoshopによって使いやすくなり、Instagramによって、オーダーメイドの定型化された組み合わせによって大衆がアクセスできるようになりました。それらは2012年頃から存在し、10個あります。それらを組み合わせて独自の効果を作成できます。</p>
    <figure id="css-fig-23">
      <div class="big-number">78%</div>
      <figcaption><a href="#css-fig-23" class="anchor-link">図 23.</a> <code>フィルター</code>プロパティを持つスタイルシートを含むページの割合。</figcaption>
    </figure>
    <p>スタイルシートの78％に<code>フィルター</code>プロパティが含まれていることがわかりました。その数も非常に高かったので、少し怪しいように思えたので、私たちは深掘りしてその高い数を説明しようとしました。正直に言って、フィルターはきちんとしていますが、すべてのアプリケーションやプロジェクトに組み込まれているわけではありません。しない限り！</p>
    <p>
      さらなる調査の結果、<a href="https://fontawesome.com">FontAwesome<span class="fn">https://fontawesome.com</span></a
      >のスタイルシートには<code>フィルター</code>の使用法と<a href="https://youtube.com">YouTube<span class="fn">https://youtube.com</span></a
      >埋め込みが含まれていることがわかりました。そのため、非常に人気のあるいくつかのスタイルシートに便乗することで、バックドアに<code>フィルター</code>が入り込むと考えています。また、<code>-ms-filter</code>の存在も含まれている可能性があり、使用率が高くなっていると考えられます。
    </p>
    <h3 id="css-ブレンドモード"><a href="#css-ブレンドモード" class="anchor-link">ブレンドモード</a></h3>
    <p>ブレンドモードは、ターゲット要素のフラットバージョンに対して実行される後処理効果であるという点でフィルターに似ていますが、ピクセル収束に関係しているという点で独特です。別の言い方をすれば、ブレンドモードとは、2つのピクセルが重なり合ったときに互いに影響を与える方法です。上部または下部のどちらの要素でも、ブレンドモードがピクセルを操作する方法に影響します。 16種類のブレンドモードがあります。どのモードが最も人気かを見てみましょう。</p>
    <figure id="css-fig-24">
      <div class="big-number">8%</div>
      <figcaption><a href="#css-fig-24" class="anchor-link">図 24.</a> <code>*-blend-mode</code>プロパティを持つスタイルシートを含むページの割合。</figcaption>
    </figure>
    <p>全体的に、ブレンドモードの使用はフィルターの使用よりもはるかに低いですが、適度に使用されていると見なすのに十分です。</p>
    <p>Web Almanacの今後のエディションでは、ブレンドモードの使用法にドリルダウンして、開発者が使用している正確なモード（乗算、スクリーン、カラーバーン、ライトなど）を把握することをお勧めします。</p>
    <h2 id="css-アニメーション"><a href="#css-アニメーション" class="anchor-link">アニメーション</a></h2>
    <h3 id="css-トランジション"><a href="#css-トランジション" class="anchor-link">トランジション</a></h3>
    <p>CSSには、トランジションのこれらの値の方法に関する単一のルールを記述するだけで簡単に使用できるこの素晴らしい補間機能があります。アプリの状態を管理するためにCSSを使用している場合、タスクを実行するためにトランジションを使用する頻度はどれくらいですか？　Webに問合せしましょう！</p>
    <figure id="css-fig-25">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig25.png">
        <img src="/static/images/2019/css/fig25.png" alt="図25.ページごとの遷移数の分布。" aria-labelledby="css-fig25-caption" aria-describedby="css-fig25-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=419145172&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig25-description" data-show-text="{{ show_description(25) }}" data-hide-text="{{ hide_description(25) }}">{{ show_description(25) }}</button>
      <div id="css-fig25-description" class="visually-hidden">ページごとのトランジションの分布を示す棒グラフ。デスクトップページの場合、10、25、50、75、および90パーセンタイルは、0、2、16、49、および118です。デスクトップの分布はモバイルよりもはるかに低く、90パーセンタイルで最大77のトランジション。</div>
      <figcaption id="css-fig25-caption"><a href="#css-fig-25" class="anchor-link">図 25.</a>ページごとの遷移数の分布。</figcaption>
    </figure>
    <p>それはかなり良いです！　私たちは<code>animate.css</code>を含めるべき人気のあるライブラリと考えていました。これはたくさんのトランジションアニメーションをもたらしますが、人々がUIのトランジションを検討しているのを見るのは今でも素晴らしいことです。</p>
    <h3 id="css-キーフレームアニメーション"><a href="#css-キーフレームアニメーション" class="anchor-link">キーフレームアニメーション</a></h3>
    <p>CSSキーフレームアニメーションは、より複雑なアニメーションやトランジションに最適なソリューションです。これにより、効果をより明確に制御できるようになります。 1つのキーフレームエフェクトのように小さくすることも、多数のキーフレームエフェクトを堅牢なアニメーションに合成して大きくすることもできます。ページあたりのキーフレームアニメーションの数の中央値は、CSSトランジションよりもはるかに低くなっています。</p>
    <figure id="css-fig-26">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig26.png">
        <img src="/static/images/2019/css/fig26.png" alt="図26.ページごとのキーフレーム数の分布。" aria-labelledby="css-fig26-caption" aria-describedby="css-fig26-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=11848448&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig26-description" data-show-text="{{ show_description(26) }}" data-hide-text="{{ hide_description(26) }}">{{ show_description(26) }}</button>
      <div id="css-fig26-description" class="visually-hidden">ページごとのキーフレームの分布を示す棒グラフ。モバイルページの場合、10、25、50、75、および90パーセンタイルは、0、0、3、18、および76キーフレームです。モバイルの分布は、75パーセンタイルと90パーセンタイルで6キーフレーム分、デスクトップよりわずかに高くなっています。</div>
      <figcaption id="css-fig26-caption"><a href="#css-fig-26" class="anchor-link">図 26.</a>ページごとのキーフレーム数の分布。</figcaption>
    </figure>
    <h2 id="css-メディアクエリ"><a href="#css-メディアクエリ" class="anchor-link">メディアクエリ</a></h2>
    <p>メディアクエリを使用すると、CSSをさまざまなシステムレベルの変数にフックして、訪問ユーザーに適切に適応させることができます。これらのクエリの一部は、印刷スタイル、プロジェクタースクリーンスタイル、ビューポート/スクリーンサイズを処理できます。長い間、メディアクエリは主にビューポートの知識のために活用されていました。デザイナーと開発者は、小さな画面、大きな画面などにレイアウトを適合させることができます。その後、ウェブはますます多くの機能とクエリを提供し始めました。つまり、メディアクエリはビューポート機能に加えてアクセシビリティ機能を管理できるようになりました。</p>
    <p>メディアクエリから始めるのに適した場所は、1ページあたりの使用数です。典型的なページが応答したいと感じるのは、いくつの瞬間やコンテキストですか？</p>
    <figure id="css-fig-27">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig27.png">
        <img src="/static/images/2019/css/fig27.png" alt="図27.ページごとのメディアクエリ数の分布。" aria-labelledby="css-fig27-caption" aria-describedby="css-fig27-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1892465673&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig27-description" data-show-text="{{ show_description(27) }}" data-hide-text="{{ hide_description(27) }}">{{ show_description(27) }}</button>
      <div id="css-fig27-description" class="visually-hidden">ページごとのメディアクエリの分布を示す棒グラフ。デスクトップページの場合、10、25、50、75、および90パーセンタイルは、0、3、14、27、および43キーフレームです。デスクトップ配布は、モバイル配布に似ています。</div>
      <figcaption id="css-fig27-caption"><a href="#css-fig-27" class="anchor-link">図 27.</a>ページごとのメディアクエリ数の分布。</figcaption>
    </figure>
    <h3 id="css-一般的なメディアクエリブレークポイントサイズ"><a href="#css-一般的なメディアクエリブレークポイントサイズ" class="anchor-link">一般的なメディアクエリブレークポイントサイズ</a></h3>
    <p>ビューポートメディアクエリの場合、任意のタイプのCSSユニットを評価用のクエリ式に渡すことができます。以前、人々は<code>em</code>と<code>px</code>をクエリに渡していましたが、時間がたつにつれて単位が追加され、Webで一般的に見られるサイズの種類について非常に興味を持ちました。ほとんどのメディアクエリは一般的なデバイスサイズに従うと想定していますが、想定する代わりにデータを見てみましょう。</p>
    <figure id="css-fig-28">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig28.png">
        <img src="/static/images/2019/css/fig28.png" alt="図28.メディアクエリで使用される最も頻繁に使用されるスナップポイント。" aria-labelledby="css-fig28-caption" aria-describedby="css-fig28-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1353707515&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig28-description" data-show-text="{{ show_description(28) }}" data-hide-text="{{ hide_description(28) }}">{{ show_description(28) }}</button>
      <div id="css-fig28-description" class="visually-hidden">最も人気のあるメディアクエリスナップポイントの棒グラフ。 768pxと767pxが最も人気があり、それぞれ23％と16％です。その後、リストはすぐに削除され、992pxは6％の時間を使用し、1200pxは4％の時間を使用しました。デスクトップとモバイルの使用方法は似ています。</div>
      <figcaption id="css-fig28-caption"><a href="#css-fig-28" class="anchor-link">図 28.</a>メディアクエリで使用される最も頻繁に使用されるスナップポイント。</figcaption>
    </figure>
    <p>上記の図28は、前提の一部が正しいことを示しています。確かに、大量のモバイル固有のサイズがありますが、そうでないものもあります。また、このチャートの範囲を超えて<code>em</code>を使用するいくつかのトリックエントリで、非常にピクセルが支配的であることも興味深いです。</p>
    <h3 id="css-ポートレートとランドスケープの使用"><a href="#css-ポートレートとランドスケープの使用" class="anchor-link">ポートレートとランドスケープの使用</a></h3>
    <p>人気のあるブレークポイントサイズからの最も人気のあるクエリ値は<code>768px</code>であるため、興味をそそられました。この値は、<code>768px</code>が一般的なモバイルポートレートビューポートを表すという仮定に基づいている可能性があるため、主にポートレートレイアウトへ切り替えるために使用されましたか？　そこで、ポートレートモードとランドスケープモードの使用の人気を確認するために、フォローアップクエリを実行しました。</p>
    <figure id="css-fig-29">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig29.png">
        <img src="/static/images/2019/css/fig29.png" alt="図29.メディアクエリの方向モードの採用。" aria-labelledby="css-fig29-caption" aria-describedby="css-fig29-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=295845630&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig29-description" data-show-text="{{ show_description(29) }}" data-hide-text="{{ hide_description(29) }}">{{ show_description(29) }}</button>
      <div id="css-fig29-description" class="visually-hidden">メディアクエリの縦向きモードと横向きモードの採用を示す棒グラフ。ページの31％は横向き、8％は縦向き、7​​％は両方を指定しています。採用は、デスクトップページとモバイルページで同じです。</div>
      <figcaption id="css-fig29-caption"><a href="#css-fig-29" class="anchor-link">図 29.</a>メディアクエリの方向モードの採用。</figcaption>
    </figure>
    <p>興味深いことに、<code>ポートレート</code>はあまり使用されませんが、<code>ランドスケープ</code>はより多く使用されます。 <code>768px</code>はポートレートレイアウトのケースとして十分に信頼できるものであり、到達できるコストははるかに少ないと想定できます。また、デスクトップコンピューターで作業をテストしているユーザーは、ブラウザーを押しつぶすほど簡単にモバイルレイアウトを見るためにポートレートをトリガーできないと想定しています。わかりにくいですが、データは魅力的です。</p>
    <h3 id="css-最も人気のあるユニットタイプ"><a href="#css-最も人気のあるユニットタイプ" class="anchor-link">最も人気のあるユニットタイプ</a></h3>
    <p>これまで見てきたメディアクエリの幅と高さでは、ピクセルはUIをビューポートに適合させることを考えている開発者にとって主要な選択単位のように見えます。ただし、これを排他的にクエリしたいので、実際に人々が使用するユニットのタイプを見てみましょう。これは私たちが見つけたものです。</p>
    <figure id="css-fig-30">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig30.png">
        <img src="/static/images/2019/css/fig30.png" alt="図30.メディアクエリスナップポイントでのユニットの採用。" aria-labelledby="css-fig30-caption" aria-describedby="css-fig30-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=305563768&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig30-description" data-show-text="{{ show_description(30) }}" data-hide-text="{{ hide_description(30) }}">{{ show_description(30) }}</button>
      <div id="css-fig30-description" class="visually-hidden">ピクセルを指定するメディアクエリスナップポイントの75％、emsを指定する8％、remを指定する1％を示す棒グラフ。</div>
      <figcaption id="css-fig30-caption"><a href="#css-fig-30" class="anchor-link">図 30.</a>メディアクエリスナップポイントでのユニットの採用。</figcaption>
    </figure>
    <h3 id="css-min-widthとmax-width">
      <a href="#css-min-widthとmax-width" class="anchor-link"><code>min-width</code>と<code>max-width</code></a>
    </h3>
    <p>人々がメディアクエリを書くとき、彼らは通常、特定の範囲を超えているか下にあるビューポート、またはその両方をチェックして、サイズの範囲内にあるかどうかをチェックしてるでしょうか？　ウェブに聞いてみましょう！</p>
    <figure id="css-fig-31">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig31.png">
        <img src="/static/images/2019/css/fig31.png" alt="図31.メディアクエリスナップポイントで使用されるプロパティの採用。" aria-labelledby="css-fig31-caption" aria-describedby="css-fig31-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=2091525146&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig31-description" data-show-text="{{ show_description(31) }}" data-hide-text="{{ hide_description(31) }}">{{ show_description(31) }}</button>
      <div id="css-fig31-description" class="visually-hidden">最大幅を使用するデスクトップページの74％、最小幅を使用する70％、および両方のプロパティを使用する68％を示す棒グラフ。採用はモバイルページでも同様です。</div>
      <figcaption id="css-fig31-caption"><a href="#css-fig-31" class="anchor-link">図 31.</a>メディアクエリスナップポイントで使用されるプロパティの採用。</figcaption>
    </figure>
    <p>ここには明確な勝者はありません。 <code>max-width</code>と<code>min-width</code>はほぼ同じように使用されます。</p>
    <h3 id="css-printとspeech"><a href="#css-printとspeech" class="anchor-link">printとspeech</a></h3>
    <p>Webサイトはデジタルペーパーのように感じますか？　ユーザーとしては、ブラウザーから印刷するだけで、そのデジタルコンテンツを物理コンテンツに変換できることが一般的に知られています。 Webサイトは、そのユースケースに合わせて変更する必要はありませんが、必要に応じて変更できます。あまり知られていないのは、ツールまたはロボットによって読み取られるユースケースでWebサイトを調整する機能です。では、これらの機能はどれくらいの頻度で活用されていますか？</p>
    <figure id="css-fig-32">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig32.png">
        <img src="/static/images/2019/css/fig32.png" alt="図32.メディアクエリのall、print、screen、およびspeechタイプの採用。" aria-labelledby="css-fig32-caption" aria-describedby="css-fig32-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=939890574&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig32-description" data-show-text="{{ show_description(32) }}" data-hide-text="{{ hide_description(32) }}">{{ show_description(32) }}</button>
      <div id="css-fig32-description" class="visually-hidden">「all」のメディアクエリタイプを使用するデスクトップページの35％、printを使用する46％、screenを使用する72％、およびspeechを使用する0％を示す棒グラフ。採用率は、モバイルに比べてデスクトップで約5パーセントポイント低くなっています。</div>
      <figcaption id="css-fig32-caption"><a href="#css-fig-32" class="anchor-link">図 32.</a>メディアクエリのall、print、screen、およびspeechタイプの採用。</figcaption>
    </figure>
    <h2 id="css-ページレベルの統計"><a href="#css-ページレベルの統計" class="anchor-link">ページレベルの統計</a></h2>
    <h3 id="css-スタイルシート"><a href="#css-スタイルシート" class="anchor-link">スタイルシート</a></h3>
    <p>ホームページから何枚のスタイルシートを参照していますか？　アプリからはどのくらい？　モバイルとデスクトップのどちらにサービスを提供していますか？　ここに他のみんなのチャートがあります！</p>
    <figure id="css-fig-33">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig33.png">
        <img src="/static/images/2019/css/fig33.png" alt="図33.ページごとにロードされるスタイルシートの数の分布。" aria-labelledby="css-fig33-caption" aria-describedby="css-fig33-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1377313548&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig33-description" data-show-text="{{ show_description(33) }}" data-hide-text="{{ hide_description(33) }}">{{ show_description(33) }}</button>
      <div id="css-fig33-description" class="visually-hidden">ページごとにロードされるスタイルシートの数の分布。デスクトップとモバイルは、10、25、50、75、および90パーセンタイル（ページごとに1、3、6、12、および20のスタイルシート）を持つ同一の分布を持っています。</div>
      <figcaption id="css-fig33-caption"><a href="#css-fig-33" class="anchor-link">図 33.</a>ページごとにロードされるスタイルシートの数の分布。</figcaption>
    </figure>
    <h3 id="css-スタイルシート名"><a href="#css-スタイルシート名" class="anchor-link">スタイルシート名</a></h3>
    <p>スタイルシートの名前は何ですか？　あなたのキャリアを通して一貫した名前にしましたか？　ゆっくり収束したか、一貫して発散しましたか？　このチャートは、ライブラリの人気を少し垣間見せています。また、CSSファイルの一般的な名前を垣間見ることもできます。</p>
    <figure id="css-fig-34">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>スタイルシート名</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>style.css</td>
                <td class="numeric">2.43%</td>
                <td class="numeric">2.55%</td>
              </tr>
              <tr>
                <td>font-awesome.min.css</td>
                <td class="numeric">1.86%</td>
                <td class="numeric">1.92%</td>
              </tr>
              <tr>
                <td>bootstrap.min.css</td>
                <td class="numeric">1.09%</td>
                <td class="numeric">1.11%</td>
              </tr>
              <tr>
                <td>BfWyFJ2Rl5s.css</td>
                <td class="numeric">0.67%</td>
                <td class="numeric">0.66%</td>
              </tr>
              <tr>
                <td>style.min.css?ver=5.2.2</td>
                <td class="numeric">0.64%</td>
                <td class="numeric">0.67%</td>
              </tr>
              <tr>
                <td>styles.css</td>
                <td class="numeric">0.54%</td>
                <td class="numeric">0.55%</td>
              </tr>
              <tr>
                <td>style.css?ver=5.2.2</td>
                <td class="numeric">0.41%</td>
                <td class="numeric">0.43%</td>
              </tr>
              <tr>
                <td>main.css</td>
                <td class="numeric">0.43%</td>
                <td class="numeric">0.39%</td>
              </tr>
              <tr>
                <td>bootstrap.css</td>
                <td class="numeric">0.40%</td>
                <td class="numeric">0.42%</td>
              </tr>
              <tr>
                <td>font-awesome.css</td>
                <td class="numeric">0.37%</td>
                <td class="numeric">0.38%</td>
              </tr>
              <tr>
                <td>style.min.css</td>
                <td class="numeric">0.37%</td>
                <td class="numeric">0.37%</td>
              </tr>
              <tr>
                <td>styles__ltr.css</td>
                <td class="numeric">0.38%</td>
                <td class="numeric">0.35%</td>
              </tr>
              <tr>
                <td>default.css</td>
                <td class="numeric">0.36%</td>
                <td class="numeric">0.36%</td>
              </tr>
              <tr>
                <td>reset.css</td>
                <td class="numeric">0.33%</td>
                <td class="numeric">0.37%</td>
              </tr>
              <tr>
                <td>styles.css?ver=5.1.3</td>
                <td class="numeric">0.32%</td>
                <td class="numeric">0.35%</td>
              </tr>
              <tr>
                <td>custom.css</td>
                <td class="numeric">0.32%</td>
                <td class="numeric">0.33%</td>
              </tr>
              <tr>
                <td>print.css</td>
                <td class="numeric">0.32%</td>
                <td class="numeric">0.28%</td>
              </tr>
              <tr>
                <td>responsive.css</td>
                <td class="numeric">0.28%</td>
                <td class="numeric">0.31%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#css-fig-34" class="anchor-link">図 34.</a>最も頻繁に使用されるスタイルシート名。</figcaption>
    </figure>
    <p>それらすべてのクリエイティブなファイル名を見てください！　スタイル、スタイル、メイン、デフォルト、すべて。しかし目立ったのは、あなたはわかりますか？ <code>BfWyFJ2Rl5s.css</code>は、最も人気のある4位になります。少し調べてみましたが、Facebookの「いいね」ボタンに関連していると思われます。そのファイルが何であるか知っていますか？　話を聞きたいので、コメントを残してください。</p>
    <h3 id="css-スタイルシートのサイズ"><a href="#css-スタイルシートのサイズ" class="anchor-link">スタイルシートのサイズ</a></h3>
    <p>これらのスタイルシートはどれくらいの大きさですか？　CSSのサイズは心配する必要がありますか？　このデータから判断すると、CSSはページ膨張の主な攻撃者ではありません。</p>
    <figure id="css-fig-35">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig35.png">
        <img src="/static/images/2019/css/fig35.png" alt="図35.ページごとにロードされるスタイルシートのバイト数（KB）の分布。" aria-labelledby="css-fig35-caption" aria-describedby="css-fig35-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=2132635319&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig35-description" data-show-text="{{ show_description(35) }}" data-hide-text="{{ hide_description(35) }}">{{ show_description(35) }}</button>
      <div id="css-fig35-description" class="visually-hidden">ページごとにロードされるスタイルシートのバイト数の分布。デスクトップページの10、25、50、75、および90パーセンタイルは、8、26、62、129、および240KBです。デスクトップ配布は、モバイル配布より5〜10KBわずかに高くなっています。</div>
      <figcaption id="css-fig35-caption"><a href="#css-fig-35" class="anchor-link">図 35.</a>ページごとにロードされるスタイルシートのバイト数（KB）の分布。</figcaption>
    </figure>
    <p>Webサイトが各コンテンツタイプにロードするバイト数の詳細については、<a href="#page-weight">ページウェイト</a>の章を参照してください。</p>
    <h3 id="css-ライブラリ"><a href="#css-ライブラリ" class="anchor-link">ライブラリ</a></h3>
    <p>新しいプロジェクトをスタートする事にCSSライブラリへ手を出すのは一般的で、人気があり、便利で強力です。あなたはライブラリに手を伸ばす人ではないかもしれませんが、私たちは2019年にウェブへ問い合わせて、どれが群を抜いているか調べました。彼らが私たちと同じように結果に驚くなら、開発者バブルがどれだけ小さいかを知る手がかりになると思います。物事は非常に人気がありますが、ウェブに問い合わせると、現実は少し異なります。</p>
    <figure id="css-fig-36">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ライブラリ</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Bootstrap</td>
                <td class="numeric">27.8%</td>
                <td class="numeric">26.9%</td>
              </tr>
              <tr>
                <td>animate.css</td>
                <td class="numeric">6.1%</td>
                <td class="numeric">6.4%</td>
              </tr>
              <tr>
                <td>ZURB Foundation</td>
                <td class="numeric">2.5%</td>
                <td class="numeric">2.6%</td>
              </tr>
              <tr>
                <td>UIKit</td>
                <td class="numeric">0.5%</td>
                <td class="numeric">0.6%</td>
              </tr>
              <tr>
                <td>Material Design Lite</td>
                <td class="numeric">0.3%</td>
                <td class="numeric">0.3%</td>
              </tr>
              <tr>
                <td>Materialize CSS</td>
                <td class="numeric">0.2%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td>Pure CSS</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.1%</td>
              </tr>
              <tr>
                <td>Angular Material</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.1%</td>
              </tr>
              <tr>
                <td>Semantic-ui</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.1%</td>
              </tr>
              <tr>
                <td>Bulma</td>
                <td class="numeric">0.0%</td>
                <td class="numeric">0.0%</td>
              </tr>
              <tr>
                <td>Ant Design</td>
                <td class="numeric">0.0%</td>
                <td class="numeric">0.0%</td>
              </tr>
              <tr>
                <td>tailwindcss</td>
                <td class="numeric">0.0%</td>
                <td class="numeric">0.0%</td>
              </tr>
              <tr>
                <td>Milligram</td>
                <td class="numeric">0.0%</td>
                <td class="numeric">0.0%</td>
              </tr>
              <tr>
                <td>Clarity</td>
                <td class="numeric">0.0%</td>
                <td class="numeric">0.0%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#css-fig-36" class="anchor-link">図 36.</a>特定のCSSライブラリを含むページの割合。</figcaption>
    </figure>
    <p>
      このチャートは、<a href="https://getbootstrap.com/">Bootstrap<span class="fn">https://getbootstrap.com/</span></a
      >がプロジェクトを支援するために知っておくべき貴重なライブラリであることを示唆しています。支援する機会があるすべてを見てください！　すべてのサイトがCSSフレームワークを使用しているわけではないので、これはポジティブなシグナルチャートにすぎないことも注目に値します。100％に達することはありません。すべてのサイトの半分以上が、既知のCSSフレームワークを使用していません。とても面白いですよね！
    </p>
    <h3 id="css-リセットユーティリティ"><a href="#css-リセットユーティリティ" class="anchor-link">リセットユーティリティ</a></h3>
    <p>CSSリセットユーティリティは、ネイティブWeb要素のベースラインを正規化または作成することを目的としています。あなたが知らなかった場合、各ブラウザはすべてのHTML要素に対して独自のスタイルシートを提供し、それら要素の外観、動作について独自の決定を下すことができます。リセットユーティリティはこれらのファイルを調べ、共通点を見つけた（もしくは見つけなかった）ため、開発者が1つのブラウザーでスタイルを設定し、別のブラウザーでも同じように見える合理的な自信を持たせるため、相違点を解決しました。</p>
    <p>それで、どれだけのサイトがそれを使っているかを見てみましょう！　彼らの存在はかなり理にかなっているように思えるので、何人の人々が彼らの戦術に同意し、彼らのサイトでそれらを使用しますか？</p>
    <figure id="css-fig-37">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig37.png">
        <img src="/static/images/2019/css/fig37.png" alt="図37. CSSリセットユーティリティの採用。" aria-labelledby="css-fig37-caption" aria-describedby="css-fig37-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1318910215&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig37-description" data-show-text="{{ show_description(37) }}" data-hide-text="{{ hide_description(37) }}">{{ show_description(37) }}</button>
      <div id="css-fig37-description" class="visually-hidden">3つのCSSリセットユーティリティの採用を示す棒グラフ：Normalize.css（33％）、Reset CSS（3％）、およびPure CSS（0％）。デスクトップページとモバイルページで採用に違いはありません。</div>
      <figcaption id="css-fig37-caption"><a href="#css-fig-37" class="anchor-link">図 37.</a> CSSリセットユーティリティの採用。</figcaption>
    </figure>
    <p>
      Webの約3分の1が<a href="https://necolas.github.io/normalize.css"><code>normalize.css</code><span class="fn">https://necolas.github.io/normalize.css</span></a
      >を使用していることがわかります。これは、リセットよりもタスクへのより穏やかなアプローチと考えることができます。少し詳しく見てみると、Bootstrapには<code>normalize.css</code>が含まれていることがわかりました。 <code>normalize.css</code>がBootstrapよりも多く採用されていることも注目に値するので、それを単独で使用する人がたくさんいます。
    </p>
    <h3 id="css-supportsとimport">
      <a href="#css-supportsとimport" class="anchor-link"><code>@supports</code>と<code>@import</code></a>
    </h3>
    <p>CSS <code>@supports</code>は、ブラウザが特定のプロパティと値の組み合わせが有効であると解析されたかどうかをチェックし、チェックがtrueを返した場合にスタイルを適用する方法です。</p>
    <figure id="css-fig-38">
      <a href="https://almanac.httparchive.org/static/images/2019/css/fig38.png">
        <img src="/static/images/2019/css/fig38.png" alt="図38. CSS「@」ルールの人気" aria-labelledby="css-fig38-caption" aria-describedby="css-fig38-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQO5CabwLwQ5Lj1_9bbEFnFM1qEqCorymaBHrcaNiMSJ7sYDKHUI5iish5VAS-SxN447UTW-1-5-OjE/pubchart?oid=1739611283&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig38-description" data-show-text="{{ show_description(38) }}" data-hide-text="{{ hide_description(38) }}">{{ show_description(38) }}</button>
      <div id="css-fig38-description" class="visually-hidden">@importおよび@supports "@"ルールの人気を示す棒グラフ。デスクトップでは、ページの28％で@importが使用され、31％で@supportsが使用されます。モバイルでは、ページの26％で@importが使用され、29％で@supportsが使用されます。</div>
      <figcaption id="css-fig38-caption"><a href="#css-fig-38" class="anchor-link">図 38.</a> CSS「@」ルールの人気</figcaption>
    </figure>
    <p>2013年にほとんどのブラウザで<code>@supports</code>が実装されたことを考慮すると、大量の使用と採用が見られることはそれほど驚くことでありません。ここでは、開発者のマインドフルネスに感銘を受けています。これは思いやりのあるコーディングです！　すべてのWebサイトの30％は、使用する前にディスプレイ関連のサポートをチェックしています。</p>
    <p>これの興味深いフォローアップは、<code>@imports</code>より<code>@supports</code>の使用が多いことです！　私たちはそれを期待していませんでした！ <code>@import</code>は1994年以来ブラウザに存在しています。</p>
    <h2 id="css-結論"><a href="#css-結論" class="anchor-link">結論</a></h2>
    <p>ここには、データマイニングするための非常に多くのものがあります！　結果の多くは私たちを驚かせました、そして同様にあなたも驚いたことを願っています。この驚くべきデータセットにより、要約が非常に楽しくなり、結果の一部がそうである理由を追い詰めたいかどうかを調査するための多くの手がかりと追跡の跡が残されました。</p>
    <p>どの結果が最も驚くべきものでしたか？ どの結果を使用して、コードベースにすばやくクエリを移動しますか？</p>
    <p>
      これらの結果からの最大のポイントは、スタイルシートのパフォーマンス、乾燥、スケーラビリティの点で、カスタムプロパティが予算に見合った価値を提供することだと感じました。インターネットのスタイルシートを再度スクラブし、新しいデータムと挑発的なチャートの扱いを探しています。クエリ、質問、アサーションを含むコメントで<a href="https://twitter.com/una">@una<span class="fn">https://twitter.com/una</span></a
      >または<a href="https://twitter.com/argyleink">@argyleink<span class="fn">https://twitter.com/argyleink</span></a
      >に連絡してください。私たちはそれらを聞きたいです！
    </p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"I","chapter_number":3,"title":"マークアップ","description":"使われている要素、カスタム要素、価値、製品、及び一般的なユースケースについて抑えてある 2019 Web Almanac マークアップの章","authors":["bkardell"],"reviewers":["zcorpan","tomhodgins","matthewp"],"translators":["MSakamaki"],"discuss":"1758","results":"https://docs.google.com/spreadsheets/d/1WnDKLar_0Btlt9UgT53Giy2229bpV4IM2D_v6OM_WzA/","queries":"03_Markup","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-05-19T00:00:00.000Z","chapter":"markup"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="markup-導入"><a href="#markup-導入" class="anchor-link">導入</a></h2>
    <p>
      2005年にIan "Hixie" Hicksonはこれまでの研究に基づいた<a href="https://web.archive.org/web/20060203035414/http://code.google.com/webstats/index.html">マークアップデータの分析<span class="fn">https://web.archive.org/web/20060203035414/http://code.google.com/webstats/index.html</span></a
      >を投稿しました。 この作業のほとんどは、クラス名を調査して、内々で開発者が採用しているセマンティクスを確認し、標準化する意味があるかの確認をすることが目的でした。 この研究の一部は、HTML5の新要素の参考として役に立ちました。
    </p>
    <p>
      14年すぎて、新しい見方をする時が来ました。 以降、<a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements">カスタム要素(Custom Elements)<span class="fn">https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements</span></a
      >と<a href="https://extensiblewebmanifesto.org/">Extensible Web Manifesto<span class="fn">https://extensiblewebmanifesto.org/</span></a
      >の導入により、開発者は要素そのものの空間を探し、標準化団体が<a href="https://bkardell.com/blog/Dropping-The-F-Bomb-On-Standards.html">辞書編集者のようになる<span class="fn">https://bkardell.com/blog/Dropping-The-F-Bomb-On-Standards.html</span></a
      >ことで、牛の通り道を舗装する(pave the cowpaths)よりよい方法を見つけることを推奨しています。 様々なものに使われる可能性があるCSSクラス名とは異なり、非標準の<em>要素</em>は作成者が要素であることを意識しているため、さらに確実なものとなります。
    </p>
    <p>
      2019年7月の時点で、HTTP Archiveは、約440万のデスクトップホームページと約530万のモバイルホームページのDOMで使用されているすべての<em>要素</em>名の収集を開始しました。 <em>(<a href="#methodology">方法論</a>の詳細を御覧ください)</em>
    </p>
    <p>このクロールの結果、<em>5,000種類を超える非標準の要素</em>が検出されたため、計測する要素の合計数を「トップ」（以下で説明）5,048種類に制限しました。</p>
    <h2 id="markup-方法論"><a href="#markup-方法論" class="anchor-link">方法論</a></h2>
    <p>各ページの要素の名前は、JavaScriptの初期化後DOMより収集されました。</p>
    <p>
      現実の要素出現数を確認することは標準の要素であっても有用ではありません、検出されたすべての要素の約25%は<code>&lt;div&gt;</code>です。 そして、約17%が<code>&lt;a&gt;</code>で、11%が<code>&lt;span&gt;</code>となっており、これらは10%以上を占める唯一の要素たちです。 言語は<a href="https://www.youtube.com/watch?v=fCn8zs912OE">一般的にこのようなもの<span class="fn">https://www.youtube.com/watch?v=fCn8zs912OE</span></a
      >ですが、これと比較してみると驚くほど少ない用語が使われています。 さらに、非標準の要素の取り込みを検討してみると、１つのサイトが特定の要素を1000回も使用しているために、とても人気があるように見えてしまい、大きな誤解を招く可能性があります。
    </p>
    <p>そのような方法を取らず、私達はHixieの元の研究のようにホームページに各要素が少なくとも1回は含まれているサイトの数に着目しました。</p>
    <p class="note">
      注意: この方法は潜在的なバイアスが無いとは言い切れません。 人気のある製品は複数のサイトで使われています。これにより個々の作成者は意識していない非標準のマークアップが導入されるでしょう。 したがって、この方法は一般的なニーズに対応するのと同じように、作成者の直接的な知識や意識的な採用を意味しないことに注意する必要があります。 調査中に、このような例はいくつか見つかりました。
    </p>
    <h2 id="markup-上位の要素と概説"><a href="#markup-上位の要素と概説" class="anchor-link">上位の要素と概説</a></h2>
    <p>2005年、Hixieはページ中に最もよく使用されていて、頻度の少ない上位要素を調査しました。 トップ３は <code>html</code>、<code>head</code>、<code>body</code>でした、これらはオプションなので省略されてもパーサーによって作成されており、彼は興味深いと述べています。 パーサーによる解析後のDOMを使って調査すると、データは普遍的に表示されます。なので、４番目に使用頻度の高い要素からはじめました。 以下は、その時点から現在までのデータの比較です。(ここでは面白いので出現数を含めました)</p>
    <figure id="markup-fig1" data-markdown="1">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>2005 (サイト毎)</th>
                <th>2019 (サイト毎)</th>
                <th>2019 (出現数)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>title</td>
                <td>title</td>
                <td>div</td>
              </tr>
              <tr>
                <td>a</td>
                <td>meta</td>
                <td>a</td>
              </tr>
              <tr>
                <td>img</td>
                <td>a</td>
                <td>span</td>
              </tr>
              <tr>
                <td>meta</td>
                <td>div</td>
                <td>li</td>
              </tr>
              <tr>
                <td>br</td>
                <td>link</td>
                <td>img</td>
              </tr>
              <tr>
                <td>table</td>
                <td>script</td>
                <td>script</td>
              </tr>
              <tr>
                <td>td</td>
                <td>img</td>
                <td>p</td>
              </tr>
              <tr>
                <td>tr</td>
                <td>span</td>
                <td>option</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#markup-fig1" class="anchor-link">図 1.</a> 2005年から2019年までの上位要素の比較。</figcaption>
    </figure>
    <h3 id="markup-ページ毎の要素"><a href="#markup-ページ毎の要素" class="anchor-link">ページ毎の要素</a></h3>
    <figure id="markup-fig2">
      <img src="/static/images/2019/markup/hixie_elements_per_page.png" alt="Hixieによる2005年の要素頻度の分布" aria-labelledby="markup-fig2-caption" aria-describedby="markup-fig2-description" width="600" height="318" />
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="markup-fig2-description" class="visually-hidden">要素数が増加するにつれて相対頻度の分布が減少することを示すグラフ</div>
      <figcaption id="markup-fig2-caption"><a href="#markup-fig2" class="anchor-link">図 2.</a> Hixieによる2005年の要素頻度の分布。</figcaption>
    </figure>
    <figure id="markup-fig3">
      <a href="https://almanac.httparchive.org/static/images/2019/markup/fig3.png">
        <img src="/static/images/2019/markup/fig3.png" alt="図3. 2019年の要素頻度" aria-labelledby="markup-fig3-caption" aria-describedby="markup-fig3-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTbHgqcSepZye6DrCTpifFAUYxKT1hEO56585awyMips8oiPMLYu20GETuIE8mALkm814ObJyktEe2P/pubchart?oid=2141583176&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="markup-fig3-description" class="visually-hidden">約2,500ページからなるグラフは、約30個の要素から開始します。そして2,000個の要素を含む327ページまで直線的に追従する前の283個の要素を持つ6,876ページあたりでピークに達します。</div>
      <figcaption id="markup-fig3-caption"><a href="#markup-fig3" class="anchor-link">図 3.</a> 2019年の要素頻度。</figcaption>
    </figure>
    <p>図2の2005年のHixieのレポートと図3の最新データを比較すると、DOMツリーの平均サイズが大きくなっていることがわかります。</p>
    <figure id="markup-fig4">
      <img src="/static/images/2019/markup/hixie_element_types_per_page.png" alt="図4. 2005年にHixieが分析したページ毎の要素タイプのヒストグラム" aria-labelledby="markup-fig4-caption" aria-describedby="markup-fig4-description" width="600" height="320" />
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="markup-fig4-description" class="visually-hidden">相対周波数が19個の要素点の周りで釣鐘曲線となっていることを示すグラフ</div>
      <figcaption id="markup-fig4-caption"><a href="#markup-fig4" class="anchor-link">図 4.</a> 2005年にHixieが分析したページ毎の要素タイプのヒストグラム。</figcaption>
    </figure>
    <figure id="markup-fig5">
      <a href="https://almanac.httparchive.org/static/images/2019/markup/fig5.png">
        <img src="/static/images/2019/markup/fig5.png" alt="図5. 2019年時点でのページ毎の要素タイプのヒストグラム。" aria-labelledby="markup-fig5-caption" aria-describedby="markup-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTbHgqcSepZye6DrCTpifFAUYxKT1hEO56585awyMips8oiPMLYu20GETuIE8mALkm814ObJyktEe2P/pubchart?oid=1500675289&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="markup-fig5-description" class="visually-hidden">308,168,000のサイトで使用されている平均要素数を示すグラフは、マークされた30個の要素の周りで釣鐘曲線になっています。</div>
      <figcaption id="markup-fig5-caption"><a href="#markup-fig5" class="anchor-link">図 5.</a> 2019年時点でのページ毎の要素タイプのヒストグラム。</figcaption>
    </figure>
    <p>ページあたりの要素の種類の平均数と、ユニークな要素数の最大値の両方が増加していることがわかります。</p>
    <h2 id="markup-カスタム要素"><a href="#markup-カスタム要素" class="anchor-link">カスタム要素</a></h2>
    <p>記録された要素のほとんどはカスタム（単純に「非標準」となる物）でした。しかし、どの要素がカスタムであるか、カスタムではないかを議論するのは少し面倒です。実際にかなりの数の要素が仕様や提案のどこかに書かれています。今回、244個の要素を標準として検討しました。（ただし、一部は非推奨またはサポート対象外のものです）</p>
    <ul>
      <li>145個のHTML要素</li>
      <li>68個のSVG要素</li>
      <li>31個のMathML要素</li>
    </ul>
    <p>実際は、これらのうち214だけに遭遇しました。</p>
    <ul>
      <li>137個のHTML要素</li>
      <li>54個のSVG要素</li>
      <li>23個のMathML要素</li>
    </ul>
    <p>デスクトップのデータセットでは、検出された4,834個の非標準要素のデータを収集しました。 次がそれに当たります。</p>
    <ul>
      <li>155個（3％）は、非常に高い確率でマークアップまたはエスケープの例外として識別できます（解析されたタグ名にマークアップが破損していることを暗示する文字が含まれていました）</li>
      <li>341個（7％）はXMLスタイルのコロン名前空間を使っています（ただし、HTMLとしてはXML名前空間は使っていません）</li>
      <li>3,207個（66％）は有効なカスタム要素の名前です</li>
      <li>
        1,211個（25％）はグローバルな名前空間にあります（非標準であり、ダッシュもコロンもありません）
        <ul>
          <li>うち、216個は2文字以上で、<code>&lt;cript&gt;</code>、<code>&lt;spsn&gt;</code>または<code>&lt;artice&gt;</code>などの標準要素名からレーベンシュタイン距離が1であるため、タイプミスの<em>可能性</em>としてフラグを立てました。ただし、これらの一部（ <code>&lt;jdiv&gt;</code>など）には意図的なものも含まれています。</li>
        </ul>
      </li>
    </ul>
    <p>付け加えると、デスクトップページの15％とモバイルページの16％には、既に廃止された要素が含まれています。</p>
    <p class="note">注意：この結果は、それぞれのの作成者がマークアップを手動で作成しているのではなく、何らかの製品を使っている為と考えられます。</p>
    <figure id="markup-fig6">
      <a href="https://almanac.httparchive.org/static/images/2019/markup/fig6.png">
        <img src="/static/images/2019/markup/fig6.png" alt="図6.最も頻繁に使われている非推奨の要素。" aria-labelledby="markup-fig6-caption" aria-describedby="markup-fig6-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTbHgqcSepZye6DrCTpifFAUYxKT1hEO56585awyMips8oiPMLYu20GETuIE8mALkm814ObJyktEe2P/pubchart?oid=1304237557&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="markup-fig6-description" class="visually-hidden">デスクトップの8.31％（モバイルの7.96％）で使用中の「center」、デスクトップサイトの8.01％（モバイルの7.38％）で使用中の「font」、デスクトップサイトの1.07％（モバイルの1.20％）で使用中の「marquee」 、デスクトップサイトの0.71％（モバイルの0.55％）で使用中の「nobr」、デスクトップサイトの0.53％（モバイルの0.47％）で使用中の「big」、デスクトップサイトの0.39%（モバイルの0.35％）で使用中の「frameset」、デスクトップサイトの0.39％（モバイルの0.35％）による「frame」の使用、デスクトップサイトの0.33％（モバイルの0.27％）による「strike」、デスクトップサイトの0.25％（モバイルの0.27％）で使用中の「noframes」を示す棒グラフ。</div>
      <figcaption id="markup-fig6-caption"><a href="#markup-fig6" class="anchor-link">図 6.</a>最も頻繁に使われている非推奨の要素。</figcaption>
    </figure>
    <p>上記の図6は、最も頻繁に使われている非推奨の要素トップ10を表しています。 これらは非常に小さな数値に見えますが、この観点は重要です。</p>
    <h2 id="markup-価値観と使用法"><a href="#markup-価値観と使用法" class="anchor-link">価値観と使用法</a></h2>
    <p>要素の使い方に関する数値（標準、非推奨、またはカスタム）を議論する為には、まず何らかの観点を確立する必要があります。</p>
    <figure id="markup-fig7">
      <a href="https://almanac.httparchive.org/static/images/2019/markup/fig7_full.png">
        <img src="/static/images/2019/markup/fig7.png" alt="図7.トップ150の要素。" aria-labelledby="markup-fig7-caption" aria-describedby="markup-fig7-description" width="600" height="778" data-width="600" data-height="778" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTbHgqcSepZye6DrCTpifFAUYxKT1hEO56585awyMips8oiPMLYu20GETuIE8mALkm814ObJyktEe2P/pubchart?oid=1694360298&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="markup-fig7-description" class="visually-hidden">使用される要素を減少の割合で降順で並べた棒グラフ：html、head、body、titleは使用率99％を超えるています、meta、a、divは98％を超える使用率です、link、script、img、spanが90％を超 えています、ul、li、p、style、input、br、formなどが70%を超えています、h2、h1、iframe、h3、button、footer、header、navは50％を超えています、50％未満からほぼ0％に低下するその他のあまり知られていないタグもあります。</div>
      <figcaption id="markup-fig7-caption"><a href="#markup-fig7" class="anchor-link">図 7.</a>トップ150の要素（<a href="https://almanac.httparchive.org/static/images/2019/markup/fig7_full.png">詳細</a>）。</figcaption>
    </figure>
    <p>上記の図7は、ページ中に現れたかどうかでカウントされた要素のトップ150を表示しています。 利用率がどのように落ちていくかに着目してください。</p>
    <p>ページの90%以上で使われている要素は11個しかありません。</p>
    <ul>
      <li><code>&lt;html&gt;</code></li>
      <li><code>&lt;head&gt;</code></li>
      <li><code>&lt;body&gt;</code></li>
      <li><code>&lt;title&gt;</code></li>
      <li><code>&lt;meta&gt;</code></li>
      <li><code>&lt;a&gt;</code></li>
      <li><code>&lt;div&gt;</code></li>
      <li><code>&lt;link&gt;</code></li>
      <li><code>&lt;script&gt;</code></li>
      <li><code>&lt;img&gt;</code></li>
      <li><code>&lt;span&gt;</code></li>
    </ul>
    <p>上を除き、ページ中50％以上使われている要素は15個だけです。</p>
    <ul>
      <li><code>&lt;ul&gt;</code></li>
      <li><code>&lt;li&gt;</code></li>
      <li><code>&lt;p&gt;</code></li>
      <li><code>&lt;style&gt;</code></li>
      <li><code>&lt;input&gt;</code></li>
      <li><code>&lt;br&gt;</code></li>
      <li><code>&lt;form&gt;</code></li>
      <li><code>&lt;h2&gt;</code></li>
      <li><code>&lt;h1&gt;</code></li>
      <li><code>&lt;iframe&gt;</code></li>
      <li><code>&lt;h3&gt;</code></li>
      <li><code>&lt;button&gt;</code></li>
      <li><code>&lt;footer&gt;</code></li>
      <li><code>&lt;header&gt;</code></li>
      <li><code>&lt;nav&gt;</code></li>
    </ul>
    <p>また、ページ中に5％以上使われている要素は40個のみでした。</p>
    <p><code>&lt;video&gt;</code>でさえ、ぎりぎりその範囲内に収まっていません。 デスクトップデータセット内の4％という結果で現れています（モバイルでは3％）。 この数字はとても低いように聞こえますが、実のところ4％はかなり人気だったりします。 事実、ページ中1％以上の要素は98個しかありません。</p>
    <p>これらの要素の分布を抑え、どの要素が1％以上使われているのかを見るのは興味深いことです。</p>
    <figure id="markup-fig8">
      <a href="https://rainy-periwinkle.glitch.me/scatter/html">
        <img src="/static/images/2019/markup/element_categories.png" alt="図8. 標準化によって人気になった要素の分類" aria-labelledby="markup-fig8-caption" width="600" height="1065" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="markup-fig8-description" class="visually-hidden">HTML、SVG、Math MLを示す散布図は比較的少数のタグを使用しますが、非標準要素（「in global ns」、「dasherized」、「colon」に分けられる）ははるかに広がっています。</div>
      <figcaption id="markup-fig8-caption"><a href="#markup-fig8" class="anchor-link">図 8.</a> 標準化によって人気になった要素の分類。</figcaption>
    </figure>
    <p>図8は、各要素の順位とそれらがどのカテゴリに属するかを示しています。 データポイントを単純に見ることができるように、個別の塊へ分割しました（そうしなければ、全データを表現するために十分なピクセル領域がありませんでした）、これは人気を一つの「線」として表します。 一番下が最も一般的で、上が一般的では無いものです。 矢印は、ページの1％以上に表示される要素の終端を指しています。</p>
    <p>ここでは2つのことを確認できます。 まず、使用率が1％を超える要素の塊は、HTMLだけではありません。実際、<em>最も人気のある100個の要素のうち27個はHTMLではなく</em>SVGです！ さらに、<em>その隙間または近くには非標準のタグもあります</em>！ そして多くのHTML要素がページ毎に1％未満として現れている事に注意してください。</p>
    <p>では、これらのページで1％の利用率となっている要素はすべて無駄ですか？、いいえ絶対にあえりえません。 これが視点を確立することが重要な理由です。 Webには約20億のWebサイトがあります。 データセットのすべてのWebサイトの0.1％に何かが表示される時、これはWeb全体で<em>約200万のWebサイト</em>を表していると推定できます。 0.01％でさえ<em>20万のサイト</em>を推定できます。 これは、良い思想では無い古い要素であったとしても、めったに要素のサポートを打ち切らない理由でもあります。 数十万または数百万のサイトを壊すことは、ブラウザベンダーが簡単にできることではありません。</p>
    <p>ほとんどの要素は、ネイティブの物も含めてページの1％未満として現れていますが、それでも非常に重要であり成功しています。 たとえば<code>&lt;code&gt;</code>は私が頻繁に使用する要素です。 これは間違いなく便利で重要ですが、ページの0.57％でしか使われていません。 この部分は私達の測定対象に基づいているため偏っています。 通常、ホームページは特定の種類のもの（たとえば<code>&lt;code&gt;</code> など）が含まれる可能性は低いでしょう。 例えば、ホームページでは見出し、段落、リンク、リスト以外はあまり一般的ではないでしょう。 ただし、データには一般的に価値があります。</p>
    <p>また、著者が定義した（ネイティブではない）<code>.shadowRoot</code>を含むページに関する情報も収集しました。 デスクトップページの約0.22％とモバイルページの約0.15％にシャドウルートが確認できています。 数が少ないように聞こえるかもしれませんが、これはモバイルデータセット内の約6.5kサイトとデスクトップ上の10kサイトであり、いくつかのHTML要素よりも多くなっています。 たとえば、<code>&lt;summary&gt;</code> はデスクトップ上で同レベルで利用されており、146番目に人気のある要素です。 <code>&lt;datalist&gt;</code> はホームページの0.04％に使われており、201番目に人気のある要素です。</p>
    <p>実際、HTMLで定義されている要素の15％以上は、デスクトップデータセットのトップ200から圏外です。 <code>&lt;meter&gt;</code>は、HTMLがLiving Standardモデルに移行する前、2004-2011頃の最も人気のない「HTML5時代」の要素です。 そしてこの要素の人気は1,000番目です。 最近導入された要素（2016年4月）である<code>&lt;slot&gt;</code>の人気は1,400番目となっています。</p>
    <h2 id="markup-大量データ：実際のweb上の実際のdom"><a href="#markup-大量データ：実際のweb上の実際のdom" class="anchor-link">大量データ：実際のWeb上の実際のDOM</a></h2>
    <p>データセット中のネイティブ/標準機能をどのように使っているかと言う観点を念頭に置いて、非標準のものについて話しましょう。</p>
    <p>測定したほとんどの要素は単一のWebページでのみ使用されると思われるかもしれませんが、実際には5,048個の要素すべてが複数のページに出現しています。 データセット中、最も出現数が少ない要素は15ページに存在しています。 そして、約5分の1は100ページ以上に存在します。 約7％は1,000ページ以上に存在します。</p>
    <p>
      データ分析を支援するために<a href="https://rainy-periwinkle.glitch.me">Glitchで小さなツール<span class="fn">https://rainy-periwinkle.glitch.me</span></a
      >を共同で作りました。 このツールはあなたも使うことができます。そして、あなたの観測した内容をパーマリンクと共に<a href="https://twitter.com/HTTPArchive">@HTTPArchive<span class="fn">https://twitter.com/HTTPArchive</span></a
      >へシェアしてください。（Tommy Hodginsは、同じように洞察に使える<a href="https://github.com/tomhodgins/hade">CLIツール<span class="fn">https://github.com/tomhodgins/hade</span></a
      >を作成しています。）
    </p>
    <p>それでは、いくつかのデータを見ていきましょう。</p>
    <h3 id="markup-製品（およびライブラリ）とそのカスタムマークアップ"><a href="#markup-製品（およびライブラリ）とそのカスタムマークアップ" class="anchor-link">製品（およびライブラリ）とそのカスタムマークアップ</a></h3>
    <p>
      いくつかの標準でない要素の普及率については、ファーストパーティの採用をしたというより、人気のあるサードパーティのツールに含まれていることが関係しているでしょう。たとえば <code>&lt;fb:like&gt;</code> 要素は0.03%のページで見つかります。これはサイト所有者が意図的に記述しているのではなく、Facebookウィジェットに含まれているためです。<a href="https://web.archive.org/web/20060203031245/http://code.google.com/webstats/2005-12/editors.html">Hixieが14年前に言及した<span class="fn">https://web.archive.org/web/20060203031245/http://code.google.com/webstats/2005-12/editors.html</span></a
      >要素のほとんどは減少しているように見えますが、大部分が残っています。
    </p>
    <ul>
      <li>
        <a href="https://en.wikipedia.org/wiki/Claris_Home_Page">Claris Home Page<span class="fn">https://en.wikipedia.org/wiki/Claris_Home_Page</span></a
        >（最後の安定版は21年前）で作られた一般的要素は、100ページ以上に<em>まだ</em>現れてます。 たとえば、<a href="https://rainy-periwinkle.glitch.me/permalink/28b0b7abb3980af793a2f63b484e7815365b91c04ae625dd4170389cc1ab0a52.html"><code>&lt;x-claris-window&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/28b0b7abb3980af793a2f63b484e7815365b91c04ae625dd4170389cc1ab0a52.html</span></a
        >は130ページに現れています。
      </li>
      <li>
        英国のeコマースプロバイダーである<a href="https://www.oxatis.co.uk">Oxatis<span class="fn">https://www.oxatis.co.uk</span></a
        >の<code>&lt;actinic:*&gt;</code> 要素の一部はさらに多くのページに出現しています。たとえば、<a href="https://rainy-periwinkle.glitch.me/permalink/30dfca0fde9fad9b2ec58b12cb2b0271a272fb5c8970cd40e316adc728a09d19.html"><code>&lt;actinic:basehref&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/30dfca0fde9fad9b2ec58b12cb2b0271a272fb5c8970cd40e316adc728a09d19.html</span></a
        >はデスクトップデータ中の154ページに出現しています。
      </li>
      <li>Macromediaの要素はほとんど消えたようです。一覧にはたった一つの要素<code>&lt;mm:endlock&gt;</code>だけが現れており、その数はわずか22ページだけです。</li>
      <li>
        Adobe Go-Liveの<a href="https://rainy-periwinkle.glitch.me/permalink/579abc77652df3ac2db1338d17aab0a8dc737b9d945510b562085d8522b18799.html"><code>&lt;csscriptdict&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/579abc77652df3ac2db1338d17aab0a8dc737b9d945510b562085d8522b18799.html</span></a
        >は、デスクトップデータセットの640ページに引き続いて現れています。
      </li>
      <li>
        Microsoft Officeの<a href="https://rainy-periwinkle.glitch.me/permalink/bc8f154a95dfe06a6d0fdb099b6c8df61727b2289141a0ef16dc17b2b57d3068.html"><code>&lt;o:p&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/bc8f154a95dfe06a6d0fdb099b6c8df61727b2289141a0ef16dc17b2b57d3068.html</span></a
        >要素は、2万ページ以上のデスクトップページとなる0.5％に引き続いて現れています。
      </li>
    </ul>
    <p>そして、Hixieのオリジナルレポートにはなかった多くの新しい要素も現れました。</p>
    <ul>
      <li>
        <a href="https://rainy-periwinkle.glitch.me/permalink/e8bf0130c4f29b28a97b3c525c09a9a423c31c0c813ae0bd1f227bd74ddec03d.html"><code>&lt;ym-measure&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/e8bf0130c4f29b28a97b3c525c09a9a423c31c0c813ae0bd1f227bd74ddec03d.html</span></a
        >は、Yandexの<a href="https://www.npmjs.com/package/yandex-metrica-watch">Metrica analytics package<span class="fn">https://www.npmjs.com/package/yandex-metrica-watch</span></a
        >によって挿入されるタグです。デスクトップとモバイルページの1％以上で使われており、最も利用されている要素トップ100でその地位を確立しています。すごい！
      </li>
      <li>
        今は亡きGoogle Plusの<a href="https://rainy-periwinkle.glitch.me/permalink/a532f18bbfd1b565b460776a64fa9a2cdd1aa4cd2ae0d37eb2facc02bfacb40c.html"><code>&lt;g:plusone&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/a532f18bbfd1b565b460776a64fa9a2cdd1aa4cd2ae0d37eb2facc02bfacb40c.html</span></a
        >は、2万1千ページ以上で出現しています。
      </li>
      <li>
        Facebookの<a href="https://rainy-periwinkle.glitch.me/permalink/2e2f63858f7715ef84d28625344066480365adba8da8e6ca1a00dfdde105669a.html"><code>&lt;fb:like&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/2e2f63858f7715ef84d28625344066480365adba8da8e6ca1a00dfdde105669a.html</span></a
        >は、14,000のモバイルページで出現しています。
      </li>
      <li>
        同様に、<a href="https://rainy-periwinkle.glitch.me/permalink/5a964079ac2a3ec1b4f552503addd406d02ec4ddb4955e61f54971c27b461984.html"><code>&lt;fb:like-box&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/5a964079ac2a3ec1b4f552503addd406d02ec4ddb4955e61f54971c27b461984.html</span></a
        >は7.8kモバイルページで出現しています。
      </li>
      <li>
        <a href="https://rainy-periwinkle.glitch.me/permalink/6997d689f56fe77e5ce345cfb570adbd42d802393f4cc175a1b974833a0e3cb5.html"><code>&lt;app-root&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/6997d689f56fe77e5ce345cfb570adbd42d802393f4cc175a1b974833a0e3cb5.html</span></a
        >は、Angularなどのフレームワークで一般的に含まれており、8.2kモバイルページに出現しています。
      </li>
    </ul>
    <p>これらを5％未満のネイティブHTML要素と比べてみましょう。</p>
    <figure id="markup-fig9">
      <a href="https://almanac.httparchive.org/static/images/2019/markup/fig9.png">
        <img src="/static/images/2019/markup/fig9.png" alt="図9. 採用率が5％以下での、製品固有とネイティブで人気の要素。" aria-labelledby="markup-fig9-caption" aria-describedby="markup-fig9-description" width="600" height="370" data-width="600" data-height="370" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTbHgqcSepZye6DrCTpifFAUYxKT1hEO56585awyMips8oiPMLYu20GETuIE8mALkm814ObJyktEe2P/pubchart?oid=962404708&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="markup-fig9-description" class="visually-hidden">videoは184,149サイト、canvasは108,355、ym-measure（製品固有のタグ）は52,146、コードは25,075、g:plusone（製品固有のタグ）は21,098、fb:like（製品固有のタグ）は12,773、fb:like-box（製品固有のタグ）は6,792、app-root（製品固有のタグ）は8,468、summaryは6,578、templateは5,913、meterは0を示す棒グラフ。</div>
      <figcaption id="markup-fig9-caption"><a href="#markup-fig9" class="anchor-link">図 9.</a> 採用率が5％以下での、製品固有とネイティブで人気の要素。</figcaption>
    </figure>
    <p>このような興味深い洞察を一日中行うことができます。</p>
    <p>これは少々違うものですが、人気のある要素には製品のエラーによって引き起こされる可能性もあります。 たとえば1,000を超えるサイトで<code>&lt;pclass="ddc-font-size-large"&gt;</code> が出現しています。 しかしこれは、これは人気のある"as-a-service"製品がスペースを取り忘れているために発生していました。 幸いなことに、このエラーは調査中に報告されて、すぐに修正されました。</p>
    <p>Hixieはオリジナルの論文で次のように述べています。</p>
    <blockquote>この非標準マークアップに対して楽天的でいられる間は少なくとも、これらの要素にはベンダープレフィックスを明確に利用しているため、これは良い考えだと言えます。これにより、標準化団体が新しく作る要素と属性が、それらと衝突する可能性を大幅に減らすことができます。</blockquote>
    <p>
      ただし、上で述べた通りこれは一般的ではありません。 記録できた非標準要素の25％以上は、グローバル名前空間の汚染を避けるために、いかなる名前空間戦略も使っていません。 例えば、<a href="https://rainy-periwinkle.glitch.me/permalink/53567ec94b328de965eb821010b8b5935b0e0ba316e833267dc04f1fb3b53bd5.html">モバイルデータセットにある1157個の要素一覧<span class="fn">https://rainy-periwinkle.glitch.me/permalink/53567ec94b328de965eb821010b8b5935b0e0ba316e833267dc04f1fb3b53bd5.html</span></a
      >を表示します。 見ての通り、これらの多くは曖昧な名前やつづりの間違など、問題がない可能性があります。 しかし、少なくともこれはいくつかの挑むべき課題を示しています。 例えば、 <code>&lt;toast&gt;</code>（Google社員が<code>&lt;std-toast&gt;</code>として最近<a href="https://www.chromestatus.com/feature/5674896879255552">提案しようとした仕様<span class="fn">https://www.chromestatus.com/feature/5674896879255552</span></a
      >）がこの一覧に含まれています。
    </p>
    <p>それほど難しくない一般的な要素もいくつかあります。</p>
    <ul>
      <li>
        Yahoo Mapsの<a href="https://rainy-periwinkle.glitch.me/permalink/2ba66fb067dce29ecca276201c37e01aa7fe7c191e6be9f36dd59224f9a36e16.html"><code>&lt;ymaps&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/2ba66fb067dce29ecca276201c37e01aa7fe7c191e6be9f36dd59224f9a36e16.html</span></a
        >は、〜12.5kのモバイルページに出現します。
      </li>
      <li>
        2008年のフォント置換ライブラリである<a href="https://rainy-periwinkle.glitch.me/permalink/5cfe2db53aadf5049e32cf7db0f7f6d8d2f1d4926d06467d9bdcd0842d943a17.html"><code>&lt;cufon&gt;</code>と <code>&lt;cufontext&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/5cfe2db53aadf5049e32cf7db0f7f6d8d2f1d4926d06467d9bdcd0842d943a17.html</span></a
        >は、〜10.5kモバイルページに出現しています。
      </li>
      <li>
        <a href="https://rainy-periwinkle.glitch.me/permalink/976b0cf78c73d125644d347be9e93e51d3a9112e31a283259c35942bda06e989.html"><code>&lt;jdiv&gt;</code><span class="fn">https://rainy-periwinkle.glitch.me/permalink/976b0cf78c73d125644d347be9e93e51d3a9112e31a283259c35942bda06e989.html</span></a
        >要素は、Jivo chatの製品によって挿入されており、〜40.3kモバイルページに出現しています。
      </li>
    </ul>
    <p>前回のチャートに今回のデータを配置すると、次のようになります（改めて、データセットに基づいて少しだけ変わっています）</p>
    <figure id="markup-fig10">
      <a href="https://almanac.httparchive.org/static/images/2019/markup/fig10.png">
        <img src="/static/images/2019/markup/fig10.png" alt="図10. 採用率が5％以下での、製品固有のコンテキストまたはネイティブで人気のあるその他の要素。" aria-labelledby="markup-fig10-caption" aria-describedby="markup-fig10-description" width="600" height="370" data-width="600" data-height="370" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTbHgqcSepZye6DrCTpifFAUYxKT1hEO56585awyMips8oiPMLYu20GETuIE8mALkm814ObJyktEe2P/pubchart?oid=468373762&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="markup-fig10-description" class="visually-hidden">videoは184,149サイトで使用され、canvasは108,355、ym-measureは52,416、codeは25,075、g:plusoneは21,098、db:likeは12,773、cufonは10,523、ymapsは8,303、fb:like-boxは6,972、app-rootが8,468、summaryが6,578、templateが5,913、meterが0を示す棒グラフ。</div>
      <figcaption id="markup-fig10-caption"><a href="#markup-fig10" class="anchor-link">図 10.</a> 採用率が5％以下での、製品固有のコンテキストまたはネイティブで人気のあるその他の要素。</figcaption>
    </figure>
    <p>この結果には興味深い点があります、それは一つのツールが他の便利になる手段も提供していると言うことです。 データ空間を調べることに興味がある場合に、具体的なタグ名は想定される尺度の一つでしかありません。 良い「俗語」の発展を見つけることができれば、それは間違いなく最強の指標でしょう。 しかし、それが私たちの興味の範囲外である場合はどうなりますか？</p>
    <h3 id="markup-一般的なユースケースとソリューション"><a href="#markup-一般的なユースケースとソリューション" class="anchor-link">一般的なユースケースとソリューション</a></h3>
    <p>
      たとえば、一般的なユースケースの解決に興味が人々の場合はどうでしょうか？ これは、現在抱えているユースケースに対応したソリューションを探している場合や、標準化を促進するために人々が解決しようとしている一般的なユースケースをさらに研究するようなものがあります。 一般的な例として「タブ」を取り上げます。 長年にわたって、タブのようなものに対して多くの要求がありました。あいまいな検索をしてみると<a href="https://rainy-periwinkle.glitch.me/permalink/c6d39f24d61d811b55fc032806cade9f0be437dcb2f5735a4291adb04aa7a0ea.html">タブには多くのバリエーション<span class="fn">https://rainy-periwinkle.glitch.me/permalink/c6d39f24d61d811b55fc032806cade9f0be437dcb2f5735a4291adb04aa7a0ea.html</span></a
      >があることがわかります。 同一のページに2つの要素が存在しているかを簡単に識別できないため、利用されているかどうかを数えるのは少し難しくなります。そのためこの計測条件は地味ですが、最大のカウントを持つものを単純に使用します。 ほとんどの場合、実際のページ数はそれより大幅に増えるでしょう。
    </p>
    <p>
      また、数多くの<a href="https://rainy-periwinkle.glitch.me/permalink/e573cf279bf1d2f0f98a90f0d7e507ac8dbd3e570336b20c6befc9370146220b.html">アコーディオン<span class="fn">https://rainy-periwinkle.glitch.me/permalink/e573cf279bf1d2f0f98a90f0d7e507ac8dbd3e570336b20c6befc9370146220b.html</span></a
      >や<a href="https://rainy-periwinkle.glitch.me/permalink/0bb74b808e7850a441fc9b93b61abf053efc28f05e0a1bc2382937e3b78695d9.html">ダイアログ<span class="fn">https://rainy-periwinkle.glitch.me/permalink/0bb74b808e7850a441fc9b93b61abf053efc28f05e0a1bc2382937e3b78695d9.html</span></a
      >、少なくとも65種類の<a href="https://rainy-periwinkle.glitch.me/permalink/651e592cb2957c14cdb43d6610b6acf696272b2fbd0d58a74c283e5ad4c79a12.html">カルーセル<span class="fn">https://rainy-periwinkle.glitch.me/permalink/651e592cb2957c14cdb43d6610b6acf696272b2fbd0d58a74c283e5ad4c79a12.html</span></a
      >、それと<a href="https://rainy-periwinkle.glitch.me/permalink/981967b19a9346ac466482c51b35c49fc1c1cc66177ede440ab3ee51a7912187.html">ポップアップ<span class="fn">https://rainy-periwinkle.glitch.me/permalink/981967b19a9346ac466482c51b35c49fc1c1cc66177ede440ab3ee51a7912187.html</span></a
      >に関するもの、そして最低でも27種類存在する<a href="https://rainy-periwinkle.glitch.me/permalink/2e6827af7c9d2530cb3d2f39a3f904091c523c2ead14daccd4a41428f34da5e8.html">トグルとスイッチ<span class="fn">https://rainy-periwinkle.glitch.me/permalink/2e6827af7c9d2530cb3d2f39a3f904091c523c2ead14daccd4a41428f34da5e8.html</span></a
      >があります。
    </p>
    <p>
      おそらくですが、<a href="https://rainy-periwinkle.glitch.me/permalink/5ae67c941395ca3125e42909c2c3881e27cb49cfa9aaf1cf59471e3779435339.html">非ネイティブである92種類のボタン要素<span class="fn">https://rainy-periwinkle.glitch.me/permalink/5ae67c941395ca3125e42909c2c3881e27cb49cfa9aaf1cf59471e3779435339.html</span></a
      >が必要な理由を調査することで、ネイティブとのギャップを埋めようとすることができます。
    </p>
    <p>
      人気の有るものがポップアップ（<code>&lt;jdiv&gt;</code>などのチャット）という事に気付く事ができれば 、私達の知っている知識（たとえば、<code>&lt;jdiv&gt;</code>についての目的や<code>&lt;olark&gt;</code>）を知り、<a href="https://rainy-periwinkle.glitch.me/permalink/db8fc0e58d2d46d2e2a251ed13e3daab39eba864e46d14d69cc114ab5d684b00.html">それらに取り組むために作り上げた43のこと<span class="fn">https://rainy-periwinkle.glitch.me/permalink/db8fc0e58d2d46d2e2a251ed13e3daab39eba864e46d14d69cc114ab5d684b00.html</span></a
      >を見て、そこを辿りながら空間を調査することができます。
    </p>
    <h2 id="markup-結論"><a href="#markup-結論" class="anchor-link">結論</a></h2>
    <p>なのでここには多くのデータがありますが、要約すると。</p>
    <ul>
      <li>ページ中の要素は、14年前よりも平均と最大の両方で増えています。</li>
      <li>ホームページ上に存在する要素の寿命は<em>非常に</em>長いでしょう。要素を非推奨やサポート停止にしたとしても、消えることはありません。</li>
      <li>世の中には多くの壊れたマークアップがあります。（タグのつづり間違い、スペースの抜け、エスケープ間違い、誤解）</li>
      <li>「有益」である事を測定するのは難しいでしょう。多くのネイティブ要素は5％の敷居、さらには1％敷居を超えることはありませんが、多くのカスタム要素は多くの理由でその敷居を越えます。少なくとも1%を超えたものには注目をするべきかもしれませんが、データを見る限りは割と<em>良い</em>成功を収めているようなので、おそらく0.5％とすべきでしょう。</li>
      <li>既に大量のカスタムマークアップがあります。様々な形式がありますが、ダッシュを含む要素は確実に削除されたようです。</li>
      <li>牛の通り道を舗装する(pave the cowpaths)ために、このデータをさらに調査して、適切な観測結果を出す必要があります。</li>
    </ul>
    <p>
      最後はあなたの出番です。 大規模なコミュニティの創造性と好奇心を利用し、いくつかのツール(<a href="https://rainy-periwinkle.glitch.me/">https://rainy-periwinkle.glitch.me/<span class="fn">https://rainy-periwinkle.glitch.me/</span></a
      >など)を使うことでこのデータを探索することができます。 興味深い観察結果を共有して、知識と理解の共有の場を作ってください。
    </p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"I","chapter_number":4,"title":"メディア","description":"2019年版Web Almanacのメディアの章では、画像ファイルのサイズとフォーマット、レスポンシブ画像、クライアントのヒント、遅延読み込み、アクセシビリティ、動画を取り上げています。","authors":["colinbendell","dougsillars"],"reviewers":["ahmadawais","eeeps"],"translators":["ksakae"],"discuss":"1759","results":"https://docs.google.com/spreadsheets/d/1hj9bY6JJZfV9yrXHsoCRYuG8t8bR-CHuuD98zXV7BBQ/","queries":"04_Media","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-07-20T00:00:00.000Z","chapter":"media"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="media-序章"><a href="#media-序章" class="anchor-link">序章</a></h2>
    <p>画像、アニメーション、動画はウェブ体験の重要な一部です。それらが重要な理由はたくさんあります。ストーリーを伝えたり、視聴者の関心を引きつけたり、他のウェブ技術では簡単には作れないような芸術的な表現を提供したりするのに役立ちます。これらのメディアリソースの重要性は、2つの方法で示すことができます。1つは、1ページのダウンロードに必要なバイト数の多さ、もう1つはメディアで描かれたピクセル数の多さです。</p>
    <p>
      純粋なバイトの観点から見ると、HTTP Archiveは<a href="https://legacy.httparchive.org/interesting.php#bytesperpage">歴史的に報告されている<span class="fn">https://legacy.httparchive.org/interesting.php#bytesperpage</span></a
      >メディアから関連付けられたリソースバイトの平均3分の2を持っています。分布の観点から見ると、事実上すべてのウェブページが画像や動画に依存していることがわかります。10パーセンタイルでさえ、我々はバイトの44％がメディアからであり、ページの90パーセンタイルで総バイトの91％に上昇できることを参照してください。
    </p>
    <figure id="media-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig1_bytes_images_and_video_versus_other.png">
        <img src="/static/images/2019/media/fig1_bytes_images_and_video_versus_other.png" alt="図1. Webページのバイト：画像と動画対その他。" aria-labelledby="media-fig1-caption" aria-describedby="media-fig1-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=1189524305&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="media-fig1-description" class="visually-hidden">p10パーセンタイルでページバイトの44.1％がメディア、p25パーセンタイルで52.7％がメディア、p50パーセンタイルで67.0％がメディア、p75パーセンタイルで81.7％がメディア、p90パーセンタイルで91.2％がメディアであることを示す棒グラフです。</div>
      <figcaption id="media-fig1-caption"><a href="#media-fig-1" class="anchor-link">図 1.</a> Webページのバイト：画像と動画対その他。</figcaption>
    </figure>
    <p>メディアは視覚体験には欠かせないものですが、この大量のバイトのインパクトには2つの副作用があります。</p>
    <p>まず、これらのバイトをダウンロードするために必要なネットワークのオーバーヘッドは大きく、携帯電話や低速ネットワーク環境（コーヒーショップやUberに乗っているときのテザリングのような）では劇的にページの<a href="#performance">パフォーマンス</a>を遅くできます。画像はブラウザによる優先度の低いリクエストですが、ダウンロード中のCSSやJavaScriptを簡単にブロックできます。これ自体がページのレンダリングを遅らせることになります。しかし、画像コンテンツは、ページの準備ができたことをユーザーに視覚的に伝える手がかりとなります。そのため、画像コンテンツの転送が遅いと、ウェブページが遅いという印象を与えることがあります。</p>
    <p>
      2つ目の影響は、ユーザーへの金銭的なコストです。これはウェブサイトの所有者の負担ではなく、エンドユーザーの負担となるため、しばしば無視されがちな側面です。逸話として、<a href="https://twitter.com/yoavweiss/status/1195036487538003968?s=20">日本のような<span class="fn">https://twitter.com/yoavweiss/status/1195036487538003968?s=20</span></a
      >という市場では、データの上限に達した月末近くは学生の購買意欲が低下し、ユーザーはビジュアルコンテンツを見ることができなくなるということが伝えられています。
    </p>
    <p>
      さらに、世界のさまざまな地域でこれらのウェブサイトを訪問するための金銭的コストは不釣り合いです。中央値と90パーセンタイルでは、画像のバイト数はそれぞれ1MBと1.9MBです。<a href="https://whatdoesmysitecost.com/#gniCost">WhatDoesMySiteCost.com<span class="fn">https://whatdoesmysitecost.com/#gniCost</span></a
      >を使用すると、マダガスカルのユーザーの一人当たりの国民総所得（GNI）コストは90パーセンタイルでウェブページを1回読み込んだだけで、一日の総所得の2.6％になることがわかります。対照的に、ドイツでは、これは1日の総所得の0.3％になります。
    </p>
    <figure id="media-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig2_total_image_bytes_per_web_page_mobile.png">
        <img src="/static/images/2019/media/fig2_total_image_bytes_per_web_page_mobile.png" alt="図2. ウェブページあたりの総画像バイト数（モバイル）。" aria-labelledby="media-fig2-caption" aria-describedby="media-fig2-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=2025280105&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="media-fig2-description" class="visually-hidden">モバイルの中央値のウェブページでは、90パーセンタイルで1MBの画像と4.9MBの画像が必要です。</div>
      <figcaption id="media-fig2-caption"><a href="#media-fig-2" class="anchor-link">図 2.</a> ウェブページあたりの総画像バイト数（モバイル）。</figcaption>
    </figure>
    <p>ページあたりのバイト数を見ると、ページパフォーマンスとユーザーに対するコストだけを見ることになりますが、それは利点を見落としています。これらのバイトは、画面上のピクセルをレンダリングするために重要です。このように、1ページあたりに使用されるメディアのピクセル数を見ることで、画像や動画リソースの重要性を見ることができます。</p>
    <p>ピクセル量を見るときに考慮すべき3つのメトリクスがあります。CSSピクセル、ナチュラルピクセル、スクリーンピクセルです。</p>
    <ul>
      <li>
        <p><em>CSSピクセルボリューム</em> はCSSの観点からのレイアウトです。この尺度は、画像や動画を引き伸ばしたり、押し込んだりできる境界ボックスに焦点を当てています。また、実際のファイルのピクセルや画面表示のピクセルは考慮されていません。</p>
      </li>
      <li>
        <p><em>ナチュラルピクセル</em> とは、 ファイル内で表現される論理的なピクセルのことを指します。この画像をGIMPやPhotoshopで読み込んだ場合、ピクセルファイルの寸法は自然なピクセルとなります。</p>
      </li>
      <li>
        <p><em>スクリーンピクセル</em> とは、ディスプレイ上の物理的な電子機器を指します。携帯電話や最新の高解像度ディスプレイが登場する以前は、CSSピクセルとスクリーン上のLEDポイントの間には1:1の関係がありました。しかし、モバイルデバイスは目に近づけられ、ノートPCの画面は昔のメインフレーム端末よりも近づけられているため、現代のスクリーンは従来のCSSピクセルに対する物理ピクセルの比率が高くなっています。この比率は、Device-Pixel-Ratio、または口語でRetina™ディスプレイと呼ばれています。</p>
      </li>
    </ul>
    <figure id="media-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig3_image_pixel_per_page_mobile_css_v_actual.png">
        <img src="/static/images/2019/media/fig3_image_pixel_per_page_mobile_css_v_actual.png" alt="図3. 1ページあたりのピクセル画像（モバイル）。CSS対実物。" aria-labelledby="media-fig3-caption" aria-describedby="media-fig3-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=2027393897&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="media-fig3-description" class="visually-hidden">画像コンテンツに割り当てられているCSSの画素数を、実際の画像の画素数と比較した結果、p10（実測は0.07MP、CSSは0.04MP）、p25（実測は0.38MP、CSSは0.18MP）、p50（実測は1.6MP、CSSは0.65MP）、p75（実測は5.1MP、CSSは1.8MP）、p90（実測は12MP、CSSは4.6MP）が表示されていることがわかります。</div>
      <figcaption id="media-fig3-caption"><a href="#media-fig-3" class="anchor-link">図 3.</a> 1ページあたりのピクセル画像（モバイル）。CSS対実物。</figcaption>
    </figure>
    <figure id="media-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig4_image_pixel_per_page_desktop_css_v_actual.png">
        <img src="/static/images/2019/media/fig4_image_pixel_per_page_desktop_css_v_actual.png" alt="図4. 1ページあたりのピクセル画像（デスクトップ）。CSS対実物。" aria-labelledby="media-fig4-caption" aria-describedby="media-fig4-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=1364487787&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="media-fig4-description" class="visually-hidden">画像コンテンツに割り当てられたCSSの画素数をデスクトップ用の実際の画像の画素数と比較した結果、p10（実際は0.09MP、CSSは0.05MP）、p25（実際は0.52MP、CSSは0.29MP）、p50（実際は2.1MP、CSSは1.1MP）、p75（実際は6.0MP、CSSは2.8MP）、p90（実際は14MP、CSSは6.3MP）が表示されています。</div>
      <figcaption id="media-fig4-caption"><a href="#media-fig-4" class="anchor-link">図 4.</a> 1ページあたりのピクセル画像（デスクトップ）。CSS対実物。</figcaption>
    </figure>
    <p>CSSピクセルと自然ピクセル量を見ると、中央値のウェブサイトは1メガピクセル (MP) のメディア コンテンツを表示するレイアウトになっていることがわかります。90パーセンタイルでは、CSSレイアウトのピクセル量はモバイルで4.6MP、デスクトップで6.3MPに増加しています。これはレスポンシブレイアウトが、異なる可能性が高いだけでなく、フォームファクターが異なることも興味深い。要するに、モバイルレイアウトはデスクトップに比べてメディアに割り当てられるスペースが少ないということです。</p>
    <p>対照的に、ナチュラル（ファイル）ピクセル量はレイアウト量の2～2.6倍です。デスクトップウェブページの中央値は2.1MPのピクセルコンテンツを送信し、1.1MPのレイアウトスペースに表示されます。モバイルでは、90パーセンタイルの割合で12MPが4.6MPに圧縮されていることがわかります。</p>
    <p>もちろん、モバイルデバイスのフォームファクターはデスクトップとは異なります。デスクトップが大きく主に横向きで使用されるのに対し、モバイルデバイスは小さく通常縦向きで使用されます。前述したように、モバイルデバイスは目から近い位置にあるため、一般的にデバイスピクセル比（DPR）が高く、タイムズスクエアのビルボードに必要なピクセル数と比べて1インチあたりのピクセル数が多く必要となります。これらの違いにより、レイアウトの変更を余儀なくされ、モバイルのユーザーはコンテンツの全体を消費するためにサイトをスクロールするのが一般的です。</p>
    <p>メガピクセルは、主に抽象的な指標であるため、難しい指標です。ウェブページで使用されているピクセルの量を表現するのに便利な方法は、ディスプレイサイズに対する比率として表現することです。</p>
    <p>ウェブページのクロールで使用したモバイル端末では、<code>512 x 360</code>の表示で、0.18MPのCSSコンテンツが表示されています（物理的な画面である<code>3x</code>や3^2以上の画素である1.7MPと混同しないように）。このビューアーのピクセル量を画像に割り当てられたCSSピクセルの数で割ると、相対的なピクセル量が得られます。</p>
    <p>もし、画面全体を完璧に埋め尽くす画像が1枚あったとしたら、これは1xピクセルの塗りつぶし率になります。もちろん、ウェブサイトが1枚の画像でキャンバス全体を埋め尽くすことはほとんどありません。メディアコンテンツは、デザインや他のコンテンツと混在する傾向があります。1xよりも大きい値はレイアウトが追加の画像コンテンツを見るため、ユーザーが、スクロールする必要があることを意味します。</p>
    <p class="note">注：これは、viperとレイアウトコンテンツのボリュームの両方のCSSレイアウトを見ているだけです。レスポンシブ画像の効果や、DPRの高いコンテンツを提供することの効果を評価しているわけではありません。</p>
    <figure id="media-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig5_image_pixel_volume_v_css_pixels.png">
        <img src="/static/images/2019/media/fig5_image_pixel_volume_v_css_pixels.png" alt="図5. 画像のピクセル量と画面サイズ（CSSピクセル）の関係。" aria-labelledby="media-fig5-caption" aria-describedby="media-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=1889020047&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="media-fig5-description" class="visually-hidden">実際の画面サイズCSSピクセルと比較したページあたりに必要なピクセル量の比較では、p10（モバイル20%、デスクトップ2%）、p25（モバイル97%、デスクトップ13%）、p50（モバイル354%、デスクトップ46%）、p75（モバイル1003%、デスクトップ123%）、およびp90（モバイル2477%、デスクトップ273%）が示されています。</div>
      <figcaption id="media-fig5-caption"><a href="#media-fig-5" class="anchor-link">図 5.</a> 画像のピクセル量と画面サイズ（CSSピクセル）の関係。</figcaption>
    </figure>
    <p>デスクトップの中央値のウェブページでは、画像や動画を含むレイアウトが表示されるのはディスプレイの46％に過ぎません。対照的に、モバイルでは、メディアピクセルの量が実際のビューポートサイズの3.5倍を埋めています。レイアウトは、1つの画面で埋められる以上のコンテンツがあり、ユーザーはスクロールする必要があります。最低でも、1サイトあたり3.5ページ分のコンテンツがスクロールしていることになります（飽和度100％を想定）。モバイルの90パーセンタイルでは、これはビューポートサイズの25倍にまで大幅に拡大します！</p>
    <p>メディアリソースは、ユーザーエクスペリエンスにとって非常に重要です。</p>
    <h2 id="media-画像"><a href="#media-画像" class="anchor-link">画像</a></h2>
    <p>バイトの削減とユーザー体験の最適化に役立つ画像の管理と最適化については、すでに多くのことが書かれています。ブランド体験を定義するのはクリエイティブなメディアであるため、多くの人にとって重要かつクリティカルなトピックとなっています。したがって画像や動画コンテンツの最適化は、意図した体験の忠実性を維持しながら、ネットワーク上で転送されるバイト数を減らすのに役立つベストプラクティスを適用することとの間のバランスをとる行為です。</p>
    <p>画像、動画、アニメーションに利用されている戦略は、大まかに似ていますが、具体的なアプローチは大きく異なります。一般的には、これらの戦略は次のようなものです。</p>
    <ul>
      <li><strong>ファイル形式</strong> - 最適なファイル形式を利用</li>
      <li><strong>レスポンシブ</strong> - レスポンシブ画像技術を適用して、画面に表示されるピクセルだけを転送する</li>
      <li><strong>遅延ローディング</strong> - 人が見たときだけコンテンツを転送する</li>
      <li><strong>アクセシビリティ</strong> - 全人類に一貫した体験を提供する</li>
    </ul>
    <p class="note">これらの結果を解釈する際には注意が必要です。Web Almanacのためにクロールされたウェブページは、Chromeブラウザでクロールされました。これは、SafariやFirefoxに適したコンテンツネゴシエーションが、このデータセットでは表現されていない可能性があることを意味しています。例えば、JPEG2000、JPEG-XR、HEVC、HEICなどのファイル形式は、Chromeではネイティブにサポートされていないため、使用されていません。これは、ウェブにこれらの他の形式や経験が含まれていないことを意味するものではありません。同様に、Chrome には遅延読み込みのネイティブサポートがあります（v76 以降）が、他のブラウザではまだ利用できません。これらの注意事項については、<a href="#methodology">方法論</a>をご覧ください。</p>
    <p>画像を利用していないウェブページを見つけることは稀です。長年にわたり、ウェブ上でコンテンツを表示するためのさまざまなファイルフォーマットが登場してきましたが、それぞれが異なる問題に対処してきました。主に4つの普遍的な画像フォーマットがあります。JPEG、PNG、GIF、およびSVGです。さらに、Chromeではメディア パイプラインが強化され、5つ目の画像フォーマットのサポートが追加されました。WebP。他のブラウザでも同様にJPEG2000（Safari）、JPEG-XL（IEとEdge）、HEIC（SafariではWebViewのみ）のサポートが追加されています。</p>
    <p>それぞれのフォーマットにはそれぞれメリットがあり、Web上での理想的な使い方があります。とても簡単にまとめると以下のようになります。</p>
    <figure id="media-fig-6">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>フォーマット</th>
                <th class="width-45">ハイライト</th>
                <th class="width-45">欠点</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>JPEG</td>
                <td>
                  <ul>
                    <li>ユビキタスに対応</li>
                    <li>写真コンテンツに最適</li>
                  </ul>
                </td>
                <td>
                  <ul>
                    <li>常に品質の損失がある</li>
                    <li>ほとんどのデコーダは、最新のカメラからの高ビット深度の写真を扱うことができません（チャンネルあたり8ビット以上）</li>
                    <li>透明性のサポートはありません</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>PNG</td>
                <td>
                  <ul>
                    <li>JPEGやGIFのように、幅広いサポートを共有しています</li>
                    <li>ロスレスです</li>
                    <li>透明度、アニメーション、高ビット深度をサポート</li>
                  </ul>
                </td>
                <td>
                  <ul>
                    <li>JPEGに比べてはるかに大きなファイル</li>
                    <li>写真コンテンツには理想的ではない</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>GIF</td>
                <td>
                  <ul>
                    <li>PNGの前身Gは、アニメーションで最もよく知られています。</li>
                    <li>ロスレス</li>
                  </ul>
                </td>
                <td>
                  <ul>
                    <li>256色の制限があるため、変換による視覚的な損失が常にあります</li>
                    <li>アニメーション用の非常に大きなファイル</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>SVG</td>
                <td>
                  <ul>
                    <li>ファイルサイズを増やさずにリサイズできるベクターベースのフォーマット</li>
                    <li>ピクセルではなく数学に基づいており、滑らかな線を作成します</li>
                  </ul>
                </td>
                <td>
                  <ul>
                    <li>写真やその他のラスターコンテンツには有用ではない</li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td>WebP</td>
                <td>
                  <ul>
                    <li>PNGのようなロスレス画像とJPEGのようなロスレス画像を生成することができる新しいファイル形式です</li>
                    <li>
                      <a href="https://developers.google.com/speed/webp/faq">JPEGと比較して平均30%のファイル削減率を誇っています<span class="fn">https://developers.google.com/speed/webp/faq</span></a
                      >が、他のデータでは、ファイル削減率の中央値は<a href="https://cloudinary.com/state-of-visual-media-report/">ピクセル量に基づいて10-28%の間であることが示唆されています<span class="fn">https://cloudinary.com/state-of-visual-media-report/</span></a>
                    </li>
                  </ul>
                </td>
                <td>
                  <ul>
                    <li>JPEGとは異なり、一部の画像がぼやけて見えるクロマサブサンプリングに限定されます</li>
                    <li>普遍的にサポートされているわけではありません。Chrome、Firefox、Androidのエコシステムのみ</li>
                    <li>ブラウザのバージョンに応じて断片化された機能のサポート</li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <figcaption><a href="#media-fig-6" class="anchor-link">図 6.</a> 主流のファイル形式の説明。</figcaption>
    </figure>
    <h3 id="media-画像フォーマット"><a href="#media-画像フォーマット" class="anchor-link">画像フォーマット</a></h3>
    <p>すべてのページを見てみると、これらのフォーマットの普及率が、高いことがわかります。ウェブ上でもっとも古いフォーマットの1つであるJPEGは画像リクエストの60％、全画像バイトの65％で圧倒的に、もっとも一般的に使用されている画像フォーマットです。興味深いことに、PNGは画像要求とバイト数の28％で2番目によく使われている画像フォーマットです。色の正確さやクリエイティブなコンテンツの精度に加えて、サポートがどこにでもあることが広く使われている理由と考えられます。対照的に、SVG、GIF、WebPは4％とほぼ同じ使用率です。</p>
    <figure id="media-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig7_image_format_usage.png">
        <img alt="Most frequent Image types used on web pages" aria-labelledby="media-fig7-caption" aria-describedby="media-fig7-description" src="/static/images/2019/media/fig7_image_format_usage.png" width="600" height="376" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="media-fig7-description" class="visually-hidden">ツリーマップを見ると、JPEGが60.27％、PNGが28.2％、WebPが4.2％、GIFが3.67％、SVGが3.63％となっています。</div>
      <figcaption id="media-fig7-caption"><a href="#media-fig-7" class="anchor-link">図 7.</a> 画像フォーマットの使用法</figcaption>
    </figure>
    <p>もちろん、ウェブページの画像コンテンツの使い方は一様でありません。画像に依存しているページもあれば、いくつかは他よりも画像に依存しています。<code>google.com</code>のホームページを見てみると、一般的なニュースサイトに比べて画像はほとんどないことがわかります。実際、中央値のウェブサイトには13枚の画像があり、90パーセンタイルでは61枚、99パーセンタイルでは229枚の画像があります。</p>
    <figure id="media-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig8_image_format_usage_per_page.png">
        <img src="/static/images/2019/media/fig8_image_format_usage_per_page.png" alt="Figure 8. Image format usage per page." aria-labelledby="media-fig8-caption" aria-describedby="media-fig8-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=294858455&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="media-fig8-description" class="visually-hidden">p10パーセンタイルでは画像フォーマットが全く使用されていないことを示す棒グラフ、p25パーセンタイルではJPGが3枚とPNGが4枚、p50パーセンタイルではJPGが9枚、PNGが4枚、GIFが1枚、p75パーセンタイルではJPEGが39枚、PNGが18枚、SVGが2枚、GIFが2枚、p99パーセンタイルではJPGが119枚、PNGが49枚、WebPが28枚、SVGが19枚、GIFが14枚使用されていることを示しています。</div>
      <figcaption id="media-fig8-caption"><a href="#media-fig-8" class="anchor-link">図 8.</a> 1ページあたりの画像フォーマットの使用量</figcaption>
    </figure>
    <p>中央値のページではJPEGが9枚、PNGが4枚となっており、GIFが使用されているのは上位25％のページのみで、採用率は報告されていません。1ページあたりの各フォーマットの使用頻度は、より近代的なフォーマットの採用についての洞察を提供していません。具体的には、各フォーマットに少なくとも1枚の画像が含まれているページの割合は？</p>
    <figure id="media-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig9_pages_using_at_least_1_image.png">
        <img src="/static/images/2019/media/fig9_pages_using_at_least_1_image.png" alt="図9. 少なくとも1枚の画像を使用しているページの割合。" aria-labelledby="media-fig9-caption" aria-describedby="media-fig9-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=1024386063&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="media-fig9-description" class="visually-hidden">棒グラフで見ると、90%のページでJPEGが使用されており、89%がPNG、9%がWebP、37%がGIF、22%がSVGとなっています。</div>
      <figcaption id="media-fig9-caption"><a href="#media-fig-9" class="anchor-link">図 9.</a> 少なくとも1枚の画像を使用しているページの割合。</figcaption>
    </figure>
    <p>これは、90パーセンタイルのページでさえWebPの頻度がゼロである理由を説明するのに役立ちます。WebPがイメージに適していない理由はたくさんありますが、メディアのベストプラクティスの採用は、WebP自体の採用のようにまだ初期段階にとどまっています。</p>
    <h3 id="media-画像ファイルのサイズ"><a href="#media-画像ファイルのサイズ" class="anchor-link">画像ファイルのサイズ</a></h3>
    <p>画像ファイルのサイズを見るには、リソースあたりの絶対バイト数とピクセルあたりのバイト数の2つの方法があります。</p>
    <figure id="media-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig10_image_format_size.png">
        <img alt="A comparison of image formats by file size" aria-labelledby="media-fig10-caption" aria-describedby="media-fig10-description" src="/static/images/2019/media/fig10_image_format_size.png" width="600" height="371" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="media-fig10-description" class="visually-hidden">p10パーセンタイルではJPEGの4KB、PNGの2KB、GIFの2KBが使用され、p25パーセンタイルではJPGの9KB、PNGの4KB、WebPの7KB、GIFの3KBが使用され、p50パーセンタイルではJPGの24KB、PNGの11KB、WebPの17KB、GIFの6KBが使用されていることを示すチャート。SVGの1KBが使用され、p75パーセンタイルではJPEGの68KB、PNGの43KB、WebPの41KB、GIFの17KB、SVGの2KBが使用され、p90パーセンタイルではJPGの116KB、PNGの152KB、WebPの90KB、GIFの87KB、SVGの8KBが使用されています。</div>
      <figcaption id="media-fig10-caption"><a href="#media-fig-10" class="anchor-link">図 10.</a> 画像形式別のファイルサイズ（KB）。</figcaption>
    </figure>
    <p>このことから、ウェブ上の典型的なリソースの大きさや小ささを知ることができます。しかし、これではこれらのファイル分布の画面上で表現されているピクセルの量を知ることはできません。これを行うには、各リソースのバイト数を画像の自然なピクセル数で割ることができます。1ピクセルあたりのバイト数が低いほど、視覚コンテンツの伝送効率が高いことを示しています。</p>
    <figure id="media-fig-11">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig11_bytes_per_pixel.png">
        <img src="/static/images/2019/media/fig11_bytes_per_pixel.png" alt="図11. ピクセルあたりのバイト数。" aria-labelledby="media-fig11-caption" aria-describedby="media-fig11-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=1379541850&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig11-description" data-show-text="{{ show_description(11) }}" data-hide-text="{{ hide_description(11) }}">{{ show_description(11) }}</button>
      <div id="media-fig11-description" class="visually-hidden">ローソク足チャートは、p10パーセンタイルでは、JPEGが0.1175byte/pixel、PNGが0.1197byte/pixel、GIFが0.1702byte/pixel、WebPが0.0586byte/pixel、SVGが0.0293byte/pixelであることを示しています。p25パーセンタイルでは、JPEGが0.1848byte/pixel、PNGが0.2874byte/pixel、GIFが0.3641byte/pixel、WebPが0.1025byte/pixel、SVGが0.174byte/pixelとなっています。p50パーセンタイルでは、JPEGが0.2997byte/pixel、PNGが0.6918byte/pixel、GIFが0.7967byte/pixel、WebPが0.183byte/pixel、SVGが0.6766byte/pixelとなっています。p75パーセンタイルでは、JPEGが0.5456byte/pixel、PNGが1.4548byte/pixel、GIFが2.515byte/pixel、WebPが0.3272byte/pixel、SVGが1.9261byte/pixelとなっています。p90パーセンタイルでは、JPEGが0.9822byte/pixel、PNGが2.5026byte/pixel、GIFが8.5151byte/pixel、WebPが0.6474byte/pixel、SVGが4.1075byte/pixelとなっています。</div>
      <figcaption id="media-fig11-caption"><a href="#media-fig-11" class="anchor-link">図 11.</a> ピクセルあたりのバイト数。</figcaption>
    </figure>
    <p>以前はGIFファイルがJPEGよりも小さいと思われていましたが、今ではJPEGのリソースが大きくなった原因はピクセルボリュームにあることがはっきりとわかります。おそらく、GIFが他のフォーマットと比較して非常に低いピクセル密度を示していることは驚きではありません。さらにPNGは高いビット深度を扱うことができ、クロマサブサンプリングのぼやけに悩まされることはありませんが、同じピクセルボリュームではJPGやWebPの約2倍のサイズになります。</p>
    <p>なお、SVGに使用されるピクセル量は、画面上のDOM要素のサイズ（CSSピクセル）です。ファイルサイズの割にはかなり小さいですが、これは一般的にSVGがレイアウトの小さい部分で使用されていることを示唆しています。これが、PNGよりも1ピクセルあたりのバイト数が悪く見える理由です。</p>
    <p>繰り返しになりますが、この画素密度の比較は、同等の画像を比較しているわけではありません。むしろ、典型的なユーザー体験を報告しているのです。次に説明するように、これらの各フォーマットでも、ピクセルあたりのバイト数をさらに最適化して減らすために使用できる技術があります。</p>
    <h3 id="media-画像フォーマットの最適化"><a href="#media-画像フォーマットの最適化" class="anchor-link">画像フォーマットの最適化</a></h3>
    <p>体験に最適なフォーマットを選択することは、フォーマットの能力のバランスをとり、総バイト数を減らすことです。ウェブページの場合、画像を最適化することでウェブパフォーマンスを向上させることが1つの目標です。しかし、それぞれのフォーマットには、バイト数を減らすのに役立つ追加機能があります。</p>
    <p>いくつかの機能は、総合的な体験に影響を与えることができます。たとえばJPEGやWebPでは、<em>量子化</em>（一般的には<em>品質レベル</em>と呼ばれる）や <em>クロマサブサンプリング</em> を利用でき、視覚的な体験に影響を与えることなく、画像に格納されているビット数を減らすことができます。音楽用のMP3のように、この技術は人間の目のバグに依存しており、カラーデータが失われるにもかかわらず同じ体験を可能にします。しかし、すべての画像がこれらの技術に適しているわけではありません。</p>
    <p>他のフォーマット機能は、単にコンテンツを整理するだけで、時には文脈に沿った知識を必要とします。たとえばJPEGのプログレッシブエンコーディングを適用すると、ピクセルはスキャンレイヤーに再編成されブラウザはより早くレイアウトを完成させることができ、同時にピクセル量を減らすことができます。</p>
    <p>1つの<a href="#methodology-lighthouse">Lighthouse</a>テストは、ベースラインとプログレッシブにエンコードされたJPEGをA/Bで比較するものです。これは画像全体がロスレス技術でさらに最適化されるか、また異なる品質レベルを使用するなど、潜在的には不可逆技術で最適化されるかどうかを示すための気付きを提供しています。</p>
    <figure id="media-fig-12">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig12_percentage_optimized_images.png">
        <img src="/static/images/2019/media/fig12_percentage_optimized_images.png" alt="図12. 「最適化された」画像の割合。" aria-labelledby="media-fig12-caption" aria-describedby="media-fig12-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=1569150767" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="media-fig12-description" class="visually-hidden">p10パーセンタイルでは100%の画像が最適化されており、p25パーセンタイルでも同様で、p50パーセンタイルでは98%の画像が最適化されており（2%は最適化されていない）、p75パーセンタイルでは83%の画像が最適化されており（17%は最適化されていない）、p90パーセンタイルでは59%の画像が最適化されており、41%の画像が最適化されていないことを示す棒グラフです。</div>
      <figcaption id="media-fig12-caption"><a href="#media-fig-12" class="anchor-link">図 12.</a> 「最適化された」画像の割合。</figcaption>
    </figure>
    <p>このAB Lighthouseテストでの節約は、p95で数MBに達することができる潜在的なバイトの節約だけでなく、ページパフォーマンスの向上を実証しています。</p>
    <figure id="media-fig-13">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig13_project_perf_improvements_image_optimization.png">
        <img src="/static/images/2019/media/fig13_project_perf_improvements_image_optimization.png" alt="図13. Lighthouseからの画像最適化によるページパフォーマンスの向上を予測。" aria-labelledby="media-fig12-caption" aria-describedby="media-fig13-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=167590779" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig13-description" data-show-text="{{ show_description(13) }}" data-hide-text="{{ hide_description(13) }}">{{ show_description(13) }}</button>
      <div id="media-fig13-description" class="visually-hidden">p10パーセンタイルでは0ms、p25パーセンタイルでも同じ、p50パーセンタイルでは150ms、p75パーセンタイルでは1,460ms、p90パーセンタイルでは5,720msの保存が可能であることを示す棒グラフです。</div>
      <figcaption id="media-fig13-caption"><a href="#media-fig-13" class="anchor-link">図 13.</a> Lighthouseからの画像最適化によるページパフォーマンスの向上を予測。</figcaption>
    </figure>
    <h3 id="media-レスポンシブ画像"><a href="#media-レスポンシブ画像" class="anchor-link">レスポンシブ画像</a></h3>
    <p>ページパフォーマンスを向上させるもう1つの軸として、レスポンシブ画像の適用があります。これは、画像の縮小によってディスプレイに表示されない余分なピクセルを減らすことで、画像のバイト数を減らすことに重点を置いた手法です。この章の最初の方でデスクトップの中央のウェブページでは、1MPの画像プレースホルダーが使用されているにもかかわらず、実際のピクセル量は2.1MP転送されていることを見ました。これは1xDPRテストだったので、1.1MPのピクセルがネットワーク経由で転送されましたが、表示されませんでした。このオーバーヘッドを減らすために、2つの技術のうちの1つを使用できます（3つの可能性もあります）。</p>
    <ul>
      <li><strong>HTMLマークアップ</strong> - <code>srcset</code>要素と<code>sizes</code>要素を組み合わせて使用することで、ブラウザはビューポートの寸法とディスプレイの密度に基づいて最適な画像を選択できます。</li>
      <li><strong>クライアントヒント</strong> - これは、リサイズ可能な画像の選択をHTTPコンテントネゴシエーションに移行させます。</li>
      <li><strong>特典</strong>: JavaScriptライブラリーは、JavaScriptがブラウザーDOMを実行して検査し、コンテナーに基づいて正しい画像を挿入できるようになるまで画像のロードを遅らせます。</li>
    </ul>
    <h3 id="media-htmlマークアップの使用"><a href="#media-htmlマークアップの使用" class="anchor-link">HTMLマークアップの使用</a></h3>
    <p>レスポンシブ画像を実装するもっとも一般的な方法は、<code>&lt;img srcset&gt;</code> または <code>&lt;source srcset&gt;</code>のいずれかを用いて代替画像のリストを作成することです。<code>srcset</code>がDPRに基づいている場合、ブラウザは追加情報なしでリストから正しい画像を選択できます。しかし、ほとんどの実装では、<code>srcset</code>のピクセルサイズに基づいて正しい画像を選択するため必要なレイアウト計算の方法をブラウザへ指示するため<code>&lt;img sizes&gt;</code>を利用しています。</p>
    <figure id="media-fig-14">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig14_html_usage_of_responsive_images.png">
        <img src="/static/images/2019/media/fig14_html_usage_of_responsive_images.png" alt="図14. HTMLでレスポンシブ画像を使用しているページの割合。" aria-labelledby="media-fig14-caption" aria-describedby="media-fig14-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=582530039&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig14-description" data-show-text="{{ show_description(14) }}" data-hide-text="{{ hide_description(14) }}">{{ show_description(14) }}</button>
      <div id="media-fig14-description" class="visually-hidden">18%の画像が「sizes」を使用しており、21%が「srcset」を使用しており、2%が「picture」を使用していることを示す棒グラフです。</div>
      <figcaption id="media-fig14-caption"><a href="#media-fig-14" class="anchor-link">図 14.</a> HTMLでレスポンシブ画像を使用しているページの割合。</figcaption>
    </figure>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images#Art_direction">アートディレクション<span class="fn">https://developer.mozilla.org/ja/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images#Art_direction</span></a
      >のような高度なレスポンシブウェブデザイン（RWD）レイアウトによく使われていることを考えると、<code>&lt;picture&gt;</code>の使用率が著しく低いのは驚くべきことでありません。
    </p>
    <h3 id="media-サイズの使用"><a href="#media-サイズの使用" class="anchor-link">サイズの使用</a></h3>
    <p><code>srcset</code>の有用性は、通常は<code>sizes</code>メディアクエリの精度に依存します。<code>sizes</code>がないと、ブラウザは<code>&lt;img&gt;</code>タグが小さいコンポーネントではなくビューポート全体を埋め尽くすと仮定します。興味深いことに、ウェブ開発者が<code>&lt;img sizes&gt;</code>に採用している共通のパターンは5つあります。</p>
    <ul>
      <li>
        <strong><code>&lt;img sizes="100vw"&gt;</code></strong> - これは画像がビューポートの幅を埋め尽くすことを示します（デフォルトでもあります）。
      </li>
      <li>
        <strong><code>&lt;img sizes="200px"&gt;</code></strong> - これは、DPRに基づいてブラウザを選択する際に便利です。
      </li>
      <li>
        <strong><code>&lt;img sizes="(max-width: 300px) 100vw, 300px"&gt;</code></strong> - これは2番目に人気のあるデザインパターンです。これはWordPressとおそらく他のいくつかのプラットフォームで自動生成されるものです。元の画像サイズ（この場合は300px）に基づいて自動生成されているように見えます。
      </li>
      <li>
        <strong><code>&lt;img sizes="(max-width: 767px) 89vw, (max-width: 1000px) 54vw, ..."&gt;</code></strong> - このパターンは、CSSレスポンシブレイアウトに合わせてカスタムビルドしたデザインパターンです。ブレークポイントごとに使用するサイズの計算が異なります。
      </li>
    </ul>
    <figure id="media-fig-15">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th><code>&lt;img sizes&gt;</code></th>
                <th>頻度 (百万)</th>
                <th>%</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>(max-width: 300px) 100vw, 300px</td>
                <td>1.47</td>
                <td>5%</td>
              </tr>
              <tr>
                <td>(max-width: 150px) 100vw, 150px</td>
                <td>0.63</td>
                <td>2%</td>
              </tr>
              <tr>
                <td>(max-width: 100px) 100vw, 100px</td>
                <td>0.37</td>
                <td>1%</td>
              </tr>
              <tr>
                <td>(max-width: 400px) 100vw, 400px</td>
                <td>0.32</td>
                <td>1%</td>
              </tr>
              <tr>
                <td>(max-width: 80px) 100vw, 80px</td>
                <td>0.28</td>
                <td>1%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption id="media-fig15-caption"><a href="#media-fig-15" class="anchor-link">図 15.</a> 最も人気のある<code>sizes</code>パターンを使用しているページの割合。</figcaption>
    </figure>
    <ul>
      <li>
        <p>
          <strong><code>&lt;img sizes="auto"&gt;</code></strong> - これはもっともよく使われている使い方ですが、実際には非標準であり、<code>lazy_sizes</code>JavaScriptライブラリの使用によるものです。これはクライアント側のコードを使って、ブラウザのためにより良い<code>sizes</code>の計算を注入します。これの欠点は、JavaScriptの読み込みとDOMの準備が完全に整っているかどうかに依存し、画像の読み込みが大幅に遅れることです。
        </p>
      </li>
    </ul>
    <figure id="media-fig-16">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig16_top_patterns_of_img_sizes.png">
        <img src="/static/images/2019/media/fig16_top_patterns_of_img_sizes.png" alt="図16. 'img sizes'のトップパターン。" aria-labelledby="media-fig16-caption" aria-describedby="media-fig16-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=663985412&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig16-description" data-show-text="{{ show_description(16) }}" data-hide-text="{{ hide_description(16) }}">{{ show_description(16) }}</button>
      <div id="media-fig16-description" class="visually-hidden">1,130万枚の画像が「img sizes="(max-width: 300px) 100vw, 300px"」を使用しており、「auto」が160万枚、「img sizes="(max-width: 767px) 89vwなどなど"」が100万枚、「100vw」が23万枚、「300px」が13万枚であることを棒グラフで示しています。</div>
      <figcaption id="media-fig16-caption"><a href="#media-fig-16" class="anchor-link">図 16.</a> <code>&lt;img sizes&gt;</code>のトップパターン。</figcaption>
    </figure>
    <h3 id="media-クライアントヒント"><a href="#media-クライアントヒント" class="anchor-link">クライアントヒント</a></h3>
    <p>
      <a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/client-hints">クライアントヒント<span class="fn">https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/client-hints</span></a> は、コンテンツ制作者が画像のリサイズをHTTPコンテンツネゴシエーションに移すことを可能にします。この方法では、HTMLはマークアップを乱雑にするための追加の <code>&lt;img srcset&gt;</code> を必要とせず、代わりにサーバや <a href="https://cloudinary.com/blog/client_hints_and_responsive_images_what_changed_in_chrome_67">最適な画像を選択するための画像CDN<span class="fn">https://cloudinary.com/blog/client_hints_and_responsive_images_what_changed_in_chrome_67</span></a> に依存できます。これによりHTMLの簡素化が可能になり、オリジンサーバが時間の経過とともに適応し、コンテンツ層とプレゼンテーション層を切り離すことが可能になります。
    </p>
    <p>クライアントヒントを有効にするには、ウェブページでブラウザに追加のHTTPヘッダー<code>Accept-CH: DPR, Width, Viewport-Width</code>を使ってシグナルを送る必要があります。 <em>または</em> HTML<code>&lt;meta http-equiv="Accept-CH" content="DPR, Width, Viewport-Width"&gt;</code>を追加します。どちらか一方の手法の利便性は実装するチームに依存し、どちらも利便性のために提供されています。</p>
    <figure id="media-fig-17">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig17_usage_of_accept-ch_http_v_html.png">
        <img src="/static/images/2019/media/fig17_usage_of_accept-ch_http_v_html.png" alt="Accept-CH の使用法: HTTP と HTML の比較。" aria-labelledby="media-fig17-caption" aria-describedby="media-fig17-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=284657706&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig17-description" data-show-text="{{ show_description(17) }}" data-hide-text="{{ hide_description(17) }}">{{ show_description(17) }}</button>
      <div id="media-fig17-description" class="visually-hidden">71%が'meta http-equiv'を使用し、30% が'Accept-CH'HTTPヘッダーを使用し、1%が両方を使用していることを示す棒グラフです。</div>
      <figcaption id="media-fig17-caption"><a href="#media-fig-17" class="anchor-link">図 17.</a> <code>Accept-CH</code>ヘッダーと同等の<code>&lt;meta&gt;</code>タグの使用法。</figcaption>
    </figure>
    <p>HTMLでクライアントヒントを呼び出すために<code>&lt;meta&gt;</code>タグを使うのは、HTTPヘッダーに比べてはるかに一般的です。これは、ミドルボックスにHTTPヘッダーを追加するよりも、マークアップテンプレートを変更する方が便利であることを反映していると思われます。しかし、HTTPヘッダーの利用状況を見ると、50％以上が単一のSaaSプラットフォーム（Mercado）からのものです。</p>
    <p>呼び出されたクライアントヒントのうち、大部分のページでは<code>DPR</code>,<code>ViewportWidth</code>,<code>Width</code>の3つのユースケースで使用されている。もちろん、<code>Width</code>のクライアントヒントでは、ブラウザがレイアウトに関する十分なコンテキストを持つために<code>&lt;img sizes&gt;</code>を使用する必要があります。</p>
    <figure id="media-fig-18">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig18_enabled_client_hints.png">
        <img src="/static/images/2019/media/fig18_enabled_client_hints.png" alt="図18. 有効化されたクライアントヒント。" aria-labelledby="media-fig18-caption" aria-describedby="media-fig18-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=1878506264&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig18-description" data-show-text="{{ show_description(18) }}" data-hide-text="{{ hide_description(18) }}">{{ show_description(18) }}</button>
      <div id="media-fig18-description" class="visually-hidden">ドーナツ型のパイチャートを見ると、クライアントヒントの26.1%が「dpr」を使用しており、24.3%が「viewport-width」を使用しており、19.7%が「width」を使用しており、6.7%が「save-data」を使用しており、6.1%が「device-memory」を使用しており、6.0%が「downnlink」を使用しており、5.6%が「rtt」を使用しており、5.6%が「ect」を使用していることを示しています。</div>
      <figcaption id="media-fig18-caption"><a href="#media-fig-18" class="anchor-link">図 18.</a> 有効化されたクライアントヒント。</figcaption>
    </figure>
    <p>ネットワーク関連のクライアントヒント<code>downlink</code>、<code>rtt</code>、<code>ect</code>はAndroid Chromeでのみ利用可能です。</p>
    <h3 id="media-遅延ローディング"><a href="#media-遅延ローディング" class="anchor-link">遅延ローディング</a></h3>
    <p>ウェブページのパフォーマンスを改善することは、部分的にはイリュージョンのゲームとして特徴付けることができます。このように遅延読み込み画像は、ユーザーがページをスクロールしたときにのみ画像やメディアコンテンツが読み込まれる、これらのイリュージョンの1つです。これにより、遅いネットワークでも知覚パフォーマンスが向上し、ユーザーが他の方法で表示されていないバイトをダウンロードする手間が省けます。</p>
    <p>
      以前、<a href="#media-fig-5">図5</a>で、75パーセンタイルの画像コンテンツの量が、理論的には単一のデスクトップやモバイルのビューポートで表示できる量をはるかに超えていることを示しました。<a href="https://developers.google.com/web/tools/lighthouse/audits/offscreen-images">オフスクリーン画像<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/offscreen-images</span></a
      >Lighthouseの監査は、この疑念を裏付けています。ウェブページの中央値では、折り目の下に27％の画像コンテンツがあります。これは、90パーセンタイルの割合で84％に増加しています。
    </p>
    <figure id="media-fig-19">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig19_lighthouse_audit_offscreen.png">
        <img src="/static/images/2019/media/fig19_lighthouse_audit_offscreen.png" alt="図19. Lighthouse監査：オフスクリーン。" aria-labelledby="media-fig19-caption" aria-describedby="media-fig19-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=2123391693&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig19-description" data-show-text="{{ show_description(19) }}" data-hide-text="{{ hide_description(19) }}">{{ show_description(19) }}</button>
      <div id="media-fig19-description" class="visually-hidden">P10パーセンタイルでは画像の0%が画面外、P25パーセンタイルでは2%が画面外、P50パーセンタイルでは27%が画面外、P75パーセンタイルでは64%が画面外、P90パーセンタイルでは 84%が画面外であることを示す棒グラフです。</div>
      <figcaption id="media-fig19-caption"><a href="#media-fig-19" class="anchor-link">図 19.</a> Lighthouse監査：オフスクリーン。</figcaption>
    </figure>
    <p>Lighthouseの監査では、質の高いプレースホルダーを使用するなど、油断できない状況がいくつもあるため、臭いを嗅ぎ分けてくれます。</p>
    <p>
      遅延ローディングはIntersection Observers、Resize Observersの組み合わせを含め<a href="https://developers.google.com/web/fundamentals/performance/lazy-loading-guidance/images-and-video">実装可能<span class="fn">https://developers.google.com/web/fundamentals/performance/lazy-loading-guidance/images-and-video</span></a> です、または<a href="https://github.com/aFarkas/lazysizes">lazySizes<span class="fn">https://github.com/aFarkas/lazysizes</span></a
      >、<a href="https://github.com/ApoorvSaxena/lozad.js">lozad<span class="fn">https://github.com/ApoorvSaxena/lozad.js</span></a
      >などのJavaScriptライブラリの使用などさまざまな方法で実装できます。
    </p>
    <p>2019年8月、Chrome76では<code>&lt;img&gt;</code>を使用したマークアップベースの遅延ローディングのサポートが開始されました。2019年のWeb Almanacに使用されたウェブサイトのスナップショットは2019年7月のデータを使用していますが、2,509以上のウェブサイトがすでにこの機能を利用していました。</p>
    <h3 id="media-アクセシビリティ"><a href="#media-アクセシビリティ" class="anchor-link">アクセシビリティ</a></h3>
    <p>画像アクセシビリティの中心にあるのは <code>alt</code> タグです。画像に <code>alt</code> タグが追加されると、このテキストは画像を見ることができない（障害のある、インターネット接続が悪いのいずれかの理由で）ユーザーに画像を説明するために使用されます。</p>
    <p>データセットのHTMLファイルに含まれるすべての画像タグを検出できます。デスクトップでは1,300万個、モバイルでは1,500万個の画像タグのうち、91.6％の画像に<code>alt</code>タグが存在しています。一見すると、ウェブ上では画像のアクセシビリティは非常に良好な状態にあるように見えます。しかし、よく調べてみると、見通しはあまり良くありません。データセットに存在する<code>alt</code>タグの長さを調べると、<code>alt</code>タグの長さの中央値は6文字であることがわかります。これは空の<code>alt</code>タグ（<code>alt=""</code>のように見える）に対応する。6文字以上の長さの<code>alt</code>テキストを使用している画像は全体の39％にすぎない。実際の」<code>alt</code>テキストの中央値は31文字で、そのうち25文字が実際に画像を説明しています。</p>
    <h2 id="media-動画"><a href="#media-動画" class="anchor-link">動画</a></h2>
    <p>ウェブページで提供されるメディアは画像が主流ですが、ウェブ上でのコンテンツ配信では動画が大きな役割を果たし始めています。HTTP Archiveによると、デスクトップサイトの4.06％、モバイルサイトの2.99％が動画ファイルをセルフホスティングしていることがわかります。つまり、動画ファイルはYouTubeやFacebookのようなウェブサイトがホストしているわけではないということです。</p>
    <h3 id="media-動画フォーマット"><a href="#media-動画フォーマット" class="anchor-link">動画フォーマット</a></h3>
    <p>動画は、多くの異なるフォーマットやプレイヤーで配信できます。モバイルおよびデスクトップ向けの主要なフォーマットは、<code>.ts</code>（HLSストリーミングのセグメント）と<code>.mp4</code>(H264 MPEG) です。</p>
    <figure id="media-fig-20">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig20_video_files_by_extension.png">
        <img src="/static/images/2019/media/fig20_video_files_by_extension.png" alt="図20. 拡張子別の動画ファイルの数" aria-labelledby="media-fig20-caption" aria-describedby="media-fig20-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=999894252&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig20-description" data-show-text="{{ show_description(20) }}" data-hide-text="{{ hide_description(20) }}">{{ show_description(20) }}</button>
      <div id="media-fig20-description" class="visually-hidden">棒グラフは、デスクトップで「ts」が1,283,439件（モバイルで792,952件）、デスクトップで「mp4」が729,757件（モバイルで662,015件）、デスクトップで「webm」が38,591件（モバイルで32,417件）、デスクトップは「mov」が22,194件（モバイルは14,986件）、デスクトップは「m4s」が17,338件（モバイルは16,046件）、デスクトップは「m4v」が7,466件（モバイルは6,169件）となっています。</div>
      <figcaption id="media-fig20-caption"><a href="#media-fig-20" class="anchor-link">図 20.</a> 拡張子別の動画ファイルの数</figcaption>
    </figure>
    <p>他にも、<code>webm</code>、<code>mov</code>、<code>m4s</code>、<code>m4v</code>（MPEG-DASHストリーミングセグメント）などのフォーマットが見られます。ウェブ上のストリーミングの大部分はHLSであり、静的動画の主要なフォーマットは<code>mp4</code>であることが明らかです。</p>
    <p>各フォーマットの動画サイズの中央値は以下の通りです。</p>
    <figure id="media-fig-21">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig21_median_vidoe_file_size_by_extension.png">
        <img src="/static/images/2019/media/fig21_median_vidoe_file_size_by_extension.png" alt="図21. 動画の拡張子別のファイルサイズの中央値。" aria-labelledby="media-fig21-caption" aria-describedby="media-fig21-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=821311770&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig21-description" data-show-text="{{ show_description(21) }}" data-hide-text="{{ hide_description(21) }}">{{ show_description(21) }}</button>
      <div id="media-fig21-description" class="visually-hidden">「ts」の平均ファイルサイズがデスクトップで335KB(モバイルで156KB)、「mp4」がデスクトップで175KB(モバイルで128KB)、「webm」がデスクトップで359KB(モバイルで192KB)、「mov」がデスクトップで128KB(モバイルで96KB)、「m4s」がデスクトップで324KB(モバイルで246KB)、「m4v」がデスクトップで383KB(モバイルで161KB)であることを示す棒グラフ。</div>
      <figcaption id="media-fig21-caption"><a href="#media-fig-21" class="anchor-link">図 21.</a> 動画の拡張子別のファイルサイズの中央値。</figcaption>
    </figure>
    <p>中央値はモバイルの方が小さくなっていますが、これはおそらくデスクトップで非常に大きな動画を持っているサイトがモバイル用へ無効化していたり、動画ストリームが小さい画面に小さいバージョンの動画を提供していたりすることを意味していると思われます。</p>
    <h3 id="media-動画ファイルのサイズ"><a href="#media-動画ファイルのサイズ" class="anchor-link">動画ファイルのサイズ</a></h3>
    <p>ウェブ上で動画を配信する場合、ほとんどの動画はHTML5動画プレイヤーで配信されます。HTML動画プレイヤーは、さまざまな目的で動画を配信するために非常にカスタマイズが可能です。たとえば、動画を自動再生するには、パラメーター<code>autoplay</code>と<code>muted</code>を追加します。<code>controls</code>属性は、ユーザーが動画を開始/停止したり、スキャンしたりすることを可能にします。HTTP Archiveの動画タグを解析することで、これらの属性の使用状況を確認できます。</p>
    <figure id="media-fig-22">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig22_html_video_tag_attributes_usage.png">
        <img src="/static/images/2019/media/fig22_html_video_tag_attributes_usage.png" alt="図21. HTML 動画タグ属性の使用法。" aria-labelledby="media-fig21-caption" aria-describedby="media-fig21-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=593556050&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig22-description" data-show-text="{{ show_description(22) }}" data-hide-text="{{ hide_description(22) }}">{{ show_description(22) }}</button>
      <div id="media-fig22-description" class="visually-hidden">デスクトップ用のバーチャート。'autoplay'は11.84%、'buffered'は0%、'controls'は12.05%、'crossorigin'は0.45%、'currenttime'は0.01%、'disablepictureinpicture'は0.01%、'disableremoteplayback'は0.01%、'duration'は0.05%、'height'は7.33%、'intrinsicsize'は0%、'loop'は14.57%、'muted'は13.92%、'playsinline'は6.49%、'poster'は8.98%、'preload'は11.62%、'src'は3.67%、'use-credentials'は0%、and 'width'は9%。そしてモバイルで'autoplay'は12.38%、'buffered'は0%、'controls'は13.88%、'crossorigin'は0.16%、'currenttime'は0.01%、disablepictureinpicture'は0.01%、'disableremoteplayback'は0.02%、'duration'は0.09%、'height'は6.54%、 intrinsicsize'は0%、'loop'は14.44%、'muted'は13.55%、'playsinline'は6.15%、'poster'は9.29%、'preload'は10.34%、'src'は4.13%、'use-credentials'は0%、'width'は9.03%である。</div>
      <figcaption id="media-fig22-caption"><a href="#media-fig-22" class="anchor-link">図 22.</a> HTML動画タグ属性の使用法。</figcaption>
    </figure>
    <p>もっとも一般的な属性は<code>autoplay</code>、<code>muted</code>、<code>loop</code>で、続いて<code>preload</code>タグ、そして<code>width</code>と<code>height</code>です。<code>loop</code>属性の使用は背景の動画や、動画をアニメーションGIFの代わりに、使用する場合に使用されるのでウェブサイトのホームページでよく使用されても不思議ではありません。</p>
    <p>ほとんどの属性はデスクトップとモバイルで似たような使い方をしていますが、いくつかの属性には大きな違いがあります。モバイルとデスクトップの間でもっとも大きな違いがあるのは<code>width</code>と<code>height</code>の2つの属性で、モバイルではこれらの属性を使用しているサイトが4％少なくなっています。興味深いことに、モバイルでは<code>poster</code>属性（再生前に動画ウィンドウの上に画像を配置する）が少しだけ増加しています。</p>
    <p>アクセシビリティの観点からは、<code>&lt;track&gt;</code>タグはキャプションや字幕を追加するために使用できます。HTTP Archiveには<code>&lt;track&gt;</code>タグの使用頻度に関するデータがありますが、調査したところ、データセットのほとんどのインスタンスはコメントアウトされているか、<code>404</code>エラーを返すアセットを指していました。多くのサイトでは、JavaScriptやHTMLのボイラプレートを使用しており、trackが使用されていない場合でもtrackを削除しないようになっているようです。</p>
    <h3 id="media-動画プレイヤー"><a href="#media-動画プレイヤー" class="anchor-link">動画プレイヤー</a></h3>
    <p>より高度な再生（および動画ストリームの再生）を行うには、HTML5ネイティブ動画プレイヤーは動作しません。再生に使用する一般的な動画ライブラリがいくつかあります。</p>
    <figure id="media-fig-23">
      <a href="https://almanac.httparchive.org/static/images/2019/media/fig23_top_javascript_video_players.png">
        <img src="/static/images/2019/media/fig23_top_javascript_video_players.png" alt="図23. トップの JavaScript 動画プレイヤー" aria-labelledby="media-fig23-caption" aria-describedby="media-fig23-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSViHIntdF6-bHAI0cl1HelY_X8rR4lf0P3W2Y8I5SyVMxG-ptggTHfWA0qrrU47RvuAydLE6Zex6L3/pubchart?oid=215677194&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig23-description" data-show-text="{{ show_description(23) }}" data-hide-text="{{ hide_description(23) }}">{{ show_description(23) }}</button>
      <div id="media-fig23-description" class="visually-hidden">3,365のデスクトップサイト(3,400のモバイルサイト)、52,375のデスクトップサイト(40,925のモバイルサイト)、110,280のデスクトップサイト(96,945のモバイルサイト)、325のデスクトップサイト(275のモバイルサイト)の「shaka」、377,990のデスクトップサイト(391,330のモバイルサイト)の「video」を示す棒グラフです。</div>
      <figcaption id="media-fig23-caption"><a href="#media-fig-23" class="anchor-link">図 23.</a> トップの JavaScript 動画プレイヤー</figcaption>
    </figure>
    <p>もっとも人気があるのは（圧倒的に）video.jsで、JWPLayerとHLS.jsがそれに続いています。著者は、「video.js」という名前のファイルが、同じ動画再生ライブラリではない可能性があることを認めています。</p>
    <h2 id="media-結論"><a href="#media-結論" class="anchor-link">結論</a></h2>
    <p>ほぼすべてのウェブページではユーザー体験を向上させ、意味を生み出すために、画像や動画をある程度使用しています。これらのメディアファイルは大量のリソースを利用し、ウェブサイトのトン数の大部分を占めています（そして、それらがなくなることはありません！）代替フォーマット、遅延ロード、レスポンシブ画像、画像の最適化を利用することは、ウェブ上のメディアのサイズを小さくするために長い道のりを行くことができます。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"II","chapter_number":5,"title":"サードパーティ","description":"2019 Web Almanacのサードパーティの章。サードパーティの使用目的、パフォーマンスへの影響、プライバシーへの影響について説明しています。","authors":["patrickhulce"],"reviewers":["zcorpan","obto","jasti"],"translators":["ksakae"],"discuss":"1760","results":"https://docs.google.com/spreadsheets/d/1iC4WkdadDdkqkrTY32g7hHKhXs9iHrr3Bva8CuPjVrQ/","queries":"05_Third_Parties","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-05-14T00:00:00.000Z","chapter":"third-parties"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="third-parties-導入"><a href="#third-parties-導入" class="anchor-link">導入</a></h2>
    <p>オープンWebは広大で、リンク可能で、設計により相互運用可能です。他の誰かの複雑なライブラリを取得し、単一の<code>&lt;link&gt;</code>または<code>&lt;script&gt;</code>要素を使用してサイトで使用する機能により開発者の生産性が大幅に向上し、素晴らしく新しいWeb体験を実現しました。反対に、一部のサードパーティプロバイダーが非常に人気があるため、パフォーマンス、プライバシー、およびセキュリティに関する重要な懸念が生じています。この章では、2019年のWebに対するサードパーティコードの普及と影響、サードパーティソリューションの人気につながる使用パターンと、Web体験の将来への影響の可能性について検討します。</p>
    <h2 id="third-parties-定義"><a href="#third-parties-定義" class="anchor-link">定義</a></h2>
    <h3 id="third-parties-サードパーティ"><a href="#third-parties-サードパーティ" class="anchor-link">"サードパーティ"</a></h3>
    <p>サードパーティとは、サイトとユーザーの主要な関係の外にあるエンティティです。つまり、サイトの側面はサイトの所有者の直接の管理下になく、承認を得て存在します。たとえば、Googleアナリティクススクリプトは、一般的なサードパーティリソースの例です。</p>
    <p>サードパーティのリソースは次のとおりです。</p>
    <ul>
      <li>共有および公開オリジンでホストされています</li>
      <li>さまざまなサイトで広く使用されています</li>
      <li>個々のサイト所有者の影響を受けない</li>
    </ul>
    <p>これらの目標を可能な限り正確に一致させるために、この章で使用されるサードパーティリソースの正式な定義は、HTTP Archiveデータセット内の少なくとも50のユニークなページにリソースを見つけることができるドメインに由来するリソースです。</p>
    <p>これらの定義を使用して、ファーストパーティ・ドメインから提供されたサードパーティ・コンテンツはファーストパーティ・コンテンツとしてカウントされることに注意してください。例えば、セルフホスティングのGoogle Fontsやbootstrap.cssは、ファースト・パーティ・コンテンツとしてカウントされます。同様に、サードパーティのドメインから提供されたファーストパーティのコンテンツは、サードパーティのコンテンツとしてカウントされます。たとえば、サードパーティ・ドメインでCDNを介して提供されるファーストパーティの画像は、サードパーティ・コンテンツとみなされます。</p>
    <h3 id="third-parties-プロバイダーカテゴリー"><a href="#third-parties-プロバイダーカテゴリー" class="anchor-link">プロバイダーカテゴリー</a></h3>
    <p>
      この章では、サードパーティプロバイダをこれらの大まかなカテゴリのいずれかに分類しています。以下に簡単な説明を記載し、ドメインとカテゴリのマッピングについては、<a href="https://github.com/patrickhulce/third-party-web/blob/8afa2d8cadddec8f0db39e7d715c07e85fb0f8ec/data/entities.json5">サードパーティ・ウェブ・リポジトリ<span class="fn">https://github.com/patrickhulce/third-party-web/blob/8afa2d8cadddec8f0db39e7d715c07e85fb0f8ec/data/entities.json5</span></a
      >を参照してください。
    </p>
    <ul>
      <li><strong>Ad</strong> - 広告の表示と測定</li>
      <li><strong>Analytics</strong> - トラッキングサイト訪問者の行動</li>
      <li><strong>CDN</strong> - 公共の共有ユーティリティやユーザーのプライベートコンテンツを提供</li>
      <li><strong>Content</strong> - 公開を容易にし、シンジゲートされたコンテンツを提供</li>
      <li><strong>Customer Success</strong> - サポートと顧客関係管理の機能</li>
      <li><strong>Hosting</strong> - ユーザー任意のコンテンツを提供</li>
      <li><strong>Marketing</strong> - 営業、見込み客獲得、メールマーケティング機能</li>
      <li><strong>Social</strong> - ソーシャルネットワークとその連携</li>
      <li><strong>Tag Manager</strong> - 他の第三者の包含を管理することを唯一の役割を提供</li>
      <li><strong>Utility</strong> - 開発を補助するためのコード</li>
      <li><strong>Video</strong> - ユーザーの任意の動画コンテンツ</li>
      <li><strong>Other</strong> - 未分類、上記に分類されないカテゴリ</li>
    </ul>
    <p class="note"><strong>CDNについての注意事項</strong>: ここでのCDNカテゴリには、<strong>パブリック</strong>CDNドメイン（例：bootstrapcdn.com、cdnjs.cloudflare.comなど）上でリソースを提供するプロバイダが含まれており、単にCDN上で提供されるリソースは含まれて<strong>いません</strong>。</p>
    <h3 id="third-parties-警告事項"><a href="#third-parties-警告事項" class="anchor-link">警告事項</a></h3>
    <ul>
      <li>ここで提示されているデータはすべて、非インタラクティブなコールドロードに基づいています。これらの値は、ユーザーとのインタラクションの後では、かなり異なって見えるようになる可能性があります。</li>
      <li>リクエスト量別のサードパーティドメインの約84％が特定され、分類されています。残りの16％は「その他」のカテゴリーに分類されています。</li>
    </ul>
    <h2 id="third-parties-データ"><a href="#third-parties-データ" class="anchor-link">データ</a></h2>
    <figure id="third-parties-fig-1">
      <div class="big-number">93.59%</div>
      <figcaption><a href="#third-parties-fig-1" class="anchor-link">図 1.</a> 少なくとも1つのサードパーティ製リソースを含むデスクトップページの割合。</figcaption>
    </figure>
    <p>サードパーティのコードは至る所にあります。ページの93％が少なくとも1つのサードパーティリソースを含み、ページの76％がアナリティクスドメインへのリクエストを発行しています。中央のページでは、ネットワークアクティビティ全体の35％を占める少なくとも9つのユニークサードパーティドメインからコンテンツをリクエストしており、最もアクティブな10％のページでは175以上のサードパーティリクエストを発行しています。サードパーティはウェブの不可欠な部分であると言っても過言ではありません。</p>
    <figure id="third-parties-fig-2">
      <div class="big-number">55.63%</div>
      <figcaption><a href="#third-parties-fig-2" class="anchor-link">図 2.</a> 少なくとも1つの広告リソースを含むデスクトップページの割合。</figcaption>
    </figure>
    <h3 id="third-parties-カテゴリー"><a href="#third-parties-カテゴリー" class="anchor-link">カテゴリー</a></h3>
    <p>サードパーティ製コンテンツの普及が驚くに値しないとすれば、おそらくもっと興味深いのは、サードパーティ製コンテンツのプロバイダタイプ別の内訳です。</p>
    <p>ウェブ上でのサードパーティの存在は広告が最もユーザーの目につきやすい例かもしれませんが、アナリティクスプロバイダーが最も一般的なサードパーティのカテゴリーであり、76％のサイトで少なくとも1つのアナリティクスリクエストが含まれています。CDNが63％、広告が57％、Sentry、Stripe、Google Maps SDKなどの開発者向けユーティリティが56％で、最も多くのウェブプロパティに表示されているのは僅差の2位、3位、4位と続いています。これらのカテゴリの人気は、本章で後述するウェブ利用パターンの基礎を形成しています。</p>
    <h3 id="third-parties-プロバイダー"><a href="#third-parties-プロバイダー" class="anchor-link">プロバイダー</a></h3>
    <p>プロバイダーの比較的小さなセットがサードパーティの状況を支配しています：トップ100ドメインは、ウェブ全体のネットワーク要求の30％を占めています。Google、Facebook、YouTubeのような大企業は、それぞれのシェアの完全なパーセンテージポイントでここの見出しを作るが、WixやShopifyのような小さな事業体は同様にサードパーティの人気のかなりの部分を指揮します。</p>
    <p>
      個々のプロバイダの人気とパフォーマンスへの影響については、多くのことが言えるかもしれませんが、このより意見の多い分析は読者や<a href="https://thirdpartyweb.today">サードパーティ製Web<span class="fn">https://thirdpartyweb.today</span></a
      >のような他の目的のために構築されたツールの練習として残されています。
    </p>
    <figure id="third-parties-fig-3">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ランク</th>
                <th>サードパーティドメイン</th>
                <th>リクエストの割合</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td><code>fonts.gstatic.com</code></td>
                <td>2.53%</td>
              </tr>
              <tr>
                <td>2</td>
                <td><code>www.facebook.com</code></td>
                <td>2.38%</td>
              </tr>
              <tr>
                <td>3</td>
                <td><code>www.google-analytics.com</code></td>
                <td>1.71%</td>
              </tr>
              <tr>
                <td>4</td>
                <td><code>www.google.com</code></td>
                <td>1.17%</td>
              </tr>
              <tr>
                <td>5</td>
                <td><code>fonts.googleapis.com</code></td>
                <td>1.05%</td>
              </tr>
              <tr>
                <td>6</td>
                <td><code>www.youtube.com</code></td>
                <td>0.99%</td>
              </tr>
              <tr>
                <td>7</td>
                <td><code>connect.facebook.net</code></td>
                <td>0.97%</td>
              </tr>
              <tr>
                <td>8</td>
                <td><code>googleads.g.doubleclick.net</code></td>
                <td>0.93%</td>
              </tr>
              <tr>
                <td>9</td>
                <td><code>cdn.shopify.com</code></td>
                <td>0.76%</td>
              </tr>
              <tr>
                <td>10</td>
                <td><code>maps.googleapis.com</code></td>
                <td>0.75%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#third-parties-fig-3" class="anchor-link">図 3.</a> サードパーティドメインの人気トップ10</figcaption>
    </figure>
    <figure id="third-parties-fig-4">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ランク</th>
                <th>サードパーティURL</th>
                <th>リクエストの割合</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td><code>https://www.google-analytics.com/analytics.js</code></td>
                <td>0.64%</td>
              </tr>
              <tr>
                <td>2</td>
                <td><code>https://connect.facebook.net/en_US/fbevents.js</code></td>
                <td>0.20%</td>
              </tr>
              <tr>
                <td>3</td>
                <td><code>https://connect.facebook.net/signals/plugins/inferredEvents.js?v=2.8.51</code></td>
                <td>0.19%</td>
              </tr>
              <tr>
                <td>4</td>
                <td><code>https://staticxx.facebook.com/connect/xd_arbiter.php?version=44</code></td>
                <td>0.16%</td>
              </tr>
              <tr>
                <td>5</td>
                <td><code>https://fonts.gstatic.com/s/opensans/v16/mem8YaGs126MiZpBA-UFVZ0b.woff2</code></td>
                <td>0.13%</td>
              </tr>
              <tr>
                <td>6</td>
                <td><code>https://www.googletagservices.com/activeview/js/current/osd.js?cb=%2Fr20100101</code></td>
                <td>0.12%</td>
              </tr>
              <tr>
                <td>7</td>
                <td><code>https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxK.woff2</code></td>
                <td>0.11%</td>
              </tr>
              <tr>
                <td>8</td>
                <td><code>https://googleads.g.doubleclick.net/pagead/id</code></td>
                <td>0.11%</td>
              </tr>
              <tr>
                <td>9</td>
                <td><code>https://fonts.gstatic.com/s/roboto/v19/KFOmCnqEu92Fr1Mu4mxK.woff2</code></td>
                <td>0.10%</td>
              </tr>
              <tr>
                <td>10</td>
                <td><code>https://www.googleadservices.com/pagead/conversion_async.js</code></td>
                <td>0.10%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#third-parties-fig-4" class="anchor-link">図 4.</a> サードパーティからのリクエストが多いトップ10</figcaption>
    </figure>
    <h3 id="third-parties-リソースの種類"><a href="#third-parties-リソースの種類" class="anchor-link">リソースの種類</a></h3>
    <p>サードパーティコンテンツのリソースタイプの内訳を見ると、サードパーティのコードがWeb全体でどのように使用されているかを知ることができます。ファーストパーティのリクエストが、56％の画像、23％のスクリプト、14％のCSS、4％のHTMLにすぎないのに対し、サードパーティのリクエストはスクリプトとHTMLの割合が高く32％のスクリプト、34％の画像、12％のHTML、6％のCSSとなっています。このことは、サードパーティのコードがデザインを支援するために使用される頻度が低く代わりにファーストパーティのコードよりもインタラクションを促進したり観察したりするために使用される頻度が高いことを示唆していますがパーティの状態別のリソースタイプの内訳を見ると、よりニュアンスのあるストーリーがわかります。CSSと画像がそれぞれ70％、64％と圧倒的にファーストパーティであるのに対し、フォントはほとんどがサードパーティのプロバイダによって提供されており、ファーストパーティのソースから提供されているのは28％ にすぎません。この使用パターンの概念については、この章で後ほど詳しく説明します。</p>
    <figure id="third-parties-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/third-parties/fig5.png">
        <img src="/static/images/2019/third-parties/fig5.png" alt="図5. カテゴリーとコンテンツタイプ別の第三者リクエストの割合。" aria-labelledby="third-parties-fig5-caption" aria-describedby="third-parties-fig5-description" width="600" height="387" data-width="600" data-height="387" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRO5jS8JpjYdTr9poYmpyw-BL1LPQtfzHx_1hLRk9lgwkHQERuyELgF_rQ-4CpTbdbAyI9u1ggtPlLQ/pubchart?oid=488955458&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="third-parties-fig5-description" class="visually-hidden">サードパーティの各カテゴリのコンテンツタイプの内訳を示すグラフ。画像とスクリプトが各カテゴリのリクエストの大半を占めています。CDNリクエストでは、特にフォントの割合が高いです。</div>
      <figcaption id="third-parties-fig5-caption"><a href="#third-parties-fig-5" class="anchor-link">図 5.</a> カテゴリーとコンテンツタイプ別の第三者リクエストの割合。</figcaption>
    </figure>
    <p>このデータからは、他にもいくつかの興味深い事実が飛び出してきます。トラッキングピクセル（解析ドメインへの画像リクエスト）は全ネットワークリクエストの1.6％を占め、FacebookやTwitterなどのソーシャルネットワークへの動画リクエストの数は、YouTubeやVimeoなどの専用動画プロバイダーの6倍にもなります（YouTubeのデフォルトの埋め込みはHTMLとプレビューサムネイルで構成されていて自動再生動画ではないためと思われます）。</p>
    <h3 id="third-parties-リクエスト数"><a href="#third-parties-リクエスト数" class="anchor-link">リクエスト数</a></h3>
    <p>全リクエストの49％がサードパーティです。ファーストパーティは2019年にも、51％と、ウェブリソースの大部分を占めるという王座にあと一歩まで迫ることができます。全リクエストの半分弱がサードパーティ製であるにもかかわらず、まったく含まれていないページが少数であることを考えると最もアクティブなサードパーティ製ユーザーは、自分の公平なシェアよりもかなり多くのことをしているに違いありません。実際、75％、90％、99％の割合で、ほぼすべてのページがサードパーティのコンテンツで構成されていることがわかります。実際、WixやSquareSpaceのような分散型WYSIWYGプラットフォームに大きく依存しているサイトでは、ルートドキュメントが唯一のファーストパーティのリクエストになっているかもしれません。</p>
    <!-- insert graphic of metric 05_11 -->
    <p>各サードパーティプロバイダーが発行するリクエストの数も、カテゴリーによって大きく異なります。アナリティクスはウェブサイトで最も普及しているサードパーティのカテゴリーですが、サードパーティのネットワークリクエスト全体のわずか7％にすぎません。一方、広告は、サイト数が20％近く少ないにもかかわらず、サードパーティのネットワークリクエスト全体の25％を占めています。彼らの人気に比べてリソースへの影響が桁違いに大きいことは、残りのデータからも明らかにしていくテーマになるでしょう。</p>
    <h3 id="third-parties-バイトの重さ"><a href="#third-parties-バイトの重さ" class="anchor-link">バイトの重さ</a></h3>
    <p>リクエストの49％がサードパーティ製のものであるのに対し、ウェブのバイト数でのシェアは28％とかなり低くなっています。複数のリソースタイプ別の内訳も同様です。サードパーティのフォントはフォント全体の72％を占めていますが、フォントのバイト数に占める割合は53％にすぎません。これらはすべて、サードパーティのプロバイダがレスポンスサイズを低く抑える責任ある管理人であることを示唆しているように見えます。</p>
    <p>スクリプトの57％を提供しているにもかかわらず、サードパーティはスクリプトバイトの64％を占めています。つまり、サードパーティのスクリプトはファーストパーティのスクリプトよりも平均で大きくなっています。これは、次のいくつかのセクションで述べるパフォーマンスへの影響を示す早期警告の兆候です。</p>
    <figure id="third-parties-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/third-parties/fig7.png">
        <img src="/static/images/2019/third-parties/fig7.png" alt="図7. サードパーティカテゴリ毎のリソースバイトの分布。" aria-labelledby="third-parties-fig7-caption" aria-describedby="third-parties-fig7-description" width="600" height="387" data-width="600" data-height="387" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRO5jS8JpjYdTr9poYmpyw-BL1LPQtfzHx_1hLRk9lgwkHQERuyELgF_rQ-4CpTbdbAyI9u1ggtPlLQ/pubchart?oid=1167032693&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="third-parties-fig7-description" class="visually-hidden">サードパーティのカテゴリ毎でコンテンツタイプ毎のバイト数の内訳を示すグラフ。画像とスクリプトはカテゴリ間で比較的均等に分布しています。フォントの80%はCDNから来ています。動画は「コンテンツ」サードパーティからのものです。</div>
      <figcaption id="third-parties-fig7-caption"><a href="#third-parties-fig-7" class="anchor-link">図 7.</a> サードパーティカテゴリ毎のリソースバイトの分布。</figcaption>
    </figure>
    <!--

```<insert graphic of metric 05_12>```
-->
    <p>具体的なサードパーティプロバイダについては、リクエスト数リーダーボードの上位にいる大手プロバイダがバイト数でも登場しています。注目すべき動きは、YouTube、Shopify、Twitterのようなメディアを中心とした大手プロバイダがバイトインパクトチャートの上位にランクインしていることくらいです。</p>
    <!--```<insert table of metric 05_07>```-->
    <h3 id="third-parties-スクリプトの実行"><a href="#third-parties-スクリプトの実行" class="anchor-link">スクリプトの実行</a></h3>
    <p>スクリプトの実行時間の57％はサードパーティ製のスクリプトによるもので、トップ100のドメインはすでにウェブ上のスクリプト実行時間の48％を占めています。このことは、少数のエンティティがウェブのパフォーマンスに与える影響が実際にどれほど大きいかを明確に示しています。このトピックについては、<a href="#third-parties-パフォーマンス">反響 &gt; パフォーマンス</a>セクションで詳しく説明しています。</p>
    <!--```<insert graphic of metric 05_05>```-->
    <!--```<insert graphic of metric 05_13>```-->
    <p>スクリプト実行の間のカテゴリの内訳は、主にリソース数の内訳に従っています。ここでも広告が最大の割合を占めています。広告スクリプトはサードパーティのスクリプト実行時間の25％を占めており、ホスティングとソーシャルプロバイダーは12％で2位と大きく引き離されています。</p>
    <!--```<insert table of metric 05_08>```-->
    <!--```<insert table of metric 05_10>```-->
    <p>
      個々のプロバイダの人気とパフォーマンスの影響については、多くのことが言えるかもしれませんが、より意見の多い分析は読者のための演習として残されていますし先に述べた <a href="https://thirdpartyweb.today">サードパーティウェブ<span class="fn">https://thirdpartyweb.today</span></a> のような他の目的のために構築されたツールもあります。
    </p>
    <h2 id="third-parties-使用パターン"><a href="#third-parties-使用パターン" class="anchor-link">使用パターン</a></h2>
    <p>サイトオーナーはなぜサードパーティのコードを使うのか？　サードパーティのコンテンツがネットワークリクエストの半分近くを占めるようになったのはなぜでしょうか？　これらのリクエストは何をしているのか？　これらの疑問に対する答えは、サードパーティのリソースの3つの主要な使用パターンにあります。大まかに言えば、サイト所有者はユーザーからデータを生成して消費し、サイト体験を収益化しWeb開発を簡素化するためにサードパーティを利用しています。</p>
    <h3 id="third-parties-データの生成と消費"><a href="#third-parties-データの生成と消費" class="anchor-link">データの生成と消費</a></h3>
    <p>アナリティクスは、ウェブ上で最も人気のあるサードパーティのカテゴリですが、ユーザーの目に触れることはほとんどありません。ユーザーのコンテキスト、デバイス、ブラウザ、接続品質、ロケーション、ページのインタラクション、セッションの長さ、再訪問者のステータスなどが継続的に生成されています。このような大規模な時系列データをウェアハウスし、正規化し分析するツールを維持するのは困難で面倒で、コストがかかります。アナリティクスがサードパーティプロバイダーの領域に入ることを明確に必要とするものはありませんが、ユーザーを理解することの魅力、問題空間の複雑さ、データを尊重し責任を持って管理することの重要性が増していることから、アナリティクスはサードパーティの人気のある使用パターンとして自然に表面化しています。</p>
    <p>しかし、ユーザーデータには消費という裏返しの側面もあります。アナリティクスはサイトの訪問者からデータを生成することですが、他のサードパーティのリソースは、他の人しか知らない訪問者に関するデータを消費することに重点を置いています。ソーシャルプロバイダーは、この利用パターンにぴったりと当てはまります。サイト所有者は、訪問者のFacebookプロフィールからの情報をサイトに統合したい場合、Facebookのリソースを使用する必要があります。サイトオーナーがソーシャルネットワークのウィジェットを使って体験をパーソナライズし、訪問者のソーシャルネットワークを活用してリーチを増やすことに興味がある限り、ソーシャル統合はサードパーティの領域であり続けると思われます。</p>
    <h3 id="third-parties-ウェブトラフィックの収益化"><a href="#third-parties-ウェブトラフィックの収益化" class="anchor-link">ウェブトラフィックの収益化</a></h3>
    <p>
      ウェブのオープンモデルは、コンテンツ制作者の金銭的利益を必ずしも満足させるものではなく、多くのサイト所有者は広告でサイトを収益化することに頼っています。広告主との直接の関係を構築し、価格契約を交渉するのは比較的難しく時間のかかるプロセスであるため、この懸念はターゲット広告とリアルタイム入札を行うサードパーティのプロバイダーによって主に処理されています。否定的な世論の広がり、広告ブロッキング技術の普及、ヨーロッパなどの主要な世界市場での規制措置は、収益化のためにサードパーティのプロバイダを継続的に使用する最大の脅威となっています。サイト所有者が突然独自の広告契約を結んだり特注の広告ネットワークを構築したりすることは考えにくいですが、ペイウォールやBraveの<a href="https://basicattentiontoken.org/">Basic Attention Token<span class="fn">https://basicattentiontoken.org/</span></a
      >のような実験のような代替的なマネタイズモデルは、将来のサードパーティの広告業界を揺るがす可能性を秘めています。
    </p>
    <h3 id="third-parties-開発の簡素化"><a href="#third-parties-開発の簡素化" class="anchor-link">開発の簡素化</a></h3>
    <p>何よりもサードパーティのリソースは、ウェブ開発の経験を単純化するために使用されます。以前の使用パターンでさえも、おそらくこのパターンに当てはまる可能性があります。ユーザーの行動分析、広告主とのコミュニケーション、ユーザー体験のパーソナライズなど、サードパーティのリソースはファーストパーティの開発を容易にするため使用されます。</p>
    <p>ホスティングプロバイダは、このパターンの最も極端な例です。これらのプロバイダーの中には、技術的な専門知識がなくても、地球上の誰もがサイトのオーナーになれるようしているところもあります。これらのプロバイダーは、資産のホスティング、コーディングの経験がなくてもサイトを構築できるツール、ドメイン登録サービスを提供しています。</p>
    <p>サードパーティ・プロバイダの残りの部分も、この使用パターンに当てはまる傾向がある。フロントエンド開発者が使用するためのjQueryなどのユーティリティライブラリのホスティングであれ、Cloudflareのエッジサーバーにキャッシュされているものであれ人気の高いGoogleCDNから提供されている一般的なフォントの膨大なライブラリであれサードパーティのコンテンツはサイトオーナーが心配することを1つ減らし、もしかしたら素晴らしい体験を提供する仕事を少しだけ楽にしてくれるもう1つの方法です。</p>
    <h2 id="third-parties-反響"><a href="#third-parties-反響" class="anchor-link">反響</a></h2>
    <h3 id="third-parties-パフォーマンス"><a href="#third-parties-パフォーマンス" class="anchor-link">パフォーマンス</a></h3>
    <p>サードパーティコンテンツの<a href="#performance">パフォーマンス</a>の影響は、カテゴリ的に良い悪いはありません。善良な行為者と悪良な行為者が存在し、カテゴリーの種類によって影響力のレベルが異なります。</p>
    <p>良い点：サードパーティ製のフォントやスタイルシートの共有ユーティリティは、平均的にファーストパーティ製のものよりも効率的に提供されます。</p>
    <p>ユーティリティ、CDN、およびコンテンツの各カテゴリーは、サードパーティのパフォーマンスにおいて最も輝かしい存在です。これらのカテゴリは、ファーストパーティのソースから提供されるコンテンツと同じ種類のコンテンツの最適化されたバージョンを提供しています。GoogleFontsとTypekitはファーストパーティのフォントよりも平均的に小さい最適化されたフォントを提供し、CloudflareCDNはサイト所有者によっては開発モードで誤って提供されてしまう可能性のあるオープンソースのライブラリをミニ化したバージョンを提供し、GoogleMapsSDKはそうでなければ素朴に大きな画像として提供されてしまう複雑な地図を効率的に配信します。</p>
    <p>悪い：非常に小さなエンティティのセットは、ページ上の機能の狭いセットを実行するJavaScriptの実行時間の非常に大きなチャンクを表しています。</p>
    <p>広告、ソーシャル、ホスティング、および特定の分析プロバイダーは、ウェブパフォーマンスへの最大の悪影響を表します。ホスティングプロバイダはサイトのコンテンツの大部分を提供しており、他のサードパーティのカテゴリよりもパフォーマンスへの影響が大きいのは当然ですが、ほとんどの場合、JavaScriptをほとんど必要としない静的なサイトを提供していてスクリプトの実行時間を正当化することはできません。しかし、パフォーマンスに影響を与える他のカテゴリーは言い訳できません。これらのカテゴリは、それぞれのページに表示される役割が非常に狭いにもかかわらず、すぐにリソースの大部分を占有してしまいます。例えば、Facebookの「いいね！」ボタンと関連するソーシャルウィジェットは、画面の面積が非常に小さく、ほとんどのウェブ体験の何分の1かしか占めていませんがソーシャルサードパーティのあるページへの影響の中央値はJavaScriptの総実行時間の20％近くになります。状況はアナリティクスについても同様です。トラッキングライブラリは知覚されたユーザー体験に直接貢献しませんが、アナリティクスのサードパーティがあるページへの影響度は90パーセンタイルで、JavaScriptの総実行時間の44％です。</p>
    <p>このような少数の事業体がこれほど大きな市場シェアを享受していることの裏には、非常に限られた集中的な努力がウェブ全体に大きな影響を与えることができるということがあります。上位数社のホスティングプロバイダのパフォーマンスを改善するだけで、全ウェブリクエストの2～3％を改善できます。</p>
    <h3 id="third-parties-プライバシー"><a href="#third-parties-プライバシー" class="anchor-link">プライバシー</a></h3>
    <p>サードパーティの最大の利用例は、サイト所有者がユーザーを追跡することであり、一握りの企業がウェブトラフィックの大部分に関する情報を受け取っています。</p>
    <p>
      ユーザーの行動を理解して分析することに対するサイト所有者の関心、それ自体は悪意のあるものではありませんが、ウェブ解析の普及した比較的裏方的な性質は有効な懸念を引き起こし、ヨーロッパの<a href="https://ja.wikipedia.org/wiki/EU%E4%B8%80%E8%88%AC%E3%83%87%E3%83%BC%E3%82%BF%E4%BF%9D%E8%AD%B7%E8%A6%8F%E5%89%87">GDPR<span class="fn">https://ja.wikipedia.org/wiki/EU%E4%B8%80%E8%88%AC%E3%83%87%E3%83%BC%E3%82%BF%E4%BF%9D%E8%AD%B7%E8%A6%8F%E5%89%87</span></a
      >やカリフォルニア州の<a href="https://en.wikipedia.org/wiki/California_Consumer_Privacy_Act">CCPA<span class="fn">https://en.wikipedia.org/wiki/California_Consumer_Privacy_Act</span></a
      >などのプライバシー規制によりユーザー、企業、法律家は近年注目を集めています。開発者がユーザーデータを責任を持って扱い、ユーザーを尊重して扱い、収集されたデータが透明であることを保証することは、アナリティクスを最も人気のあるサードパーティのカテゴリーとして維持し、将来のユーザー価値を提供するためにユーザーの行動を分析するという共生的な性質を維持するための鍵となります。
    </p>
    <p>スクリプトの実行が上位に集中していることは、パフォーマンス向上の潜在的な影響を考えると素晴らしいことですが、プライバシーへの影響を考えるとあまり刺激的ではありません。ウェブ上の全スクリプト実行時間の29％は、GoogleやFacebookが所有するドメイン上のスクリプトだけです。これは、たった2つの事業体によって制御されているCPU時間の非常に大きな割合です。アナリティクスプロバイダーに適用されているのと同じプライバシー保護が、他の広告、ソーシャル、開発者向けユーティリティカテゴリにも適用されるようにすることが重要です。</p>
    <h3 id="third-parties-セキュリティ"><a href="#third-parties-セキュリティ" class="anchor-link">セキュリティ</a></h3>
    <p>
      セキュリティのトピックについては <a href="#security">セキュリティ</a> の章で詳しく説明していますが、サイトに外部の依存関係を導入することによるセキュリティへの影響は、プライバシーへの懸念と密接に関連しています。第三者が任意のJavaScriptを実行できるようにすることは、あなたのページを完全に制御できます。スクリプトがDOMと<code>window</code>を制御できれば、すべてのことができるようになります。たとえコードにセキュリティ上の懸念がなくても、単一の障害点を導入できます<a href="https://www.stevesouders.com/blog/2010/06/01/frontend-spof/">これは以前から潜在的な問題として認識されていました<span class="fn">https://www.stevesouders.com/blog/2010/06/01/frontend-spof/</span></a
      >。
    </p>
    <p>
      <a href="https://csswizardry.com/2019/05/self-host-your-static-assets/">サードパーティのコンテンツをセルフホスティングする<span class="fn">https://csswizardry.com/2019/05/self-host-your-static-assets/</span></a> は、ここで述べた懸念事項のいくつかとその他の懸念事項に対応しています。さらに、ブラウザが <a href="https://chromestatus.com/feature/5730772021411840">HTTPキャッシュのパーティショニング<span class="fn">https://chromestatus.com/feature/5730772021411840</span></a> を増やしていることから、サードパーティから直接読み込むことのメリットはますます疑問視されています。おそらく多くのユースケースでサードパーティのコンテンツを利用するには、その影響を測定することが難しくなってもこの方法の方が良いでしょう。
    </p>
    <h2 id="third-parties-結論"><a href="#third-parties-結論" class="anchor-link">結論</a></h2>
    <p>サードパーティのコンテンツはどこにでもあります。これは驚くべきことでありません。ウェブの基本は、相互接続とリンクを可能にすることです。この章では、メインドメインから離れてホストされている資産という観点から、サードパーティコンテンツを調べてみました。もし、自己ホスト型のサードパーティ・コンテンツ（例えば、メイン・ドメインにホストされている一般的なオープンソース・ライブラリなど）を含めるとサードパーティの利用率はさらに高まっていたでしょう。</p>
    <p>
      <a href="https://en.wikipedia.org/wiki/Code_reuse">コンピュータ技術での再利用<span class="fn">https://en.wikipedia.org/wiki/Code_reuse</span></a
      >は一般的にベストプラクティスですが、ウェブ上のサードパーティは、ページのパフォーマンス、プライバシー、セキュリティにかなりの影響を与える依存関係を導入します。セルフホスティングと慎重なプロバイダの選択は、これらの影響を軽減するために長い道のりを歩むことができます。
    </p>
    <p>第三者のコンテンツがどのようにページに追加されるかという重要な問題に関わらず、結論は同じです。サードパーティはWebの不可欠な部分です！</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"I","chapter_number":6,"title":"フォント","description":"フォントがどこから読み込まれるか、フォントのフォーマット、フォントの読み込み性能、可変フォント、カラーフォントを網羅した2019年Web AlmanacのFontsの章。","authors":["zachleat"],"reviewers":["hyperpress","AymenLoukil"],"translators":["ksakae"],"discuss":"1761","results":"https://docs.google.com/spreadsheets/d/108g6LXdC3YVsxmX1CCwrmpZ3-DmbB8G_wwgQHX5pn6Q/","queries":"06_Fonts","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-06-30T00:00:00.000Z","chapter":"fonts"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="fonts-序章"><a href="#fonts-序章" class="anchor-link">序章</a></h2>
    <p>ウェブフォントは、ウェブ上で美しく機能的なタイポグラフィを可能にします。ウェブフォントを使用することは、デザインに力を与えるだけでなく、デザインのサブセットを民主化します。しかし、どんなに良いことがあってもウェブフォントが適切に読み込まれていないと、サイトのパフォーマンスに大きな悪影響を及ぼすこともあります。</p>
    <p>それらはウェブにとってプラスになるのか？　それらは害よりも多くの利益を提供しているか?　Web標準の牛道は、デフォルトでWebフォントの読み込みのベストプラクティスを奨励するために十分に舗装されているだろうか？　そうでない場合、何を変える必要があるのでしょうか？　今日のウェブ上でウェブフォントがどのように使用されているかを調べることで、これらの疑問に答えられるかどうかをデータ駆動型で覗いてみましょう。</p>
    <h2 id="fonts-そのウェブフォントはどこで手に入れたの？"><a href="#fonts-そのウェブフォントはどこで手に入れたの？" class="anchor-link">そのウェブフォントはどこで手に入れたの？</a></h2>
    <p>最初の、そして最も顕著な問題は、パフォーマンスです。<a href="#performance">パフォーマンス</a>に特化した章がありますが、ここではフォント固有のパフォーマンスの問題について少し掘り下げてみましょう。</p>
    <p>
      ホストされたWebフォントを使用すると、実装やメンテナンスが容易になりますが、セルフホスティングは最高のパフォーマンスを提供します。Webフォントはデフォルトで、Webフォントの読み込み中にテキストを非表示にする（<a href="https://css-tricks.com/fout-foit-foft/">Flash of Invisible Text<span class="fn">https://css-tricks.com/fout-foit-foft/</span></a
      >、またはFOITとしても知られています）ことを考えると、Webフォントのパフォーマンスは画像のような非ブロッキング資産よりも重要になる可能性があります。
    </p>
    <h3 id="fonts-フォントは同じホストでホストされているのか、それとも別のホストでホストされているのか？"><a href="#fonts-フォントは同じホストでホストされているのか、それとも別のホストでホストされているのか？" class="anchor-link">フォントは同じホストでホストされているのか、それとも別のホストでホストされているのか？</a></h3>
    <p>サードパーティのホスティングに対するセルフホスティングの差別化は、<a href="#http2">HTTP/2</a>の世界ではますます重要になってきています。同一ホストのリクエストには、ウォーターフォール内の他の同一ホストのリクエストに対して優先順位をつける可能性が高いという大きな利点があります。</p>
    <p>別のホストからウェブフォントを読み込む際のパフォーマンスコストを軽減するための推奨事項としては、<code>preconnect</code>、<code>dns-prefetch</code>、<code>preload</code> <a href="#resource-hints">リソースのヒント</a>の使用がありますが、優先度の高いウェブフォントは、ウェブフォントのパフォーマンスへの影響を最小限に抑えるため、同一ホストからのリクエストにすべきです。これは視覚的に、非常に目立つコンテンツやページの大部分を占める本文コピーで使用されるフォントへ対して特に重要です。</p>
    <figure id="fonts-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/fonts/fig1.png">
        <img src="/static/images/2019/fonts/fig1.png" alt="図1. 人気のあるウェブフォントのホスティング戦略。" aria-labelledby="fonts-fig1-description" aria-describedby="fonts-fig1-caption" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQDogXDb3BwZZHrBT39qccP_LJoCScD3QEi_FmjT_8VDPD_1Srpz-g7ZuuTUEb8pYXBpDmQzZ1hQh7q/pubchart?oid=1546332659&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="fonts-fig1-description" class="visually-hidden">ウェブフォントのサードパーティおよびセルフホスティング戦略の人気を示す棒グラフ。モバイルWebページの75%がサードパーティ製ホストを使用し、25%がセルフホストを使用しています。デスクトップのウェブサイトでも、同様の利用状況です。</div>
      <figcaption id="fonts-fig1-caption"><a href="#fonts-fig-1" class="anchor-link">図 1.</a> 人気のあるウェブフォントのホスティング戦略。font hosting strategies.</figcaption>
    </figure>
    <p>4分の3がホストされているという事実は、おそらく我々が議論するGoogle Fontsの優位性を考えると意外と知られていません<a href="#fonts-最も人気のあるサードパーティ製のホストは何ですか？">以下</a>。</p>
    <p>Googleは<code>https://fonts.googleapis.com</code>でホストされているサードパーティのCSSファイルを使ってフォントを提供しています。開発者は、マークアップの<code>&lt;link&gt;</code>タグを使ってこれらのスタイルシートにリクエストを追加します。これらのスタイルシートはレンダーブロッキングされていますが、そのサイズは非常に小さいです。しかし、フォントファイルは<code>https://fonts.gstatic.com</code>という別のドメインでホストされています。2つの異なるドメインへの2つの別々のホップを必要とするモデルでは、CSSがダウンロードされるまで発見されない2つ目のリクエストには<code>preconnect</code>が最適な選択肢となります。</p>
    <p>
      <code>preload</code>はリクエストのウォーターフォールの上位にフォントファイルをロードするための素晴らしい追加機能ですが（<code>preconnect</code>は接続を設定するもので、ファイルの内容をリクエストするものではないことを覚えておいてください）、<code>preload</code>はGoogle Fontsではまだ利用できません。Google Fontsはフォントファイル用のユニークなURLを生成します<a href="https://github.com/google/fonts/issues/1067">これは変更される可能性があります<span class="fn">https://github.com/google/fonts/issues/1067</span></a
      >。
    </p>
    <h3 id="fonts-最も人気のあるサードパーティ製のホストは何ですか？"><a href="#fonts-最も人気のあるサードパーティ製のホストは何ですか？" class="anchor-link">最も人気のあるサードパーティ製のホストは何ですか？</a></h3>
    <figure id="fonts-fig-2">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ホスト</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>fonts.gstatic.com</td>
                <td class="numeric">75.4%</td>
                <td class="numeric">74.9%</td>
              </tr>
              <tr>
                <td>use.typekit.net</td>
                <td class="numeric">7.2%</td>
                <td class="numeric">6.6%</td>
              </tr>
              <tr>
                <td>maxcdn.bootstrapcdn.com</td>
                <td class="numeric">1.8%</td>
                <td class="numeric">2.0%</td>
              </tr>
              <tr>
                <td>use.fontawesome.com</td>
                <td class="numeric">1.1%</td>
                <td class="numeric">1.2%</td>
              </tr>
              <tr>
                <td>static.parastorage.com</td>
                <td class="numeric">0.8%</td>
                <td class="numeric">1.2%</td>
              </tr>
              <tr>
                <td>fonts.shopifycdn.com</td>
                <td class="numeric">0.6%</td>
                <td class="numeric">0.6%</td>
              </tr>
              <tr>
                <td>cdn.shopify.com</td>
                <td class="numeric">0.5%</td>
                <td class="numeric">0.5%</td>
              </tr>
              <tr>
                <td>cdnjs.cloudflare.com</td>
                <td class="numeric">0.4%</td>
                <td class="numeric">0.5%</td>
              </tr>
              <tr>
                <td>use.typekit.com</td>
                <td class="numeric">0.4%</td>
                <td class="numeric">0.4%</td>
              </tr>
              <tr>
                <td>netdna.bootstrapcdn.com</td>
                <td class="numeric">0.3%</td>
                <td class="numeric">0.4%</td>
              </tr>
              <tr>
                <td>fast.fonts.net</td>
                <td class="numeric">0.3%</td>
                <td class="numeric">0.3%</td>
              </tr>
              <tr>
                <td>static.dealer.com</td>
                <td class="numeric">0.2%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td>themes.googleusercontent.com</td>
                <td class="numeric">0.2%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td>static-v.tawk.to</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.3%</td>
              </tr>
              <tr>
                <td>stc.utdstc.com</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td>cdn.jsdelivr.net</td>
                <td class="numeric">0.2%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td>kit-free.fontawesome.com</td>
                <td class="numeric">0.2%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td>open.scdn.co</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.1%</td>
              </tr>
              <tr>
                <td>assets.squarespace.com</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.1%</td>
              </tr>
              <tr>
                <td>fonts.jimstatic.com</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.2%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#fonts-fig-2" class="anchor-link">図 2.</a> リクエストの割合による上位20のフォントホスト。</figcaption>
    </figure>
    <p>ここでのGoogle Fontsの優位性は、同時に驚くべきことであると同時に意外性のないものであった。期待していたという点では予想外でしたが、サービスの圧倒的な人気の高さには驚きました。フォントリクエストの75％というのは驚異的だ。TypeKitは一桁台の遠い2位で、Bootstrapライブラリがさらに遠い3位を占めていました。</p>
    <figure id="fonts-fig-3">
      <div class="big-number">29%</div>
      <figcaption><a href="#fonts-fig-3" class="anchor-link">図 3.</a> ドキュメント内にGoogle Fontsスタイルシートのリンクを含むページの割合 <code>&lt;head&gt;</code>。</figcaption>
    </figure>
    <p>ここでのGoogle Fontsの使用率の高さは非常に印象的だが、Google Fonts<code>&lt;link&gt;</code>要素を含むページが29％しかなかったことも注目に値する。これはいくつかのことを意味しているかもしれない。</p>
    <ul>
      <li>ページがGoogle Fontsを使用する場合、彼らはGoogle Fontsを多く使用しています。それらは結局のところ、金銭的なコストなしで提供されています。おそらく、人気のあるWYSIWYGエディタで使われているのではないでしょうか？　これは非常に可能性の高い説明のように思えます。</li>
      <li>あるいは、もっとありそうにない話としては、多くの人が<code>&lt;link&gt;</code>の代わりに<code>@import</code>を使ってGoogle Fontsを使っているということかもしれません。</li>
      <li>
        あるいは、超ありえないシナリオにまで踏み込んでみたいのであれば、多くの人が代わりに<a href="https://developer.mozilla.org/ja/docs/Web/HTTP">HTTP <code>Link:</code>ヘッダー<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTTP</span></a
        >を使ってGoogle Fontsを使っているということになるかもしれません。
      </li>
    </ul>
    <figure id="fonts-fig-4">
      <div class="big-number">0.4%</div>
      <figcaption><a href="#fonts-fig-4" class="anchor-link">図 4.</a> ドキュメントの最初の子としてGoogle Fontsスタイルシートのリンクを含むページの割合 <code>&lt;head&gt;</code>。</figcaption>
    </figure>
    <p>Google Fontsのドキュメントでは、Google Fonts CSSの<code>&lt;link&gt;</code>はページの<code>&lt;head&gt;</code>の最初の子として配置することを推奨しています。これは大きなお願いです！　実際、これは一般的でありません。全ページの半分のパーセント（約20,000ページ）しかこのアドバイスを受けていないので、これは一般的でありません。</p>
    <p>さらに言えば、ページが<code>preconnect</code>や<code>dns-prefetch</code>を<code>&lt;link&gt;</code>要素として使用している場合、これらはいずれにしてもGoogle Fonts CSSの前へ来ることになります。これらのリソースのヒントについては、続きを読んでください。</p>
    <h3 id="fonts-サードパーティホスティングの高速化"><a href="#fonts-サードパーティホスティングの高速化" class="anchor-link">サードパーティホスティングの高速化</a></h3>
    <p>上述したように、サードパーティホストへのウェブフォント要求を高速化する超簡単な方法は、<code>preconnect</code><a href="#resource-hints">リソースヒント</a>を使用することです。</p>
    <figure id="fonts-fig-5">
      <div class="big-number">1.7%</div>
      <figcaption><a href="#fonts-fig-5" class="anchor-link">図 5.</a> モバイルページがウェブフォントホストにプリコネクティングしている割合。</figcaption>
    </figure>
    <p>
      うわー！　2％未満のページが<a href="https://web.dev/uses-rel-preconnect"><code>preconnect</code><span class="fn">https://web.dev/uses-rel-preconnect</span></a
      >を使用している！　Google Fontsが75％であることを考えると、これはもっと高いはずです！　開発者の皆さん: Google Fontsを使うなら、<code>preconnect</code>を使いましょう！　Google Fonts:<code>preconnect</code>をもっと宣伝しよう！
    </p>
    <p>実際、もしあなたがGoogle Fontsを使っているのであれば、<code>&lt;head&gt;</code>にこれを追加してください。</p>
    <p><code>&lt;link rel="preconnect" href="https://fonts.gstatic.com/"&gt;</code></p>
    <h3 id="fonts-最も人気のある書体"><a href="#fonts-最も人気のある書体" class="anchor-link">最も人気のある書体</a></h3>
    <figure id="fonts-fig-6">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ランク</th>
                <th>フォントファミリー</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="numeric">1</td>
                <td>Open Sans</td>
                <td class="numeric">24%</td>
                <td class="numeric">22%</td>
              </tr>
              <tr>
                <td class="numeric">2</td>
                <td>Roboto</td>
                <td class="numeric">15%</td>
                <td class="numeric">19%</td>
              </tr>
              <tr>
                <td class="numeric">3</td>
                <td>Montserrat</td>
                <td class="numeric">5%</td>
                <td class="numeric">4%</td>
              </tr>
              <tr>
                <td class="numeric">4</td>
                <td>Source Sans Pro</td>
                <td class="numeric">4%</td>
                <td class="numeric">3%</td>
              </tr>
              <tr>
                <td class="numeric">5</td>
                <td>Noto Sans JP</td>
                <td class="numeric">3%</td>
                <td class="numeric">3%</td>
              </tr>
              <tr>
                <td class="numeric">6</td>
                <td>Lato</td>
                <td class="numeric">3%</td>
                <td class="numeric">3%</td>
              </tr>
              <tr>
                <td class="numeric">7</td>
                <td>Nanum Gothic</td>
                <td class="numeric">4%</td>
                <td class="numeric">2%</td>
              </tr>
              <tr>
                <td class="numeric">8</td>
                <td>Noto Sans KR</td>
                <td class="numeric">3%</td>
                <td class="numeric">2%</td>
              </tr>
              <tr>
                <td class="numeric">9</td>
                <td>Roboto Condensed</td>
                <td class="numeric">2%</td>
                <td class="numeric">2%</td>
              </tr>
              <tr>
                <td class="numeric">10</td>
                <td>Raleway</td>
                <td class="numeric">2%</td>
                <td class="numeric">2%</td>
              </tr>
              <tr>
                <td class="numeric">11</td>
                <td>FontAwesome</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">12</td>
                <td>Roboto Slab</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">13</td>
                <td>Noto Sans TC</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">14</td>
                <td>Poppins</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">15</td>
                <td>Ubuntu</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">16</td>
                <td>Oswald</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">17</td>
                <td>Merriweather</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">18</td>
                <td>PT Sans</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">19</td>
                <td>Playfair Display</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
              <tr>
                <td class="numeric">20</td>
                <td>Noto Sans</td>
                <td class="numeric">1%</td>
                <td class="numeric">1%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#fonts-fig-6" class="anchor-link">図 6.</a> 全フォント宣言に占める上位20のフォントファミリーの割合。</figcaption>
    </figure>
    <p>
      ここでの上位のエントリが<a href="https://fonts.google.com/?sort=popularity">Google Fontsの人気順フォント一覧<span class="fn">https://fonts.google.com/?sort=popularity</span></a
      >と非常によく似ていることは驚くに値しません。
    </p>
    <h2 id="fonts-どのようなフォント形式を使用していますか？"><a href="#fonts-どのようなフォント形式を使用していますか？" class="anchor-link">どのようなフォント形式を使用していますか？</a></h2>
    <p>
      今日のブラウザでは<a href="https://caniuse.com/#feat=woff2">WOFF2はかなりサポートされています<span class="fn">https://caniuse.com/#feat=woff2</span></a
      >。Google FontsはWOFF2というフォーマットを提供していますが、これは前身のWOFFよりも圧縮率が向上したフォーマットで、それ自体はすでに他の既存のフォントフォーマットよりも改善されていました。
    </p>
    <figure id="fonts-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/fonts/fig7.png">
        <img src="/static/images/2019/fonts/fig7.png" alt="図7. ウェブフォントのMIMEタイプの普及率" aria-labelledby="fonts-fig7-caption" aria-describedby="fonts-fig7-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQDogXDb3BwZZHrBT39qccP_LJoCScD3QEi_FmjT_8VDPD_1Srpz-g7ZuuTUEb8pYXBpDmQzZ1hQh7q/pubchart?oid=998584594&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="fonts-fig7-description" class="visually-hidden">ウェブフォントのMIMEタイプの人気を示す棒グラフ。フォントの74%でWOFF2が使用されており、次いでWOFFが13%、octet-streamが 6%、TTFが3%、plainが2%、HTMLが1%、SFNTが1%、その他のすべてのタイプが1%未満となっています。デスクトップとモバイルでは、同様の分布となっています。</div>
      <figcaption id="fonts-fig7-caption"><a href="#fonts-fig-7" class="anchor-link">図 7.</a> ウェブフォントのMIMEタイプの普及率</figcaption>
    </figure>
    <p>私から見れば、ここでの結果を見て、WebフォントはWOFF2オンリーにした方がいいという意見もあるかもしれません。二桁台のWOFF使用率はどこから来ているのでしょうか？　もしかして、まだWebフォントをInternet Explorerに提供している開発者がいるのでしょうか？</p>
    <p>第3位の<code>octet-stream</code>(およびもう少し下の<code>plain</code>)は、多くのウェブサーバが不適切に設定されており、ウェブフォントファイルのリクエストで誤ったMIMEタイプを送信していることを示唆しているように見えます。</p>
    <p>もう少し深く掘り下げて、<code>@font-face</code>宣言の<code>src:</code>プロパティで使われている<code>format()</code>の値を見てみましょう。</p>
    <figure id="fonts-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/fonts/fig8.png">
        <img src="/static/images/2019/fonts/fig8.png" alt="図8. <code>@font-face</code>宣言におけるフォントフォーマットの人気度。" aria-labelledby="fonts-fig8-caption" aria-describedby="fonts-fig8-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQDogXDb3BwZZHrBT39qccP_LJoCScD3QEi_FmjT_8VDPD_1Srpz-g7ZuuTUEb8pYXBpDmQzZ1hQh7q/pubchart?oid=700778025&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="fonts-fig8-description" class="visually-hidden">フォントフェイス宣言で使用されるフォーマットの人気を示す棒グラフ。デスクトップページの@font-face宣言の 69%がWOFF2形式を指定しており、11%がWOFF、10%がTrueType、8%がSVG、2%がEOT、1%未満でOpenType、TTF、OTFを指定しています。モバイルページの分布も同様です。</div>
      <figcaption id="fonts-fig8-caption"><a href="#fonts-fig-8" class="anchor-link">図 8.</a> <code>@font-face</code>宣言におけるフォントフォーマットの人気度。</figcaption>
    </figure>
    <p>
      <a href="https://caniuse.com/#feat=svg-fonts">SVGフォント<span class="fn">https://caniuse.com/#feat=svg-fonts</span></a
      >が衰退しているのを見て期待していたのですが。バグだらけだし、Safari以外のブラウザでは実装が削除されている。そろそろ捨ててしまおうか。
    </p>
    <p>ここのSVGデータポイントを見ると、どのMIMEタイプでSVGフォントを提供しているのか気になります。図7のどこにも<code>image/svg+xml</code>は見当たりません。とにかく、それを修正することは気にしないで、ただそれらを取り除くだけです！</p>
    <h3 id="fonts-woff2専用"><a href="#fonts-woff2専用" class="anchor-link">WOFF2専用</a></h3>
    <figure id="fonts-fig-9">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ランク</th>
                <th>フォーマットの組み合わせ</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="numeric">1</td>
                <td>woff2</td>
                <td class="numeric">84.0%</td>
                <td class="numeric">81.9%</td>
              </tr>
              <tr>
                <td class="numeric">2</td>
                <td>svg, truetype, woff</td>
                <td class="numeric">4.3%</td>
                <td class="numeric">4.0%</td>
              </tr>
              <tr>
                <td class="numeric">3</td>
                <td>svg, truetype, woff, woff2</td>
                <td class="numeric">3.5%</td>
                <td class="numeric">3.2%</td>
              </tr>
              <tr>
                <td class="numeric">4</td>
                <td>eot, svg, truetype, woff</td>
                <td class="numeric">1.3%</td>
                <td class="numeric">2.9%</td>
              </tr>
              <tr>
                <td class="numeric">5</td>
                <td>woff, woff2</td>
                <td class="numeric">1.8%</td>
                <td class="numeric">1.8%</td>
              </tr>
              <tr>
                <td class="numeric">6</td>
                <td>eot, svg, truetype, woff, woff2</td>
                <td class="numeric">1.2%</td>
                <td class="numeric">2.1%</td>
              </tr>
              <tr>
                <td class="numeric">7</td>
                <td>truetype, woff</td>
                <td class="numeric">0.9%</td>
                <td class="numeric">1.1%</td>
              </tr>
              <tr>
                <td class="numeric">8</td>
                <td>woff</td>
                <td class="numeric">0.7%</td>
                <td class="numeric">0.8%</td>
              </tr>
              <tr>
                <td class="numeric">9</td>
                <td>truetype</td>
                <td class="numeric">0.6%</td>
                <td class="numeric">0.7%</td>
              </tr>
              <tr>
                <td class="numeric">10</td>
                <td>truetype, woff, woff2</td>
                <td class="numeric">0.6%</td>
                <td class="numeric">0.6%</td>
              </tr>
              <tr>
                <td class="numeric">11</td>
                <td>opentype, woff, woff2</td>
                <td class="numeric">0.3%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td class="numeric">12</td>
                <td>svg</td>
                <td class="numeric">0.2%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td class="numeric">13</td>
                <td>eot, truetype, woff</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.2%</td>
              </tr>
              <tr>
                <td class="numeric">14</td>
                <td>opentype, woff</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.1%</td>
              </tr>
              <tr>
                <td class="numeric">15</td>
                <td>opentype</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.1%</td>
              </tr>
              <tr>
                <td class="numeric">16</td>
                <td>eot</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.1%</td>
              </tr>
              <tr>
                <td class="numeric">17</td>
                <td>opentype, svg, truetype, woff</td>
                <td class="numeric">0.1%</td>
                <td class="numeric">0.0%</td>
              </tr>
              <tr>
                <td class="numeric">18</td>
                <td>opentype, truetype, woff, woff2</td>
                <td class="numeric">0.0%</td>
                <td class="numeric">0.0%</td>
              </tr>
              <tr>
                <td class="numeric">19</td>
                <td>eot, truetype, woff, woff2</td>
                <td class="numeric">0.0%</td>
                <td class="numeric">0.0%</td>
              </tr>
              <tr>
                <td class="numeric">20</td>
                <td>svg, woff</td>
                <td class="numeric">0.0%</td>
                <td class="numeric">0.0%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#fonts-fig-9" class="anchor-link">図 9.</a> フォントフォーマットの組み合わせトップ20</figcaption>
    </figure>
    <p>このデータセットは、大多数の人がすでに<code>@font-face</code>ブロックでWOFF2のみを使っていることを示唆しているように見える。しかし、このデータセットにおけるGoogle Fontsの優位性についての以前の議論によれば、もちろんこれは誤解を招くものです。Google Fontsは合理化されたCSSファイルを提供するためにいくつかのスニッフィングメソッドを実行しており、最新の<code>format()</code>のみを含んでいる。当然のことながら、WOFF2がここでの結果を支配しているのはこの理由によるもので、WOFF2に対するブラウザのサポートは以前からかなり広くなっている。</p>
    <p>重要なのは、この特定のデータはまだWOFF2オンリーのケースを支持しているわけではないということですが、魅力的なアイデアであることに変わりはありません。</p>
    <h2 id="fonts-見えない文字との戦い"><a href="#fonts-見えない文字との戦い" class="anchor-link">見えない文字との戦い</a></h2>
    <p>デフォルトのWebフォントの読み込み動作である「読み込み中は見えない」(FOITとしても知られています)に対抗するため持っている第一のツールは<code>font-display</code>です。<code>font-display: swap</code>を<code>@font-face</code>ブロックに追加すると、ウェブフォントが読み込まれている間にフォールバックテキストを表示するようにブラウザに指示する簡単な方法です。</p>
    <p>
      <a href="https://caniuse.com/#feat=mdn-css_at-rules_font-face_font-display">ブラウザ対応<span class="fn">https://caniuse.com/#feat=mdn-css_at-rules_font-face_font-display</span></a
      >もいいですね。Internet ExplorerやChromium以前のEdgeではサポートされていませんが、Webフォントが読み込まれたときにデフォルトでフォールバックテキストをレンダリングしてくれます（ここではFOITは使えません）。Chromeのテストでは、<code>font-display</code>はどのくらいの頻度で使われているのでしょうか？
    </p>
    <figure id="fonts-fig-10">
      <div class="big-number">26%</div>
      <figcaption><a href="#fonts-fig-10" class="anchor-link">図 10.</a> <code>font-display</code>スタイルを利用しているモバイルページの割合。</figcaption>
    </figure>
    <p>
      私はこれが時間の経過とともに忍び寄ってくることを想定しています、特に今は<a href="https://www.zachleat.com/web/google-fonts-display/">Google Fontsがすべての新しいコードスニペットに <code>font-display</code> を追加しています<span class="fn">https://www.zachleat.com/web/google-fonts-display/</span></a
      >が彼らのサイトからコピーされています。
    </p>
    <p>
      Google Fontsを使っているなら、スニペットを更新しよう！　Google Fontsを使っていない場合は、<code>font-display</code>を使いましょう！ <code>font-display</code>についての詳細は <a href="https://developer.mozilla.org/ja/docs/Web/CSS/@font-face/font-display">MDN<span class="fn">https://developer.mozilla.org/ja/docs/Web/CSS/@font-face/font-display</span></a> を参照してください。
    </p>
    <p>どのような<code>font-display</code>値が人気あるのか見てみましょう。</p>
    <figure id="fonts-fig-11">
      <a href="https://almanac.httparchive.org/static/images/2019/fonts/fig11.png">
        <img src="/static/images/2019/fonts/fig11.png" alt="図11. `font-display'の値の使用法。" aria-labelledby="fonts-fig11-caption" aria-describedby="fonts-fig11-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQDogXDb3BwZZHrBT39qccP_LJoCScD3QEi_FmjT_8VDPD_1Srpz-g7ZuuTUEb8pYXBpDmQzZ1hQh7q/pubchart?oid=1988783738&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig11-description" data-show-text="{{ show_description(11) }}" data-hide-text="{{ hide_description(11) }}">{{ show_description(11) }}</button>
      <div id="fonts-fig11-description" class="visually-hidden">フォント表示スタイルの利用状況を示す棒グラフ。モバイルページの2.6％がこのスタイルを「swap」、1.5％が「auto」、0.7％が「block」、0.4％が「fallback」、0.2％が「optional」、0.1％が引用符で囲んだ「swap」に設定しているが、これは無効である。デスクトップの分布は、「swap」の利用率が0.4％ポイント低く、「auto」の利用率が0.1％ポイント高くなっている以外は似ている。</div>
      <figcaption id="fonts-fig11-caption"><a href="#fonts-fig-11" class="anchor-link">図 11.</a> <code>font-display</code>の値の使用法。</figcaption>
    </figure>
    <p>ウェブフォントの読み込み中にフォールバックテキストを表示する簡単な方法として、<code>font-display: swap</code>が最も一般的な値として君臨しています。<code>swap</code>は新しいGoogle Fontsのコードスニペットでもデフォルト値として使われています。いくつかの著名な開発者のエバンジェリストがこれを求めてちょっとした働きかけをしていたので、ここでは<code>optional</code>(キャッシュされた場合にのみレンダリングする)がもう少し使われることを期待していたのですが、駄目でした。</p>
    <h2 id="fonts-ウェブフォントの数が多すぎる？"><a href="#fonts-ウェブフォントの数が多すぎる？" class="anchor-link">ウェブフォントの数が多すぎる？</a></h2>
    <p>ある程度のニュアンスが必要な質問です。フォントはどのように使われているのか？　ページ上のコンテンツの量は？　そのコンテンツはレイアウトのどこにあるのか？　フォントはどのようにレンダリングされているのか？　しかし、ニュアンスの代わりに、リクエスト数を中心とした大まかで重い分析に飛び込んでみましょう。</p>
    <figure id="fonts-fig-12">
      <a href="https://almanac.httparchive.org/static/images/2019/fonts/fig12.png">
        <img src="/static/images/2019/fonts/fig12.png" alt="図12. ページあたりのフォント要求の分布。" aria-labelledby="fonts-fig12-caption" aria-describedby="fonts-fig12-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQDogXDb3BwZZHrBT39qccP_LJoCScD3QEi_FmjT_8VDPD_1Srpz-g7ZuuTUEb8pYXBpDmQzZ1hQh7q/pubchart?oid=451821825&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="fonts-fig12-description" class="visually-hidden">ページごとのフォント要求の分布を示す棒グラフ。デスクトップでの10、25、50、75、90パーセンタイルは以下の通りです。0、1、3、6、9のフォント要求があります。モバイルの分布は75パーセンタイルと90パーセンタイルまでは同じで、モバイルページでは要求されるフォントが1つ少なくなっています。</div>
      <figcaption id="fonts-fig12-caption"><a href="#fonts-fig-12" class="anchor-link">図 12.</a> ページあたりのフォント要求の分布。</figcaption>
    </figure>
    <p>中央値のウェブページでは、3つのウェブフォントをリクエストしています。90パーセンタイルでは、モバイルとデスクトップでそれぞれ6つと9つのウェブフォントをリクエストしています。</p>
    <figure id="fonts-fig-13">
      <a href="https://almanac.httparchive.org/static/images/2019/fonts/fig13.png">
        <img src="/static/images/2019/fonts/fig13.png" alt="図13. ページあたりに要求されたウェブフォントのヒストグラム。" aria-labelledby="fonts-fig13-description" aria-describedby="fonts-fig13-caption" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQDogXDb3BwZZHrBT39qccP_LJoCScD3QEi_FmjT_8VDPD_1Srpz-g7ZuuTUEb8pYXBpDmQzZ1hQh7q/pubchart?oid=1755200484&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig13-description" data-show-text="{{ show_description(13) }}" data-hide-text="{{ hide_description(13) }}">{{ show_description(13) }}</button>
      <div id="fonts-fig13-description" class="visually-hidden">ページあたりのフォントリクエスト数の分布を示すヒストグラム。最も人気のあるフォントリクエスト数は0で、デスクトップページの22%を占めています。この分布は、1つのフォントを持つページの9%まで落ち込み、2～4つのフォントでは10%で頂点に達し、フォント数が増えるにつれて落ち込んでいきます。デスクトップとモバイルの分布は似ていますが、モバイルの分布はページあたりのフォント数が少ない方にわずかに傾いています。</div>
      <figcaption id="fonts-fig13-caption"><a href="#fonts-fig-13" class="anchor-link">図 13.</a> ページあたりに要求されたウェブフォントのヒストグラム。</figcaption>
    </figure>
    <p>
      Webフォントのリクエストがデスクトップとモバイルの間でかなり安定しているように見えるというのは非常に興味深いことです。私は、<a href="https://css-tricks.com/snippets/css/using-font-face/#article-header-id-6"><code>@media</code>クエリの中の<code>@font-face</code>ブロックを隠すことを推奨すること<span class="fn">https://css-tricks.com/snippets/css/using-font-face/#article-header-id-6</span></a
      >が流行らなかったのを見てうれしく思います (何も考えないでください)。
    </p>
    <p>しかし、モバイルデバイスでのフォントのリクエストはわずかに多い。ここでの私の勘は、モバイルデバイスで利用できる書体が少ないということはGoogle Fonts CSSでの<code>local()</code>のヒット数が少ないということであり、ネットワークからのフォントリクエストに戻ってしまうのではないかと考えています。</p>
    <h3 id="fonts-この賞を受賞したくない"><a href="#fonts-この賞を受賞したくない" class="anchor-link">この賞を受賞したくない</a></h3>
    <figure id="fonts-fig-14">
      <div class="big-number">718</div>
      <figcaption><a href="#fonts-fig-14" class="anchor-link">図 14.</a> 1ページで最も多くのWebフォントのリクエストがあった。</figcaption>
    </figure>
    <p>最も多くのウェブフォントをリクエストしたページの賞は、<strong>718</strong>のウェブフォントをリクエストしたサイトに贈られます！</p>
    <p>コードに飛び込んだ後、それらの718のリクエストのすべてがGoogle Fontsに向かっています！　どうやらWordPress用の「ページの折り返しの上に」最適化プラグインが誤作動して、このサイトで不正を行い、すべてのGoogle Fonts-oopsにリクエストしている（DDoS-ing？）。</p>
    <p>パフォーマンス最適化プラグインは、あなたのパフォーマンスをはるかに悪化させることができることを皮肉っています！</p>
    <h2 id="fonts-unicode-rangeを使うとより正確なマッチングが可能になります">
      <a href="#fonts-unicode-rangeを使うとより正確なマッチングが可能になります" class="anchor-link"><code>Unicode-range</code>を使うとより正確なマッチングが可能になります</a>
    </h2>
    <figure id="fonts-fig-15">
      <div class="big-number">56%</div>
      <figcaption><a href="#fonts-fig-15" class="anchor-link">図 15.</a> <code>unicode-range</code>プロパティでWebフォントを宣言しているモバイルページの割合。</figcaption>
    </figure>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/CSS/@font-face/unicode-range"><code>unicode-range</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/CSS/@font-face/unicode-range</span></a
      >は、ブラウザに、ページがフォントファイルで使用したいコードポイントを具体的に知らせるための優れたCSSプロパティです。<code>@font-face</code>宣言に<code>unicode-range</code>がある場合、ページ上のコンテンツは、フォントが要求される前に、その範囲内のコードポイントのいずれかにマッチしなければなりません。これは非常に良いことです。
    </p>
    <p>Google FontsはそのCSSのほとんど（すべてではないにしても）で<code>unicode-range</code>を使用しているので、これもGoogle Fontsの使用状況によって偏っていると予想される指標です。ユーザーの世界でこれはあまり一般的でないと思いますが、Web Almanacの次の版ではGoogle Fontsのリクエストをフィルタリングして除外することが可能かもしれません。</p>
    <h2 id="fonts-システムフォントが存在する場合、ウェブフォントを要求しないようにする"><a href="#fonts-システムフォントが存在する場合、ウェブフォントを要求しないようにする" class="anchor-link">システムフォントが存在する場合、ウェブフォントを要求しないようにする</a></h2>
    <figure id="fonts-fig-16">
      <div class="big-number">59%</div>
      <figcaption><a href="#fonts-fig-16" class="anchor-link">図 16.</a> <code>local()</code>プロパティでWebフォントを宣言しているモバイルページの割合。</figcaption>
    </figure>
    <p><code>local()</code>は<code>@font-face</code>、<code>src</code>のシステムフォントを参照するための良い方法です。もし <code>local()</code>フォントが存在するならば、ウェブフォントを要求する必要は全くありません。これはGoogle Fontsによって広く使われており、論争の的にもなっているのでユーザの土地からパターンを得ようとしているのであれば、これも歪んだデータの一例になるでしょう。</p>
    <p>
      ここでは、私よりも賢い人々(TypeKitのBram Stein氏) が、<a href="https://bramstein.com/writing/web-font-anti-patterns-local-fonts.html">インストールされているフォントのバージョンが古くて信頼性は低い場合があるため、<code>local()</code>を使うことは予測不可能である可能性がある<span class="fn">https://bramstein.com/writing/web-font-anti-patterns-local-fonts.html</span></a
      >と述べていることにも注目しておきましょう。
    </p>
    <h2 id="fonts-縮約されたフォントとfont-stretch">
      <a href="#fonts-縮約されたフォントとfont-stretch" class="anchor-link">縮約されたフォントと<code>font-stretch</code></a>
    </h2>
    <figure id="fonts-fig-17">
      <div class="big-number">7%</div>
      <figcaption><a href="#fonts-fig-17" class="anchor-link">図 17.</a> <code>font-stretch</code> プロパティを持つスタイルを含むデスクトップページとモバイルページの割合。</figcaption>
    </figure>
    <p>
      歴史的に、<code>font-stretch</code>はブラウザのサポートが悪く、よく知られた<code>@font-face</code>プロパティではありませんでした。詳しくは<a href="https://developer.mozilla.org/ja/docs/Web/CSS/font-stretch">MDNの<code>font-stretch</code>について<span class="fn">https://developer.mozilla.org/ja/docs/Web/CSS/font-stretch</span></a> を参照してください。しかし、<a href="https://caniuse.com/#feat=css-font-stretch">ブラウザのサポート<span class="fn">https://caniuse.com/#feat=css-font-stretch</span></a
      >は広がっています。
    </p>
    <p>小さいビューポートで凝縮されたフォントを使用することで、より多くのテキストを表示できるようになることが示唆されていますが、このアプローチは一般的には使用されていません。とはいえ、このプロパティがモバイルよりもデスクトップで半パーセントポイント多く使われているというのは予想外で、7％というのは私が予想していたよりもはるかに高いと思えます。</p>
    <h2 id="fonts-可変フォントは未来のもの"><a href="#fonts-可変フォントは未来のもの" class="anchor-link">可変フォントは未来のもの</a></h2>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/CSS/CSS_Fonts/Variable_Fonts_Guide">可変フォント<span class="fn">https://developer.mozilla.org/ja/docs/Web/CSS/CSS_Fonts/Variable_Fonts_Guide</span></a
      >では、1つのフォントファイルに複数のフォントの太さやスタイルを含めることができます。
    </p>
    <figure id="fonts-fig-18">
      <div class="big-number">1.8%</div>
      <figcaption><a href="#fonts-fig-18" class="anchor-link">図 18.</a> 可変フォントを含むページの割合</figcaption>
    </figure>
    <p>
      1.8％でさえ、これは予想よりも高かったが、これがうまくいくのを見て興奮している。<a href="https://developers.google.com/fonts/docs/css2">Google Fonts v2<span class="fn">https://developers.google.com/fonts/docs/css2</span></a
      >には可変フォントのサポートがいくつか含まれています。
    </p>
    <figure id="fonts-fig-19">
      <a href="https://almanac.httparchive.org/static/images/2019/fonts/fig19.png">
        <img src="/static/images/2019/fonts/fig19.png" alt="図19. 'font-variation-settings'軸の使用法。" aria-labelledby="fonts-fig19-caption" aria-describedby="fonts-fig19-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQDogXDb3BwZZHrBT39qccP_LJoCScD3QEi_FmjT_8VDPD_1Srpz-g7ZuuTUEb8pYXBpDmQzZ1hQh7q/pubchart?oid=699343351&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig19-description" data-show-text="{{ show_description(19) }}" data-hide-text="{{ hide_description(19) }}">{{ show_description(19) }}</button>
      <div id="fonts-fig19-description" class="visually-hidden">font-variation-settingsプロパティの使用状況を示す棒グラフ。デスクトップページのプロパティの42%が"opsz"の値に設定されており、32%が"wght"、16%が"wdth"、2%以下が"roun"、"crsb"、"slnt"、"inln"などに設定されています。デスクトップページとモバイルページで顕著な違いは、"opsz"の使用率が26％、"wght"の使用率が38％、"wdth"の使用率が23％となっており、"wght"の使用率は、"wght"の使用率と"wght"の使用率の差が大きい。</div>
      <figcaption id="fonts-fig19-caption"><a href="#fonts-fig-19" class="anchor-link">図 19.</a> <code>font-variation-settings</code>軸の使用法。</figcaption>
    </figure>
    <p>この大規模なデータセットのレンズを通して見ると、これらの結果は非常に低いサンプルサイズであることがわかります。しかし、デスクトップページで最も一般的な軸として<code>opsz</code>が注目され、<code>wght</code>と<code>wdth</code>が後に続く。私の経験では、可変フォントの入門デモはたいていウェイトベースです。</p>
    <h2 id="fonts-カラーフォントも未来かも？"><a href="#fonts-カラーフォントも未来かも？" class="anchor-link">カラーフォントも未来かも？</a></h2>
    <figure id="fonts-fig-20">
      <div class="big-number">117</div>
      <figcaption><a href="#fonts-fig-20" class="anchor-link">図 20.</a> カラーフォントを含むデスクトップウェブページの数。</figcaption>
    </figure>
    <p>
      これらのここでの使用法は基本的に存在しませんが、詳細については<a href="https://www.colorfonts.wtf/">カラーフォント！　WTF?<span class="fn">https://www.colorfonts.wtf/</span></a
      >という優れたリソースをチェックできます。フォント用のSVGフォーマット(これは良くないし消えていく)に似ていますが(全くそうではありません)、これを使うとOpenTypeファイルの中にSVGを埋め込むことができ、これは素晴らしくクールです。
    </p>
    <h2 id="fonts-結論"><a href="#fonts-結論" class="anchor-link">結論</a></h2>
    <p>ここでの最大の収穫は、Google Fontsがウェブフォントの議論を支配しているということだ。彼らが取ったアプローチは、ここで記録したデータに大きく影響している。ここでのポジティブな点はウェブフォントへのアクセスが容易であること、優れたフォントフォーマット（WOFF2）であること、そして自由な<code>unicode範囲</code>の設定が可能であることだ。ここでの欠点はサードパーティのホスティング、異なるホストからのリクエスト、および<code>preload</code>にアクセスできないことでパフォーマンスが低下することです。</p>
    <p>私は、将来的には「バリアブルフォントの台頭」を見ることになるだろうと完全に予想しています。バリアブルフォントは複数の個々のフォントファイルを1つの合成フォントファイルに結合するので、これはウェブフォントのリクエストの減少と対になっているはずです。しかし歴史が示しているように、ここで通常起こることは、あるものを最適化してその空所を埋めるためにさらに多くのものを追加してしまうことです。</p>
    <p>カラーフォントの人気が高まるかどうかは非常に興味深いところです。私は、これらは可変フォントよりもはるかにニッチなものになると予想していますが、アイコンフォントのスペースに生命線を見ることができるかもしれません。</p>
    <p>フォントを凍らせるなよ。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"II","chapter_number":7,"title":"パフォーマンス","description":"コンテンツの初回ペイント（FCP）、最初のバイトまでの時間（TTFB）、初回入力遅延（FID）を取り扱う2019 Web Almanac パフォーマンスの章。","authors":["rviscomi"],"reviewers":["JMPerez","obto","sergeychernyshev","zeman"],"translators":["MSakamaki"],"discuss":"1762","results":"https://docs.google.com/spreadsheets/d/1zWzFSQ_ygb-gGr1H1BsJCfB7Z89zSIf7GX0UayVEte4/","queries":"07_Performance","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-03-02T00:00:00.000Z","chapter":"performance"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="performance-導入"><a href="#performance-導入" class="anchor-link">導入</a></h2>
    <p>パフォーマンスはユーザー体験で大切なものの一つです。 多くのWebサイトでは、ページの読み込み時間を早くする事によるユーザー体験の向上と、コンバージョン率の上昇は一致しています。 逆に、パフォーマンスが低い場合、ユーザーはコンバージョンを達成せず、不満を持ち、ページをクリックすると怒りを覚えることさえあります。</p>
    <p>Webのパフォーマンスを定量化する方法は色々とあります。 ここで一番大切なのは、ユーザーにとって特に重要な点を計測することです。 ただ、<code>onload</code>や<code>DOMContentLoaded</code>などのイベントはユーザーが実際に目で見て体験できているものとは限りません。 例えば、電子メールクライアントを読み込んだ時、受信トレイの内容が非同期に読み込まれる間、画面全体を覆うようなプログレスバーが表示される事があります。 ここでの問題は<code>onload</code>イベントが受信ボックスの非同期読み込みの完了まで待機しないことです。 この例において、ユーザーの一番大切にするべき計測値とは「受信トレイが使えるようになるまでの時間」であり、<code>onload</code>イベントに着目するのは誤解を招く可能性があります。 そのために、この章ではユーザーが実際にページをどのように体験しているかを把握し、よりモダンで広く使える描画、読み込み、および対話性の計測を検討します。</p>
    <p>パフォーマンスデータにはラボとフィールドの２種類があります。 合成テストや実ユーザー測定（またはRUM）でそれらを聞いたことがあるかもしれません。 ラボでパフォーマンスを測定すると、各Webサイトが共通の条件でテストされ、ブラウザー、接続速度、物理的な場所、キャッシュ状態などの状態は常に同じになります。 この一貫性が保証されることで、それぞれのWebサイトを比較することができます。 その反面、フィールドのパフォーマンス測定は、ラボでは決して行うことのできない無限に近い条件の組み合わせで、現実に近いユーザーのWeb体験を計測することを可能にします。 この章の目的と実際のユーザー体験を理解するために、今回はフィールドデータを見ていきます。</p>
    <h2 id="performance-パフォーマンスの状態"><a href="#performance-パフォーマンスの状態" class="anchor-link">パフォーマンスの状態</a></h2>
    <p>
      Web Almanacにある他のほとんどの章は、<a href="https://httparchive.org/">HTTP Archive<span class="fn">https://httparchive.org/</span></a
      >のデータに基づいています。 ただ、実際のユーザーがWebをどのように体験するかを取得するには、違うデータセットが必要になります。 このセクションでは、<a href="http://bit.ly/chrome-ux-report">Chrome UXレポート<span class="fn">http://bit.ly/chrome-ux-report</span></a
      >（CrUX）を使用しています。この情報はHTTP Archiveとすべて同じウェブサイトで構成されるGoogleの公開データセットとなっており、Chromeを使うユーザーの実際の体験を集約しています。そして体験は次のように分類されます。
    </p>
    <ul>
      <li>
        ユーザーデバイスのフォームファクタ
        <ul>
          <li>デスクトップ</li>
          <li>携帯電話</li>
          <li>タブレット</li>
        </ul>
      </li>
      <li>
        モバイル用語で言うユーザーの有効な接続タイプ(ECT)
        <ul>
          <li>オフライン</li>
          <li>遅い2G</li>
          <li>2G</li>
          <li>3G</li>
          <li>4G</li>
        </ul>
      </li>
      <li>ユーザーの地理的な位置</li>
    </ul>
    <p>
      体験は描画、読み込み、そして対話性の定量化を含めて毎月測定されます。 最初に私達が見るべき指標は<a href="https://developers.google.com/web/fundamentals/performance/user-centric-performance-metrics#first_paint_and_first_contentful_paint">コンテンツの初回ペイント(First Contentful Paint)<span class="fn">https://developers.google.com/web/fundamentals/performance/user-centric-performance-metrics#first_paint_and_first_contentful_paint</span></a
      >(FCP)です。 これはページや画像やテキストなど、ユーザーが画面として見るために必要なものが表示されるのを待つ時間です。 次は、読み込み時間の指標である<a href="https://developer.mozilla.org/en-US/docs/Glossary/time_to_first_byte">最初のバイトまでの時間(Time to First Byte)<span class="fn">https://developer.mozilla.org/en-US/docs/Glossary/time_to_first_byte</span></a> (TTFB)です。 これはユーザーがナビゲーションを行ってから、Webページのレスポンスの最初のバイトを受信するまでにかかった時間を計測したものです。 そして最後に確認するフィールドの指標は<a href="https://developers.google.com/web/updates/2018/05/first-input-delay">初回入力遅延(First Input Delay)<span class="fn">https://developers.google.com/web/updates/2018/05/first-input-delay</span></a> (FID)です。 これは比較的新しい指標で、読み込み以外のパフォーマンスUXの一部を表すものです。 ユーザーがページのUIを操作できるようになるまでの時間、つまり、ブラウザのメインスレッドがイベント処理の準備が整うまでの時間を測定したものです。
    </p>
    <p>では、それによってどのような洞察ができるのかを見てきましょう。</p>
    <h3 id="performance-コンテンツの初回ペイントfirst-contentful-paint"><a href="#performance-コンテンツの初回ペイントfirst-contentful-paint" class="anchor-link">コンテンツの初回ペイント(First Contentful Paint)</a></h3>
    <figure id="performance-fig1">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig1.png">
        <img src="/static/images/2019/performance/fig1.png" alt="図1. Webサイトの高速、適度、および低速のFCPパフォーマンスの分布。" aria-labelledby="performance-fig1-caption" aria-describedby="performance-fig1-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=115935793&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="performance-fig1-description" class="visually-hidden">Webサイト1000個から見た、FCPが高速、適度、低速の分布。FCPが早いサイトの分布は100%から0%までが線形になっているように見えます。</div>
      <figcaption id="performance-fig1-caption"><a href="#performance-fig1" class="anchor-link">図 1.</a> Webサイトの高速、適度、および低速のFCPパフォーマンスの分布。</figcaption>
    </figure>
    <p>図1では、FCPの体験がWeb全体でどのように分散しているかを見ることができます。 このチャートは、CrUXデータセット内にある数百万のWebサイト分布を1,000個のWebサイトに圧縮しており、図の縦線一つ一つはWebサイトを表しています。 このグラフは、１秒未満の高速なFCP体験、３秒以上かかる遅い体験、その中間にある適度な体験（以前は平均と言われていた）の割合で並べられています。 グラフには、ほぼ100%高速な体験を備えたWebサイトと、ほぼ100%低速な体験となっているWebサイトが存在しています。 その中間にある、高速、適度、及び低速のパフォーマンスが混じり合ったWebサイトは、低速よりも適度か高速に傾いており、良い結果になっています。</p>
    <p class="note">注意：ユーザー体験の低下があった場合、その理由が何であるか突き止めるのは難しいでしょう。 Webサイト自体が不十分で非効率な構築がされている可能性があるかもしれませんが、ユーザーの通信速度が遅い可能性やキャッシュが空など、他の環境要因がある可能性があります。そのため、このフィールドデータを見てユーザー体験が悪いとわかっても、理由は必ずしもWebサイトにあるとは言えません。</p>
    <p>Webサイトが十分に<strong>高速</strong>かどうかを分類するために、新しい方法論である PageSpeed Insights (PSI)を使います。 この方法はWebサイトのFCP体験の少なくとも75%が１秒未満でなければなりません。 同様に、FCP体験がとても<strong>低速</strong>となる25%のWebサイトでは３秒以上かかっています。 どちらの条件も満たさない場合、Webサイトのパフォーマンスは<strong>適度</strong>です。</p>
    <figure id="performance-fig2">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig2.png">
        <img src="/static/images/2019/performance/fig2.png" alt="図2. 高速、適度、低速のFCPラベルが貼られたWebサイトの分布。" aria-labelledby="performance-fig2-caption" aria-describedby="performance-fig2-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=36103372&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="performance-fig2-description" class="visually-hidden">Webサイトの13%が高速なFCPで、66%が適度のFCP、20%が低速のFCPを示す棒グラフ。</div>
      <figcaption id="performance-fig2-caption"><a href="#performance-fig2" class="anchor-link">図 2.</a> 高速、適度、低速のFCPラベルが貼られたWebサイトの分布。</figcaption>
    </figure>
    <p>図2の結果は、Webサイトの13％だけが高速と判断されています。 これはまだ改善の余地があるようですが、多くのWebサイトで意味を持つコンテンツを素早く一貫して描画できています。 Webサイトの３分の２は適度のFCP体験となっているようです。</p>
    <p>デバイス毎にFCPのユーザー体験がどの様になっているかを知るために、フォームファクタ別に分類してみましょう。</p>
    <h4 id="performance-デバイス毎のfcp"><a href="#performance-デバイス毎のfcp" class="anchor-link">デバイス毎のFCP</a></h4>
    <figure id="performance-fig3">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig3.png">
        <img src="/static/images/2019/performance/fig3.png" alt="図3. 「デスクトップ向け」Webサイトの高速、適度、低速のFCPパフォーマンスの分布。" aria-labelledby="performance-fig3-caption" aria-describedby="performance-fig3-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=1231764008&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="performance-fig3-description" class="visually-hidden">1,000個のデスクトップWebサイトの高速、適度、低速のFCP分布、高速なFCPの分布は100%から0%までが線形となっており、中央で少し膨らんでいます。</div>
      <figcaption id="performance-fig3-caption"><a href="#performance-fig3" class="anchor-link">図 3.</a> <em>デスクトップ</em>Webサイトの高速、適度、低速のFCPパフォーマンスの分布。</figcaption>
    </figure>
    <figure id="performance-fig4">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig4.png">
        <img src="/static/images/2019/performance/fig4.png" alt="図4. 「携帯電話向け」Webサイトの高速、適度、低速のFCPパフォーマンスの分布。" aria-labelledby="performance-fig4-caption" aria-describedby="performance-fig4-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=167423587&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="performance-fig4-description" class="visually-hidden">1,000個の携帯電話向けWebサイトの高速、適度、低速のFCP分布、高速なFCPの分布は100%から0%までに膨らみが無く、線形に見えます。</div>
      <figcaption id="performance-fig4-caption"><a href="#performance-fig4" class="anchor-link">図 4.</a> <em>携帯電話向け</em>Webサイトの高速、適度、低速のFCPパフォーマンスの分布。</figcaption>
    </figure>
    <p>上の図3と図4は、FCPの分布をデスクトップと携帯電話で分類しています。 微妙な差ですが、デスクトップFCP分布の胴部は携帯電話ユーザーの分布よりも凸型となっているように見えます。 この視覚的な近似が示すのは、デスクトップユーザーが高速なFCPにおいて全体的に割合が高いことを示しています。 これを検証するために、PSIという方法を各分布に適用していきます。</p>
    <figure id="performance-fig5">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig5.png">
        <img src="/static/images/2019/performance/fig5.png" alt="図5.高速、適度、低速FCPのラベルが付けられたWebサイトの分布。デバイスの種類で分類されています。" aria-labelledby="performance-fig5-caption" aria-describedby="performance-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=486448175&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="performance-fig5-description" class="visually-hidden">デスクトップとモバイルのFCP分布を示す棒グラフ。デスクトップは高速、適度、低速が17%、67%、16%となっており、モバイルは11%、66%、23%となっています。</div>
      <figcaption id="performance-fig5-caption"><a href="#performance-fig5" class="anchor-link">図 5.</a>高速、適度、低速FCPのラベルが付けられたWebサイトの分布。デバイスの種類で分類されています。</figcaption>
    </figure>
    <p>PSIの分類によると、モバイルユーザーの11%と比べて、デスクトップユーザーは17%に対して高速なFCP体験が全体的に提供されています。 全体的な分布を見ると、デスクトップのほうが体験が少しだけ高速に偏っていますが、低速のWebサイトは少なく高速と適度のカテゴリーが多くなっています。</p>
    <p>Webサイトでデスクトップユーザーが高確率で携帯電話のユーザーより高速なFCP体験をするのは何故でしょう？ それは結局、このデータセットはWebがどのように機能しているかという答えでしかなく必ずそう動いていると言った話では無いからです。 ただ、デスクトップユーザーはキャリアの通信ではなく、WiFiのような高速で信頼性の高いネットワークでインターネット接続をしていると推測できます。 この疑問に答えるために、ECTでユーザー体験がどのように違うかを調べることもできます。</p>
    <h4 id="performance-有効な接続タイプ毎のfcp"><a href="#performance-有効な接続タイプ毎のfcp" class="anchor-link">有効な接続タイプ毎のFCP</a></h4>
    <figure id="performance-fig6">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig6.png">
        <img src="/static/images/2019/performance/fig6.png" alt="図6. 高速、適度、低速のFCPでラベル付けされたWebサイトの分布。ECTで分類されています。" aria-labelledby="performance-fig6-caption" aria-describedby="performance-fig6-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=1987967547&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="performance-fig6-description" class="visually-hidden">有効な接続タイプ毎のFCP分布棒グラフ。4Gの高速、適度、低速：14％、67％、19％。 3G：1％、38％、61％。 2G：0％、9％、90％。 低速な2G：0％、1％、99％。</div>
      <figcaption id="performance-fig6-caption"><a href="#performance-fig6" class="anchor-link">図 6.</a> 高速、適度、低速のFCPでラベル付けされたWebサイトの分布。<abbr title="effective connection type">ECT</abbr>で分類されています。</figcaption>
    </figure>
    <p>上の図6にあるFCP体験は、ユーザーの体験するECT毎にグループ化されています。 興味深いことに、ECTの速度と高速FCPを提供するWebサイトの割合との間には相関関係があります。 ECTの速度が低下すると、高速な体験の割合はゼロに近づきます。 ECTが4Gのユーザーにサービスを提供しているWebサイトの14％は高速なFCPエクスペリエンスを提供していますが、そのWebサイトの19％は低速な体験を提供しています。 61％のWebサイトは、ECTが3Gのユーザーに低速のFCPを提供し、ECTが2Gだと90％に、ETCが低速の2Gだと99％となっています。 これらの事実から、4Gより遅い接続を持つユーザーには、Webサイトがほぼ一貫して高速のFCPを提供できていないことを示しています。</p>
    <h4 id="performance-地理によるfcp"><a href="#performance-地理によるfcp" class="anchor-link">地理によるFCP</a></h4>
    <figure id="performance-fig7">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig7.png">
        <img src="/static/images/2019/performance/fig7.png" alt="図7. 高速、適度、低速FCPでラベル付を行ったWebサイトの分布を地域別に分類したもの。" aria-labelledby="performance-fig7-caption" aria-describedby="performance-fig7-description" width="600" height="940" data-width="600" data-height="940" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=792398959&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="performance-fig7-description" class="visually-hidden">最も人気があるトップ23地域のFCP分布棒グラフです。韓国は36%で最も早いWebサイトを持っています。そこから高速なWebサイトの割合は、日本28%、台湾26％、オランダ21%となり、そこから他の地域は急速に減少しています。</div>
      <figcaption id="performance-fig7-caption"><a href="#performance-fig7" class="anchor-link">図 7.</a> 高速、適度、低速FCPでラベル付を行ったWebサイトの分布を地域別に分類したもの。</figcaption>
    </figure>
    <p>
      最後にユーザーの地理（geo）でFCPを切り分けてみましょう。 上記のグラフは、個別に多くのWebサイトを持っているトップ23の地域を表しています。これはオープンWeb全体での人気の計測です。 アメリカのWebユーザーは、1,211,002の最も際立ったWebサイトにアクセスします。 十分に高速なFCP体験のWebサイトの割合で地理をソートしましょう。リストのトップ3には<a href="https://en.wikipedia.org/wiki/Asia-Pacific">アジアパシフィック<span class="fn">https://en.wikipedia.org/wiki/Asia-Pacific</span></a
      >(APAC)が入っています。それは韓国、台湾、日本です。 この結果から、<a href="https://en.wikipedia.org/wiki/List_of_countries_by_Internet_connection_speeds">これらの地域では非常に高速なネットワーク接続<span class="fn">https://en.wikipedia.org/wiki/List_of_countries_by_Internet_connection_speeds</span></a
      >が使われていることが説明できます。 韓国では高速のFCP基準を満たすウェブサイトが36％あり、低速と評価されているのはわずか7%です。 高速/適度/低速のウェブサイトの世界的な分布はおおよそ13/66/20であり、韓国がかなり良い意味で外れ値となっています。
    </p>
    <p>他のAPAC地域の話をしましょう。タイ、ベトナム、インドネシア、インドの高速Webサイトは、ほぼ10％未満です。 そして、これらの地域は韓国の3倍以上低速なWebサイトと言う割合になっています。</p>
    <h3 id="performance-最初のバイトまでの時間time-to-first-byte-ttfb"><a href="#performance-最初のバイトまでの時間time-to-first-byte-ttfb" class="anchor-link">最初のバイトまでの時間(Time to First Byte) (TTFB)</a></h3>
    <p>
      <a href="https://web.dev/time-to-first-byte">最初のバイトまでの時間<span class="fn">https://web.dev/time-to-first-byte</span></a
      >は、ユーザーがWebページにナビゲーションしてからレスポンスの最初のバイトを受信するまでにかかった時間の測定値です。
    </p>
    <figure id="performance-fig8">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/nav-timing.png">
        <img src="/static/images/2019/performance/nav-timing.png" alt="図8.ページナビゲーションのイベントとNavigation Timing API の図表。" aria-labelledby="performance-fig8-caption" aria-describedby="performance-fig8-description" width="2580" height="868" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="performance-fig8-description" class="visually-hidden">ページの読み込みにおけるネットワークフェーズのシーケンスを示す図：startTime（promptForUnload）、リダイレクト、AppCache、DNS、TCP、リクエスト、レスポンス、処理、読み込み。</div>
      <figcaption id="performance-fig8-caption"><a href="#performance-fig8" class="anchor-link">図 8.</a>ページナビゲーションのイベントとNavigation Timing API の図表。</figcaption>
    </figure>
    <p>
      TTFBとそれに影響する多くの要因を説明するために、<a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigation_timing_API">Navigation Timing APIの仕様<span class="fn">https://developer.mozilla.org/en-US/docs/Web/API/Navigation_timing_API</span></a
      >から図を借りました。 上の図8は<code>startTime</code>から<code>responseStart</code>までの間を表しており、<code>unload</code>、<code>redirects</code>、<code>AppCache</code>、<code>DNS</code>、<code>SSL</code>、<code>TCP</code>などのサーバー側のリクエスト処理に費やす全てを含んでいます。 このようなコンテキストを考慮して、ユーザーがこの数値をどのように体験しているかを見てみましょう。
    </p>
    <figure id="performance-fig9">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig9.png">
        <img src="/static/images/2019/performance/fig9.png" alt="図9. WebサイトのTTFBパフォーマンス、高速、適度、低速の分布。" aria-labelledby="performance-fig9-caption" aria-describedby="performance-fig9-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=444630188&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="performance-fig9-description" class="visually-hidden">Webサイト1,000個の高速、適度、低速のTTFBの配布。 高速TTFBの分布は、10番目まで早い割合で、そして約90％から50％に急速に低下します。 その後分布は50％から0％に徐々に減少し、最後の1割は底辺を這います。</div>
      <figcaption id="performance-fig9-caption"><a href="#performance-fig9" class="anchor-link">図 9.</a> WebサイトのTTFBパフォーマンス、高速、適度、低速の分布。</figcaption>
    </figure>
    <p>
      図1のFCPチャートと同様に、これは高速TTFB毎に並べられた代表的な1,000個の値のサンプルのビューです。 <a href="https://developers.google.com/speed/docs/insights/Server#recommendations">高速TTFB<span class="fn">https://developers.google.com/speed/docs/insights/Server#recommendations</span></a
      >は0.2秒（200ミリ秒）未満、低速TTFBは1秒以上、その間はすべて適度です。
    </p>
    <p>高速の割合の曲がり方を見ると、形はFCPとかなり異なります。 75％を超える高速なTTFBを持つWebサイトは非常に少なく、25％を下回るWebサイトが半分以上となっています。</p>
    <p>以前にFCPで使用したPSI方法論からインスピレーションを貰って、TTFB速度のラベルを各Webサイトに適用しましょう。 ウェブサイトが75％以上のユーザー体験に対して高速なTTFBを提供する場合、<strong>高速</strong>とラベル付けされます。 それ以外に、25％以上のユーザー体験に対して<strong>低速</strong> なTTFBを提供するものを、低速とします。 この条件のどちらでもないものを<strong>適度</strong>とします</p>
    <figure id="performance-fig10">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig10.png">
        <img src="/static/images/2019/performance/fig10.png" alt="図10. TTFBが高速、適度、低速としてラベル付けされたWebサイトの分布。" aria-labelledby="performance-fig10-caption" aria-describedby="performance-fig10-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=926985367&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="performance-fig10-description" class="visually-hidden">Webサイトの2%が高速なTTFBを、56%が適度のTTFBを、42%が低速なTTFBとなっていることを示す棒グラフ。</div>
      <figcaption id="performance-fig10-caption"><a href="#performance-fig10" class="anchor-link">図 10.</a> TTFBが高速、適度、低速としてラベル付けされたWebサイトの分布。</figcaption>
    </figure>
    <p>Webサイトの42%で低速のTTFB体験となっています。 TTFBは他のすべてのパフォーマンス値の妨げになるため、この値はとても重要です。 <em>定義上は、TTFBに1秒以上かかる場合、ユーザーは高速なFCPを体験できない可能性があります</em>。</p>
    <h4 id="performance-ttfb-by-geo"><a href="#performance-ttfb-by-geo" class="anchor-link">TTFB by geo</a></h4>
    <figure id="performance-fig11">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig11.png">
        <img src="/static/images/2019/performance/fig11.png" alt="図11. 高速、適度、低速のTTFBそれぞれでラベル付けされたWebサイトの分布。地域別に分類されています。" aria-labelledby="performance-fig11-caption" aria-describedby="performance-fig11-description" width="600" height="940" data-width="600" data-height="940" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=685447534&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig11-description" data-show-text="{{ show_description(11) }}" data-hide-text="{{ hide_description(11) }}">{{ show_description(11) }}</button>
      <div id="performance-fig11-description" class="visually-hidden">最も人気のあるトップ23地域のTTFB分布の棒グラフ。韓国は14%で特に早いWebサイトを持っています。そこから、早いWebサイトの割合は台湾7%、日本5%、オランダ4%となり、他の地域では急速に減少していきます。</div>
      <figcaption id="performance-fig11-caption"><a href="#performance-fig11" class="anchor-link">図 11.</a> 高速、適度、低速のTTFBそれぞれでラベル付けされたWebサイトの分布。地域別に分類されています。</figcaption>
    </figure>
    <p>次に、さまざまな地域で、高速なTTFBをユーザーに提供しているWebサイトの割合を見てみましょう。 韓国、台湾、日本のようなAPAC地域は依然として世界のユーザーを上回っています。 しかし、どの地域も15%を超えてた高速なTTFBとなっているWebサイトはありません。 インドでは、高速TTFBとなっているWebサイトは1%未満で、低速なTTFBとなっているWebサイトは79%となっています。</p>
    <h3 id="performance-初回入力遅延（first-input-delay）"><a href="#performance-初回入力遅延（first-input-delay）" class="anchor-link">初回入力遅延（First Input Delay）</a></h3>
    <p>
      最後に確認するフィールド値は<a href="https://developers.google.com/web/updates/2018/05/first-input-delay">初回入力遅延(First Input Delay)<span class="fn">https://developers.google.com/web/updates/2018/05/first-input-delay</span></a
      >(FID)です。 この値は、ユーザーがページのUIを最初に操作してから、ブラウザのメインスレッドでイベントの処理が可能になるまでの時間です。 この時間には、アプリケーションへの実際の入力処理の時間は含まれないことに注意してください。 最悪の場合は、FIDが遅いとページが応答しなくなり、ユーザー体験は苛立たしいものとなってしまいます。
    </p>
    <p>いくつかのしきい値を定義することから始めましょう。 新しいPSI手法によると、<strong>高速</strong>なFIDは100ミリ秒未満です。 これによりアプリケーションは、入力イベントを処理しユーザーへの応答の結果が瞬時に感じるのに十分な時間を与えることができます。 <strong>低速</strong>なFIDは300ミリ秒以上となっており、その間はすべて<strong>適度</strong>にあたります。</p>
    <figure id="performance-fig12">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig12.png">
        <img src="/static/images/2019/performance/fig12.png" alt="図12. Webサイトの高速、適度、低速のFIDパフォーマンスの分布。" aria-labelledby="performance-fig12-caption" aria-describedby="performance-fig12-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=60679078&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="performance-fig12-description" class="visually-hidden">Webサイト1,000個の高速、適度、低速のFID配布。75%を超える高速なFIDの分布は、4分の3でもWebサイトがあり、その後急速に0％に低下します。</div>
      <figcaption id="performance-fig12-caption"><a href="#performance-fig12" class="anchor-link">図 12.</a> Webサイトの高速、適度、低速のFIDパフォーマンスの分布。</figcaption>
    </figure>
    <p>貴方はいま難題を抱えています。 この表はWebサイトの高速、適度、低速のFID体験の分布を表しています。 これは以前のFCPとTTFBの表とは劇的に異なります。(<a href="#performance-fig1">図1</a>と<a href="#performance-fig9">図9</a>をそれぞれ見る). 高速FIDの曲線は100%から75%にゆるやかに下っていき、その後急降下します。 FIDの体験は、ほとんどのWebサイトでほぼ高速になっています。</p>
    <figure id="performance-fig13">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig13.png">
        <img src="/static/images/2019/performance/fig13.png" alt="図13. 高速、適度、低速のTTFBでラベル付けされたWebサイトの分布。" aria-labelledby="performance-fig13-caption" aria-describedby="performance-fig13-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=1828752871&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig13-description" data-show-text="{{ show_description(13) }}" data-hide-text="{{ hide_description(13) }}">{{ show_description(13) }}</button>
      <div id="performance-fig13-description" class="visually-hidden">40％のWebサイトが高速なFID、45％が適度のFID、15％が低速のFIDであることを示す棒グラフ。</div>
      <figcaption id="performance-fig13-caption"><a href="#performance-fig13" class="anchor-link">図 13.</a> 高速、適度、低速のTTFBでラベル付けされたWebサイトの分布。</figcaption>
    </figure>
    <p>十分に高速や低速のFIDとなるWebサイトのラベル付けを行うため、PSI方法論はFCPと少しだけ異なる方法を取ります。 <strong>高速</strong>なサイトと定義するのは、FID体験の95％以上を高速と定める必要があります。 遅いFID体験となる5％のサイトを<strong>遅い</strong>として、そのほかの体験を<strong>適度</strong>とします。</p>
    <p>以前の測定と比較して、集計されたFIDパフォーマンスの分布は低速よりも高速および適度の体験に大きく偏っています。 Webサイトの40%でFIDが早く、FIDが遅いと言えるのは15%だけです。 FIDが対話性の計測であるという性質は、ネットワーク速度によって制限される読み込みの計測と違い、パフォーマンス特性の全く異なる方法になります。</p>
    <h4 id="performance-デバイス毎のfid"><a href="#performance-デバイス毎のfid" class="anchor-link">デバイス毎のFID</a></h4>
    <figure id="performance-fig14">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig14.png">
        <img src="/static/images/2019/performance/fig14.png" alt="図14.  「デスクトップ」 WebサイトのFIDパフォーマンスの高速、適度、低速の分布。" aria-labelledby="performance-fig14-caption" aria-describedby="performance-fig14-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=16379508&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig14-description" data-show-text="{{ show_description(14) }}" data-hide-text="{{ hide_description(14) }}">{{ show_description(14) }}</button>
      <div id="performance-fig14-description" class="visually-hidden">デスクトップWebサイト1,000個の高速、適度、低速FIDの配布。 Webサイトの最速の4分の3で、高速FIDの分布は100％から90％にかけて非常にゆっくりと減少して、その後高速FIDは75％まで減少します。 ほぼすべてのデスクトップWebサイトは、75％以上の高速なFID体験を備えています。</div>
      <figcaption id="performance-fig14-caption"><a href="#performance-fig14" class="anchor-link">図 14.</a> <em>デスクトップ</em> WebサイトのFIDパフォーマンスの高速、適度、低速の分布。</figcaption>
    </figure>
    <figure id="performance-fig15">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig15.png">
        <img src="/static/images/2019/performance/fig15.png" alt="図15.  「携帯電話向け」WebサイトのFIDパフォーマンスの高速、適度、低速の分布。" aria-labelledby="performance-fig15-caption" aria-describedby="performance-fig15-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=519511409&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig15-description" data-show-text="{{ show_description(15) }}" data-hide-text="{{ hide_description(15) }}">{{ show_description(15) }}</button>
      <div id="performance-fig15-description" class="visually-hidden">モバイルWebサイト1,000個の高速、適度、低速FIDの配布。 高速なFIDの分布は着実に減少していますが、デスクトップよりもはるかに速く減っています。 ウェブサイトの4分の3までが75％となる高速に達していますが、その後すぐに0％に低下します。</div>
      <figcaption id="performance-fig15-caption"><a href="#performance-fig15" class="anchor-link">図 15.</a> <em>携帯電話向け</em> WebサイトのFIDパフォーマンスの高速、適度、低速の分布。</figcaption>
    </figure>
    <p>FIDをデバイスで分類してみると、この2つはまったく別の話となるようです。 デスクトップユーザーの殆どは常に高速なFIDで楽しめているようです。 まれに遅い体験をさせられるWebサイトがあるかもしれませんが、結果としては圧倒的に高速となっています。 一方モバイルのユーザーは2種類の体験に大別できます。 かなり高速(デスクトップほどではないが)か、全く早くないのどちらかとなるようです。 後者はWebサイトの10%のみ体験しているようですが、これは大きな違いでしょう。</p>
    <figure id="performance-fig16">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig16.png">
        <img src="/static/images/2019/performance/fig16.png" alt="図16. 高速、適度、低速FIDとしてラベル付けされたWebサイトの分布。デバイス種類別に分類されています。" aria-labelledby="performance-fig16-caption" aria-describedby="performance-fig16-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=1533541692&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig16-description" data-show-text="{{ show_description(16) }}" data-hide-text="{{ hide_description(16) }}">{{ show_description(16) }}</button>
      <div id="performance-fig16-description" class="visually-hidden">デスクトップとモバイルFID分布の棒グラフ。 デスクトップは高速、適度、低速がそれぞれ82％、12％、5％。 モバイルの場合26％、52％、22％。</div>
      <figcaption id="performance-fig16-caption"><a href="#performance-fig16" class="anchor-link">図 16.</a> 高速、適度、低速FIDとしてラベル付けされたWebサイトの分布。デバイス種類別に分類されています。</figcaption>
    </figure>
    <p>PSIラベルをデスクトップと携帯電話の体験に適用してみると、差分が非常に明瞭になります。 デスクトップユーザーが経験するWebサイトの82％はFIDが高速であるのに対し、低速は5％だけです。 モバイルで体験するWebサイトは、26％が高速であり、22％が低速です。 フォームファクターは、FIDなどの対話性計測の成果に大きな役割を果たします。</p>
    <h4 id="performance-有効な接続タイプ別のfid"><a href="#performance-有効な接続タイプ別のfid" class="anchor-link">有効な接続タイプ別のFID</a></h4>
    <figure id="performance-fig17">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig17.png">
        <img src="/static/images/2019/performance/fig17.png" alt="図17. ECTによって分類された高速、適度、低速FIDとしてラベル付けされたWebサイトの分布" aria-labelledby="performance-fig17-caption" aria-describedby="performance-fig17-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=1173039776&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig17-description" data-show-text="{{ show_description(17) }}" data-hide-text="{{ hide_description(17) }}">{{ show_description(17) }}</button>
      <div id="performance-fig17-description" class="visually-hidden">有効な接続タイプ毎のFID分布の棒グラフ。4G高速、適度、低速がそれぞれ41％、45％、15％。3G：22％、52％、26％。 2G：19％、58％、23％。 低速な2G：15％、58％、27％。</div>
      <figcaption id="performance-fig17-caption"><a href="#performance-fig17" class="anchor-link">図 17.</a> <abbr title="effective connection type">ECT</abbr>によって分類された高速、適度、低速FIDとしてラベル付けされたWebサイトの分布</figcaption>
    </figure>
    <p>一見、FIDはCPUの動作速度が影響するように思えます。 性能の悪いデバイスを使うと、ユーザーがWebページを操作しようとしたときに待ち状態になる可能性が高いと考えるのは自然でしょうか？</p>
    <p>上記のECTの結果からは、接続速度とFIDパフォーマンスの間に相関関係があることが示されています。 ユーザーの有効な接続の速度が低下すると、高速なFIDを体験するWebサイトの割合も低下しています。 4GのECTを使うユーザーがアクセスするWebサイトの41%は高速なFIDで、3Gは22%、2Gは19%、低速な2Gは15%です。</p>
    <h4 id="performance-fid-by-geo"><a href="#performance-fid-by-geo" class="anchor-link">FID by geo</a></h4>
    <figure id="performance-fig18">
      <a href="https://almanac.httparchive.org/static/images/2019/performance/fig18.png">
        <img src="/static/images/2019/performance/fig18.png" alt="図18. 高速、適度、低速FIDでラベル付けされたWebサイトの分布を地域別に分類したもの。" aria-labelledby="performance-fig18-caption" aria-describedby="performance-fig18-description" width="600" height="940" data-width="600" data-height="940" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSQlf3_ySLPB5322aTumUZhbVGdaUdkmi1Hs4bYuO3Z1kqM4xspx7REbwXukwPd_tsOSg6oImzpYLM9/pubchart?oid=11500240&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig18-description" data-show-text="{{ show_description(18) }}" data-hide-text="{{ hide_description(18) }}">{{ show_description(18) }}</button>
      <div id="performance-fig18-description" class="visually-hidden">最も人気のある上位23の地域のFID分布の棒グラフ。最速のWebサイトは韓国の69％です。そこから高速なWebサイトの割合は、オーストラリア55％、アメリカ合衆国52％、カナダ51％となり、他の地域で確実に減少しています。</div>
      <figcaption id="performance-fig18-caption"><a href="#performance-fig18" class="anchor-link">図 18.</a> 高速、適度、低速FIDでラベル付けされたWebサイトの分布を地域別に分類したもの。</figcaption>
    </figure>
    <p>この地理的な位置によるFIDの内訳では、韓国はまたもや他のすべてよりも抜きん出ています。 しかし、トップを占める地域にはいくつか新しい顔ぶれが現れています。次に現れるのはオーストラリア、米国、カナダとなっており、50％以上のWebサイトが高速なFIDとなっています。</p>
    <p>他の地域固有の結果と同様に、ユーザー体験に影響を与える可能性のある要因は多数あるでしょう。 例えば、より裕福な地理的条件が揃う地域に住んでいる人々は、より高速なネットワーク・インフラを購入でき、デスクトップも携帯電話もお金をかけてハイエンドなものを持っている率は高くなる可能性があります。</p>
    <h2 id="performance-結論"><a href="#performance-結論" class="anchor-link">結論</a></h2>
    <p>Webページの読み込み速度を定量化することは、単一の計測では表すことのできない不完全な科学です。 従来の<code>onload</code>等を計測する計測する方法は、ユーザー体験とは関係のない部分まで計測してしまい、本当に抑えるべき点を見逃してしまう可能性があります。 FCPやFIDなどのユーザーの知覚に相当する計測は、ユーザーが見たり感じたりする内容を着実に伝達できます。 ただそれでも、どちらの計測も単独で見てはページ全体の読み込み体験が高速なのか低速かについての結論を導き出すことはできません。 多くの計測値を総合的に見ることでのみ、Webサイト個々のパフォーマンスとWebの状態を理解することができます。</p>
    <p>この章で表されたデータから、高速なWebサイトとにするためには多くの設定されるべき目標と作業があることを示しています。 確かなフォームファクター、効果的な接続の種類、そして地理にはユーザー体験の向上と相関しますが、低いパフォーマンスとなる人口の統計も組み合わせる必要があることを忘れてはいけません。 殆どの場合、Webプラットフォームはビジネスで使われています。コンバージョン率を改善してより多くのお金を稼ぐことは、Webサイトを高速化する大きな動機になるでしょう。 最終的に、すべてのWebサイトのパフォーマンスとは、ユーザーの邪魔をしたり、イラつかせたり、怒らせたりしない方法で、ユーザーにより良い体験を提供することです。</p>
    <p>
      Webがまた一つ古くなり、ユーザー体験を測定する能力が徐々に向上するにつれて、開発者がより総合的なユーザー体験を捉えて計測された値を身近に思えるようになることを楽しみにしています。 FCPは有用なコンテンツをユーザーに表示するタイムラインのほぼ最初部分であり、それ以外にも<a href="https://web.dev/largest-contentful-paint">Large Contentful Paint<span class="fn">https://web.dev/largest-contentful-paint</span></a
      >（LCP）と呼ばれる新しい計測値が出現して、ページの読み込みがどのように認識されるかの可視性が向上しています。 <a href="https://web.dev/layout-instability-api">Layout Instability API<span class="fn">https://web.dev/layout-instability-api</span></a
      >は、ページの読み込み以降でユーザーが不満を持つ体験がある事を新たに垣間見せてくれました。
    </p>
    <p>こういった新しい計測が出来るようになった2020年のWebは、さらに透明性が高まって理解が深まり、開発者がパフォーマンスを改善するための有意義な進歩を遂げることで、より良いユーザー体験を提供できるでしょう。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"II","chapter_number":8,"title":"セキュリティ","description":"トランスポート・レイヤー・セキュリティ(TLS()、混合コンテンツ、セキュリティヘッダ、Cookie、サブリソース完全性を網羅した2019年版Web Almanacのセキュリティの章。","authors":["ScottHelme","arturjanc"],"reviewers":["bazzadp","ghedo","paulcalvano"],"translators":["ksakae"],"discuss":"1763","results":"https://docs.google.com/spreadsheets/d/1Zq2tQhPE06YZUcbzryRrBE6rdZgHHlqEp2XcgS37cm8/","queries":"08_Security","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-06-30T00:00:00.000Z","chapter":"security"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="security-序章"><a href="#security-序章" class="anchor-link">序章</a></h2>
    <p>Web Almanacのこの章では、Web上のセキュリティの現状を見ていきます。オンラインでのセキュリティとプライバシーの重要性がますます高まる中、サイト運営者とユーザーを保護するための機能が増えています。ここでは、ウェブ上でのこれらの新機能の採用状況を見ていきます。</p>
    <h2 id="security-トランスポートレイヤーセキュリティ"><a href="#security-トランスポートレイヤーセキュリティ" class="anchor-link">トランスポートレイヤーセキュリティ</a></h2>
    <p>
      現在、オンラインでのセキュリティとプライバシーを向上させるための最大の後押しは、おそらくトランスポート・レイヤー・セキュリティ（TLS）の普及です。TLS（または古いバージョンのSSL）は、HTTPSの「S」を提供し、安全でプライベートなWebサイトのブラウジングを可能にするプロトコルです。<a href="https://httparchive.org/reports/state-of-the-web#pctHttps">ウェブ上でのHTTPSの使用が大幅に増加している<span class="fn">https://httparchive.org/reports/state-of-the-web#pctHttps</span></a
      >だけでなく、TLSv1.2やTLSv1.3のような最新バージョンのTLSが増加していることも重要です。
    </p>
    <figure id="security-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/security/fig1.png">
        <img src="/static/images/2019/security/fig1.png" alt="図1.HTTPとHTTPS の使用法。" aria-labelledby="security-fig1-caption" aria-describedby="security-fig1-description" width="760" height="470" data-width="760" data-height="470" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRCG3clMcnkVPrnZSCWFi3qG-EU00Qr8X3XaRFQPWHEXQmYWMxnS_kfmmyMQsPZe2P6ECjzCjG0dVFg/pubchart?oid=933123879&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="security-fig1-description" class="visually-hidden">横棒グラフは、モバイルのHTTPSが79%、HTTPが21%、その下にデスクトップのHTTPSが 80.51%、HTTPが19.49%であることを示しています。</div>
      <figcaption id="security-fig1-caption"><a href="#security-fig-1" class="anchor-link">図 1.</a>HTTPとHTTPS の使用法。</figcaption>
    </figure>
    <h3 id="security-プロトコルのバージョン"><a href="#security-プロトコルのバージョン" class="anchor-link">プロトコルのバージョン</a></h3>
    <figure id="security-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/security/fig2.png">
        <img src="/static/images/2019/security/fig2.png" alt="図2. TLSプロトコルのバージョン使用状況" aria-labelledby="security-fig2-caption" aria-describedby="security-fig2-description" width="760" height="470" data-width="760" data-height="470" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRCG3clMcnkVPrnZSCWFi3qG-EU00Qr8X3XaRFQPWHEXQmYWMxnS_kfmmyMQsPZe2P6ECjzCjG0dVFg/pubchart?oid=1441324762&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="security-fig2-description" class="visually-hidden">横棒グラフは、デスクトップとモバイルのTLSの使用状況を示しています。TLSv1.2が58%、TLSv1.3が41%、TLSv1.0の使用率はほとんどなく (0.75%)、TLSv1.1の使用率はわずかです。</div>
      <figcaption id="security-fig2-caption"><a href="#security-fig-2" class="anchor-link">図 2.</a> TLSプロトコルのバージョン使用状況</figcaption>
    </figure>
    <p>
      図2は、さまざまなプロトコルバージョンのサポートを示しています。TLSv1.0やTLSv1.1のようなレガシーなTLSバージョンの使用は最小限であり、ほとんどすべてのサポートはプロトコルの新しいバージョンであるTLSv1.2やTLSv1.3に対応しています。TLSv1.3はまだ標準としては非常に若いですが（TLSv1.3は<a href="https://tools.ietf.org/html/rfc8446">2018年8月<span class="fn">https://tools.ietf.org/html/rfc8446</span></a
      >に正式に承認されたばかりです）、TLSを使用するリクエストの40％以上が最新バージョンを使用しています！　TLSv1.0やTLSv1.1のようなレガシーバージョンの使用はほとんどありません。
    </p>
    <p>これは、多くのサイトが<a href="#third-parties">サードパーティコンテンツ</a>のために大きなプレイヤーからのリクエストを使用していることが原因であると考えられます。例えば、どのようなサイトでもGoogle Analytics、Google AdWords、またはGoogle FontsをロードしGoogleのような大規模なプレイヤーは通常新しいプロトコルのためのアーリーアダプターです。</p>
    <p>ホームページだけを見て、それ以外のサイトのリクエストをすべて見ない場合、TLSの使用率は予想通りかなり高いですが、Wordpressのような<a href="#cms">CMS</a>サイトや<a href="#cdn">CDN</a>のようなサイトが原因である可能性は高いです。</p>
    <figure id="security-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/security/fig3.png">
        <img src="/static/images/2019/security/fig3.png" alt="図3. ホームページリクエストだけのTLSプロトコルバージョン使用状況。" aria-labelledby="security-fig3-caption" aria-describedby="security-fig3-description" width="760" height="470" data-width="760" data-height="470" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRCG3clMcnkVPrnZSCWFi3qG-EU00Qr8X3XaRFQPWHEXQmYWMxnS_kfmmyMQsPZe2P6ECjzCjG0dVFg/pubchart?oid=897771966&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="security-fig3-description" class="visually-hidden">横棒グラフは、デスクトップとモバイルの類似したTLSの使用状況を示しています。デスクトップでは47%(モバイルでは43%)がTLSv1.2、デスクトップでは20.2%(モバイルでは19.7%)がTLSv1.3を使用しており、TLSv1.0の使用量はほとんどなく(1.1%～1.2%)、TLSv1.1の使用量はわずかです。</div>
      <figcaption id="security-fig3-caption"><a href="#security-fig-3" class="anchor-link">図 3.</a> ホームページリクエストだけのTLSプロトコルバージョン使用状況。</figcaption>
    </figure>
    <p>一方で、Web Almanacが使用している<a href="#methodology">方法論</a>は、大規模サイトの利用状況を<em>過小評価</em>します。なぜなら、大規模サイトはそのサイト自体が現実世界ではより大きなインターネット・トラフィックを形成している可能性が高いにもかかわらず、これらの統計のために一度しかクロールされないからです。</p>
    <h3 id="security-証明書発行者"><a href="#security-証明書発行者" class="anchor-link">証明書発行者</a></h3>
    <p>もちろん、ウェブサイトでHTTPSを使用するには、認証局（CA）からの証明書が必要です。HTTPSの使用の増加に伴い、CAとその製品／サービスの使用も増加しています。ここでは、証明書を使用するTLSリクエストの量に基づいて、上位10社の証明書発行者を紹介します。</p>
    <figure id="security-fig-4">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>発行証明書発行局</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Google Internet Authority G3</td>
                <td>19.26%</td>
                <td>19.68%</td>
              </tr>
              <tr>
                <td>Let's Encrypt Authority X3</td>
                <td>10.20%</td>
                <td>9.19%</td>
              </tr>
              <tr>
                <td>DigiCert SHA2 High Assurance Server CA</td>
                <td>9.83%</td>
                <td>9.26%</td>
              </tr>
              <tr>
                <td>DigiCert SHA2 Secure Server CA</td>
                <td>7.55%</td>
                <td>8.72%</td>
              </tr>
              <tr>
                <td>GTS CA 1O1</td>
                <td>7.87%</td>
                <td>8.43%</td>
              </tr>
              <tr>
                <td>DigiCert SHA2 Secure Server CA</td>
                <td>7.55%</td>
                <td>8.72%</td>
              </tr>
              <tr>
                <td>COMODO RSA Domain Validation Secure Server CA</td>
                <td>6.29%</td>
                <td>5.79%</td>
              </tr>
              <tr>
                <td>Go Daddy Secure Certificate Authority - G2</td>
                <td>4.84%</td>
                <td>5.10%</td>
              </tr>
              <tr>
                <td>Amazon</td>
                <td>4.71%</td>
                <td>4.45%</td>
              </tr>
              <tr>
                <td>COMODO ECC Domain Validation Secure Server CA 2</td>
                <td>3.22%</td>
                <td>2.75%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-4" class="anchor-link">図 4.</a> 使用されている認証局トップ10。</figcaption>
    </figure>
    <p>前述したように、Googleのボリュームは他のサイトでGoogleアナリティクス、Google Adwords、またはGoogle Fontsを繰り返し使用していることを反映している可能性が高い。</p>
    <p>
      <a href="https://letsencrypt.org/ja/">Let's Encrypt<span class="fn">https://letsencrypt.org/ja/</span></a
      >の台頭は2016年初頭の開始後、急成長を遂げ、それ以来世界でもトップレベルの証明書発行局の1つになりました。無料の証明書の可用性と自動化されたツールは、ウェブ上でのHTTPSの採用に決定的に重要な役割を果たしています。Let's Encryptは、これらの両方において重要な役割を果たしています。
    </p>
    <p>
      コストの削減により、HTTPSへの参入障壁は取り除かれましたが、Let's Encryptが使用する自動化は証明書の寿命を短くできるため、長期的にはより重要であると思われます、<a href="https://scotthelme.co.uk/why-we-need-to-do-more-to-reduce-certificate-lifetimes/">これは多くのセキュリ ティ上のメリットがあります<span class="fn">https://scotthelme.co.uk/why-we-need-to-do-more-to-reduce-certificate-lifetimes/</span></a
      >。
    </p>
    <h3 id="security-認証キーの種類"><a href="#security-認証キーの種類" class="anchor-link">認証キーの種類</a></h3>
    <p>HTTPSを使用するという重要な要件と並行して、適切な構成を使用するという要件もあります。非常に多くの設定オプションと選択肢があるため、これは慎重にバランスを取る必要があります。</p>
    <p>まず、認証に使用される鍵について見ていきましょう。従来、証明書はRSAアルゴリズムを使用した鍵に基づいて発行されてきましたが、より新しく優れたアルゴリズムであるECDSA(Elliptic Curve Digital Signature Algorithm — 楕円曲線DSA) を使用しており、RSAアルゴリズムよりも優れた性能を発揮する小さな鍵の使用を可能にしています。私たちのクロールの結果を見ると、ウェブの大部分がRSAを使用していることがわかります。</p>
    <figure id="security-fig-5">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>キーの種類</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>RSA Keys</td>
                <td>48.67%</td>
                <td>58.8%</td>
              </tr>
              <tr>
                <td>ECDA Keys</td>
                <td>21.47%</td>
                <td>26.41%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-5" class="anchor-link">図 5.</a> 使用する認証キーの種類</figcaption>
    </figure>
    <p>ECDSA鍵はより強力な鍵であるため、より小さな鍵の使用が可能となりRSA鍵よりも優れたパフォーマンスを発揮しますが、下位互換性に関する懸念やその間の両方のサポートの複雑さが一部のウェブサイト運営者の移行を妨げる要因となっています。</p>
    <h3 id="security-forward-secrecy"><a href="#security-forward-secrecy" class="anchor-link">Forward secrecy</a></h3>
    <p>
      <a href="https://ja.wikipedia.org/wiki/Forward_secrecy">Forward secrecy<span class="fn">https://ja.wikipedia.org/wiki/Forward_secrecy</span></a
      >は将来サーバの秘密鍵が漏洩した場合でも、サーバへの各接続が公開されるのを防ぐような方法で接続を保護するいくつかの鍵交換メカニズムの特性です。これは、接続のセキュリティを保護するために全てのTLS接続で望ましい事として、セキュリティコミュニティ内ではよく理解されています。2008年にTLSv1.2でオプション設定として導入され、2018年にはTLSv1.3でForward Secrecyの使用が必須となりました。
    </p>
    <p>Forward Secrecyを提供するTLSリクエストの割合を見ると、サポートが非常に大きいことがわかります。デスクトップの96.92％、モバイルリクエストの96.49％がForward Secrecyを使用しています。TLSv1.3の採用が継続的に増加していることから、これらの数字はさらに増加すると予想されます。</p>
    <h3 id="security-暗号スイート"><a href="#security-暗号スイート" class="anchor-link">暗号スイート</a></h3>
    <p>
      TLSでは、さまざまな暗号スイートを使用できます。従来、TLSの新しいバージョンは暗号スイートを追加してきましたが、古い暗号スイートを削除することには消極的でした。TLSv1.3はこれを単純化するために、より少ない暗号スイートのセットを提供し、古い安全でない暗号スイートを使用することを許可しません。<a href="https://www.ssllabs.com/">SSL Labs<span class="fn">https://www.ssllabs.com/</span></a> のようなツールは、ウェブサイトのTLS設定 (サポートされている暗号スイートとその好ましい順序を含む) を簡単に見ることができ、より良い設定を促進するのに役立ちます。TLSリクエストのためにネゴシエートされた暗号化スイートの大部分は確かに優れたものであったことがわかります。
    </p>
    <figure id="security-fig-6">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>暗号スイート</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>AES_128_GCM</code></td>
                <td>75.87%</td>
                <td>76.71%</td>
              </tr>
              <tr>
                <td><code>AES_256_GCM</code></td>
                <td>19.73%</td>
                <td>18.49%</td>
              </tr>
              <tr>
                <td><code>AES_256_CBC</code></td>
                <td>2.22%</td>
                <td>2.26%</td>
              </tr>
              <tr>
                <td><code>AES_128_CBC</code></td>
                <td>1.43%</td>
                <td>1.72%</td>
              </tr>
              <tr>
                <td><code>CHACHA20_POLY1305</code></td>
                <td>0.69%</td>
                <td>0.79%</td>
              </tr>
              <tr>
                <td><code>3DES_EDE_CBC</code></td>
                <td>0.06%</td>
                <td>0.04%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-6" class="anchor-link">図 6.</a> 使用されている暗号スイートの使用法</figcaption>
    </figure>
    <p>
      古いCBC暗号は安全性が低いので、GCM暗号がこのように広く使われるようになったのはポジティブなことです。<a href="https://blog.cloudflare.com/it-takes-two-to-chacha-poly/">CHACHA20_POLY1305<span class="fn">https://blog.cloudflare.com/it-takes-two-to-chacha-poly/</span></a
      >はまだニッチな暗号スイートであり、私たちはまだ<a href="https://ja.wikipedia.org/wiki/%E3%83%88%E3%83%AA%E3%83%97%E3%83%ABDES#%E5%AE%89%E5%85%A8%E6%80%A7">安全でないトリプルDES暗号<span class="fn">https://ja.wikipedia.org/wiki/%E3%83%88%E3%83%AA%E3%83%97%E3%83%ABDES#%E5%AE%89%E5%85%A8%E6%80%A7</span></a
      >をごくわずかしか使っていません。
    </p>
    <p>
      これらはChromeを使ったクロールに使われた暗号化スイートですが、サイトは古いブラウザでも他の暗号化スイートをサポートしている可能性が高いことに注意してください。例えば<a href="https://www.ssllabs.com/ssl-pulse/">SSL Pulse<span class="fn">https://www.ssllabs.com/ssl-pulse/</span></a> などの他の情報源では、サポートされているすべての暗号スイートとプロトコルの範囲についてより詳細な情報を提供しています。
    </p>
    <h2 id="security-混合コンテンツ"><a href="#security-混合コンテンツ" class="anchor-link">混合コンテンツ</a></h2>
    <p>ウェブ上のほとんどのサイトは元々HTTPサイトとして存在しており、HTTPSにサイトを移行しなければなりませんでした。この「リフトアンドシフト」作業は難しく、時には見落としたり、取り残されたりすることもあります。その結果、ページはHTTPSで読み込まれているが、ページ上の何か（画像やスタイルなど）はHTTPで読み込まれているような、コンテンツが混在しているサイトが発生します。コンテンツが混在していると、セキュリティやプライバシーに悪影響を及ぼし、発見して修正するのが困難になることがあります。</p>
    <figure id="security-fig-7">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>混合コンテンツタイプ</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>任意のコンテンツが混在しているページ</td>
                <td>16.27%</td>
                <td>15.37%</td>
              </tr>
              <tr>
                <td>アクティブな混合コンテンツのページ</td>
                <td>3.99%</td>
                <td>4.13%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-7" class="anchor-link">図 7.</a> 混在コンテンツの利用状況。</figcaption>
    </figure>
    <p>モバイル（645,485サイト）とデスクトップ（594,072サイト）では、約20％のサイトが何らかの形で混合コンテンツを表示していることがわかります。画像のようなパッシブな混合コンテンツの危険性は低いですが、混合コンテンツを持つサイトのほぼ4分の1がアクティブな混合コンテンツを持っていることがわかります。JavaScriptのようなアクティブな混合コンテンツは、攻撃者が自分の敵対的なコードを簡単にページに挿入できるため、より危険です。</p>
    <p>
      これまでのウェブブラウザは、受動的な混合コンテンツを許可して警告を表示していたが、能動的な混合コンテンツはブロックしていた。しかし最近では、Chrome<a href="https://blog.chromium.org/2019/10/no-more-mixed-messages-about-https.html">発表<span class="fn">https://blog.chromium.org/2019/10/no-more-mixed-messages-about-https.html</span></a> はこの点を改善し、HTTPSが標準になるにつれて代わりにすべての混合コンテンツをブロックすることを意図しています。
    </p>
    <h2 id="security-セキュリティヘッダ"><a href="#security-セキュリティヘッダ" class="anchor-link">セキュリティヘッダ</a></h2>
    <p>
      サイト運営者がユーザーをより良く保護するための多くの新しい機能が、ブラウザに組み込まれたセキュリティ保護を設定したり制御したりできる新しいHTTPレスポンスヘッダの形で提供されています。これらの機能の中には、簡単に有効にして大きなレベルの保護を提供するものもあれば、サイト運営者が少し作業を必要とするものもあります。サイトがこれらのヘッダを使用しており、正しく設定されているかどうかを確認したい場合は、<a href="https://securityheaders.com/">Security Headers<span class="fn">https://securityheaders.com/</span></a
      >ツールを使用してスキャンできます。
    </p>
    <figure id="security-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/security/fig8.png">
        <img src="/static/images/2019/security/fig8.png" alt="図8. セキュリティヘッダの使用法" aria-labelledby="security-fig8-caption" aria-describedby="security-fig8-description" width="760" height="450" data-width="760" data-height="450" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRCG3clMcnkVPrnZSCWFi3qG-EU00Qr8X3XaRFQPWHEXQmYWMxnS_kfmmyMQsPZe2P6ECjzCjG0dVFg/pubchart?oid=2029255231&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="security-fig8-description" class="visually-hidden">デスクトップ、モバイルともに、左から順にセキュリティヘッダリストの使用量が増加していることを縦棒グラフで示しています。左から順に、Cross-origin-resource-policy(両方とも0サイト)、feature policy(デスクトップとモバイルで約8k)、report-to(デスクトップで74k、モバイルで83k)、nel(デスクトップで74k、モバイルで83k)、referrer-policy(デスクトップで142k、モバイルで156k)、content-security-policy(デスクトップで240k)のリストです。252k モバイル）、strict-transport-security（648k デスクトップ、679k モバイル）、x-xss-protection（642k デスクトップ、805k モバイル）、x-frame-options（743k デスクトップ、782k モバイル）、そして最後にx-content-type-options（770k デスクトップ、932k モバイル）です。</div>
      <figcaption id="security-fig8-caption"><a href="#security-fig-8" class="anchor-link">図 8.</a> セキュリティヘッダの使用法</figcaption>
    </figure>
    <h3 id="security-http-strict-transport-security"><a href="#security-http-strict-transport-security" class="anchor-link">HTTP Strict Transport Security</a></h3>
    <p>
      <a href="https://tools.ietf.org/html/rfc6797">HSTS<span class="fn">https://tools.ietf.org/html/rfc6797</span></a> ヘッダーは、Webサイトがブラウザに、安全なHTTPS接続でのみサイトと通信するように指示することを可能にします。これは、http:// URLを使用しようとする試みは、リクエストが行われる前に自動的にhttps://に変換されることを意味します。リクエストの40％以上がTLSを使用できることを考えると、要求するようにブラウザに指示しているリクエストの割合はかなり低いと考えられます。
    </p>
    <figure id="security-fig-9">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>HSTSディレクティブ</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>max-age</code></td>
                <td>14.80%</td>
                <td>12.81%</td>
              </tr>
              <tr>
                <td><code>includeSubDomains</code></td>
                <td>3.86%</td>
                <td>3.29%</td>
              </tr>
              <tr>
                <td><code>preload</code></td>
                <td>2.27%</td>
                <td>1.99%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-9" class="anchor-link">図 9.</a> HSTS ディレクティブの使用法</figcaption>
    </figure>
    <p>モバイルページやデスクトップページの15％未満が<code>max-age</code>ディレクティブ付きのHSTSを発行しています。これは有効なポリシーの最低条件です。また、<code>includeSubDomains</code>ディレクティブでサブドメインをポリシーに含めているページはさらに少なく、HSTSのプリロードを行っているページはさらに少ないです。HSTSの<code>max-age</code>の中央値を見ると、これを使用している場合はデスクトップとモバイルの両方で15768000となっており、半年(60X60X24X365/2)に相当する強力な設定であることがわかります。</p>
    <figure id="security-fig-10">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="colgroup" colspan="2">クライアント</th>
              </tr>
              <tr>
                <th scope="col">パーセンタイル</th>
                <th scope="col">デスクトップ</th>
                <th scope="col">モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>10</td>
                <td>300</td>
                <td>300</td>
              </tr>
              <tr>
                <td>25</td>
                <td>7889238</td>
                <td>7889238</td>
              </tr>
              <tr>
                <td>50</td>
                <td>15768000</td>
                <td>15768000</td>
              </tr>
              <tr>
                <td>75</td>
                <td>31536000</td>
                <td>31536000</td>
              </tr>
              <tr>
                <td>90</td>
                <td>63072000</td>
                <td>63072000</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <figcaption><a href="#security-fig-10" class="anchor-link">図 10.</a> HSTSの`max-age`ポリシーのパーセンタイル別の中値。</figcaption>
    </figure>
    <h4 id="security-hstsプリロード"><a href="#security-hstsプリロード" class="anchor-link">HSTSプリロード</a></h4>
    <p>
      HTTPレスポンスヘッダーを介して配信されるHSTSポリシーでは、初めてサイトを訪れたときに、ブラウザはポリシーが設定されているかどうかを知ることができません。この<a href="https://en.wikipedia.org/wiki/Trust_on_first_use">初回使用時の信頼<span class="fn">https://en.wikipedia.org/wiki/Trust_on_first_use</span></a
      >の問題を回避するために、サイト運営者はブラウザ(または他のユーザーエージェント)にポリシーをプリロードしておくことができます。
    </p>
    <p>
      プリロードにはいくつかの要件があり、<a href="https://hstspreload.org/">HSTSプリロード<span class="fn">https://hstspreload.org/</span></a
      >サイトで概要が説明されています。現在の基準では、デスクトップでは0.31％、モバイルでは0.26％というごく少数のサイトしか対象としていないことがわかる。サイトは、ドメインをプリロードするために送信する前、ドメインの下にあるすべてのサイトをHTTPSに完全に移行させておく必要があります。
    </p>
    <h3 id="security-コンテンツセキュリティポリシー"><a href="#security-コンテンツセキュリティポリシー" class="anchor-link">コンテンツセキュリティポリシー</a></h3>
    <p>
      ウェブアプリケーションは、敵対的なコンテンツがページへ挿入される攻撃に頻繁に直面しています。最も心配なコンテンツはJavaScriptであり、攻撃者がJavaScriptをページに挿入する方法を見つけると、有害な攻撃を実行できます。これらの攻撃は<a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0">クロスサイトスクリプティング(XSS)<span class="fn">https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0</span></a
      >として知られており、<a href="https://www.w3.org/TR/CSP2/">コンテンツセキュリティポリシー(CSP)<span class="fn">https://www.w3.org/TR/CSP2/</span></a> はこれらの攻撃に対する効果的な防御策を提供しています。
    </p>
    <p>CSPとは、ウェブサイトが公開しているHTTPヘッダ(<code>Content-Security-Policy</code>)のことで、サイトで許可されているコンテンツに関するルールをブラウザに伝えるものです。セキュリティ上の欠陥のために追加のコンテンツがサイトに注入され、それがポリシーで許可されていない場合、ブラウザはそのコンテンツの使用をブロックします。XSS保護の他にも、CSPは、<a href="#security-upgrade-insecure-requests">HTTPSへの移行を容易にする</a>など、いくつかの重要な利点を提供しています。</p>
    <p>
      CSPの多くの利点にもかかわらず、その非常に目的がページ上で許容されるものを制限することであるため、ウェブサイトに実装することは複雑になる可能性があります。ポリシーは必要なすべてのコンテンツやリソースを許可しなければならず、大きく複雑になりがちです。<a href="https://report-uri.com/">レポートURI<span class="fn">https://report-uri.com/</span></a
      >のようなツールは、適切なポリシーを分析して構築するのに役立ちます。
    </p>
    <p>デスクトップページのわずか5.51％にCSPが含まれ、モバイルページのわずか4.73％にCSPが含まれていることがわかりましたが、これは展開の複雑さが原因と思われます。</p>
    <h4 id="security-ハッシュノンス"><a href="#security-ハッシュノンス" class="anchor-link">ハッシュ/ノンス</a></h4>
    <p>
      CSPの一般的なアプローチは、JavaScriptなどのコンテンツをページにロードすることを許可されているサードパーティドメインのホワイトリストを作成することです。これらのホワイトリストの作成と管理は困難な場合があるため、<a href="https://www.w3.org/TR/CSP2/#source-list-valid-hashes">ハッシュ<span class="fn">https://www.w3.org/TR/CSP2/#source-list-valid-hashes</span></a
      >と<a href="https://www.w3.org/TR/CSP2/#source-list-valid-nonces">ノンス<span class="fn">https://www.w3.org/TR/CSP2/#source-list-valid-nonces</span></a
      >が代替的なアプローチとして導入されました。ハッシュはスクリプトの内容に基づいて計算されるので、ウェブサイト運営者が公開しているスクリプトが変更されたり、別のスクリプトが追加されたりするとハッシュと一致せずブロックされてしまいます。ノンスは、CSPによって許可され、スクリプトにタグが付けられているワンタイムコード(ページが読み込まれるたびに変更され推測されるのを防ぐ必要があります)です。このページのノンスの例は、ソースを見てGoogle Tag Managerがどのように読み込まれているかを見ることで見ることができます。
    </p>
    <p>調査対象となったサイトのうち、ノンスソースを使用しているのはデスクトップページで0.09％、ハッシュソースを使用しているのはデスクトップページで0.02％にとどまっている。モバイルページではノンスソースを使用しているサイトは0.13%とやや多いが、ハッシュソースの使用率は0.01%とモバイルページの方が低い。</p>
    <h4 id="security-strict-dynamic">
      <a href="#security-strict-dynamic" class="anchor-link"><code>strict-dynamic</code></a>
    </h4>
    <p>
      <a href="https://www.w3.org/TR/CSP3/">CSP<span class="fn">https://www.w3.org/TR/CSP3/</span></a
      >の次のイテレーションにおける<a href="https://www.w3.org/TR/CSP3/#strict-dynamic-usage"><code>strict-dynamic</code><span class="fn">https://www.w3.org/TR/CSP3/#strict-dynamic-usage</span></a
      >の提案は、ホワイトリスト化されたスクリプトがさらにスクリプトの依存性をロードできるようにすることで、CSPを使用するためのサイト運営者の負担をさらに軽減します。すでに<a href="https://caniuse.com/#feat=mdn-http_headers_csp_content-security-policy_strict-dynamic">いくつかの最新ブラウザでサポート<span class="fn">https://caniuse.com/#feat=mdn-http_headers_csp_content-security-policy_strict-dynamic</span></a
      >されているこの機能の導入にもかかわらず、ポリシーにこの機能を含めるのは、デスクトップページの0.03％とモバイルページの0.1％にすぎません。
    </p>
    <h4 id="security-trusted-types">
      <a href="#security-trusted-types" class="anchor-link"><code>trusted-types</code></a>
    </h4>
    <p>
      XSS攻撃には様々な形がありますが、<a href="https://github.com/w3c/webappsec-trusted-types">Trusted-Types<span class="fn">https://github.com/w3c/webappsec-trusted-types</span></a
      >はDOM-XSSに特化して作られました。効果的なメカニズムであるにもかかわらず、私たちのデータによると、モバイルとデスクトップの2つのページだけがTrusted-Typesディレクティブを使用しています。
    </p>
    <h4 id="security-unsafe-inlineとunsafe-eval">
      <a href="#security-unsafe-inlineとunsafe-eval" class="anchor-link"><code>unsafe inline</code>と<code>unsafe-eval</code></a>
    </h4>
    <p>CSPがページにデプロイされると、インラインスクリプトや<code>eval()</code>の使用のような特定の安全でない機能は無効化されます。ページはこれらの機能に依存し、安全な方法で、おそらくノンスやハッシュソースを使ってこれらの機能を有効にできます。サイト運営者は、<code>unsafe-inline</code>や<code>unsafe-eval</code>を使って、これらの安全でない機能をCSPで再有効にすることもできますが、その名前が示すようにそうすることでCSPが提供する保護の多くを失うことになります。CSPを含むデスクトップページの5.51％のうち、33.94％が<code>unsafe-inline</code>を、31.03％が<code>unsafe-eval</code>を含んでいます。モバイルページでは、CSPを含む4.73％のうち、34.04％が<code>unsafe-inline</code>を使用し、31.71％が<code>unsafe-eval</code>を使用していることがわかります。</p>
    <h4 id="security-upgrade-insecure-requests">
      <a href="#security-upgrade-insecure-requests" class="anchor-link"><code>upgrade-insecure-requests</code></a>
    </h4>
    <p>先に、サイト運営者がHTTPからHTTPSへの移行で直面する共通の問題として、一部のコンテンツがHTTPSページのHTTP上に誤って読み込まれてしまう可能性があることを述べました。この問題は混合コンテンツとして知られており、CSPはこの問題を解決する効果的な方法を提供します。upgrade-insecure-requests`ディレクティブは、ブラウザにページ上のすべてのサブリソースを安全な接続で読み込むように指示し、例としてHTTPリクエストをHTTPSリクエストに自動的にアップグレードします。ページ上のサブリソースのためのHSTSのようなものと考えてください。</p>
    <p>先に図7で示したように、デスクトップで調査したHTTPSページのうち、16.27％のページが混合コンテンツを読み込んでおり、3.99％のページがJS/CSS/fontsなどのアクティブな混合コンテンツを読み込んでいることがわかる。モバイルページでは、HTTPSページの15.37％が混合コンテンツを読み込み、4.13％がアクティブな混合コンテンツを読み込みました。HTTP上でJavaScriptなどのアクティブなコンテンツを読み込むことで、攻撃者は簡単に敵対的なコードをページに注入して攻撃を開始できます。これは、CSPの<code>upgrade-insecure-requests</code> ディレクティブが防御しているものです。</p>
    <p><code>upgrade-insecure-requests</code>ディレクティブは、デスクトップページの3.24％とモバイルページの2.84％のCSPに含まれており、採用が増えることで大きな利益が得られることを示しています。以下のようなポリシーで、幅広いカテゴリをホワイトリスト化し、<code>unsafe-inline</code>や<code>unsafe-eval</code>を含めることで、完全にロックダウンされたCSPや複雑さを必要とせずに比較的簡単に導入できます。</p>
    <pre><code>Content-Security-Policy: upgrade-insecure-requests; default-src https:</code></pre>
    <h4 id="security-frame-ancestors">
      <a href="#security-frame-ancestors" class="anchor-link"><code>frame-ancestors</code></a>
    </h4>
    <p>
      <a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%82%B8%E3%83%A3%E3%83%83%E3%82%AD%E3%83%B3%E3%82%B0">クリックジャッキング<span class="fn">https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%82%B8%E3%83%A3%E3%83%83%E3%82%AD%E3%83%B3%E3%82%B0</span></a
      >として知られているもう1つの一般的な攻撃は、敵対するウェブサイトのiframeの中にターゲットのウェブサイトを配置し、自分たちがコントロールしている隠しコントロールやボタンをオーバーレイする攻撃者によって行われます。<code>X-Frame-Options</code>ヘッダー(後述)はもともとフレームを制御することを目的としていましたが、柔軟性がなく、CSPの<code>frame-ancestors</code>はより柔軟なソリューションを提供するために介入しました。サイト運営者は、フレーム化を許可するホストのリストを指定できるようになり、他のホストがフレーム化しようとするのを防ぐことができるようになりました。
    </p>
    <p>調査したページのうち、デスクトップページの2.85％がCSPで<code>frame-ancestors</code>ディレクティブを使用しており、デスクトップページの0.74％がframe-Ancestorsを<code>'none'</code>に設定してフレーミングを禁止し、0.47％のページが<code>frame-ancestors</code>を<code>'self'</code>に設定して自分のサイトのみがフレーミングできるようにしています。モバイルでは2.52％のページが<code>frame-ancestors</code>を使用しており、0.71％が<code>'none'</code>を設定し、0.41％が<code>self'</code>を設定しています。</p>
    <h3 id="security-参照元ポリシー"><a href="#security-参照元ポリシー" class="anchor-link">参照元ポリシー</a></h3>
    <p>
      <a href="https://www.w3.org/TR/referrer-policy/"><code>Referrer-Policy</code><span class="fn">https://www.w3.org/TR/referrer-policy/</span></a
      >ヘッダーは、ユーザーが現在のページから離れた場所へ移動したとき、<code>Refererer</code>ヘッダーにどのような情報を送るかをサイトが制御することを可能とします。これは、検索クエリやURLパラメータに含まれるその他のユーザー依存情報など、URLに機密データが含まれている場合、情報漏洩の原因となる可能性があります。<code>Referer</code>ヘッダで送信される情報を制御し、理想的には制限することで、サイトはサードパーティに送信される情報を減らすことで訪問者のプライバシーを保護できます。
    </p>
    <p>
      リファラーポリシーは<code>Refererer</code>ヘッダのスペルミス<a href="https://stackoverflow.com/questions/3087626/was-the-misspelling-of-the-http-field-name-referer-intentional">これはよく知られたエラーとなっています<span class="fn">https://stackoverflow.com/questions/3087626/was-the-misspelling-of-the-http-field-name-referer-intentional</span></a
      >に従っていないことに注意してください。
    </p>
    <p>デスクトップページの3.25％とモバイルページの2.95%が<code>Referrerer-Policy</code>ヘッダを発行しています。</p>
    <figure id="security-fig-11">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>設定</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>no-referrer-when-downgrade</code></td>
                <td>39.16%</td>
                <td>41.52%</td>
              </tr>
              <tr>
                <td><code>strict-origin-when-cross-origin</code></td>
                <td>39.16%</td>
                <td>22.17%</td>
              </tr>
              <tr>
                <td><code>unsafe-url</code></td>
                <td>22.17%</td>
                <td>22.17%</td>
              </tr>
              <tr>
                <td><code>same-origin</code></td>
                <td>7.97%</td>
                <td>7.97%</td>
              </tr>
              <tr>
                <td><code>origin-when-cross-origin</code></td>
                <td>6.76%</td>
                <td>6.44%</td>
              </tr>
              <tr>
                <td><code>no-referrer</code></td>
                <td>5.65%</td>
                <td>5.38%</td>
              </tr>
              <tr>
                <td><code>strict-origin</code></td>
                <td>4.35%</td>
                <td>4.14%</td>
              </tr>
              <tr>
                <td><code>origin</code></td>
                <td>3.63%</td>
                <td>3.23%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-11" class="anchor-link">図 11.</a> <code>Referrer-Policy</code> 設定オプションの使用法。</figcaption>
    </figure>
    <p>
      この表はページによって設定された有効な値を示しており、このヘッダーを使用するページのうち、デスクトップでは99.75％、モバイルでは96.55％のページが有効なポリシーを設定していることがわかる。最も人気のある設定は<code>no-referrer-when-downgrade</code>で、これはユーザがHTTPSページからHTTPページに移動する際<code>Refererer</code>ヘッダが送信されないようにするものです。2番目に人気のある選択は<code>strict-origin-when-cross-origin</code>で、これはスキームのダウングレード(HTTPSからHTTPナビゲーション)時に情報が送信されるのを防ぎ、<code>Refererer</code>で情報が送信される際にはソースのオリジンのみを含み、完全なURLは含まれません(例えば、<code>https://www.example.com/page/</code>ではなく<code>https://www.example.com</code>)。その他の有効な設定の詳細は、<a href="https://www.w3.org/TR/referrer-policy/#referrer-policies">Referrerer Policy specification<span class="fn">https://www.w3.org/TR/referrer-policy/#referrer-policies</span></a
      >に記載されています、<code>unsafe-url</code>の多用はさらなる調査を必要としますが、アナリティクスや広告ライブラリのような<a href="#third-parties">サードパーティ</a>コンポーネントである可能性が高いです。
    </p>
    <h3 id="security-機能方針"><a href="#security-機能方針" class="anchor-link">機能方針</a></h3>
    <p>
      ウェブプラットフォームがより強力で機能も豊富になるにつれ、攻撃者はこれらの新しいAPIを興味深い方法で悪用できるようになります。強力なAPIの悪用を制限するために、サイト運営者は<a href="https://w3c.github.io/webappsec-feature-policy/"><code>Feature-Policy</code><span class="fn">https://w3c.github.io/webappsec-feature-policy/</span></a
      >ヘッダを発行して必要のない機能を無効化し、悪用されるのを防ぐことができます。
    </p>
    <p>ここでは、機能方針で管理されている人気の高い5つの機能をご紹介します。</p>
    <figure id="security-fig-12">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>機能</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>microphone</code></td>
                <td>10.78%</td>
                <td>10.98%</td>
              </tr>
              <tr>
                <td><code>camera</code></td>
                <td>9.95%</td>
                <td>10.19%</td>
              </tr>
              <tr>
                <td><code>payment</code></td>
                <td>9.54%</td>
                <td>9.54%</td>
              </tr>
              <tr>
                <td><code>geolocation</code></td>
                <td>9.38%</td>
                <td>9.41%</td>
              </tr>
              <tr>
                <td><code>gyroscope</code></td>
                <td>7.92%</td>
                <td>7.90%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-12" class="anchor-link">図 12.</a> 使用される <code>Feature-Policy</code> オプションの上位5つ。</figcaption>
    </figure>
    <p>コントロールできる最も人気のある機能はマイクで、デスクトップとモバイルページのほぼ11％がマイクを含むポリシーを発行していることがわかります。データを掘り下げていくと、これらのページが何を許可しているか、またはブロックしているかを見ることができます。</p>
    <figure id="security-fig-13">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>機能</th>
                <th>設定</th>
                <th>使用率</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>microphone</code></td>
                <td><code>none</code></td>
                <td>9.09%</td>
              </tr>
              <tr>
                <td><code>microphone</code></td>
                <td><code>none</code></td>
                <td>8.97%</td>
              </tr>
              <tr>
                <td><code>microphone</code></td>
                <td><code>self</code></td>
                <td>0.86%</td>
              </tr>
              <tr>
                <td><code>microphone</code></td>
                <td><code>self</code></td>
                <td>0.85%</td>
              </tr>
              <tr>
                <td><code>microphone</code></td>
                <td><code>*</code></td>
                <td>0.64%</td>
              </tr>
              <tr>
                <td><code>microphone</code></td>
                <td><code>*</code></td>
                <td>0.53%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-13" class="anchor-link">図 13.</a> マイク機能の設定.</figcaption>
    </figure>
    <p>圧倒的に最も一般的なアプローチは、ここではそのアプローチを取っているページの約9％で、完全にマイクの使用をブロックすることです。少数のページでは、独自のオリジンによるマイクの使用を許可しており、興味深いことにページ内のコンテンツを読み込んでいる任意のオリジンによるマイクの使用を意図的に許可しているページの少数選択があります。</p>
    <h3 id="security-x-frame-options">
      <a href="#security-x-frame-options" class="anchor-link"><code>X-Frame-Options</code></a>
    </h3>
    <p>
      <a href="https://tools.ietf.org/html/rfc7034"><code>X-Frame-Options</code><span class="fn">https://tools.ietf.org/html/rfc7034</span></a
      >ヘッダーは、ページが別のページでiframeに配置できるかどうかを制御することを可能にします。上述したCSPの<code>frame-ancestors</code>の柔軟性には欠けますが、フレームの細かい制御を必要としない場合には効果的です。
    </p>
    <p>デスクトップ(16.99％)とモバイル(14.77％)の両方で<code>X-Frame-Options</code>ヘッダの使用率が非常に高いことがわかります。</p>
    <figure id="security-fig-14">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>設定</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>sameorigin</code></td>
                <td>84.92%</td>
                <td>83.86%</td>
              </tr>
              <tr>
                <td><code>deny</code></td>
                <td>13.54%</td>
                <td>14.50%</td>
              </tr>
              <tr>
                <td><code>allow-from</code></td>
                <td>1.53%</td>
                <td>1.64%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-14" class="anchor-link">図 14.</a> 使用される <code>X-Frame-Options</code> の設定。</figcaption>
    </figure>
    <p>
      大多数のページでは、そのページのオリジンのみにフレーミングを制限しているようで、次の重要なアプローチはフレーミングを完全に防止することです。これはCSPの<code>frame-ancestors</code>と似ており、これら2つのアプローチが最も一般的です。また、<code>allow-from</code>オプションは、理論的にはサイト所有者がフレーム化を許可するサードパーティのドメインをリストアップできるようにするものですが、<a href="https://developer.mozilla.org/ja/docs/Web/HTTP/X-Frame-Options#Browser_compatibility">決して十分にサポートされていないので<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTTP/X-Frame-Options#Browser_compatibility</span></a
      >、非推奨とされています。
    </p>
    <h3 id="security-x-content-type-options">
      <a href="#security-x-content-type-options" class="anchor-link"><code>X-Content-Type-Options</code></a>
    </h3>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/X-Content-Type-Options"><code>X-Content-Type-Options</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/X-Content-Type-Options</span></a
      >ヘッダは最も広く展開されているセキュリティヘッダであり、最もシンプルであり、設定可能な値は<code>nosniff</code>のみです。このヘッダが発行されると、ブラウザはコンテンツの一部を<code>Content-Type</code>ヘッダで宣言されたMIMEタイプとして扱わなければならず、ファイルが異なるタイプのものであることを示唆したときに値を変更しようとはしません。ブラウザが誤ってタイプを嗅ぎ取るように説得された場合、さまざまなセキュリティ上の欠陥が導入される可能性となります。
    </p>
    <p>モバイルとデスクトップの両方で、17.61％のページが<code>X-Content-Type-Options</code>ヘッダを発行していることがわかりました。</p>
    <h3 id="security-x-xss-protection">
      <a href="#security-x-xss-protection" class="anchor-link"><code>X-XSS-Protection</code></a>
    </h3>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/X-XSS-Protection">X-XSS-Protection`<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/X-XSS-Protection</span></a
      >ヘッダーは、サイトがブラウザに組み込まれたXSS AuditorやXSS Filterを制御することを可能にし、理論的には何らかのXSS保護を提供するはずです。
    </p>
    <p>デスクトップリクエストの14.69％とモバイルリクエストの15.2％が<code>X-XSS-Protection</code>ヘッダを使用していた。データを掘り下げてみると、ほとんどのサイト運営者がどのような意図を持っているかが図13に示されています。</p>
    <figure id="security-fig-15">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>設定</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>1;mode=block</code></td>
                <td>91.77%</td>
                <td>91.46%</td>
              </tr>
              <tr>
                <td><code>1</code></td>
                <td>5.54%</td>
                <td>5.35%</td>
              </tr>
              <tr>
                <td><code>0</code></td>
                <td>2.58%</td>
                <td>3.11%</td>
              </tr>
              <tr>
                <td><code>1;report=</code></td>
                <td>0.12%</td>
                <td>0.09%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-15" class="anchor-link">図 15.</a> <code>X-XSS-Protection</code> の利用設定。</figcaption>
    </figure>
    <p>値<code>1</code>はフィルタ/監査を有効にし、<code>mode=block</code>は(理論的には)XSS攻撃が疑われる場合にページを表示しないような最も強い保護を設定します。2番目に多かった設定は、単に監査/フィルタがオンになっていることを確認するために<code>1</code>という値を提示したもので、3番目に多かった設定は非常に興味深いものでした。</p>
    <p>ヘッダーに<code>0</code>の値を設定すると、ブラウザが持っている可能性のあるXSSの監査やフィルタを無効にするように指示します。歴史的な攻撃の中には監査やフィルタがユーザーを保護するのではなく、攻撃者を助けるように騙されてしまうことが実証されているものもあるのでサイト運営者の中には、XSSに対する十分な保護があると確信している場合にそれを無効にできるものもあります。</p>
    <p>これらの攻撃のため、EdgeはXSSフィルタを引退させ、ChromeはXSS監査を非推奨とし、Firefoxはこの機能のサポートを実装しませんでした。現在ではほとんど役に立たなくなっているにもかかわらず、現在でも全サイトの約15％でヘッダーが広く使われています。</p>
    <h3 id="security-report-to"><a href="#security-report-to" class="anchor-link">Report-To</a></h3>
    <p>
      <a href="https://www.w3.org/TR/reporting/">Reporting API<span class="fn">https://www.w3.org/TR/reporting/</span></a> は、サイト運営者が<a href="https://scotthelme.co.uk/introducing-the-reporting-api-nel-other-major-changes-to-report-uri/">ブラウザからの遠隔測定<span class="fn">https://scotthelme.co.uk/introducing-the-reporting-api-nel-other-major-changes-to-report-uri/</span></a
      >の様々な情報を収集できるようにするため導入されました。サイト上の多くのエラーや問題は、ユーザーの体験を低下させる可能性がありますが、サイト運営者はユーザーが連絡しなければ知ることができません。Reporting APIは、ユーザーの操作や中断なしに、ブラウザがこれらの問題を自動的に報告するメカニズムを提供します。Reporting APIは<code>Report-To</code>ヘッダーを提供することで設定されます。
    </p>
    <p>
      遠隔測定を送信すべき場所を含むヘッダーを指定することでブラウザは自動的にデータの送信を開始し、<a href="https://report-uri.com/">Report URI<span class="fn">https://report-uri.com/</span></a
      >のようなサードパーティのサービスを使用してレポートを収集したり、自分で収集したりできます。導入と設定の容易さを考えると、現在この機能を有効にしているサイトは、デスクトップ（1.70％）とモバイル（1.57％）のごく一部に過ぎないことがわかります。収集できるテレメトリの種類については、<a href="https://www.w3.org/TR/reporting/">Reporting API仕様<span class="fn">https://www.w3.org/TR/reporting/</span></a
      >を参照してください。
    </p>
    <h3 id="security-ネットワークエラーロギング"><a href="#security-ネットワークエラーロギング" class="anchor-link">ネットワークエラーロギング</a></h3>
    <p>
      <a href="https://www.w3.org/TR/network-error-logging/">ネットワークエラーロギング(NEL)<span class="fn">https://www.w3.org/TR/network-error-logging/</span></a
      >は、サイトが動作不能になる可能性のあるブラウザのさまざまな障害についての詳細な情報を提供します。<code>Report-To</code>が読み込まれたページの問題を報告するために使用されるのに対し、<code>NEL</code>ヘッダーを使用すると、サイトはブラウザにこのポリシーをキャッシュするように通知し、将来の接続問題が発生したときに上記の<code>Reporting-To</code>ヘッダーで設定されたエンドポイントを介して報告できます。したがって、NELはReporting APIの拡張機能とみなすことができます。
    </p>
    <p>もちろん、NELはReporting APIに依存しているので、NELの使用量がReporting APIの使用量を上回ることはありません。これらの数値が同じであるという事実は、これらが一緒にデプロイされていることを示唆しています。</p>
    <p>
      NELは信じられないほど貴重な情報を提供しており、情報の種類については<a href="https://w3c.github.io/network-error-logging/#predefined-network-error-types">ネットワークエラーロギング仕様<span class="fn">https://w3c.github.io/network-error-logging/#predefined-network-error-types</span></a
      >で詳しく説明しています。
    </p>
    <h3 id="security-クリアサイトデータ"><a href="#security-クリアサイトデータ" class="anchor-link">クリアサイトデータ</a></h3>
    <p>
      クッキー、キャッシュ、ローカルストレージなどを介してユーザーのデバイスにデータをローカルに保存する機能が増えているため、サイト運営者はこのデータを管理する信頼性の高い方法を必要としていました。Clear Site Dataヘッダーは、特定のタイプのすべてのデータがデバイスから削除されることを確実にする手段を提供しますが、<a href="https://caniuse.com/#feat=mdn-http_headers_clear-site-data">すべてのブラウザではまだサポートされていません<span class="fn">https://caniuse.com/#feat=mdn-http_headers_clear-site-data</span></a
      >。
    </p>
    <p>このヘッダの性質を考えると、使用量がほとんど報告されていないのは驚くに値しません。デスクトップリクエストが9件、モバイルリクエストが7件だけです。私たちのデータはサイトのホームページしか見ていないので、ログアウトのエンドポイントでヘッダーが最もよく使われているのを見ることはないでしょう。サイトからログアウトすると、サイト運営者はClear Site Dataヘッダを返し、ブラウザは指定されたタイプのすべてのデータを削除します。これはサイトのホームページでは行われないでしょう。</p>
    <h2 id="security-クッキー"><a href="#security-クッキー" class="anchor-link">クッキー</a></h2>
    <p>クッキーには利用可能な多くのセキュリティ保護があり、それらのいくつかは長年にわたって利用可能であるが、それらのいくつかは本当に非常に新しいものでありここ数年の間に導入されただけです。</p>
    <h3 id="security-secure">
      <a href="#security-secure" class="anchor-link"><code>Secure</code></a>
    </h3>
    <p>クッキーの<code>Secure</code>フラグは、ブラウザに安全な(HTTPS)接続でのみクッキーを送信するように指示し、ホームページでセキュアフラグが設定されたクッキーを発行しているサイトはごくわずかな割合(デスクトップでは4.22％、モバイルでは3.68％)であることがわかります。この機能が比較的簡単に使用できることを考えると、これは憂慮すべきことです。繰り返しになりますが、HTTPとHTTPSの両方でデータを収集したいと考えている分析や広告<a href="#third-parties">サードパーティ</a>リクエストの高い使用率がこれらの数字を歪めている可能性が高く、認証クッキーのような他のクッキーでの使用状況を見るのは興味深い調査でしょう。</p>
    <h3 id="security-httponly">
      <a href="#security-httponly" class="anchor-link"><code>HttpOnly</code></a>
    </h3>
    <p>クッキーの<code>HttpOnly</code>フラグはブラウザにページ上のJavaScriptがクッキーへアクセスできなくすることを指示します。多くのクッキーはサーバによってのみ使用されるので、ページ上のJavaScriptが必要としないため、クッキーへのアクセスを制限することはクッキーを盗むXSS攻撃からの大きな防御となります。デスクトップでは24.24％、モバイルでは22.23％と、ホームページ上でこのフラグを立ててクッキーを発行しているサイトの方がはるかに多いことがわかります。</p>
    <h3 id="security-samesite">
      <a href="#security-samesite" class="anchor-link"><code>SameSite</code></a>
    </h3>
    <p>
      クッキーの保護に追加された最近の追加機能として、<code>SameSite</code>フラグは <a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%AA">クロスサイトリクエストフォージェリ(CSRF)<span class="fn">https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%AA</span></a
      >攻撃(XSRFとしてもよく知られています)に対する強力な保護となります。
    </p>
    <p>これらの攻撃は、ブラウザが通常、すべてのリクエストに関連するクッキーを含むという事実を利用して動作します。したがって、ログインしていてクッキーが設定されていて、悪意のあるサイトを訪問した場合、APIを呼び出すことができブラウザは「親切に」クッキーを送信します。クッキーに<code>SameSite</code>属性を追加することで、第三者のサイトからの呼び出しがあった場合にクッキーを送信しないようにウェブサイトがブラウザに通知し、攻撃を失敗させることができます。</p>
    <p>最近導入されたメカニズムなので、デスクトップとモバイルの両方でリクエストの0.1％と予想されるように、同じサイトのクッキーの使用率ははるかに低くなっています。クッキーがクロスサイトで送信されるべき使用例があります。例えば、シングルサインオンサイトは認証トークンと一緒にクッキーを設定することで暗黙のうちに動作します。</p>
    <figure id="security-fig-16">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>設定</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>strict</code></td>
                <td>53.14%</td>
                <td>50.64%</td>
              </tr>
              <tr>
                <td><code>lax</code></td>
                <td>45.85%</td>
                <td>47.42%</td>
              </tr>
              <tr>
                <td><code>none</code></td>
                <td>0.51%</td>
                <td>0.41%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#security-fig-16" class="anchor-link">図 16.</a> SameSite設定の使用法。</figcaption>
    </figure>
    <p>既にSame-Siteのクッキーを利用しているページのうち、半分以上が<code>strict</code>モードで利用していることがわかる。これに続いて、<code>lax</code>モードでSame-Siteを利用しているサイト、そして少数のサイトでは<code>none</code>を利用しているサイトが続いています。この最後の値は、ブラウザベンダーが<code>lax</code>モードをデフォルトで実装する可能性があるという今後の変更をオプトアウトするために使用されます。</p>
    <p>
      この機能は危険な攻撃からの保護を提供するため、現在のところ、主要なブラウザが <a href="https://blog.chromium.org/2019/10/developers-get-ready-for-new.html">デフォルトでこの機能を実装<span class="fn">https://blog.chromium.org/2019/10/developers-get-ready-for-new.html</span></a
      >し、値が設定されていなくてもクッキーに対してこの機能を有効にする可能性があると指摘されています。これが実現した場合、SameSiteの保護機能は有効になりますが、<code>strict</code>モードではなく<code>lax</code>モードの弱い設定では、より多くの破損を引き起こす可能性があるためです。
    </p>
    <h3 id="security-プレフィックス"><a href="#security-プレフィックス" class="anchor-link">プレフィックス</a></h3>
    <p>クッキーに最近追加されたもう一つの方法として、クッキープレフィックスがあります。これらはクッキーの名前を使用して、すでにカバーされている保護に加えて、2つのさらなる保護のうちの1つを追加します。上記のフラグはクッキー上で誤って設定を解除される可能性がありますが、名前は変更されませんので、セキュリティ属性を定義するために名前を使用することでより確実にフラグを強制できます。</p>
    <p>現在のところ、クッキーの名前の前には<code>__Secure-</code>か<code>__Host-</code>のどちらかを付けることができ、どちらもクッキーに追加のセキュリティを提供しています。</p>
    <figure id="security-fig-17">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="colgroup" colspan="2">ホームページ数</th>
                <th scope="colgroup" colspan="2">ホームページの割合</th>
              </tr>
              <tr>
                <th scope="col">プレフィックス値</th>
                <th scope="col">デスクトップ</th>
                <th scope="col">モバイル</th>
                <th scope="col">デスクトップ</th>
                <th scope="col">モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>__Secure-</code></td>
                <td>640</td>
                <td>628</td>
                <td>0.01%</td>
                <td>0.01%</td>
              </tr>
              <tr>
                <td><code>__Host-</code></td>
                <td>154</td>
                <td>157</td>
                <td>0.00%</td>
                <td>0.00%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <figcaption><a href="#security-fig-17" class="anchor-link">図 17.</a> クッキーのプレフィックスの使用法</figcaption>
    </figure>
    <p>図が示すように、どちらのプレフィックスの使用率も信じられないほど低いのですが、2つのプレフィックスが緩和されているため<code>__Secure-</code>プレフィックスの方がすでに利用率は高いです。</p>
    <h2 id="security-サブリソースの完全性"><a href="#security-サブリソースの完全性" class="anchor-link">サブリソースの完全性</a></h2>
    <p>最近増えているもう1つの問題は、サードパーティの依存関係のセキュリティです。サードパーティからスクリプトファイルを読み込む際には、スクリプトファイルが常に欲しいライブラリ、おそらく特定のバージョンのjQueryであることを期待します。CDNやサードパーティのホスティングサービスが危殆化した場合、それらをホスティングしているスクリプトファイルを変更される可能性があります。このシナリオでは、アプリケーションは訪問者に危害を加える可能性のある悪意あるJavaScriptを読み込んでいることになります。これが、サブリソースの完全性が保護する機能です。</p>
    <p>スクリプトやリンクタグに<code>integrity</code>属性を追加することで、ブラウザはサードパーティのリソースの整合性をチェックし、変更された場合は拒否できます。</p>
    <pre><code>&lt;script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"&gt;&lt;/script&gt;</code></pre>
    <p>整合性属性が設定されたリンクまたはスクリプトタグを含むデスクトップページの0.06％（247,604）とモバイルページの0.05％（272,167）しかないため、SRIの使用には多くの改善の余地があります。現在、多くのCDNがSRIの整合性属性を含むコードサンプルを提供しているため、SRIの使用は着実に増加していると思われます。</p>
    <h2 id="security-結論"><a href="#security-結論" class="anchor-link">結論</a></h2>
    <p>Webの機能が向上し、より多くの機密データへのアクセスが可能になるにつれ、開発者が自社のアプリケーションを保護するためにWebセキュリティ機能を採用することがますます重要になってきています。本章でレビューするセキュリティ機能は、Webプラットフォーム自体に組み込まれた防御機能であり、すべてのWeb制作者が利用可能です。しかし、本章の研究結果のレビューからもわかるように、いくつかの重要なセキュリティメカニズムはウェブの一部にしか適用されていないため、エコシステムのかなりの部分がセキュリティやプライバシーのバグにさらされたままとなっています。</p>
    <h3 id="security-暗号化"><a href="#security-暗号化" class="anchor-link">暗号化</a></h3>
    <p>ここ数年の間に、転送中データの暗号化については、Webが最も進歩しています。<a href="#security-トランスポートレイヤーセキュリティ">TLSセクション</a>で説明したように、ブラウザーベンダー、開発者、Let's Encryptのような認証局の様々な努力のおかげで、HTTPSを使用しているウェブの割合は着実に増加しています。本稿執筆時点では、大多数のサイトがHTTPSで利用可能であり、トラフィックの機密性と完全性が確保されています。重要なことに、HTTPSを有効にしているWebサイトの99％以上では、TLSプロトコルの新しい安全なバージョン（TLSv1.2およびTLSv1.3）が使用されています。GCMモードでのAESなどの強力な<a href="#security-暗号スイート">cipher suites</a>の使用率も高く、すべてのプラットフォームで95％以上のリクエストを占めています。</p>
    <p>同時に、TLS設定のギャップは依然としてかなり一般的です。15％以上のページが<a href="#security-混合コンテンツ">混合コンテンツ</a>の問題に悩まされており、ブラウザに警告が表示され、4％のサイトではセキュリティ上の理由から最新のブラウザにブロックされています。同様に、<a href="#security-http-strict-transport-security">HTTP Strict Transport Security</a>の利点は、主要なサイトのごく一部にしか及ばず、大多数のWebサイトでは最も安全なHSTS構成を有効にしておらず、<a href="#security-hstsプリロード">HSTS プリロード</a>の対象外となっています。HTTPSの採用が進んでいるにもかかわらず、未だに多くのクッキーが<code>Secure</code>フラグなしで設定されており、クッキーを設定しているホームページのうち、暗号化されていないHTTPでの送信を防止しているのはわずか4％に過ぎません。</p>
    <h3 id="security-一般的なウェブの脆弱性からの防御"><a href="#security-一般的なウェブの脆弱性からの防御" class="anchor-link">一般的なウェブの脆弱性からの防御</a></h3>
    <p>
      機密データを扱うサイトで作業するウェブ開発者は、<a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0wiki/Cross-site_scripting">XSS<span class="fn">https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0wiki/Cross-site_scripting</span></a
      >、<a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%AA">CSRF<span class="fn">https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AD%E3%82%B9%E3%82%B5%E3%82%A4%E3%83%88%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%82%B8%E3%82%A7%E3%83%AA</span></a
      >、<a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%82%B8%E3%83%A3%E3%83%83%E3%82%AD%E3%83%B3%E3%82%B0">クリックジャッキング<span class="fn">https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%82%B8%E3%83%A3%E3%83%83%E3%82%AD%E3%83%B3%E3%82%B0</span></a
      >、およびその他の一般的なウェブバグからアプリケーションを保護するために、オプトインウェブセキュリティ機能を有効にしていることがよくあります。これらの問題は、<a href="#security-x-frame-options"><code>X-Frame-Options</code></a
      >、<a href="#security-x-content-type-options"><code>X-Content-Type-Options</code></a
      >、<a href="#security-コンテンツセキュリティポリシー"><code>コンテンツセキュリティポリシー</code></a
      >を含む、多くの標準的で広くサポートされているHTTPレスポンスヘッダを設定することで緩和できます。
    </p>
    <p>
      セキュリティ機能とウェブアプリケーションの両方共複雑であることが大部分を占めていますが、現在これらの防御機能を利用しているウェブサイトは少数派であり、多くの場合、リファクタリングの努力を必要としないメカニズムのみを有効にしています。最も一般的なオプトインアプリケーションのセキュリティ機能は、<code>X-Content-Type-Options</code> (17％のページで有効)、<code>X-Frame-Options</code> (16％)、および非推奨の<code>X-XSS-Protection</code>ヘッダ(15％)です。最も強力なWebセキュリティメカニズムであるコンテンツセキュリティポリシーは、5％のWebサイトでしか有効になっておらず、そのうちのごく一部(全サイトの約0.1％)だけが<a href="#security-ハッシュノンス">CSP ナンスとハッシュ</a>に基づいたより安全な設定を使用しています。関連する <a href="#security-参照元ポリシー"><code>参照元ポリシー</code></a
      >は、<code>Referer</code>ヘッダーで第三者に送信される情報量を減らすことを目的としているが、同様に使用しているのは3％のウェブサイトのみです。
    </p>
    <h3 id="security-現代のウェブプラットフォームの防御"><a href="#security-現代のウェブプラットフォームの防御" class="anchor-link">現代のウェブプラットフォームの防御</a></h3>
    <p>近年、ブラウザーは、主要な脆弱性や新たなWeb脅威からの保護を提供する強力な新しいメカニズムを実装しています; これには、<a href="#security-サブリソースの完全性">サブリソースの完全性</a>、<a href="#security-samesite">同じサイトのクッキー</a>、および<a href="#security-プレフィックス">クッキーのプレフィックス</a>が含まれます。</p>
    <p>
      これらの機能は比較的少数のウェブサイトでしか採用されていません。<a href="https://w3c.github.io/webappsec-trusted-types/dist/spec/">Trusted Types<span class="fn">https://w3c.github.io/webappsec-trusted-types/dist/spec/</span></a
      >、<a href="https://developer.mozilla.org/ja/docs/Web/HTTP/Cross-Origin_Resource_Policy_(CORP)">オリジン間リソース共有<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTTP/Cross-Origin_Resource_Policy_(CORP)</span></a
      >、<a href="https://www.chromestatus.com/feature/5432089535053824">オリジン間オープナー共有<span class="fn">https://www.chromestatus.com/feature/5432089535053824</span></a
      >のような、さらに最近のセキュリティメカニズムは、まだ広く採用されていません。
    </p>
    <p>
      同様に、<a href="#security-report-to">Reporting API</a>、<a href="#security-ネットワークエラーロギング">ネットワークエラーロギング</a>、<a href="#security-クリアサイトデータ"><code>Clear-Site-Data</code></a
      >ヘッダのような便利な機能もまだ初期段階であり、現在は少数のサイトで利用されています。
    </p>
    <h2 id="security-結びつき"><a href="#security-結びつき" class="anchor-link">結びつき</a></h2>
    <p>ウェブの規模では、オプトインプラットフォームのセキュリティ機能の全体的なカバー率は、現在のところ比較的低い。最も広く採用されている保護であっても、一般的なセキュリティ問題に対するプラットフォームのセーフガードを持たないウェブの大部分を残して、ウェブサイトの4分の1未満で有効になっています。</p>
    <p>
      しかし、これらのメカニズムの採用は、より機密性の高いユーザーデータを頻繁に扱う大規模なウェブアプリケーションに偏っていることに注意することが重要です。これらのサイトの開発者は、一般的な脆弱性に対する様々な保護を可能にすることを含め、ウェブの防御力を向上させるために投資することが多くなっています。<a href="https://observatory.mozilla.org/">Mozilla Observatory<span class="fn">https://observatory.mozilla.org/</span></a
      >や<a href="https://securityheaders.com/">Security Headers<span class="fn">https://securityheaders.com/</span></a
      >などのツールは、ウェブで利用可能なセキュリティ機能の便利なチェックリストを提供してくれます。
    </p>
    <p>ウェブアプリケーションが機密性の高いユーザーデータを扱う場合はユーザーを保護し、ウェブをより安全にするためこのセクションで概説されているセキュリティメカニズムを有効にすることを検討してください。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"II","chapter_number":9,"title":"アクセシビリティ","description":"読みやすさ、メディア、操作性の容易さ、および支援技術とその互換性をカバーする2019 Web Almanacアクセシビリティの章。","authors":["nektarios-paisios","obto","kleinab"],"reviewers":["ljme"],"translators":["MSakamaki"],"discuss":"1764","results":"https://docs.google.com/spreadsheets/d/16JGy-ehf4taU0w4ABiKjsHGEXNDXxOlb__idY8ifUtQ/","queries":"09_Accessibility","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-05-27T00:00:00.000Z","chapter":"accessibility"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="accessibility-導入"><a href="#accessibility-導入" class="anchor-link">導入</a></h2>
    <p>Webのアクセシビリティは、包摂的で公平な社会の上では無くてはならない存在です。私たちの社会性と仕事や生活の多くがオンラインの世界に推移するにつれて、障害のある人々も分け隔てなく、すべてのオンラインの対話に参加できることがさらに重要になってきます。建築家が車椅子用の傾斜路のようなアクセシビリティ機能を作成や省略できるように、Web開発者はユーザーが頼りにしている支援技術を助けたり邪魔したりできます。</p>
    <p>障害を持つユーザーの事を考えた時ユーザージャーニーはほぼ同じとなることを忘れないでください、彼らは異なるツールを使っているだけでしかありません。よく知られてるツールとして、スクリーンリーダー、画面拡大鏡、ブラウザまたは文字の拡大、音声コントロールなどがありますが、これ以外にも色々とあります。</p>
    <p>ほとんどの場合、アクセシビリティを改善することでサイトを訪れるすべての人に対してメリットを与える事ができます。私達は普通、障害者は生涯その障害を抱えていると思っていますが、一時的だったり状況的に障害を持つような人も居ます。たとえばその誰かが全盲なのか、一時的な目の感染症なのか、はたまた野外で眩しい太陽の下という状況なのか。これらすべて、その誰かが画面を見ることができない理由の説明になります。誰もが状況により障害を持ちうるため、Webページのアクセシビリティを改善することは、あらゆる状況ですべてのユーザーの体験を向上させることに繋がります。</p>
    <p>
      <a href="https://www.w3.org/WAI/WCAG21/quickref/">Webコンテンツのアクセシビリティガイドライン<span class="fn">https://www.w3.org/WAI/WCAG21/quickref/</span></a> (WCAG)はWebサイトの利便性を向上する方法についてのアドバイスが纏められています。このガイドラインを分析の基礎に使いました。しかし、ほとんどの場合においてWebサイトのアクセシビリティをプログラムによって分析するのは非常に困難です。たとえば、Webプラットフォームは機能的には同じ結果となる複数の方法を提供しており、それを実現するための基盤となるコードはまったく別物になる場合があります。したがって、私達の分析結果はWebアクセシビリティ全体の単なる概算でしかありません。
    </p>
    <p>私達はもっとも興味深い洞察を4種類のカテゴリに分類しました。それは読みやすさ、Web上のメディア、ページナビゲーションのしやすさ、補助技術との互換性です。</p>
    <p>テスト中にデスクトップとモバイルの間でアクセシビリティに大きな違いは見つかりませんでした。この結果で提示されているメトリックは、とくに明記していない限りはデスクトップの分析結果です。</p>
    <h2 id="accessibility-読みやすさ"><a href="#accessibility-読みやすさ" class="anchor-link">読みやすさ</a></h2>
    <p>Webページの主な目的はユーザーの興味を引くコンテンツを配信することです。このコンテンツはビデオや画像の組み合わせなどありますが、ほとんどの場合、シンプルなページ上のテキストです。テキストコンテンツが読者にとって読みやすいことは、とても重要です。訪問者がWebページを読めない場合、訪問者はWebページに興味を持つことがなくなり、最終的には離脱してしまうでしょう。この節ではサイトが苦労するであろう3つの分野を見ていきます。</p>
    <h3 id="accessibility-色のコントラスト"><a href="#accessibility-色のコントラスト" class="anchor-link">色のコントラスト</a></h3>
    <p>
      あなたのサイトの訪問者が完璧な内容を見ることができない、さまざまな可能性があります。訪問者は色覚多様性を持ち、フォントと背景色を区別できない場合があります（ヨーロッパ系の<a href="http://www.cvrl.org/people/stockman/pubs/1999%20Genetics%20chapter%20SSJN.pdf">男性12人に1人、女性200人に1人<span class="fn">http://www.cvrl.org/people/stockman/pubs/1999%20Genetics%20chapter%20SSJN.pdf</span></a
      >）。おそらく、彼らは太陽の下で画面の明るさを最大にして読んでいるため、視力を著しく損なっているのでしょう。もしくは年をとってしまい、彼らの目が以前と同じように色を区別できなくなったのでしょう。
    </p>
    <p>このような条件下であっても、あなたのWebサイトが確実に読めるようにするため、テキストと背景で十分な色のコントラストがあることを確認することは重要です。</p>
    <figure id="accessibility-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/example-of-good-and-bad-color-contrast-lookzook.svg">
        <img alt="図1.色のコントラストが不十分なテキストの表示例 LookZook提供" aria-labelledby="accessibility-fig1-caption" aria-describedby="accessibility-fig1-description" src="/static/images/2019/accessibility/example-of-good-and-bad-color-contrast-lookzook.svg" width="568" height="300" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="accessibility-fig1-description" class="visually-hidden">褐色とグレー4色のボックスに白いテキストがあり、2列に並んでいます。左の列は、色の薄い、<code>#FCA469</code>と書かれた褐色色の背景色があります。右の列は、推奨と表示されており、褐色色の背景色に<code>#BD5B0E</code>と書かれています。各列の上のボックスには白いテキスト#FFFFFFに褐色色の背景で、下のボックスは灰色の背景に白いテキスト#FFFFFFとなっています。同等のグレースケールは、それぞれ<code>＃B8B8B8</code>および<code>＃707070</code>です。LookZook提供。</div>
      <figcaption id="accessibility-fig1-caption"><a href="#accessibility-fig-1" class="anchor-link">図 1.</a>色のコントラストが不十分なテキストの表示例 LookZook提供</figcaption>
    </figure>
    <p>すべてのテキストに十分な色のコントラストが適用されているサイトは22.04％のみでした。これは言い換えると、5つのサイトのうち4つは背景に溶け込んで読みにくいテキストを持っていると言うことです。</p>
    <p class="note">注意：画像中のテキストは分析できていないため、ここで報告されているメトリックはカラーコントラストテストに合格したWebサイトの総数の上限でしかありません。</p>
    <h3 id="accessibility-ズーミングとページのスケーリング"><a href="#accessibility-ズーミングとページのスケーリング" class="anchor-link">ズーミングとページのスケーリング</a></h3>
    <p>
      <a href="https://accessibleweb.com/question-answer/minimum-font-size/">読みやすいフォントサイズ<span class="fn">https://accessibleweb.com/question-answer/minimum-font-size/</span></a
      >や<a href="https://www.w3.org/WAI/WCAG21/quickref/#target-size">ターゲットサイズ<span class="fn">https://www.w3.org/WAI/WCAG21/quickref/#target-size</span></a
      >を使うことで、ユーザーがWebサイトを読んだり操作するのを手助けできます。しかし、このガイドラインに対して完全に準拠しているWebサイトですら、訪問者一人ひとりの特定のニーズを満たすことはできません。これがピンチズームやスケーリングなどのデバイスによる機能が非常に重要となる理由です。ユーザーが貴方のページを微調整できるようにして彼らのニーズを満たします。また、小さなフォントやボタンが使われて操作が非常に難しいサイトであっても、ユーザーにそのサイトを使う機会を与えることができます。
    </p>
    <p>まれですが、スケーリングの無効化が許容される場合はあります。それは問題となるページがタッチコントロールを使ったWebベースのゲームなどの場合です。このような場合、有効にしてしまうとプレイヤーがゲームで2回タップをするたびにプレイヤーのスマホがズームインやズームアウトしてしまい、皮肉なことに操作できなくなってしまいます。</p>
    <p>
      なので、開発者は<a href="https://developer.mozilla.org/ja/docs/Mobile/Viewport_meta_tag">メタビューポートタグ<span class="fn">https://developer.mozilla.org/ja/docs/Mobile/Viewport_meta_tag</span></a
      >で次の2つのプロパティのどちらかを設定することで、この機能を無効化できます。
    </p>
    <ol>
      <li>
        <p><code>user-scalable</code>を<code>0</code>か<code>no</code>に設定</p>
      </li>
      <li>
        <p><code>maximum-scale</code>を<code>1</code>もしくは<code>1.0</code>などに設定</p>
      </li>
    </ol>
    <p>
      悲しいことに、開発者はこの機能を誤用しすぎており、モバイルサイトの3つのうち1つ（32.21％）でこの機能を無効化しています。さらにApple（iOS 10の時点）でWeb開発者がズームを無効化できなくなってしまいました。モバイルSafariは純粋に<a href="https://archive.org/details/ios-10-beta-release-notes">タグを無視します<span class="fn">https://archive.org/details/ios-10-beta-release-notes</span></a
      >。すべてのサイトは新しいiOSデバイスでズームとスケーリングができます。
    </p>
    <figure id="accessibility-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/fig2.png">
        <img src="/static/images/2019/accessibility/fig2.png" alt="図2. ズームとスケーリングを無効にしているサイトとデバイスの種類の割合。" aria-labelledby="accessibility-fig2-caption" aria-describedby="accessibility-fig2-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSG3DTnx7j-YT1hnQpQYjDRD-rCSF1dXbgva-iJQZKdCKIt34ojGMDRhx74fF93CpPg7oGW_C68fWGT/pubchart?oid=2053904956&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="accessibility-fig2-description" class="visually-hidden">20刻みの0から80までの垂直測定パーセンテージデータ。デバイスタイプをデスクトップとモバイルでグループ化しています。デスクトップで有効なのは 75.46%無効が24.54%、モバイルで有効なのは67.79%無効が32.21%.</div>
      <figcaption id="accessibility-fig2-caption"><a href="#accessibility-fig-2" class="anchor-link">図 2.</a> ズームとスケーリングを無効にしているサイトとデバイスの種類の割合。</figcaption>
    </figure>
    <h3 id="accessibility-言語の識別"><a href="#accessibility-言語の識別" class="anchor-link">言語の識別</a></h3>
    <p>Webには驚くべき大量のコンテンツが溢れていますが、ここには大きな落とし穴があります。世界には1,000以上の異なる言語が存在しており、探しているコンテンツが流暢な言葉で書かれていない可能性があります。昨今、私たちは翻訳技術で大きな進歩を遂げており、貴方はおそらくその1つをWebで利用しているでしょう（例：Google翻訳）</p>
    <p>
      この機能を円滑に行うために、翻訳エンジンはあなたのページがどの言語で書かれているかを知る必要があります。これには<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Global_attributes/lang"><code>lang</code>属性<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Global_attributes/lang</span></a
      >が使われます。lang属性がないと、コンピューターはページが記述されている言語を推測する必要が出てきます。想像できると思いますが、ページ中で複数の言語が使われている場合、これは多くの間違いを引き起こします（たとえば、ページナビゲーションは英語なのに投稿されているコンテンツが日本語のような場合）。
    </p>
    <p>この言語が指定されていない場合の問題は、規定のユーザー言語でテキストを読む傾向があるスクリーンリーダーのようなテキスト読み上げ支援技術で顕著になります。</p>
    <p>分析の結果、26.13％で<code>lang</code>属性による言語指定がありませんでした。これは4分の1以上のページが上記のような問題の影響を受けやすいという事です。良いニュース？ <code>lang</code>属性を使っているサイトの99.68％で有効な言語コードが適用されています。</p>
    <h3 id="accessibility-煩わしいコンテンツ"><a href="#accessibility-煩わしいコンテンツ" class="anchor-link">煩わしいコンテンツ</a></h3>
    <p>認知障害などの一部のユーザーは、1つの作業に対して長時間集中することが困難です。こういったユーザーは、とくに表面的なエフェクトが多く、それが目の前の作業に関わらない場合、動きやアニメーションが多く含まれるページを利用したくありません。</p>
    <p>
      残念なことに、私達の調査結果では無限ループアニメーションがWebでは非常に一般的であり、21.04％のページが無限CSSアニメーションや<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/marquee"><code>&lt;marquee&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/marquee</span></a
      >および<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/blink"><code>&lt;blink&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/blink</span></a
      >要素が使われている事を示しています。
    </p>
    <p>ただし、この問題の大部分は人気のあるサードパーティー製のスタイルシートが規定で無限ループのCSSアニメーションが含まれている事が原因であることに注意してください。このようなアニメーションスタイルを実際に適用したページ数がいくつあるのか、私達は特定できませんでした。</p>
    <h2 id="accessibility-web上のメディア"><a href="#accessibility-web上のメディア" class="anchor-link">Web上のメディア</a></h2>
    <h3 id="accessibility-画像の代替テキスト"><a href="#accessibility-画像の代替テキスト" class="anchor-link">画像の代替テキスト</a></h3>
    <p>
      画像はWebの体験の根幹です。それらは強い物語性を伝えることができ、注意を引いて感情を引き出すことができます。しかし、ストーリーの一部を伝えるために私達が頼っている画像は、誰でも見ることができるわけではありません。幸いなことに、1995年、HTML 2.0でこの問題に対する解決策が提供されました、それは<a href="https://webaim.org/techniques/alttext/">alt属性<span class="fn">https://webaim.org/techniques/alttext/</span></a
      >です。alt属性は使われている画像にテキストの説明を追加できる機能をWeb開発者に提供します。これによって、画像を見ることができない（もしくは読み込めない）ときに、altテキストに書かれた説明を読むことができます。altテキストは、彼らが見逃していたかもしれないストーリーの一部を埋めることができます。
    </p>
    <p>alt属性は25年前から存在していますが、49.91％のページで画像の一部にalt属性が提供されておらず、8.68％のページでまったく使用されていませんでした。</p>
    <h3 id="accessibility-ビデオやオーディオの字幕"><a href="#accessibility-ビデオやオーディオの字幕" class="anchor-link">ビデオやオーディオの字幕</a></h3>
    <p>画像が強力なストーリーテラーであるように、オーディオとビデオも注目を集めたりアイデアを表現する事ができます。オーディオやビデオコンテンツに字幕が付けられていない場合、コンテンツが聞こえないユーザーはWebのほとんどを見逃してしてしまいます。耳が聞こえない、もしくは難聴のユーザーから一番よく聞くのは、すべてのオーディオとビデオコンテンツに字幕を含めて欲しいというお話です。</p>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/audio"><code>&lt;audio&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/audio</span></a
      >や<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/video"><code>&lt;video&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/video</span></a
      >要素を使うサイトのうち、字幕を提供しているのは0.54％のみでした（<a href="https://developer.mozilla.org/ja/docs/Web/Guide/Audio_and_video_delivery/Adding_captions_and_subtitles_to_HTML5_video"><code>&lt;track&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/Guide/Audio_and_video_delivery/Adding_captions_and_subtitles_to_HTML5_video</span></a
      >要素を含むサイトで測定）一部のWebサイトには、ユーザーにビデオとオーディオの字幕を提供するカスタムソリューションがあります。これらは検出できなかったので、字幕を利用しているサイトの本当の割合は、おそらく少し高いでしょう。
    </p>
    <h2 id="accessibility-使いやすいページナビゲーション"><a href="#accessibility-使いやすいページナビゲーション" class="anchor-link">使いやすいページナビゲーション</a></h2>
    <p>レストランでメニューを開くとき、おそらく最初にするのは前菜、サラダ、主料理、デザートなどのセクションヘッダーをすべて読むことでしょう。ここから、すべてのメニューの選択肢を見渡し、もっとも興味のある料理に飛ぶことができます。同様に、訪問者がWebページを開く時、訪問者の目標はもっとも興味を持っている情報を見つけることです（それがページにアクセスした理由のはずです）ユーザーが目的のコンテンツをできるだけ早く見つけることができるように（それと、戻るボタンを押させないため）ページのコンテンツをいくつかの視覚的に異なるセクションに分割する必要があります。たとえば、ナビゲーション用のサイトヘッダーを置き、記事の見出しをユーザーが素早く見渡せるようにしたりその他の無関係なリソースを纏めたフッターなどをに分割する等です。</p>
    <p>これは非常に重要な事で、訪問者のコンピューターがこれらの異なるセクションを認識できるよう、注意してページのマークアップをする必要があります。それはなぜかと言うと、ほとんどの読者はマウスを利用してページを探索しますが、それ以外の読者はキーボードとスクリーンリーダーに依存しています。これらのテクノロジーは、コンピューターがあなたのページをどの程度理解できるかに大きく依存します。</p>
    <h3 id="accessibility-見出し"><a href="#accessibility-見出し" class="anchor-link">見出し</a></h3>
    <p>見出しは見た目上で有用なだけではなく、スクリーンリーダーでも役立ちます。見出しによってスクリーンリーダーはセクション間を素早く移動でき、さらに、セクションが終了して別のセクションが開始される場所を明示的にします。</p>
    <p>スクリーンリーダーを使うユーザーの混乱を避けるために、見出しのレベルを飛ばさないようにしてください。たとえば、H2をスキップして、H1の次にH3を使うのは止めてください。なぜこれが重要なのか？　それはスクリーンリーダーを使うユーザーが、予期せぬ変化からコンテンツを見逃したと勘違いしてしまうためです。このような場合、本当は見逃しがないにもかかわらず、見逃している可能性があるものを探し始めてしまいます。あわせて、より一貫したデザインを維持することで、すべての読者を支援します。</p>
    <p>そうは言いつつも、結果としては次のようになっています。</p>
    <ol>
      <li>89.36％のページが何らかの方法で見出しを使っています。素晴らしことです。</li>
      <li>38.6％のページは見出しのレベルを飛ばしています。</li>
      <li>不思議な事に、H2はH1よりも多くのサイトで見つかりました。</li>
    </ol>
    <figure id="accessibility-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/fig3.png">
        <img src="/static/images/2019/accessibility/fig3.png" alt="図3. 見出しレベルの人気。" aria-labelledby="accessibility-fig3-caption" aria-describedby="accessibility-fig3-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-crolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSG3DTnx7j-YT1hnQpQYjDRD-rCSF1dXbgva-iJQZKdCKIt34ojGMDRhx74fF93CpPg7oGW_C68fWGT/pubchart?oid=1123601243&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="accessibility-fig3-description" class="visually-hidden">20毎に0から80の範囲のパーセンテージデータを測定する垂直棒グラフ。各見出しはh1〜h6レベルを表します。H1：63.25％、H2：67.86％、H3：58.63％、H4：36.38％、H5：14.64％、H6：6.91％。</div>
      <figcaption id="accessibility-fig3-caption"><a href="#accessibility-fig-3" class="anchor-link">図 3.</a> 見出しレベルの人気。</figcaption>
    </figure>
    <h3 id="accessibility-mainランドマーク"><a href="#accessibility-mainランドマーク" class="anchor-link">Mainランドマーク</a></h3>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/Roles/Main_role">mainランドマーク<span class="fn">https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/Roles/Main_role</span></a
      >はWebページのメインコンテンツが始まる場所をスクリーンリーダーに示すことで、ユーザーがーすぐその場所に飛ぶことができます。mainランドマークがない場合、スクリーンリーダーのユーザーはサイト内の新しいページにアクセスするたび、手動でナビゲーションをスキップする必要が出てきます。これは明らかにイライラするでしょう。
    </p>
    <p>ページの4分の1（26.03％）にだけmainランドマークが含まれていることが判明しました。さらに驚くべきことに、8.06％のページに複数のmainランドマークが誤って含まれているため、ユーザーは実際のメインコンテンツがどのランドマークなのかを推測する必要が出ていました。</p>
    <figure id="accessibility-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/fig4.png">
        <img src="/static/images/2019/accessibility/fig4.png" alt="図4. 「main」ランドマークの数によるページの割合。" aria-labelledby="accessibility-fig4-caption" aria-describedby="accessibility-fig4-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSG3DTnx7j-YT1hnQpQYjDRD-rCSF1dXbgva-iJQZKdCKIt34ojGMDRhx74fF93CpPg7oGW_C68fWGT/pubchart?oid=1420590464&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="accessibility-fig4-description" class="visually-hidden">20毎に0〜80の範囲のパーセントデータを表示する垂直棒グラフと、0〜4のページごとの「main」ランドマークの数を表すバー。ソース：HTTP Archive （2019年7月）。 0：73.97％、1：17.97％、2：7.41％、3：0.15％; 4：0.06％。</div>
      <figcaption id="accessibility-fig4-caption"><a href="#accessibility-fig-4" class="anchor-link">図 4.</a> 「main」ランドマークの数によるページの割合。</figcaption>
    </figure>
    <h3 id="accessibility-html-section要素"><a href="#accessibility-html-section要素" class="anchor-link">HTML section要素</a></h3>
    <p>HTML5は2008年リリースされ、2014年に公式の標準となっているので、コンピューターとスクリーンリーダーがページの見た目と構造を理解するのに有用なHTML要素がたくさんあります。</p>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/header"><code>&lt;header&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/header</span></a
      >、<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/footer"><code>&lt;footer&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/footer</span></a
      >、<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/nav"><code>&lt;navigation&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/nav</span></a
      >、<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/main"><code>&lt;main&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/main</span></a
      >などの要素は特定の種類のコンテンツがどこにあるか明示的にして、ユーザーがそのページへ素早く飛ぶことを可能にします。これらはWeb全体で幅広く使われており、ほとんどがページの50％以上で使われています。(<code>&lt;main&gt;</code>は外れ値です。)
    </p>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/article"><code>&lt;article&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/article</span></a
      >、<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/hr"><code>&lt;hr&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/hr</span></a
      >、<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/aside"><code>&lt;aside&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/aside</span></a
      >のようなものは、読者がページのメインコンテンツを理解するのに役立ちます。たとえば、<code>&lt;article&gt;</code>は記事が終了して別の記事が開始される場所を示します。これらの要素はほとんど使われておらず、使用率は約20％ですが、これらはすべてのWebページで必要となるわけではないため、とくに驚くべき統計ではありません。
    </p>
    <p>これらの要素はすべてアクセシビリティサポートを主目的として設計されており、見た目の変化はありません。つまりこれは、既存の要素を安全に置き換えることが可能なので意図しない影響で苦しむことはないでしょう。</p>
    <figure id="accessibility-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/fig5.png">
        <img src="/static/images/2019/accessibility/fig5.png" alt="図5. 色々なHTMLセマンティック要素の利用率。" aria-labelledby="accessibility-fig5-caption" aria-describedby="accessibility-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSG3DTnx7j-YT1hnQpQYjDRD-rCSF1dXbgva-iJQZKdCKIt34ojGMDRhx74fF93CpPg7oGW_C68fWGT/pubchart?oid=708035719&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="accessibility-fig5-description" class="visually-hidden">各要素のバーと20毎に0〜60の範囲のページの割合を表す水平線を含む縦棒グラフ。nav：53.94％、header：54.82％、footer：55.92％、main：18.47％、aside：16.99％、article：22.59％、hr：19.1％、section：36.55%。</div>
      <figcaption id="accessibility-fig5-caption"><a href="#accessibility-fig-5" class="anchor-link">図 5.</a> 色々なHTMLセマンティック要素の利用率。</figcaption>
    </figure>
    <h3 id="accessibility-ナビゲーションで使われているその他のhtml要素"><a href="#accessibility-ナビゲーションで使われているその他のhtml要素" class="anchor-link">ナビゲーションで使われているその他のHTML要素</a></h3>
    <p>よく使われているスクリーンリーダーは、ユーザーがリンク、一覧、一覧のアイテム、iframe、それと編集フィールド、ボタン、リストボックスなどのフォームフィールドに素早く飛び、誘導できます。図6はこういった要素を使うページの表示頻度を表しています。</p>
    <figure id="accessibility-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/fig6.png">
        <img src="/static/images/2019/accessibility/fig6.png" alt="図6. ナビゲーションで使われるその他のHTML要素。" aria-labelledby="accessibility-fig6-caption" aria-describedby="accessibility-fig6-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSG3DTnx7j-YT1hnQpQYjDRD-rCSF1dXbgva-iJQZKdCKIt34ojGMDRhx74fF93CpPg7oGW_C68fWGT/pubchart?oid=389034849&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="accessibility-fig6-description" class="visually-hidden">各要素を示すバーと、25毎に0~100の範囲でページの割合を示す縦棒グラフ。a：98.22％、ul：88.62％、input：76.63％、iframe：60.39％、button：56.74％、select：19.68％、textarea：12.03%。</div>
      <figcaption id="accessibility-fig6-caption"><a href="#accessibility-fig-6" class="anchor-link">図 6.</a> ナビゲーションで使われるその他のHTML要素。</figcaption>
    </figure>
    <h3 id="accessibility-スキップリンク"><a href="#accessibility-スキップリンク" class="anchor-link">スキップリンク</a></h3>
    <p>
      <a href="https://webaim.org/techniques/skipnav/">スキップリンク<span class="fn">https://webaim.org/techniques/skipnav/</span></a
      >はスクリーンリーダーやキーボードだけを使うユーザーが、メインコンテンツに直接飛ぶことができるようにする、ページ上部に配置されるリンクです。これは、ページの上部にあるすべてのナビゲーションリンクとメニューを効率的に「スキップ」します。スキップリンクは、スクリーンリーダーを利用していないキーボードユーザーにとってとくに便利です。それは、このようなユーザーは通常他のクィックナビゲーションモード（ランドマークや見出しなど）にアクセスできないためです。サンプリングされたページの14.19％にスキップリンクが使われていました。
    </p>
    <p>スキップリンクの動作を試す事ができます！　シンプルにGoogle検索を実行し、検索結果ページが表示されたらすぐに「Tab」キーを押します。図7のような、事前に隠されたリンクが表示されます。</p>
    <figure id="accessibility-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/example-of-a-skip-link-on-google.com.png">
        <img alt="図7. google.comのスキップリンク外観。" aria-labelledby="accessibility-fig7-caption" aria-describedby="accessibility-fig7-description" src="/static/images/2019/accessibility/example-of-a-skip-link-on-google.com.png" width="600" height="333" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="accessibility-fig7-description" class="visually-hidden">「Http Archive」を検索するためのGoogle検索結果ページのスクリーンショット。表示される「メインコンテンツにスキップ」のリンクは青色のフォーカスハイライトと、スキップリンクを示す赤い矢印の付いた黄色のオーバーレイボックスに囲まれ「google.comのスキップリンク」と表示されます。</div>
      <figcaption id="accessibility-fig7-caption"><a href="#accessibility-fig-7" class="anchor-link">図 7.</a> google.comのスキップリンク外観。</figcaption>
    </figure>
    <p>サイトを分析するときに、正しいスキップリンクを判断するのは困難です。なのでこの分析ではページの最初の3つのリンク内にアンカーリンク（<code>href=#heading1</code>）が見つかった場合、それをスキップリンクのあるページと定義しました。つまり14.19％というのは厳密には上限です。</p>
    <h3 id="accessibility-ショートカット"><a href="#accessibility-ショートカット" class="anchor-link">ショートカット</a></h3>
    <p>
      <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-keyshortcuts"><code>aria-keyshortcuts</code><span class="fn">https://www.w3.org/TR/wai-aria-1.1/#aria-keyshortcuts</span></a
      >や<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Global_attributes/accesskey"><code>accesskey</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Global_attributes/accesskey</span></a
      >属性を介して設定されたショートカットキーは、次の2つの方法のどちらかで使うことができます。
    </p>
    <ol>
      <li><p>リンクやボタンなどのページ上の要素を活性化させます。</p></li>
      <li><p>特定の要素に対するページフォーカスを提供します。たとえばページ上にある特定の入力にフォーカスを移動させて、すぐさまユーザーが入力できるようにします。</p></li>
    </ol>
    <p>
      サンプルを見る限り<a href="https://www.w3.org/TR/wai-aria-1.1/#aria-keyshortcuts"><code>aria-keyshortcuts</code><span class="fn">https://www.w3.org/TR/wai-aria-1.1/#aria-keyshortcuts</span></a
      >はほとんど採用されておらず、400万以上ある分析対象のうち、たった159のサイトでだけ使われていました。<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Global_attributes/accesskey"><code>accesskey</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Global_attributes/accesskey</span></a
      >属性はかなり利用されており、Webページの2.47％（モバイルだと1.74％）で使われています。デスクトップでショートカットの利用率が多いのは、開発者がモバイルでサイトにアクセスする時、キーボードでなくタッチスクリーンのみで利用することを期待しているためと考えています。
    </p>
    <p>とくに驚くべき点は、ショートカットキーを適用しているモバイルサイトの15.56％とデスクトップサイトの13.03％で、1つのショートカットキーを複数の要素に割り当てている事です。これはブラウザがショートカットキーの対象となる要素を推測する必要があることを意味しています。</p>
    <h3 id="accessibility-テーブル"><a href="#accessibility-テーブル" class="anchor-link">テーブル</a></h3>
    <p>テーブルは大量のデータを整理し表現する主要な方法の1つです。スクリーンリーダーやスイッチ（運動障害のあるユーザーが使ったりします）などのさまざまな支援技術には、この表形式データをより効率的に操作できる特別な機能を持っています。</p>
    <h4 id="accessibility-テーブルの見出し"><a href="#accessibility-テーブルの見出し" class="anchor-link">テーブルの見出し</a></h4>
    <p>テーブルの詳細な構造に対応したテーブルヘッダーを使うことで、特定の列または行が参照するコンテキストを失うこと無く、列や行全体を簡単に読み取り可能とします。ヘッダー行や列のないテーブルを操作しないといけないのは、スクリーンリーダーのユーザーにとっては使いづらいでしょう。これは、テーブルが非常に大きい時にスクリーンリーダーのユーザーはヘッダーのないテーブルだと自分の場所を把握するのが難しいからです。</p>
    <p>
      テーブルのヘッダーをマークアップするには、シンプルに（<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/td"><code>&lt;td&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/td</span></a
      >タグの代わりに）<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/th"><code>&lt;th&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/th</span></a
      >タグを使うか、ARIAの <a href="https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/Roles/Table_Role"><code>columnheader</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/Roles/Table_Role</span></a
      >か<a href="https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/Roles/Table_Role"><code>rowheader</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/Roles/Table_Role</span></a
      >ロールのどれかを使います。この方法のどれかでテーブルがマークアップされていたのは、テーブルを含むページの24.5％だけでした。そのため、テーブルにヘッダーが含まれない四分の三のページは、スクリーンリーダーのユーザーにとって非常に深刻な課題を持っています。
    </p>
    <p><code>&lt;th&gt;</code>と <code>&lt;td&gt;</code>を利用するのは、テーブルにヘッダーをマークアップするもっとも一般的な方法のようです。<code>columnheader</code>と<code>rowheader</code>のロールを使っているサイトはほとんど存在せず、使っているサイトは合計677個（0.058％）のみでした。</p>
    <h4 id="accessibility-キャプション"><a href="#accessibility-キャプション" class="anchor-link">キャプション</a></h4>
    <p>
      <a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/caption"><code>&lt;caption&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/caption</span></a
      >要素が使われているテーブルキャプションは、さまざまな読者に対してより多くのコンテキストを提供できます。キャプションはテーブルが共有している情報を読む準備ができてる人や、集中できない環境だったり、作業の中断が必要な人々にとってとくに便利になります。また、スクリーンリーダーユーザーや学習障害、知的障害のある人などの、大きなテーブルだと自分の見ている場所で迷子になる可能性がある人々にとっても有用です。読者が分析している内容を理解しやすくすればするほど、より良い結果を得られるでしょう。
    </p>
    <p>にもかかわらず、表が含まれるページでは4.32％だけでしかキャプションを提供していません。</p>
    <h2 id="accessibility-支援技術との互換性"><a href="#accessibility-支援技術との互換性" class="anchor-link">支援技術との互換性</a></h2>
    <h3 id="accessibility-ariaの使用"><a href="#accessibility-ariaの使用" class="anchor-link">ARIAの使用</a></h3>
    <p>
      Web上でもっとも一般的かつ広く活用されているアクセシビリティの使用の1つに<a href="https://www.w3.org/WAI/standards-guidelines/aria/">Accessible Rich Internet Applications<span class="fn">https://www.w3.org/WAI/standards-guidelines/aria/</span></a> (ARIA)という標準があります。この標準は視覚的要素の背景にある目的（つまり、セマンティクスな意味）と、それにより可能になるアクションの種類を教えるのに役立つ追加のHTML属性をもった大きな配列を提供します。
    </p>
    <p>ARIAを適切かつ正しく使うのは難しい場合があります。例えば、ARIA属性を使っているページでは12.31％の属性に無効な値が割り当てられていました。ARIA属性の利用に誤りがあると、ページに視覚的な影響が及ばないため問題になります。これらの間違いは自動検証ツールを使っても検出できますが、一般的には実際の支援ソフトウェア（スクリーンリーダーなど）を実際に使う必要があります。この節ではARIAがWeb上でどのように使われているか、特に標準のどの部分が最も普及しているのかを検証していきます。</p>
    <figure id="accessibility-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/fig8.png">
        <img src="/static/images/2019/accessibility/fig8.png" alt="図8. 総ページ数とARIA属性の割合。" aria-labelledby="accessibility-fig8-caption" aria-describedby="accessibility-fig8-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSG3DTnx7j-YT1hnQpQYjDRD-rCSF1dXbgva-iJQZKdCKIt34ojGMDRhx74fF93CpPg7oGW_C68fWGT/pubchart?oid=792161340&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="accessibility-fig8-description" class="visually-hidden">0〜25の範囲で5ずつ増加するパーセントデータと、各属性のバーを表示する垂直棒グラフ。 aria-hidden：23.46％、aria-label：17.67％、aria-expanded：8.68％、aria-current：7.76％、aria-labelledby：6.85％、aria-controls：3.56％、aria-haspopup：2.62％、aria-invalid：2.68％、aria-describedby：1.69％、aria-live：1.04％、aria-required：1％</div>
      <figcaption id="accessibility-fig8-caption"><a href="#accessibility-fig-8" class="anchor-link">図 8.</a> 総ページ数とARIA属性の割合。</figcaption>
    </figure>
    <h4 id="accessibility-role属性">
      <a href="#accessibility-role属性" class="anchor-link"><code>role</code>属性</a>
    </h4>
    <p>「ロール」属性は、すべてのARIAの仕様中で最も重要な属性です。これは指定されたHTML要素の目的（セマンティックな意味）をブラウザへ通知するために使用されます。たとえば、CSSを使って視覚的にボタンのようにスタイルが適用された<code>&lt;div&gt;</code>要素には<code>button</code>のARIAロールを与える必要があります。</p>
    <p>実際には46.91％のページが少なくとも1つのARIAロール属性を使っています。以下の図9は、最もよく使われているトップ10のARIAロールの値一覧を纏めました。</p>
    <figure id="accessibility-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/accessibility/fig9.png">
        <img src="/static/images/2019/accessibility/fig9.png" alt="図9. ariaロールトップ10。" aria-labelledby="accessibility-fig9-caption" aria-describedby="accessibility-fig9-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSG3DTnx7j-YT1hnQpQYjDRD-rCSF1dXbgva-iJQZKdCKIt34ojGMDRhx74fF93CpPg7oGW_C68fWGT/pubchart?oid=176877741&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="accessibility-fig9-description" class="visually-hidden">0から25までの範囲で5ずつ増加サイトの割合と各ロールタイプのバーを備えた垂直棒グラフ。Navigation：20.4％。 search：15.49％; main：14.39％; banner：13.62％; contentinfo：11.23％; button：10.59％; dialog：7.87％; complementary：6.06％; menu：4.71％; form：3.75％</div>
      <figcaption id="accessibility-fig9-caption"><a href="#accessibility-fig-9" class="anchor-link">図 9.</a> ariaロールトップ10。</figcaption>
    </figure>
    <p>図9の結果を見ると、2つの興味深い見解が得られます。UIフレームワークを更新すると、Web全体のアクセシビリティおよび操作しやすいダイアログとなっているサイトの数が非常に多くなるようです。</p>
    <h5 id="accessibility-uiフレームワークの更新は、web全体のアクセシビリティを向上させる方法となる可能性がある"><a href="#accessibility-uiフレームワークの更新は、web全体のアクセシビリティを向上させる方法となる可能性がある" class="anchor-link">UIフレームワークの更新は、Web全体のアクセシビリティを向上させる方法となる可能性がある</a></h5>
    <p>11％以上のページに表示されるトップ5のロールはランドマークロールです。これはコンボボックスなどのヴィジェット機能が何かを説明するためではなく、ナビゲーションを助けるために使われています。ARIAが開発された主な目的は、Web開発者が汎用のHTML要素(<code>&lt;div&gt;</code>など)で作られたヴィジェット機能に対して説明を追加できる機能を提供することだったため、これは予想しなかった結果です。</p>
    <p>とても良く使われているWeb UIフレームワークは、テンプレートにナビゲーションロールが含まれているはずです。これはランドマーク属性が普及している説明に繋がります。この見解が正しい場合、一般的なUIフレームワークを更新してアクセシビリティサポートを追加すると、Webのアクセシビリティに大きな影響が出る可能性を持っています。</p>
    <p>この結論が導き出されるもう1つの答えは、より「高度」で同じくらい重要なARIA属性が一切使用されていないように見えるという事実です。この属性はUIフレームワークを介してかんたんにデプロイすることはできません。なぜなら、このような属性は各サイトの構造と外観に基づいて個々にカスタマイズする必要がある為です。例えば<code>posinset</code>や<code>setsize</code>属性は0.01％のページでしか使われていませんでした。これらの属性は一覧やメニューにあるアイテムの数と現在選択されているアイテムを、スクリーンリーダーユーザーに伝えることができます。そのため、視覚障害のあるユーザーがメニューを操作しようとすると「ホーム、5分の1」「製品、5分の2」「ダウンロード、5分の3」というようなインデックスのアナウンスが聞こえます。</p>
    <h5 id="accessibility-多くのサイトは、ダイアログをアクセス可能にしようとしています"><a href="#accessibility-多くのサイトは、ダイアログをアクセス可能にしようとしています" class="anchor-link">多くのサイトは、ダイアログをアクセス可能にしようとしています</a></h5>
    <p>
      スクリーンリーダーを使っているユーザーはダイアログへのアクセスが難しく、見るからにそれが<a href="https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/Roles/dialog_role">ダイアログロール<span class="fn">https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/Roles/dialog_role</span></a
      >その相対的な人気となっています。そのため、分析されたページの約8％で挑戦しはじめているのを見るのは興奮します。繰り返しますが、これはいくつかのUIフレームワークを使った結果に思えます。
    </p>
    <h4 id="accessibility-対話的要素のあるラベル"><a href="#accessibility-対話的要素のあるラベル" class="anchor-link">対話的要素のあるラベル</a></h4>
    <p>ユーザーがWebサイトを操作する最も一般的な方法は、Webサイトを閲覧するためのリンクやボタンなどのコントロールを使うことです。ただし、殆どの場合においてスクリーンリーダーのユーザーは、活性化されたコントロールが何を実行するのかを判断できません。この混乱が発生する原因の多くは、テキストラベルが無いためです。例えば、左向きの矢印アイコンが表示された「戻る」事を示すボタンですが、テキストが実際は含まれていません。</p>
    <p>ボタンまたはリンクを使うページの約4分の1（24.39％）でしか、これらのコントロールにテキストラベルが含まれていませんでした。コントロールにラベルが付いていない場合、スクリーンリーダーのユーザーは「検索」などの意味のある単語ではなく「ボタン」などの一般的なものを読み上げることがあります。</p>
    <p>ボタンとリンクはタブオーダーの対象であるため、視認性は非常に高くなります。Tabキーを使ってのWebサイト閲覧は、キーボードだけを使っているユーザーのWebサイト閲覧では普通の事です。なので、ユーザーはTabキーを使ってWebサイトを移動している場合に、ラベルのないボタンとリンクに必ず遭遇するでしょう。</p>
    <h3 id="accessibility-フォームコントロールのアクセシビリティ"><a href="#accessibility-フォームコントロールのアクセシビリティ" class="anchor-link">フォームコントロールのアクセシビリティ</a></h3>
    <p>
      フォームへの入力は私達が毎日行う沢山行う作業です。ショッピングや旅行の予約、仕事の申込みなど、フォームはユーザーがWebページと情報を共有する主な方法です。そのため、フォームを便利にすることは非常に重要です。これを達成するための簡単な方法は、各入力にラベルを提供することです（<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/label"><code>&lt;label&gt;</code>要素<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/label</span></a
      >や<a href="https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-label_attribute"><code>aria-label</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-label_attribute</span></a
      >または<a href="https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-labelledby_attribute"><code>aria-labelledby</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-labelledby_attribute</span></a
      >を用いて）。悲しいことに、すべてのフォーム入力にラベルを提供しているのページは22.33％しかありませんでした。つまり、5ページあるうちの4ページは非常に記入が難しいフォームを持っています。
    </p>
    <h4 id="accessibility-必須や無効なフィールドであることを示す手がかり"><a href="#accessibility-必須や無効なフィールドであることを示す手がかり" class="anchor-link">必須や無効なフィールドであることを示す手がかり</a></h4>
    <p>
      大きなアスタリスクがあるフィールドに出会うと、それが必須フィールドだと理解できます。もしくは、サブミットをクリックして無効な入力があると通知された場合に、異なる色で強調表示されているものは全てを修正してから再送信する必要があります。しかし、視力が低い人や無い人はこのような視覚的合図に頼ることができないため、htmlの入力属性である <code>required</code>や<code>aria-required</code>と<code>aria-invalid</code> などが非常に重要になります。これらは、スクリーンリーダーに対して赤いアスタリスクや赤い強調表示されたフィールドと同等の物を提供します。更に良いことに、必要なフィールドをブラウザに教えれば<a href="https://developer.mozilla.org/ja/docs/Learn/HTML/Forms/Form_validation">フォームの一部を検証<span class="fn">https://developer.mozilla.org/ja/docs/Learn/HTML/Forms/Form_validation</span></a
      >することも可能です。これにはJavaScriptが必要ありません。
    </p>
    <p>フォームを使っているページのうち21.73％は必須フィールドをマークアップするときに <code>required</code>か<code>aria-required</code> を適用しています。５分の１のサイトでだけ、これらは使用されています。これはサイトを使いやすくするための簡単な手続きです、すべてのユーザーに対してブラウザの役立つ機能を開放します。</p>
    <p>フォームを持つサイトの3.52％で<code>aria-invalid</code>が使われていることも判明しました。しかし、ほとんどのフォームは誤った情報が送信された後にこのフィールドを参照するため、このマークアップを適用しているサイトの本当の割合を確認することはできませんでした。</p>
    <h4 id="accessibility-重複したid"><a href="#accessibility-重複したid" class="anchor-link">重複したID</a></h4>
    <p>
      HTMLでIDを使い２つの要素をリンクさせることができます。例えば<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/label"><code>&lt;label&gt;</code>要素<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/label</span></a
      >は次のように機能します。ラベルにinputフィールドのIDを指定し、ブラウザはその２つをリンクさせます。結果はどうなるか？　ユーザーはこのラベルをクリックすることでユーザーはinputフィールドにフォーカスすることが可能になり、スクリーンリーダーはこのラベルを説明として使うことができます。
    </p>
    <p>
      残念ながら34.62％のサイトで重複したIDが確認できます、つまり多くのサイトではユーザーの指定したIDが複数の異なったinputを参照しています。そのため、ユーザーがラベルをクリックしてフィールドを選択すると、意図したものと<a href="https://www.deque.com/blog/unique-id-attributes-matter/">違う項目が選択される<span class="fn">https://www.deque.com/blog/unique-id-attributes-matter/</span></a
      >可能性を持っています。想像されている通り、これはショッピングカートのようなものに対して良くない結果をもたらす可能性があります。
    </p>
    <p>
      この問題はユーザーが選択肢の内容を視覚的に再確認できないスクリーンリーダーユーザーに対してさらに際立ちます。そして、<a href="https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-describedby_attribute"><code>aria-describedby</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-describedby_attribute</span></a
      >や<a href="https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-labelledby_attribute"><code>aria-labelledby</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-labelledby_attribute</span></a
      >などのARIA属性は上で説明したlabel要素と同じように機能します。つまり、サイトを操作しやすくするには、最初に重複するIDを全て削除するのが良いでしょう。
    </p>
    <h2 id="accessibility-結論"><a href="#accessibility-結論" class="anchor-link">結論</a></h2>
    <p>アクセシビリティを必要としているのは障害のある人々だけではありません。例えば、一時的に手首を負傷している人は小さな操作対象を触れるのが難しいと感じているはずです。視力は年齢とともに低下することが多く、小さなフォントで書かれたテキストは読みにくくなります。指の器用さは年齢毎に異なるため、かなりの割合のユーザーが対話的なコントロールに触れたり、モバイルWebサイトのコンテンツをスワイプしたりするのが難しくなっていきます。</p>
    <p>同様に支援ソフトウェアは障害のある人のためだけでなく、すべての人の日々の体験を良くしていくためのものです。</p>
    <ul>
      <li>モバイルデバイスと家庭用の両方で音声認識が人気なのは、コンピューティングデバイスを音声コマンドで制御することが多くのユーザーにとって有意義であり不可欠であることを示しています。このような音声制御は、以前はアクセシビリティ機能にしかありませんでしたが現在では商品の主流になりつつあります。</li>
      <li>運転手は道路から目を離す事無くニュース記事のような長文を読み上げるスクリーンリーダーの恩恵を受けることができるでしょう。</li>
      <li>字幕はビデオを聞く事ができない人だけでなく、騒々しいレストランや、図書館でビデオを見たい人なども楽しませています。</li>
    </ul>
    <p>一度Webサイトが完成すると、既存のサイト構成とウィジェットに対してアクセシビリティを改良する事は殆どの場合で困難になります。アクセシビリティは後で簡単にデコレーションすることが出来るものではなく、設計と実装のプロセスとして必要になります。しかし残念ながら、認識不足または使いやすいテストツールのせいで多くの開発者は、すべてのユーザーのニーズと支援ソフトウェアの要件に精通していません。</p>
    <p>これは結論ではありませんが、私達の活動結果からARIAやアクセシビリティのベストプラクティス（代替テキストを使うなど）のようなアクセシビリティ標準の利用はWebの<em>かなりの、しかし実質的でない</em>部分で見つかることが示されています。表面的にはこれは励みになりますが、こういった良い方向にある事柄の多くは特定のUIフレームワークがよく利用されているからだと私達は訝しんでいます。一方、Web開発者にとってはシンプルにUIフレームワークを頼ってサイトにアクセシビリティを差し込むことはできないため、非常に期待はずれです。その一方で、UIフレームワークがWebのアクセシビリティに与える影響の大きさを確認できるのは心強いでしょう。</p>
    <p>私達の見解では次の開拓地は、UIフレームワークを介して利用可能なウィジェットをより簡単に操作できるようになることです。世の中で使われている多くの複雑なウィジェット（カレンダーのピッカーなど）はUIライブラリなどに含まれており、こういったウィジェットがそのまま使えるのは素晴らしいことです。私達は次の結果を集める時、より適切に実装された複雑なARIAロールの利用が増えて、より複雑なウィジェットに対しても操作が簡単になっていることを願っています。そして、すべてのユーザーがウェブの豊かさを楽しむことが出来るよう、映画やビデオなどがさらにアクセスしやすいメディアとなった未来を見たいと思います。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"I","chapter_number":10,"title":"SEO","description":"コンテンツ、メタタグ、インデクサビリティ、リンク、速度、構造化データ、国際化、SPA、AMP、セキュリティをカバーする2019 Web AlmanacのSEOの章。","authors":["ymschaap","rachellcostello","AVGP"],"reviewers":["clarkeclark","andylimn","AymenLoukil","catalinred","mattludwig"],"translators":["MSakamaki"],"discuss":"1765","results":"https://docs.google.com/spreadsheets/d/1uARtBWwz9nJOKqKPFinAMbtoDgu5aBtOhsBNmsCoTaA/","queries":"10_SEO","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-03-01T00:00:00.000Z","chapter":"seo"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="seo-導入"><a href="#seo-導入" class="anchor-link">導入</a></h2>
    <p>検索エンジン最適化（SEO）はデジタルマーケティングの担当者にとって、単なる趣味やサイドプロジェクトではなくWebサイトを成功に導くための重要な要素です。 SEOの主な目標は、Webサイトをクロールする必要のある検索エンジンボットと、Webサイトを操作するコンテンツの消費者向けにWebサイトを最適化することです。 SEOはWebサイトを作っている開発者から、新しい潜在顧客に対して宣伝する必要のあるデジタルマーケティング担当者に至るまで、すべてのWebサイトに関わる人に影響を及ぼします。</p>
    <p>
      それでは、SEOの重要性を見ていきましょう。 今年のはじめにSEO業界は「困難な年」と言われた後<a href="https://www.bbc.co.uk/news/business-47877688">ASOSが利益の87%減少<span class="fn">https://www.bbc.co.uk/news/business-47877688</span></a
      >を報告したため、その恐ろしさ(と魅力)への注目が集まりました。 このブランドの問題は、200以上のマイクロサイトを立ち上げた為に発生した検索エンジンのランキング低下と、Webサイトのナビゲーションの大幅な変更などの技術的変更が原因であると考えられています。驚きです！
    </p>
    <p>Web AlmanacのSEOの章の目的は、検索エンジンによるコンテンツのクロールとインデックス付け、そして最終的にWebサイトのパフォーマンスに影響を与えるWebのオンサイト要素を分析することです。 この章では、上位のWebサイトがユーザーおよび検索エンジンに優れた体験を提供するためにどれだけ十分な整備がされているか、そしてどのような作業を行うべきかについて見ていきます。</p>
    <p>この分析には、<a href="#methodology-lighthouse">Lighthouse</a>と、<a href="#methodology-chrome-ux-report">Chrome UX Report</a>、HTML要素の分析データが含まれています。 <code>&lt;title&gt;</code>要素、様々な種類のページ上リンク、コンテンツ、読み込み速度などによるSEOの基礎だけではなく、500万以上のインデクサビリティ、構造化データ、国際化、AMPなどSEOのさらなる技術的な面にも注目しています。</p>
    <p>カスタムメトリクスはこれまで公開されていなかった洞察を提供します。<code>hreflang</code>タグ、リッチリザルトの適格性、見出しタグの使用、さらにシングルページアプリケーションのアンカーによるナビゲーション要素などの採用と実装について断言できるようになりました。</p>
    <p class="note">注意：データはホームページの分析のみに限定されており、サイト全体のクロールから集計はされていません。 そのようにした理由は、以降説明する多くの指標に影響を与えるため、特定の指標について言及する場合に関連する制限を追加しました。制限の詳しい内容は<a href="#methodology">Methodology</a>を御覧ください。</p>
    <p>では、Webの現状と検索エンジンの使いやすさについての詳細をお読みください。</p>
    <h2 id="seo-基本"><a href="#seo-基本" class="anchor-link">基本</a></h2>
    <p>検索エンジンにはクロール、インデックスの作成、ランキングの３つの手順があります。 それには検索エンジンにとって、ページを見つけやすく、理解でき、search engine results pages(SERPs)（検索エンジンの結果ページ）を閲覧しているユーザーにとって価値が有り高品質なコンテンツが含まれている必要があります。</p>
    <p>SEOの基本的なベストプラクティスの基準を満たしているWebの量を分析するため、本文のコンテンツ、<code>meta</code>タグ、内部リンクなどのページ上の要素を評価しました。それでは結果を見てみましょう。</p>
    <h3 id="seo-コンテンツ"><a href="#seo-コンテンツ" class="anchor-link">コンテンツ</a></h3>
    <p>ページの内容を理解して、最も関連性の高い回答を提供できる検索クエリが何かを決定的にするためには、まず検索エンジンがそのコンテンツを探し出してアクセス出来る必要があります。 しかし、検索エンジンは現在どのようにコンテンツを見つけるのでしょうか？、その回答を得るために、単語数と見出しの２つのカスタムメトリクスを作りました。</p>
    <h4 id="seo-単語の数"><a href="#seo-単語の数" class="anchor-link">単語の数</a></h4>
    <p>私達は、少なくとも３つの単語グループを探し合計でいくつ見つかったかを数えるようにして、ページのコンテンツを評価しました。 デスクトップページには単語グループを持たないものが2.73%見つかりました。これはWebサイトが何を指しているのかを検索エンジンが理解するのに役立つ本文コンテンツが無いことを示しています。</p>
    <figure id="seo-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig1.png">
        <img src="/static/images/2019/seo/fig1.png" alt="図1.ページ毎の単語数分布。" aria-labelledby="seo-fig1-caption" aria-describedby="seo-fig1-caption" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=190546113&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="seo-fig1-description" class="visually-hidden">ページ毎の単語分布。デスクトップページあたりの単語数の中央値は346でモバイルページの場合は306となっています。デスクトップページには、パーセンタイル全体でより多くの単語があり、90パーセンタイルで120単語もあります</div>
      <figcaption id="seo-fig1-caption"><a href="#seo-fig-1" class="anchor-link">図 1.</a>ページ毎の単語数分布。</figcaption>
    </figure>
    <p>デスクトップ向けホームページの中央値は346単語で、モバイル向けホームページの中央値は306単語とわずかに少ない単語数になっています。 これはモバイル向けサイトが少し少ない量をユーザーにコンテンツとして提供していることを示していますが、300単語を超えたとしても読むのには問題ない量でしょう。 これは、例えばホームページは記事があるページなどよりコンテンツが自然と少なくなるため特に該当するでしょう。 全体を見ると単語の分布は幅があり、10パーセンタイルのあたりでは22単語、90パーセンタイルあたりで最大1,361単語です。</p>
    <h4 id="seo-見出し"><a href="#seo-見出し" class="anchor-link">見出し</a></h4>
    <p>また、ページに含まれるコンテンツのコンテキストが適切な方法で構造化されて提供されているかを調べました。 見出し（<code>H1</code>、 <code>H2</code>、 <code>H3</code>、など）を使ってページを整え構造化すれば、コンテンツは読みやすく、解析しやすいようになります。 そんな見出しの重要性にもかかわらず、ページの10.67%には見出しタグがまったくありませんでした。</p>
    <figure id="seo-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig2.png">
        <img src="/static/images/2019/seo/fig2.png" alt="図2.ページ毎の見出し数分布。" aria-labelledby="seo-fig2-caption" aria-describedby="seo-fig2-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=676369575&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="seo-fig2-description" class="visually-hidden">ページ毎の見出しの分布。 デスクトップもモバイルもページ毎の見出しの中央値は10です。10/25/75/90それぞれのパーセンタイルではデスクトップの場合 0、3、21、39となっており、モバイルの見出し分布よりも少しだけ高くなっています。</div>
      <figcaption id="seo-fig2-caption"><a href="#seo-fig-2" class="anchor-link">図 2.</a>ページ毎の見出し数分布。</figcaption>
    </figure>
    <p>１ページあたりの見出し要素の中央値は10となっています。 見出しにはモバイルページで30単語、デスクトップページで32単語が含まれています。 これは、見出しを活用できているWebサイトが、ページが読みやすく、説明的で、ページの構造とコンテキストを検索エンジンボットに明確に概説することに多大な労力を費やしていることを意味します。</p>
    <figure id="seo-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig3.png">
        <img src="/static/images/2019/seo/fig3.png" alt="図3.ページ毎のH1の長さの分布。" aria-labelledby="seo-fig3-caption" aria-describedby="seo-fig3-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=1380411857&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="seo-fig3-description" class="visually-hidden">ページ毎の最初のH1文字数の分布。デスクトップとモバイルの分配はほぼ同様となっており、10、25、50、75、90パーセンタイルで6、11、19、31、47文字です。</div>
      <figcaption id="seo-fig3-caption"><a href="#seo-fig-3" class="anchor-link">図 3.</a>ページ毎のH1の長さの分布。</figcaption>
    </figure>
    <p>具体的な見出しの長さを見ると、最初に見つかった<code>H1</code>要素の長さの中央値はデスクトップで19文字です。</p>
    <p>
      SEOとアクセシビリティのための<code>H1</code>と見出しの処理に関するアドバイスについては、Ask Google Webmastersシリーズの<a href="https://www.youtube.com/watch?v=zyqJJXWk0gk">John Muellerによるこのビデオの回答<span class="fn">https://www.youtube.com/watch?v=zyqJJXWk0gk</span></a
      >をご覧ください。
    </p>
    <h3 id="seo-メタタグ"><a href="#seo-メタタグ" class="anchor-link">メタタグ</a></h3>
    <p>メタタグを使用すると、ページ上の色々な要素やコンテンツに関する特定の指示や情報を検索エンジンボットに提供できます。 特定のメタタグにはページの注目すべき情報や、クロールとインデックス付けの方法などを伝えることができます。 私達はWebサイトの提供するメタタグが、これらの機会を最大限に活用しているかどうかを評価したいと考えました。</p>
    <h4 id="seo-ページのタイトル"><a href="#seo-ページのタイトル" class="anchor-link">ページのタイトル</a></h4>
    <figure id="seo-fig-4">
      <div class="big-number">97%</div>
      <figcaption><a href="#seo-fig-4" class="anchor-link">図 4.</a> <code>&lt;title&gt;</code>タグを含むモバイルページの割合。</figcaption>
    </figure>
    <p>ページのタイトルはページの目的をユーザーや検索エンジンに伝える重要な手段です。 <code>&lt;title&gt;</code>タグはSERPSの見出にも、ページにアクセスする時のブラウザーのタブのタイトルとしても使われるので、モバイルページの97.1%にドキュメントタイトルが存在することは驚くことではないでしょう。</p>
    <figure id="seo-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig5.png">
        <img src="/static/images/2019/seo/fig5.png" alt="図5.ページごとのタイトルの長さの分布。" aria-labelledby="seo-fig5-caption" aria-describedby="seo-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=1015017335&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="seo-fig5-description" class="visually-hidden">ページ毎のタイトル要素毎の文字数分布。デスクトップのタイトルの長さそれぞれの10、25、50、75、90パーセンタイルは、4、9、20、40、66文字です。モバイルの分布も非常に似ています。</div>
      <figcaption id="seo-fig5-caption"><a href="#seo-fig-5" class="anchor-link">図 5.</a>ページごとのタイトルの長さの分布。</figcaption>
    </figure>
    <p>
      一般的に<a href="https://moz.com/learn/seo/title-tag">GoogleのSERPはページタイトルの最初の50〜60文字を表示<span class="fn">https://moz.com/learn/seo/title-tag</span></a
      >しますが、<code>&lt;title&gt;</code>タグの長さの中央値はモバイルページで21文字、デスクトップページで20文字でした。 75パーセンタイルでも、境界を下回っています。 これは、一部のSEOとコンテンツの記者が、検索エンジンによって割り当てられたSERPsのホームページを記述するために割り当てられた領域を最大限利用できていないことを示します。
    </p>
    <h4 id="seo-メタディスクリプション"><a href="#seo-メタディスクリプション" class="anchor-link">メタディスクリプション</a></h4>
    <p><code>&lt;title&gt;</code>タグと比べると、メタディスクリプションが検出されたページは少なくなっており、モバイル用ホームページの64.02%にだけメタディスクリプションが設定されています。 Googleが検索者のクエリに応じてSERP内のメタディスクリプションの記述を頻繁に書き換えることを考慮すると、おそらくWebサイトの所有者はメタディスクリプションを含めることを重要視しないでしょう。</p>
    <figure id="seo-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig6.png">
        <img src="/static/images/2019/seo/fig6.png" alt="図6. ページ毎のメタ記述の長さ分布。" aria-labelledby="seo-fig6-caption" aria-describedby="seo-fig6-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=1750266149&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="seo-fig6-description" class="visually-hidden">ページ毎のメタ記述毎の文字数分布。デスクトップのタイトルの長さの10、25、50、75、90パーセンタイルはそれぞれ、9、48、123、162、230文字です。モバイルの分布は任意のパーセンタイルでは10文字未満だけわずかに高くなっています。</div>
      <figcaption id="seo-fig6-caption"><a href="#seo-fig-6" class="anchor-link">図 6.</a> ページ毎のメタ記述の長さ分布。</figcaption>
    </figure>
    <p>
      メタディスクリプションの長さは<a href="https://moz.com/learn/seo/meta-description">155-160文字が推奨<span class="fn">https://moz.com/learn/seo/meta-description</span></a
      >となっていますが、デスクトップページの中央値ははそれより短い123文字となっています。 さらに興味深い事があります、モバイルのSERPはピクセル制限により従来よりも短かくなるにも関わらず、メタディスクリプションは一貫してデスクトップよりもモバイルが長くなっています。 この制約は最近拡張されたばかりなので、おそらく多くのWebサイトの所有者がモバイルの結果に対して、より長くて説明的なメタディスクリプションの影響を確認しているのでしょう。
    </p>
    <h4 id="seo-画像のaltタグ"><a href="#seo-画像のaltタグ" class="anchor-link">画像の<code>alt</code>タグ</a></h4>
    <p>SEOとアクセシビリティのための<code>alt</code>テキストの重要性を考えたとき、モバイルページの46.71%でしか画像に<code>alt</code>属性が使われていないのを見ると理想とはほど遠い状況です。 これは、Web上の画像をユーザーにとってさらにアクセスしやすく、検索エンジンにとって理解しやすくすることに関しては、まだ改善する点が多く有ることを意味します。 この問題に対する詳細については<a href="#accessibility">アクセシビリティ</a>の章を御覧ください。</p>
    <h3 id="seo-インデクサビリティ"><a href="#seo-インデクサビリティ" class="anchor-link">インデクサビリティ</a></h3>
    <p>SERPでユーザーにページのコンテンツを表示するためには検索エンジンのクローラーがそのページにアクセスしてインデックスを作れるようにする必要があります。検索エンジンによるページのクロールとインデックス登録の機能に影響を与える要因には次の様なものがあります。</p>
    <ul>
      <li>ステータスコード</li>
      <li><code>noindex</code>タグ</li>
      <li>canonicalタグ</li>
      <li><code>robots.txt</code>ファイル</li>
    </ul>
    <h4 id="seo-ステータスコード"><a href="#seo-ステータスコード" class="anchor-link">ステータスコード</a></h4>
    <p>検索エンジンにインデックスを付けたい重要なページは常に<code>200 OK</code>ステータスコードにしておく事をお勧めします。 テストされたページの殆どは検索エンジンにアクセス可能で、デスクトップでは最初のHTML要求の87.03%が<code>200</code>ステータスコードを返しました。 モバイルの場合は少しだけ低く、82.95%のページだけが<code>200</code>となるステータスコードを返しました。</p>
    <p>
      モバイルでは次によく見られるステータスコードは一時的なリダイレクトである<code>302</code>となっており、これはモバイルページの10.45%で見つけることができました。 この結果はデスクトップよりも多く、デスクトップ用のホームページで<code>302</code>ステータスコードを返すのは6.71%しかありませんでした。 これは、モバイル用のホームページがレスポンシヴでなく<a href="https://developers.google.com/search/mobile-sites/mobile-seo/separate-urls">デバイスごとにWebサイトのバージョンが異なるような<span class="fn">https://developers.google.com/search/mobile-sites/mobile-seo/separate-urls</span></a
      >、デスクトップページの代替が用意されていることに起因している可能性があります。
    </p>
    <p class="note">注意：この結果にはステータスコード<code>4xx</code>と<code>5xx</code>は含んでいません。</p>
    <h4 id="seo-noindex">
      <a href="#seo-noindex" class="anchor-link"><code>noindex</code></a>
    </h4>
    <p><code>noindex</code>指示はHTMLの <code>&lt;head&gt;</code>もしくはHTTPヘッダーの<code>X-Robots</code>指示で使うことができます。 <code>noindex</code>指示は基本的に検索エンジンにそのページをSERPに含めないように指示しますが、ユーザーがWebサイトを操作しているときでもページはアクセス可能です。 一般的に<code>noindex</code>指示は、同一コンテンツを提供するページの複製バージョン、またはオーガニック検索からWebサイトにアクセスするユーザーに価値を提供しないであろう低品質のページ(フィルタ、ファセット、内部検索ページなど)に追加されます。</p>
    <p>
      モバイル用ページの96.93%が<a href="https://developers.google.com/web/tools/lighthouse/audits/indexing">Lighthouseのインデックス作成監査に合格しており<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/indexing</span></a
      >、これらのページには<code>noindex</code>指示が含まれていませんでした。 ただし、これはモバイルホームページの3.07%に<code>noindex</code>指示が含まれていたことも意味しています。これは心配の種であり、Googleはこれらのページのインデックスを作成できないことを意味しています。
    </p>
    <p class="note">私達の調査に含まれるWebサイトは<a href="#methodology-chrome-ux-report">Chrome UX Report</a>のデータセットから提供されていますが、公開されていないWebサイトは除外されています。 これはChromeが非公開であると判断したサイトは分析できないので、バイアスの重要な源です。 これについては<a href="#methodology-websites">方法論</a>の詳細を御覧ください。</p>
    <h4 id="seo-canonicalによる最適化"><a href="#seo-canonicalによる最適化" class="anchor-link">canonicalによる最適化</a></h4>
    <p>canonicalタグを使い重複ページと優先代替ページを指定します。 これにより検索エンジンは、グループ内の複数のページに散っているオーソリティを1つのメインページに統合してランキングの結果を上げることができます。</p>
    <p>
      モバイル用ホームページの48.34%でcanonicalタグが使われていることが<a href="https://developers.google.com/web/tools/lighthouse/audits/canonical">検出<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/canonical</span></a
      >されました。 自分を指ししめすcanonicalタグは必須でなく、普通は複製されたページにcanonicalタグを必要とします。 ホームページがサイトのどこか他の場所に複製されることはめったに無いので、canonicalタグがページ毎で半分未満になっているのは驚くことではありません。
    </p>
    <h4 id="seo-robotstxt"><a href="#seo-robotstxt" class="anchor-link">robots.txt</a></h4>
    <p>
      検索エンジンのクロールを制御する最も効果的な方法の1つは、<a href="https://www.deepcrawl.com/knowledge/technical-seo-library/robots-txt/"><code>robots.txt</code>ファイル<span class="fn">https://www.deepcrawl.com/knowledge/technical-seo-library/robots-txt/</span></a
      >です。 これは、Webサイトのルートドメインに置かれる事で、検索エンジンのクロールに対し許可しないURLとURLパスを指定する事ができるファイルです。
    </p>
    <p>
      <a href="https://developers.google.com/web/tools/lighthouse/audits/robots">Lighthouseの結果<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/robots</span></a
      >からモバイル用サイトの72.16%でしか有効な<code>robots.txt</code>を持っていないことがわかりました。 見つかった問題の主な内訳は、<code>robots.txt</code>ファイルをまったく持たないサイトが22%、無効な<code>robots.txt</code>ファイルを提供する約6%で、それぞれ検査に失敗しています。 <a href="https://webmasters.googleblog.com/2017/01/what-crawl-budget-means-for-googlebot.html">クロールバジェットの問題<span class="fn">https://webmasters.googleblog.com/2017/01/what-crawl-budget-means-for-googlebot.html</span></a
      >に悩まされないような小規模Webサイトを運営していたりするなど、<code>robots.txt</code>ファイルを持たない妥当な理由もあったりしますが、無効な<code>robots.txt</code>が有るというのは、それだけで心配の種になります。
    </p>
    <h3 id="seo-リンク"><a href="#seo-リンク" class="anchor-link">リンク</a></h3>
    <p>Webページの最も重要な属性の1つはリンクです。 リンクは検索エンジンがインデックスに追加してWebサイトをナビゲートするための新しい関連ページを発見するのに役立ちます。 データセットにあるWebページの96%には最低でも1つの内部リンク存在し、93%は少なくとも１つの別ドメインへの外部リンクが存在しています。 内部や外部リンクを持たないごく一部のページは、ターゲットページへ通じるリンクという大きな価値を取りこぼしています。</p>
    <p>デスクトップ用のページに含まれる内部と外部リンクの数は、モバイル用のページよりも全ての場合で多くなっています。これは殆どの場合、モバイルのデザインはビューポートが小さく空間が限られているために、リンクが含まれるテキストはデスクトップに比べて少なくなっているためです。</p>
    <p>
      モバイル用のページで内部リンクが少ない場合、Webサイトで<a href="https://moz.com/blog/internal-linking-mobile-first-crawl-paths">問題が発生する可能性<span class="fn">https://moz.com/blog/internal-linking-mobile-first-crawl-paths</span></a
      >が有るため注意が必要です。 新しいWebサイトでGoogleの規定である<a href="https://www.deepcrawl.com/knowledge/white-papers/mobile-first-index-guide/">モバイルファーストインデックス<span class="fn">https://www.deepcrawl.com/knowledge/white-papers/mobile-first-index-guide/</span></a
      >が適用されると、そのページがデスクトップ用ではリンクされているがモバイル用からリンクが無い時、検索エンジンはそのページを見つけてランク付けするのがとても難しくなってしまいます。
    </p>
    <figure id="seo-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig7.png">
        <img src="/static/images/2019/seo/fig7.png" alt="図7.ページ毎の内部リンク分布。" aria-labelledby="seo-fig7-caption" aria-describedby="seo-fig7-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=534496673&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="seo-fig7-description" class="visually-hidden">ページ毎の内部リンク数の分布。デスクトップの内部リンクは10、25、50、75、90パーセンタイルごとに、7、29、70、142、261となっています。モバイル分布はかなり低く、90パーセンタイルでリンク数は30、中央値で10となっています。</div>
      <figcaption id="seo-fig7-caption"><a href="#seo-fig-7" class="anchor-link">図 7.</a>ページ毎の内部リンク分布。</figcaption>
    </figure>
    <figure id="seo-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig8.png">
        <img src="/static/images/2019/seo/fig8.png" alt="図8.ページ毎の外部リンク数の分布。" aria-labelledby="seo-fig8-caption" aria-describedby="seo-fig8-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=1997009875&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="seo-fig8-description" class="visually-hidden">ページ毎の外部リンク数の分布。デスクトップの外部リンクは10、25、50、75、90パーセンタイルごとに、1、4、10、22、51となっています。モバイルの分布はかなり低く、90パーセンタイルでリンク数は11、中央値で2となっています。</div>
      <figcaption id="seo-fig8-caption"><a href="#seo-fig-8" class="anchor-link">図 8.</a>ページ毎の外部リンク数の分布。</figcaption>
    </figure>
    <p>デスクトップ用ページの内部リンク(同一サイト)数は中央値で70となっていますが、モバイル用ページの内部リンク数の中央値は60になっています。外部リンク数のページ毎中央値も同じような傾向となっており、デスクトップ用ページの外部リンク数は10で、モバイル用ページは8になっています。</p>
    <figure id="seo-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig9.png">
        <img src="/static/images/2019/seo/fig9.png" alt="図9.ページ毎のアンカーリンク数の分布。" aria-labelledby="seo-fig9-caption" aria-describedby="seo-fig9-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=1852200766&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="seo-fig9-description" class="visually-hidden">ページ毎のアンカーリンク数の分布。デスクトップの内部アンカーは10、25、50、75、90パーセンタイルに対して、0、0、0、1、3となっています。モバイルの分布も同様です。</div>
      <figcaption id="seo-fig9-caption"><a href="#seo-fig-9" class="anchor-link">図 9.</a>ページ毎のアンカーリンク数の分布。</figcaption>
    </figure>
    <p>同一ページの特定スクロール位置にリンクするアンカーリンクはあまり人気が無いようです。 ホームページの65%以上でアンカーリンクは使われていません。 これはおそらく、一般的なホームページには長文形式のコンテンツが含まれていないからでしょう。</p>
    <p>
      説明的なリンクテキストの測定からは良いニュースが伺えます。 モバイル用ページの89.94%が<a href="https://developers.google.com/web/tools/lighthouse/audits/descriptive-link-text">Lighthouseの説明的なリンクテキストの監査<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/descriptive-link-text</span></a
      >で合格しています。つまり、これらのページは一般的な「ここをクリック」「リンク」「続きを読む」「全文表示」のようなリンクを使わず、より有意義なリンクテキストを使うことで、ユーザーと検索エンジンにページのコンテキストやページ同士のつながりがあることを理解できるようにしています。
    </p>
    <h2 id="seo-advanced"><a href="#seo-advanced" class="anchor-link">Advanced</a></h2>
    <p>説明的で有用なコンテンツ以外に対して<code>noindex</code>や<code>Disallow</code>という指示を出してページを検索エンジンからブロックするだけでは、Webサイトをオーガニックサーチさせるには不十分です。これらは単なる基本でしかありません。 WebサイトのパフォーマンスやSERPsの外観を向上させるなど、できることはたくさんあります。</p>
    <p>Webサイトのインデックス作成とランク付成功のために重要となっている技術的に複雑な局面として、速度、構造化データ、国際化、セキュリティ、モバイルフレンドリーなどがあります。</p>
    <h3 id="seo-speed"><a href="#seo-speed" class="anchor-link">Speed</a></h3>
    <p>
      モバイルの読み込み速度は、<a href="https://webmasters.googleblog.com/2018/01/using-page-speed-in-mobile-search.html">2018年にGoogleからランキング要素として初めて発表<span class="fn">https://webmasters.googleblog.com/2018/01/using-page-speed-in-mobile-search.html</span></a
      >されました。 しかしGoogleにとって速度は新しい観点ではありません。 2010年に既に速度が<a href="https://webmasters.googleblog.com/2010/04/using-site-speed-in-web-search-ranking.html">ランキングシグナルとして導入されたことが明らか<span class="fn">https://webmasters.googleblog.com/2010/04/using-site-speed-in-web-search-ranking.html</span></a
      >にっています。
    </p>
    <p>Webサイトが高速であることは、優れたユーザー体験のためにも重要です。 サイトの読み込みに数秒待たされるユーザは、すぐ離脱してSERPsから別の似たような内容の素早く読み込まれるページを探す傾向があります。</p>
    <p>Web全体の読み込み速度の分析に使った指標は <a href="#methodology-chrome-ux-report">Chrome UX Report</a>（CrUX）を基にしています。このレポートは、実際のChromeユーザーからデータを収集します。 このデータで驚くべき点は、48%のWebサイトが<strong>遅い</strong>とラベル付されていることです。 FCPの25%が3秒より遅い場合、<em>もしくは</em> FIDの5%が300ミリ秒より遅い場合にWebサイトは低速とラベル付されます。</p>
    <figure id="seo-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/seo/fig10.png">
        <img src="/static/images/2019/seo/fig10.png" alt="図10.デバイスタイプごとのユーザー体験パフォーマンスの分布。" aria-labelledby="seo-fig10-caption" aria-describedby="seo-fig10-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSrPaauIA_G4AySC09FX4fK5DsJ8DWhJGUQE0obrBe9HGSA8geyq3KwFi531jg9Ll9auE3x_UEwnF8g/pubchart?oid=2083126642&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="seo-fig10-description" class="visually-hidden">デスクトップ、電話、タブレットのパフォーマンスにおけるユーザー体験の分布。 デスクトップ：2%高速、52%中程度、46%低速。 電話：高速1%、中程度41%、低速58%。 タブレット：高速0%、中程度35%、低速65%。</div>
      <figcaption id="seo-fig10-caption"><a href="#seo-fig-10" class="anchor-link">図 10.</a>デバイスタイプごとのユーザー体験パフォーマンスの分布。</figcaption>
    </figure>
    <p>デバイスごとに分けるとより鮮明になります、この画像ではタブレット(65%)、電話(58%)を示しています。</p>
    <p>数字だけ見るとWebの速度には暗雲が立ち込めるように思えますが、良いニュースもあります。 それはSEOの専門家とツールがWebサイトの高速化のための技術課題に集中しているという点です。 Webパフォーマンスの状態については<a href="#performance">パフォーマンス</a>の章で詳しく知ることができます。</p>
    <h3 id="seo-構造化データ"><a href="#seo-構造化データ" class="anchor-link">構造化データ</a></h3>
    <p>
      構造化データを使うことでWebサイトの所有者は、<a href="https://en.wikipedia.org/wiki/JSON-LD">JSON-LD<span class="fn">https://en.wikipedia.org/wiki/JSON-LD</span></a
      >スニペットや<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Microdata">Microdata<span class="fn">https://developer.mozilla.org/en-US/docs/Web/HTML/Microdata</span></a
      >などを加える事で、Webページに付属的なセマンティックデータを付与できます。 検索エンジンはこのデータを解析してこれらのページを深く理解し、マークアップにより検索結果に追加の関連情報を表示も行う事ができます。
    </p>
    <p>よく見る構造化データの種類には次のようなものがあります。</p>
    <ul>
      <li>
        <a href="https://developers.google.com/search/docs/data-types/review-snippet">reviews<span class="fn">https://developers.google.com/search/docs/data-types/review-snippet</span></a>
      </li>
      <li>
        <a href="https://developers.google.com/search/docs/data-types/product">products<span class="fn">https://developers.google.com/search/docs/data-types/product</span></a>
      </li>
      <li>
        <a href="https://developers.google.com/search/docs/data-types/local-business">businesses<span class="fn">https://developers.google.com/search/docs/data-types/local-business</span></a>
      </li>
      <li>
        <a href="https://developers.google.com/search/docs/data-types/movie">movies<span class="fn">https://developers.google.com/search/docs/data-types/movie</span></a>
      </li>
      <li>
        <a href="https://developers.google.com/search/docs/guides/search-gallery">その他<span class="fn">https://developers.google.com/search/docs/guides/search-gallery</span></a>
      </li>
    </ul>
    <p>
      構造化データがWebサイトに提供できる<a href="https://developers.google.com/search/docs/guides/enhance-site">追加の可視性<span class="fn">https://developers.google.com/search/docs/guides/enhance-site</span></a
      >はユーザーがサイトに訪れる機会を増やすのに役立つため、サイトの所有者にとっては魅力的です。 たとえば、比較的新しい<a href="https://developers.google.com/search/docs/data-types/faqpage">FAQスキーマ<span class="fn">https://developers.google.com/search/docs/data-types/faqpage</span></a
      >はスニペットとSERPsの領域を２倍にできます。
    </p>
    <p>調査の結果、モバイルでリッチな結果を得ることが出来るサイトは14.67%しか無いことが解りました。 興味深いことに、デスクトップサイトの適格性はわずかに低くなり12.46%となっています。 これはサイト所有者がホームページ検索で表示されるための最適化に対して、もっと出来ることが有ることを示しています。</p>
    <p>構造化データのマークアップを持つサイトの中で、最もよく見る種類は次の５つでした。</p>
    <ol>
      <li><code>WebSite</code> (16.02%)</li>
      <li><code>SearchAction</code> (14.35%)</li>
      <li><code>Organization</code> (12.89%)</li>
      <li><code>WebPage</code> (11.58%)</li>
      <li><code>ImageObject</code> (5.35%)</li>
    </ol>
    <p>
      興味深いことに、一番良く利用されている検索エンジンの機能をトリガーするデータ型は<a href="https://developers.google.com/search/docs/data-types/sitelinks-searchbox">サイトリンクの検索ボックス<span class="fn">https://developers.google.com/search/docs/data-types/sitelinks-searchbox</span></a
      >を強化する<code>SearchAction</code>です。
    </p>
    <p>トップ5のマークアップタイプはすべてGoogleの検索結果の可視性を高める物で、これらのタイプの構造化データをさらに採用する理由になるかもしれません。</p>
    <p>今回の分析はホームページだけを見ているため、インテリアページも考慮した場合は結果は大きく異なった結果が見えてくる可能性があります。</p>
    <p>
      レビューの星はWebのホームページ上で1.09%だけにしかありません。(<a href="https://schema.org/AggregateRating">AggregateRating<span class="fn">https://schema.org/AggregateRating</span></a
      >より) また、新しく導入された<a href="https://schema.org/QAPage">QAPage<span class="fn">https://schema.org/QAPage</span></a
      >は48の例しかなく、<a href="https://schema.org/FAQPage">FAQPage<span class="fn">https://schema.org/FAQPage</span></a
      >は少しだけ高い数が出現して218となっています。 この最後の2種類の数については、クロールを更に実行してWeb Almanacの分析を掘り下げていくと、将来増加することが予想されています。
    </p>
    <h3 id="seo-国際化"><a href="#seo-国際化" class="anchor-link">国際化</a></h3>
    <p>
      <a href="https://twitter.com/JohnMu/status/965507331369984002">一部のGoogle検索の従業員<span class="fn">https://twitter.com/JohnMu/status/965507331369984002</span></a
      >によれば、国際化はSEOの最も複雑な面の1つとなっているようです。 SEOの国際化は、ユーザーが特定の言語のコンテンツをターゲットしていることを確認し、それに合わせて複数の言語や国のバージョンを持つWebサイトから適切なコンテンツを提供することに重点をおいています。
    </p>
    <p>HTML lang属性が英語に設定されているデスクトップ用サイトの38.40%（モバイルでは33.79%）で、別の言語バージョンへの <code>hreflang</code>リンクが含まれるサイトはたった7.43%（モバイルで6.79%）しかありませんでした。 これから、分析したWebサイトの殆どが言語ターゲティングを必要とするホームページの別バージョンを提供していないことを示しています。しかしそれは、個別のバージョンは存在するが構成が正しく無い場合を除きます。</p>
    <figure id="seo-fig-11">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th><code>hreflang</code></th>
                <th>Desktop</th>
                <th>Mobile</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>en</td>
                <td class="numeric">12.19%</td>
                <td class="numeric">2.80%</td>
              </tr>
              <tr>
                <td>x-default</td>
                <td class="numeric">5.58%</td>
                <td class="numeric">1.44%</td>
              </tr>
              <tr>
                <td>fr</td>
                <td class="numeric">5.23%</td>
                <td class="numeric">1.28%</td>
              </tr>
              <tr>
                <td>es</td>
                <td class="numeric">5.08%</td>
                <td class="numeric">1.25%</td>
              </tr>
              <tr>
                <td>de</td>
                <td class="numeric">4.91%</td>
                <td class="numeric">1.24%</td>
              </tr>
              <tr>
                <td>en-us</td>
                <td class="numeric">4.22%</td>
                <td class="numeric">2.95%</td>
              </tr>
              <tr>
                <td>it</td>
                <td class="numeric">3.58%</td>
                <td class="numeric">0.92%</td>
              </tr>
              <tr>
                <td>ru</td>
                <td class="numeric">3.13%</td>
                <td class="numeric">0.80%</td>
              </tr>
              <tr>
                <td>en-gb</td>
                <td class="numeric">3.04%</td>
                <td class="numeric">2.79%</td>
              </tr>
              <tr>
                <td>de-de</td>
                <td class="numeric">2.34%</td>
                <td class="numeric">2.58%</td>
              </tr>
              <tr>
                <td>nl</td>
                <td class="numeric">2.28%</td>
                <td class="numeric">0.55%</td>
              </tr>
              <tr>
                <td>fr-fr</td>
                <td class="numeric">2.28%</td>
                <td class="numeric">2.56%</td>
              </tr>
              <tr>
                <td>es-es</td>
                <td class="numeric">2.08%</td>
                <td class="numeric">2.51%</td>
              </tr>
              <tr>
                <td>pt</td>
                <td class="numeric">2.07%</td>
                <td class="numeric">0.48%</td>
              </tr>
              <tr>
                <td>pl</td>
                <td class="numeric">2.01%</td>
                <td class="numeric">0.50%</td>
              </tr>
              <tr>
                <td>ja</td>
                <td class="numeric">2.00%</td>
                <td class="numeric">0.43%</td>
              </tr>
              <tr>
                <td>tr</td>
                <td class="numeric">1.78%</td>
                <td class="numeric">0.49%</td>
              </tr>
              <tr>
                <td>it-it</td>
                <td class="numeric">1.62%</td>
                <td class="numeric">2.40%</td>
              </tr>
              <tr>
                <td>ar</td>
                <td class="numeric">1.59%</td>
                <td class="numeric">0.43%</td>
              </tr>
              <tr>
                <td>pt-br</td>
                <td class="numeric">1.52%</td>
                <td class="numeric">2.38%</td>
              </tr>
              <tr>
                <td>th</td>
                <td class="numeric">1.40%</td>
                <td class="numeric">0.42%</td>
              </tr>
              <tr>
                <td>ko</td>
                <td class="numeric">1.33%</td>
                <td class="numeric">0.28%</td>
              </tr>
              <tr>
                <td>zh</td>
                <td class="numeric">1.30%</td>
                <td class="numeric">0.27%</td>
              </tr>
              <tr>
                <td>sv</td>
                <td class="numeric">1.22%</td>
                <td class="numeric">0.30%</td>
              </tr>
              <tr>
                <td>en-au</td>
                <td class="numeric">1.20%</td>
                <td class="numeric">2.31%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#seo-fig-11" class="anchor-link">図 11.</a> よく見る<code>hreflang</code>値のトップ25。</figcaption>
    </figure>
    <p>英語の次に最もよく見る言語は、フランス語、スペイン語、およびドイツ語です。 この後にアメリカ人向けの英語（<code>en-us</code>）やアイルランド人向けのスペイン語（<code>es-ie</code>）などの不明瞭な組み合わせなどの、特定の地域を対象とした言語が続いています。</p>
    <p>
      この分析では、異なる言語バージョン同士が相互で適切にリンクしているかどうかなどの正しい実装は確認しませんでした。 しかし、<a href="https://www.google.com/url?q=https://support.google.com/webmasters/answer/189077?hl%3Den&amp;sa=D&amp;ust=1570627963630000&amp;usg=AFQjCNFwzwglsbysT9au_I-7ZQkwa-QvrA">推奨にある<span class="fn">https://www.google.com/url?q=https://support.google.com/webmasters/answer/189077?hl%3Den&amp;sa=D&amp;ust=1570627963630000&amp;usg=AFQjCNFwzwglsbysT9au_I-7ZQkwa-QvrA</span></a
      >x-defaultバージョン（デスクトップでは3.77%、モバイルでは1.30%）の採用が少ない点を考慮すると、この要素が複雑で常に正しいとは限らないということを示しています。
    </p>
    <h3 id="seo-spaのクロールに関する可能性"><a href="#seo-spaのクロールに関する可能性" class="anchor-link">SPAのクロールに関する可能性</a></h3>
    <p>
      ReactやVue.jsなどのフレームワークで構築されたシングルページアプリケーション（SPA）には、独特のSEOの複雑さが伴っています。 ハッシュを使ったナビゲーションを使用するWebサイトは検索エンジンがクロールして適切にインデックスを作成するのがとても難しくなります。 例を上げると、Googleには「AJAXクロールスキーム」という回避策がありましたが、開発者だけでなく検索エンジンにとっても難解であることが判明し、この仕様は<a href="https://webmasters.googleblog.com/2015/10/deprecating-our-ajax-crawling-scheme.html">2015年に廃止<span class="fn">https://webmasters.googleblog.com/2015/10/deprecating-our-ajax-crawling-scheme.html</span></a
      >されました。
    </p>
    <p>ハッシュURLを介して提供されるリンクの数が比較的少なく、Reactモバイルページの13.08%がナビゲーションにハッシュURLを使用し、モバイルVue.jsページで8.15%、モバイルAngularページで2.37%で使用されているという結果になっています。 この結果はデスクトップ用ページでも非常に似通った結果でした。 ハッシュURLからコンテンツの発見に対する影響を考慮すると、この結果はSEOの観点からは良い状態と言えるでしょう。</p>
    <p>
      特に驚いた点は、ハッシュURLの数がAngularページでは少ないのとは対照的に、ReactページでのハッシュURLの数が多くなっている点です。 両方のフレームワークはハッシュURLに依存せず、代わりにリンク時に<a href="https://developer.mozilla.org/en-US/docs/Web/API/History">History API<span class="fn">https://developer.mozilla.org/en-US/docs/Web/API/History</span></a
      >が標準となっているルーティングパッケージの採用を推奨しています。 Vue.jsは<code>vue-router</code>パッケージのバージョン3から、<a href="https://github.com/vuejs/rfcs/pull/40">History APIを標準で使うことを検討<span class="fn">https://github.com/vuejs/rfcs/pull/40</span></a
      >しています。
    </p>
    <h3 id="seo-amp"><a href="#seo-amp" class="anchor-link">AMP</a></h3>
    <p>
      AMP（以前は「Accelerated Mobile Pages」として知られていました）は、2015年にGoogleによってオープンソースのHTMLフレームワークとして初めて導入されました。 キャッシュ、遅延読み込み、最適化された画像などの最適化手法を使うことで、Webサイトのサイトのコンポーネントと基盤構造を提供することで、ユーザーに高速な体験を提供します。 特に、Googleは検索エンジンにもこれを採用し、AMPページも独自のCDNから提供されています。 この機能は後に<a href="https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html">Signed HTTP Exchanges<span class="fn">https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html</span></a
      >という名前の標準提案になりました。
    </p>
    <p>にも関わらず、AMPバージョンへのリンクが含まれるモバイルホームページはわずか0.62%しかありません。 このプロジェクトの可視性を考慮しても、これは採用率が比較的低い事が示されています。 ただし、今回のホームページに焦点を宛てた分析なので、他のページタイプの採用率は見ていません、記事ページを配信する場合はAMPのほうが有利な場合が多いでしょう。</p>
    <h3 id="seo-セキュリティ"><a href="#seo-セキュリティ" class="anchor-link">セキュリティ</a></h3>
    <p>
      近年、WebがデフォルトでHTTPSに移行するという強力なオンラインの変化がありました。 HTTPSでは、例えばユーザー入力データが安全に送信されないパブリックWi-FiネットワークでもWebサイトのトラフィックが傍受されるのを防ぎます。GoogleはサイトでHTTPSを採用するよう推進しており、<a href="https://webmasters.googleblog.com/2014/08/https-as-ranking-signal.html">ランキングシグナルとしてHTTPS<span class="fn">https://webmasters.googleblog.com/2014/08/https-as-ranking-signal.html</span></a
      >を作りました。Chromeはブラウザで非HTTPSページを<a href="https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure/">非セキュア<span class="fn">https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure/</span></a
      >としてラベル付けすることでセキュアなページへの移行もサポートしています。
    </p>
    <p>
      HTTPSの重要性とその採用方法に関するGoogleの詳細な情報と手引については、<a href="https://developers.google.com/web/fundamentals/security/encrypt-in-transit/why-https">HTTPSが重要な理由<span class="fn">https://developers.google.com/web/fundamentals/security/encrypt-in-transit/why-https</span></a
      >をご覧ください。
    </p>
    <p>現在、デスクトップ用Webサイトの67.06%がHTTPS経由で配信されています。 Webサイトの半分以下がまだHTTPSに移行しておらず、ユーザーに安全でないページを提供しています。 これはかなりの数です。 移行は大変な作業になる場合が多く、そのために採用率が高くない可能性がありますが、HTTPSの移行に必要なのは大抵の場合SSL証明書と<code>.htaccess</code>ファイルの簡単な変更です。&nbsp; HTTPSに切り替えない理由はありません。</p>
    <p>
      <a href="https://transparencyreport.google.com/https/overview">Googleの透明性レポート<span class="fn">https://transparencyreport.google.com/https/overview</span></a
      >では、Google以外の上位100ドメインでhttpsの採用率は90%であると報告されています(これは世界中のWebサイトトラフィックの25%です)。 この数字と私たちの数字の違いから、比較的小規模なサイトはゆるやかにHTTPSを採用しているという事実によって説明できます。
    </p>
    <p>セキュリティの状態の詳細については、<a href="#security">セキュリティ</a>の章を御覧ください。</p>
    <h2 id="seo-結論"><a href="#seo-結論" class="anchor-link">結論</a></h2>
    <p>分析の結果、ほとんどのWebサイトでは基礎がしっかりしている事が判明しました。ホームページはクロール可能で、インデックス付け可能で、検索エンジンの結果ページでのランキングに必要な主要コンテンツが存在しています。 Webサイトを所有する人々がSEOを熟知しているわけではなく、ベストプラクティスの指針などは言うまでもありません。つまり、これらの非常に多くのサイトが基本をカバーしていることは非常に頼もしいことです。</p>
    <p>しかし、SEOとアクセシビリティのより高度な面のいくつかに関しては、予想していたよりも多くのサイトが注目していません。 サイトの速度については、特にモバイルのときに多くのWebサイトが苦労している要因の一つになっており、これは大きな問題です。なぜなら速度はUXの最大の要因の1つで、ランキングに影響を与える可能性があるためです。 HTTPS経由でまだ提供されていないWebサイトの数も、セキュリティの重要性を考慮してユーザーデータを安全に保つという点に問題があるように見えます。</p>
    <p>私達全員がSEOのベストプラクティスを学んだり、業界の発展に貢献できることはたくさんあります。 これは、検索業界が進化する性質を持ちながら、その変化の速度から必要な事です。 検索エンジンは毎年数千のアルゴリズムを改善しています、Webサイトがオーガニックサーチでより多くの訪問者に届くようにしたい場合、置いていかれないようにする必要があります。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"II","chapter_number":11,"title":"PWA","description":"Service Worker（登録、インストール可能性、イベント、およびファイルサイズ）、Webアプリマニフェストプロパティ、およびWorkboxを対象とする2019 Web AlmanacのPWAの章。","authors":["tomayac","jeffposnick"],"reviewers":["hyperpress","ahmadawais"],"translators":["ksakae"],"discuss":"1766","results":"https://docs.google.com/spreadsheets/d/19BI3RQc_vR9bUPPZfVsF_4gpFWLNT6P0pLcAdL-A56c/","queries":"11_PWA","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-03-02T00:00:00.000Z","chapter":"pwa"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="pwa-導入"><a href="#pwa-導入" class="anchor-link">導入</a></h2>
    <p>
      プログレッシブWebアプリ（PWA）は、<a href="https://developer.mozilla.org/en/docs/Web/API/Service_Worker_API">Service Worker API<span class="fn">https://developer.mozilla.org/en/docs/Web/API/Service_Worker_API</span></a
      >などのプラットフォームプリミティブ上に構築される新しいクラスのWebアプリケーションです。Service Workerは、ネットワークプロキシとして機能し、Webアプリの発信要求をインターセプトしプログラムまたはキャッシュされた内容で応答することによりアプリがネットワークに依存しない読み込みをサポートできるようにします。Service Workerは、プッシュ通知を受信し、対応するアプリが実行されていなくてもバックグラウンドでデータを同期できます。さらに、Service Workerは、<a href="https://developer.mozilla.org/en-US/docs/Web/Manifest">Webアプリマニフェスト<span class="fn">https://developer.mozilla.org/en-US/docs/Web/Manifest</span></a
      >と共にユーザーがデバイスのホーム画面にPWAをインストールできるようにします。
    </p>
    <p>
      Service Workerは2014年12月に<a href="https://blog.chromium.org/2014/12/chrome-40-beta-powerful-offline-and.html">Chrome 40で初めて実装<span class="fn">https://blog.chromium.org/2014/12/chrome-40-beta-powerful-offline-and.html</span></a
      >され、プログレッシブWebアプリという用語は2015年に<a href="https://infrequently.org/2015/06/progressive-apps-escaping-tabs-without-losing-our-soul/">Frances BerrimanとAlex Russellによって作られました<span class="fn">https://infrequently.org/2015/06/progressive-apps-escaping-tabs-without-losing-our-soul/</span></a
      >。Service Workerはすべての主要なブラウザでようやく実装されたため、この章の目標は実際に存在するPWAの数と、これらの新しいテクノロジーをどのように利用するかを決定します。<a href="https://caniuse.com/#feat=background-sync">バックグラウンド同期<span class="fn">https://caniuse.com/#feat=background-sync</span></a
      >のような特定の高度なAPIは、現在もChromiumベースのブラウザでのみ利用できるため、追加の質問として、これらのPWAが実際に使用する機能を調べました。
    </p>
    <h2 id="pwa-service-worker"><a href="#pwa-service-worker" class="anchor-link">Service Worker</a></h2>
    <h3 id="pwa-service-workerの登録とインストール可能性"><a href="#pwa-service-workerの登録とインストール可能性" class="anchor-link">Service Workerの登録とインストール可能性</a></h3>
    <figure id="pwa-fig-1">
      <div class="big-number">0.44%</div>
      <figcaption><a href="#pwa-fig-1" class="anchor-link">図 1.</a> Service Workerを登録するデスクトップページの割合。</figcaption>
    </figure>
    <p>最初に検討する指標は、Service Workerのインストールです。 HTTP Archiveの機能カウンターを介して公開されたデータを見ると、すべてのデスクトップの0.44％とすべてのモバイルページの0.37％がService Workerを登録しており、時間の経過に伴う両方の曲線が急成長しています。</p>
    <figure id="pwa-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/pwa/fig2.png" class="fig-mobile">
        <img src="/static/images/2019/pwa/fig2.png" alt="図2.デスクトップおよびモバイルのService Workerの経時的なインストール。" aria-labelledby="pwa-fig2-caption" aria-describedby="pwa-fig2-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7DUzACr4eBhNU4cDz8-17oSx2qYbi9OFDjngz0NXNBP2IzZFxvDxLX2XThlN4SZymKMygOXzpI2AJ/pubchart?oid=251442414&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="pwa-fig2-description" class="visually-hidden">Service Workerのインストールの時系列チャート。 2017年1月以降、デスクトップとモバイルは約0.0％から約0.4％に着実に増加しています。</div>
      <figcaption id="pwa-fig2-caption"><a href="#pwa-fig-2" class="anchor-link">図 2.</a>デスクトップおよびモバイルのService Workerの経時的なインストール。</figcaption>
    </figure>
    <p>
      これはあまり印象的でないかもしれませんが、Chromeプラットフォームステータスからのトラフィックデータを考慮すると、Service Workerが<a href="https://www.chromestatus.com/metrics/feature/timeline/popularity/990">すべてのページロードの約15％<span class="fn">https://www.chromestatus.com/metrics/feature/timeline/popularity/990</span></a
      >を制御していることがわかります。トラフィックの多いサイトがますますService Workerを受け入れ始めています。
    </p>
    <figure id="pwa-fig-3">
      <div class="big-number">15%</div>
      <figcaption>
        <a href="#pwa-fig-3" class="anchor-link">図 3.</a>Service Workerを登録するページのページビューの割合。 （出典：Chromeプラットフォームステータス） (出典: <a href="https://www.chromestatus.com/metrics/feature/timeline/popularity/990">Chromeプラットフォームステータス<span class="fn">https://www.chromestatus.com/metrics/feature/timeline/popularity/990</span></a
        >)
      </figcaption>
    </figure>
    <p>
      <a href="#methodology-lighthouse">Lighthouse</a>は、ページが<a href="https://developers.google.com/web/tools/lighthouse/audits/install-prompt">インストールプロンプト<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/install-prompt</span></a
      >の対象かどうかを確認します。モバイルページの1.56％に<a href="https://web.dev/installable-manifest/">インストール可能なマニフェスト<span class="fn">https://web.dev/installable-manifest/</span></a
      >があります。
    </p>
    <p>
      インストール体験をコントロールするために、全デスクトップの0.82％と全モバイルページの0.94％が<a href="https://w3c.github.io/manifest/#beforeinstallpromptevent-interface"><code>OnBeforeInstallPrompt</code>インターフェイス<span class="fn">https://w3c.github.io/manifest/#beforeinstallpromptevent-interface</span></a
      >を使用します。現在、<a href="https://caniuse.com/#feat=web-app-manifest">サポートはChromiumベースのブラウザに限定されています<span class="fn">https://caniuse.com/#feat=web-app-manifest</span></a
      >。
    </p>
    <h3 id="pwa-service-workerイベント"><a href="#pwa-service-workerイベント" class="anchor-link">Service Workerイベント</a></h3>
    <p>
      Service Workerでは、<a href="https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle">いくつかのイベントをリッスンできます<span class="fn">https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle</span></a
      >。
    </p>
    <ul>
      <li><code>install</code>, Service Workerのインストール時に発生します。</li>
      <li><code>activate</code>, Service Workerのアクティベーション時に発生します。</li>
      <li><code>fetch</code>, リソースがフェッチされるたびに発生します。</li>
      <li><code>push</code>, プッシュ通知が到着したときに発生します。</li>
      <li><code>notificationclick</code>, 通知がクリックされたときに発生します。</li>
      <li><code>notificationclose</code>, 通知が閉じられたときに発生します。</li>
      <li><code>message</code>, <code>postMessage()</code>を介して送信されたメッセージが到着したときに発生します。</li>
      <li><code>sync</code>, バックグラウンド同期イベントが発生すると発生します。</li>
    </ul>
    <figure id="pwa-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/pwa/fig4.png">
        <img src="/static/images/2019/pwa/fig4.png" alt="図4. Service Workerイベントの人気。" aria-labelledby="pwa-fig4-caption" aria-describedby="pwa-fig4-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7DUzACr4eBhNU4cDz8-17oSx2qYbi9OFDjngz0NXNBP2IzZFxvDxLX2XThlN4SZymKMygOXzpI2AJ/pubchart?oid=2110574556&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="pwa-fig4-description" class="visually-hidden">さまざまなService Workerイベントの人気を示す棒グラフ。 Fetchは、モバイルService Workerの73％、インストール71％、アクティブ化56％、通知クリック10％、プッシュ8％、メッセージ5％、通知クローズ2％、同期1％で使用されます。デスクトップService Workerの使用方法は似ていますが、取得、インストール、およびアクティブ化の場合は若干低くなります。</div>
      <figcaption id="pwa-fig4-caption"><a href="#pwa-fig-4" class="anchor-link">図 4.</a> Service Workerイベントの人気。</figcaption>
    </figure>
    <p>HTTP Archiveで見つけることのできるService Workerがこれらのイベントのどれをリッスンしているかを調べました。モバイルとデスクトップの結果は非常によく似ており、<code>fetch</code>、<code>install</code>、および<code>activate</code>が3つの最も人気のあるイベントであり、それに続いて<code>notificationclick</code>と<code>push</code>が行われます。これらの結果を解釈すると、Service Workerが有効にするオフラインユースケースは、プッシュ通知よりもはるかに先のアプリ開発者にとって最も魅力的な機能です。可用性が限られているため、あまり一般的ではないユースケースのため、現時点ではバックグラウンド同期は重要な役割を果たしていません。</p>
    <h3 id="pwa-service-workerのファイルサイズ"><a href="#pwa-service-workerのファイルサイズ" class="anchor-link">Service Workerのファイルサイズ</a></h3>
    <p>一般に、ファイルサイズまたはコード行は、手元のタスクの複雑さの悪いプロキシです。ただし、この場合、モバイルとデスクトップのService Workerの（圧縮された）ファイルサイズを比較することは間違いなく興味深いです。</p>
    <figure id="pwa-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/pwa/fig5.png">
        <img src="/static/images/2019/pwa/fig5.png" alt="図5. Service Workerの転送サイズの分布。" aria-labelledby="pwa-fig5-caption" aria-describedby="pwa-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7DUzACr4eBhNU4cDz8-17oSx2qYbi9OFDjngz0NXNBP2IzZFxvDxLX2XThlN4SZymKMygOXzpI2AJ/pubchart?oid=345926232&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="pwa-fig5-description" class="visually-hidden">Service Workerの転送サイズの分布を示す棒グラフ。デスクトップService Worker転送サイズの10、25、50、75、および90パーセンタイルは、176、350、895、2,010、および4,138バイトです。デスクトップService Workerは、90パーセンタイルの1,000バイトから、パーセンタイルごとに大きくなります。</div>
      <figcaption id="pwa-fig5-caption"><a href="#pwa-fig-5" class="anchor-link">図 5.</a> Service Workerの転送サイズの分布。</figcaption>
    </figure>
    <p>
      デスクトップのService Workerファイルの中央値は895バイトですが、モバイルでは694バイトです。すべてのパーセンタイルを通じて、デスクトップService WorkerはモバイルService Workerよりも大きくなっています。これらの統計は、<a href="https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/importScripts"><code>importScripts()</code><span class="fn">https://developer.mozilla.org/en-US/docs/Web/API/WorkerGlobalScope/importScripts</span></a
      >メソッドを使用して動的にインポートされたスクリプトを考慮しないため、結果は大きく歪む可能性が高いことに注意してください。
    </p>
    <h2 id="pwa-webアプリマニフェスト"><a href="#pwa-webアプリマニフェスト" class="anchor-link">Webアプリマニフェスト</a></h2>
    <h3 id="pwa-webアプリマニフェストのプロパティ"><a href="#pwa-webアプリマニフェストのプロパティ" class="anchor-link">Webアプリマニフェストのプロパティ</a></h3>
    <p>Webアプリマニフェストは、ブラウザーにWebアプリケーションと、ユーザーのモバイルデバイスまたはデスクトップにインストールされたときの動作を通知する単純なJSONファイルです。典型的なマニフェストファイルには、アプリ名、使用するアイコン、起動時に開く開始URLなどに関する情報が含まれています。検出されたすべてのマニフェストの1.54％のみが無効なJSONであり、残りは正しく解析されました。</p>
    <p>
      <a href="https://w3c.github.io/manifest/#webappmanifest-dictionary">Web App Manifest仕様<span class="fn">https://w3c.github.io/manifest/#webappmanifest-dictionary</span></a
      >で定義されているさまざまなプロパティを調べ、非標準の独自プロパティも検討しました。仕様によると、次のプロパティが許可されています。
    </p>
    <ul>
      <li><code>dir</code></li>
      <li><code>lang</code></li>
      <li><code>name</code></li>
      <li><code>short_name</code></li>
      <li><code>description</code></li>
      <li><code>icons</code></li>
      <li><code>screenshots</code></li>
      <li><code>categories</code></li>
      <li><code>iarc_rating_id</code></li>
      <li><code>start_url</code></li>
      <li><code>display</code></li>
      <li><code>orientation</code></li>
      <li><code>theme_color</code></li>
      <li><code>background_color</code></li>
      <li><code>scope</code></li>
      <li><code>serviceworker</code></li>
      <li><code>related_applications</code></li>
      <li><code>prefer_related_applications</code></li>
    </ul>
    <p>私たちが野生で観察しなかった唯一のプロパティは<code>iarc_rating_id</code>でした。これは、Webアプリケーションの国際年齢評価連合（IARC）認定コードを表す文字列です。 Webアプリケーションがどの年齢に適しているかを判断するために使用することを目的としています。</p>
    <figure id="pwa-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/pwa/fig6.png">
        <img src="/static/images/2019/pwa/fig6.png" alt="図6. Webアプリマニフェストプロパティの人気。" aria-labelledby="pwa-fig6-caption" aria-describedby="pwa-fig6-description" width="600" height="452" data-width="600" data-height="452" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7DUzACr4eBhNU4cDz8-17oSx2qYbi9OFDjngz0NXNBP2IzZFxvDxLX2XThlN4SZymKMygOXzpI2AJ/pubchart?oid=1904325089&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="pwa-fig6-description" class="visually-hidden">デスクトップおよびモバイル向けのWebアプリマニフェストプロパティの人気を示す棒グラフ。デスクトップWebアプリマニフェストの88％には、名前プロパティ、82％はアイコン、61％はディスプレイ、55％はテーマカラー、49％は背景色、45％はショートネーム、36％は開始URL、19％はGCM送信者ID、9％はGCMユーザーのみ表示、9％はオリエンテーション、説明7％、範囲5％、言語4％。モバイルWebアプリマニフェストでのプロパティの人気は似ており、プラスまたはマイナス2パーセントポイントです。</div>
      <figcaption id="pwa-fig6-caption"><a href="#pwa-fig-6" class="anchor-link">図 6.</a> Webアプリマニフェストプロパティの人気。</figcaption>
    </figure>
    <p>頻繁に遭遇した独自のプロパティは、従来のGoogle Cloud Messaging（GCM）サービスの<code>gcm_sender_id</code>と<code>gcm_user_visible_only</code>でした。興味深いことに、モバイルとデスクトップにはほとんど違いがありません。ただし、両方のプラットフォームで、ブラウザーによって解釈されないプロパティの長いテールがありますが、<code>作成者</code>や<code>バージョン</code>などの潜在的に有用なメタデータが含まれています。また、重要なタイプミスのプロパティもありました。私たちのお気に入りは、<code>short_name</code>ではなく<code>shot_name</code>です。興味深い外れ値は<code>serviceworker</code>プロパティです。これは標準ですが、ブラウザベンダーによって実装されていません。それでも、モバイルおよびデスクトップページで使用されるすべてのWebアプリマニフェストの0.09％で見つかりました。</p>
    <h3 id="pwa-値を表示する"><a href="#pwa-値を表示する" class="anchor-link">値を表示する</a></h3>
    <p>開発者が<code>display</code>プロパティに設定した値を見ると、PWAがWebテクノロジーの起源を明かさない「適切な」アプリとして認識されることを望んでいることがすぐに明らかになります。</p>
    <figure id="pwa-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/pwa/fig7.png">
        <img src="/static/images/2019/pwa/fig7.png" alt="図7. Webアプリマニフェストのdisplayプロパティの使用法。" aria-labelledby="pwa-fig7-caption" aria-describedby="pwa-fig7-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7DUzACr4eBhNU4cDz8-17oSx2qYbi9OFDjngz0NXNBP2IzZFxvDxLX2XThlN4SZymKMygOXzpI2AJ/pubchart?oid=1514793237&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="pwa-fig7-description" class="visually-hidden">Webアプリマニフェストの表示プロパティがデスクトップおよびモバイルWebサイトでどのように使用されるかを示す棒グラフ。どちらの場合も、57％の時間で「standalone」値が使用されます。マニフェストの38％でプロパティがまったく設定されていません。 「minimal UI」、「browser」、および「fullscreen」の各値は、使用量の1〜2％のみを占めています。</div>
      <figcaption id="pwa-fig7-caption"><a href="#pwa-fig-7" class="anchor-link">図 7.</a> Webアプリマニフェストの<code>display</code>プロパティの使用法。</figcaption>
    </figure>
    <p><code>standalone</code>を選択することで、エンドユーザーにブラウザUIが表示されないようにします。これは、<code>prefers_related_applications</code>プロパティを使用するアプリの大部分に反映されています。モバイルアプリケーションとデスクトップアプリケーションの両方の97％がネイティブアプリケーションを優先していません。</p>
    <h3 id="pwa-category値"><a href="#pwa-category値" class="anchor-link">Category値</a></h3>
    <p><code>categories</code>プロパティは、Webアプリケーションが属する予想されるアプリケーションカテゴリを記述します。これは、Webアプリケーションをリストするカタログまたはアプリストアへのヒントとしてのみ意図されており、Webサイトは1つ以上の適切なカテゴリに自分自身をリストするために最善を尽くすことが期待されます。</p>
    <figure id="pwa-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/pwa/fig8.png">
        <img src="/static/images/2019/pwa/fig8.png" alt="図8.上位のWebアプリマニフェストカテゴリ。" aria-labelledby="pwa-fig8-caption" aria-describedby="pwa-fig8-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7DUzACr4eBhNU4cDz8-17oSx2qYbi9OFDjngz0NXNBP2IzZFxvDxLX2XThlN4SZymKMygOXzpI2AJ/pubchart?oid=1609487902&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="pwa-fig8-description" class="visually-hidden">上位のWebアプリマニフェストカテゴリを示す棒グラフ。 60個のモバイルマニフェストは「ショッピング」カテゴリ、15個は「ビジネス」、9個は「ウェブ」、9個は「テクノロジー」、8個は「ゲーム」、8個は「エンターテイメント」、7個は「ソーシャル」などです。 「ショッピング」の場合、デスクトップマニフェストは1つだけです。</div>
      <figcaption id="pwa-fig8-caption"><a href="#pwa-fig-8" class="anchor-link">図 8.</a>上位のWebアプリマニフェストカテゴリ。</figcaption>
    </figure>
    <p>このプロパティを利用したマニフェストはあまり多くありませんでしたが、モバイルで最も人気のあるカテゴリである「ショッピング」から「ビジネス」「テクノロジー」、そして最初の場所を均等に共有するデスクトップ上の「ウェブ」（それが意味するものは何でも）。</p>
    <h3 id="pwa-アイコンのサイズ"><a href="#pwa-アイコンのサイズ" class="anchor-link">アイコンのサイズ</a></h3>
    <p>
      Lighthouseには少なくとも192X192ピクセルのサイズのアイコンが<a href="https://developers.google.com/web/tools/lighthouse/audits/manifest-contains-192px-icon">必要<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/manifest-contains-192px-icon</span></a
      >ですが、一般的なファビコン生成ツールは他のサイズのアイコンも大量に作成します。
    </p>
    <figure id="pwa-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/pwa/fig9.png">
        <img src="/static/images/2019/pwa/fig9.png" alt="図9.上位のWebアプリマニフェストアイコンのサイズ。" aria-labelledby="pwa-fig9-caption" aria-describedby="pwa-fig9-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7DUzACr4eBhNU4cDz8-17oSx2qYbi9OFDjngz0NXNBP2IzZFxvDxLX2XThlN4SZymKMygOXzpI2AJ/pubchart?oid=1369881840&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="pwa-fig9-description" class="visually-hidden">上位のWebアプリマニフェストアイコンサイズプロパティ値の使用状況を示す棒グラフ。すべての値は高さと幅のピクセルで指定されます。たとえば、マニフェストの23％のトップ値は192X192ピクセルです。次に人気のあるサイズは、11％で144、11％で96、10％で72、10％で48、9％で512、9％で36％、5％で256、2％で384、1%で128、そして1％で152です。デスクトップとモバイルの使用パターンは同じです。</div>
      <figcaption id="pwa-fig9-caption"><a href="#pwa-fig-9" class="anchor-link">図 9.</a>上位のWebアプリマニフェストアイコンのサイズ。</figcaption>
    </figure>
    <p>
      Lighthouseのルールが、おそらくアイコンサイズ選択の犯人で、192ピクセルがデスクトップとモバイルの両方で最も人気があります。<a href="https://developers.google.com/web/fundamentals/web-app-manifest#icons">Googleのドキュメント<span class="fn">https://developers.google.com/web/fundamentals/web-app-manifest#icons</span></a
      >で512X512を明示的に推奨していますが、これは特に目立つオプションとしては表示されてません。
    </p>
    <h3 id="pwa-orientation値"><a href="#pwa-orientation値" class="anchor-link">Orientation値</a></h3>
    <p>
      <code>orientation</code>プロパティの有効な値は、<a href="https://www.w3.org/TR/screen-orientation/#dom-orientationlocktype">画面方向API仕様<span class="fn">https://www.w3.org/TR/screen-orientation/#dom-orientationlocktype</span></a
      >で定義されています。現在、それらは次のとおりです。
    </p>
    <ul>
      <li><code>"any"</code></li>
      <li><code>"natural"</code></li>
      <li><code>"landscape"</code></li>
      <li><code>"portrait"</code></li>
      <li><code>"portrait-primary"</code></li>
      <li><code>"portrait-secondary"</code></li>
      <li><code>"landscape-primary"</code></li>
      <li><code>"landscape-secondary"</code></li>
    </ul>
    <figure id="pwa-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/pwa/fig10.png">
        <img src="/static/images/2019/pwa/fig10.png" alt="図10.上位のWebアプリマニフェストのOrientation値。" aria-labelledby="pwa-fig10-caption" aria-describedby="pwa-fig10-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT7DUzACr4eBhNU4cDz8-17oSx2qYbi9OFDjngz0NXNBP2IzZFxvDxLX2XThlN4SZymKMygOXzpI2AJ/pubchart?oid=2065142361&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="pwa-fig10-description" class="visually-hidden">上位のWebアプリマニフェストの方向の値を示す棒グラフ。 「Portrait」はデスクトップマニフェストの6％に設定され、2％に「any」が続き、マニフェストの1％未満に他のすべてが設定されます。これはモバイルマニフェストでの使用に似ていますが、マニフェストの8％で「portrait」が設定され、1％で「portrait-primary」が設定されます。</div>
      <figcaption id="pwa-fig10-caption"><a href="#pwa-fig-10" class="anchor-link">図 10.</a>上位のWebアプリマニフェストのOrientation値。</figcaption>
    </figure>
    <p><code>「portrait」</code>オリエンテーションは両方のプラットフォームで明確な勝者であり、<code>「any」</code>オリエンテーションがそれに続きます。</p>
    <h2 id="pwa-workbox"><a href="#pwa-workbox" class="anchor-link">Workbox</a></h2>
    <p>
      <a href="https://developers.google.com/web/tools/workbox">Workbox<span class="fn">https://developers.google.com/web/tools/workbox</span></a
      >は、一般的なService Workerのユースケースを支援する一連のライブラリです。たとえばWorkboxには、ビルドプロセスにプラグインしてファイルのマニフェストを生成できるツールがあり、Service Workerによって事前にキャッシュされます。 Workboxには、ランタイムキャッシング、リクエストルーティング、キャッシュの有効期限、バックグラウンド同期などを処理するライブラリが含まれています。
    </p>
    <p>
      Service Worker APIの低レベルの性質を考慮すると、多くの開発者は、Service Workerロジックをより高レベルで再利用可能なコードの塊に構造化する方法としてWorkboxに注目しています。 Workboxの採用は、<a href="https://create-react-app.dev/"><code>create-react-app</code><span class="fn">https://create-react-app.dev/</span></a
      >や<a href="https://www.npmjs.com/package/@vue/cli-plugin-pwa">VueのPWAプラグイン<span class="fn">https://www.npmjs.com/package/@vue/cli-plugin-pwa</span></a
      >など、多くの一般的なJavaScriptフレームワークスターターキットの機能として含まれることによっても促進されます。
    </p>
    <p>HTTP Archiveは、Service Workerを登録するWebサイトの12.71％が少なくとも1つのWorkboxライブラリを使用していることを示しています。この割合は、デスクトップ（14.36％）と比較してモバイルではわずかに低い割合（11.46％）で、デスクトップとモバイルでほぼ一貫しています。</p>
    <h2 id="pwa-結論"><a href="#pwa-結論" class="anchor-link">結論</a></h2>
    <p>この章の統計は、PWAがまだごく一部のサイトでしか使用されていないことを示しています。ただし、この比較的少ない使用量はトラフィックのシェアがはるかに大きい人気のあるサイトによってもたらされ、ホームページ以外のページはこれをさらに使用する可能性があります。ページのロードの15％がService Workerを使用することがわかりました。特に<a href="#mobile-web">モバイル</a>向けの<a href="#performance">パフォーマンス</a>と<a href="#caching">キャッシング</a>のより優れた制御に与える利点は、使用が増え続けることを意味するはずです。</p>
    <p>
      PWAは、Chrome主導のテクノロジーと見なされることがよくあります。一部のプラットフォームでは一流のインストール可能性が遅れているものの、他のブラウザは、基盤となるテクノロジーのほとんどを実装するために最近大きく進歩しました。サポートがさらに普及するのを前向きに見る事ができます。 <a href="https://twitter.com/firt">Maximiliano Firtman<span class="fn">https://twitter.com/firt</span></a
      >は、<a href="https://medium.com/@firt/iphone-11-ipados-and-ios-13-for-pwas-and-web-development-5d5d9071cc49">Safari PWAサポートの説明<span class="fn">https://medium.com/@firt/iphone-11-ipados-and-ios-13-for-pwas-and-web-development-5d5d9071cc49</span></a
      >など、iOSでこれを追跡する素晴らしい仕事をしています。 AppleはPWAという用語をあまり使用せず、<a href="https://developer.apple.com/news/?id=09062019b">HTML5アプリはApp Storeの外部に最適配信されると明示的に述べています<span class="fn">https://developer.apple.com/news/?id=09062019b</span></a
      >。Microsoftは逆の方向に進み、<a href="https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps/microsoft-store">アプリストアでPWAを奨励するだけでなく、Bing Webクローラーを介して検出されたPWAを自動的にショートリストに追加しました<span class="fn">https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps/microsoft-store</span></a
      >。 Googleは、<a href="https://developers.google.com/web/updates/2019/02/using-twa">信頼できるWebアクティビティ<span class="fn">https://developers.google.com/web/updates/2019/02/using-twa</span></a
      >を介して、Google PlayストアにWebアプリをリストする方法も提供しています。
    </p>
    <p>PWAは、ネイティブプラットフォームやアプリストアではなくWeb上でビルドおよびリリースすることを希望する開発者に道を提供します。すべてのOSとブラウザがネイティブソフトウェアと完全に同等であるとは限りませんが、改善は継続され、おそらく2020年は展開が爆発的に増加する年になるでしょうか？</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"II","chapter_number":12,"title":"モバイルウェブ","description":"2019年Web AlmanacのモバイルWebの章では、ページの読み込み、テキストコンテンツ、拡大縮小、ボタンやリンク、フォームへの記入のしやすさなどをカバーしています。","authors":["obto"],"reviewers":["AymenLoukil","hyperpress"],"translators":["ksakae"],"discuss":"1767","results":"https://docs.google.com/spreadsheets/d/1dPBDeHigqx9FVaqzfq7CYTz4KjllkMTkfq4DG4utE_g/","queries":"12_Mobile_Web","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-05-27T00:00:00.000Z","chapter":"mobile-web"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="mobile-web-序章introduction"><a href="#mobile-web-序章introduction" class="anchor-link">序章Introduction</a></h2>
    <p>2007年に少し戻ってみましょう。「モバイルウェブ」は現在、レーダー上ではほんの一瞬の出来事に過ぎませんが、それには正当な理由があります。なぜでしょうか？　モバイルブラウザはCSSをほとんどサポートしていないため、サイトの見た目がデスクトップとは全く異なります。画面は信じられないほど小さく、一度に数行のテキストしか表示できません。また、マウスの代わりとなるのは、「タブを使って移動する」ための小さな矢印キーです。言うまでもなく、携帯電話でウェブを閲覧することは本当に愛の労働です。 しかし、このすべてをちょうど変更しようとしている。</p>
    <p>プレゼンの途中、スティーブ・ジョブズは発表されたばかりのiPhoneを手にして座り、それまで夢見ていた方法でウェブサーフィンを始めます。大きな画面とフル機能のブラウザで、ウェブサイトをフルに表示します。そして最も重要なことは、人間に知られている最も直感的なポインターデバイスを使ってウェブサーフィンをすることです：私たちの指。小さな矢印キーを使って、これ以上のタブ操作はありません。</p>
    <p>
      2007年以降、モバイルウェブは爆発的な成長を遂げました。そして13年後の現在、2019年7月の<a href="https://developer.akamai.com/akamai-mpulse-real-user-monitoring-solution">Akamai mPulse<span class="fn">https://developer.akamai.com/akamai-mpulse-real-user-monitoring-solution</span></a
      >のデータによると、モバイルは<a href="https://www.merkleinc.com/thought-leadership/digital-marketing-report">全検索の 59%<span class="fn">https://www.merkleinc.com/thought-leadership/digital-marketing-report</span></a
      >と全ウェブトラフィックの58.7％を占めています。モバイルはもはや余計なものでなく、人々がウェブを体験する主要な方法となっています。モバイルの重要性を考えると、私たちは訪問者にどのような体験を提供しているのでしょうか？　どこが不足しているのか？　それを探ってみましょう。
    </p>
    <h2 id="mobile-web-ページの読み込み体験"><a href="#mobile-web-ページの読み込み体験" class="anchor-link">ページの読み込み体験</a></h2>
    <p>私たちが分析したモバイルウェブ体験の最初の部分は、私たちが最も身近に感じているものです。<em>ページの読み込み体験</em>です。しかし、今回の調査結果へ飛び込む前に、典型的なモバイルユーザーが<em>実際に</em>どのようなユーザーであるかについて全員が同じ見解を持っていることを確認しておきましょう。これは、これらの結果を再現するのに役立つだけでなく、これらのユーザーをよりよく理解することにもつながるからです。</p>
    <p>
      まずは、典型的なモバイルユーザーがどのような電話を持っているかから始めましょう。平均的なAndroid携帯電話<a href="https://web.archive.org/web/20190921115844/https://www.idc.com/getdoc.jsp?containerId=prUS45115119">価格は～250ドル<span class="fn">https://web.archive.org/web/20190921115844/https://www.idc.com/getdoc.jsp?containerId=prUS45115119</span></a
      >で、その範囲内の<a href="https://web.archive.org/web/20190812221233/https://deviceatlas.com/blog/most-popular-android-smartphones">最も人気のある携帯電話<span class="fn">https://web.archive.org/web/20190812221233/https://deviceatlas.com/blog/most-popular-android-smartphones</span></a
      >の1つは、サムスンのギャラクシーS6です。だから、これはおそらく典型的なモバイルユーザーが使用している携帯電話の種類であり、実際にはiPhone 8よりも4倍遅いです。このユーザーは、高速な4G接続へのアクセス権を持っていませんが、むしろ2G接続（<a href="https://www.gsma.com/r/mobileeconomy/">29%<span class="fn">https://www.gsma.com/r/mobileeconomy/</span></a
      >時間の）または3G接続（<a href="https://www.gsma.com/r/mobileeconomy/">28%<span class="fn">https://www.gsma.com/r/mobileeconomy/</span></a
      >時間の）を使用しています。そして、これが全ての足し算になります。
    </p>
    <figure id="mobile-web-fig-1">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>Connection type</th>
                <td>
                  <a href="https://www.gsma.com/r/mobileeconomy/">2G or 3G<span class="fn">https://www.gsma.com/r/mobileeconomy/</span></a>
                </td>
              </tr>
              <tr>
                <th>Latency</th>
                <td>300 - 400ms</td>
              </tr>
              <tr>
                <th>Bandwidth</th>
                <td>0.4 - 1.6Mbps</td>
              </tr>
              <tr>
                <th>Phone</th>
                <td>
                  <a href="https://www.gsmarena.com/samsung_galaxy_s6-6849.php">Galaxy S6<span class="fn">https://www.gsmarena.com/samsung_galaxy_s6-6849.php</span></a> — <a href="https://www.notebookcheck.net/A11-Bionic-vs-7420-Octa_9250_6662.247596.0.html">4x slower<span class="fn">https://www.notebookcheck.net/A11-Bionic-vs-7420-Octa_9250_6662.247596.0.html</span></a> than iPhone 8 (Octane V2 score)
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#mobile-web-fig-1" class="anchor-link">図 1.</a> 典型的なモバイルユーザーの技術的プロフィール。</figcaption>
    </figure>
    <p>この結果に驚かれる方もいらっしゃると思います。あなたがこれまでにサイトをテストしたことのある条件よりも、はるかに悪い条件かもしれません。しかし、モバイルユーザーが本当にどのようなものなのかということについては、今はみんな同じページにいるのでさっそく始めてみましょう。</p>
    <h3 id="mobile-web-javascriptで肥大化したページ"><a href="#mobile-web-javascriptで肥大化したページ" class="anchor-link">JavaScriptで肥大化したページ</a></h3>
    <p>
      モバイルウェブのJavaScriptの状態が恐ろしい。HTTP Archiveの <a href="https://httparchive.org/reports/state-of-javascript?start=2016_05_15&amp;end=2019_07_01&amp;view=list#bytesJs">JavaScript レポート<span class="fn">https://httparchive.org/reports/state-of-javascript?start=2016_05_15&amp;end=2019_07_01&amp;view=list#bytesJs</span></a
      >によると、モバイルサイトの中央値では、携帯電話が375KBのJavaScriptをダウンロードする必要があります。圧縮率を70％と仮定すると、携帯電話は中央値で1.25MBのJavaScriptを解析、コンパイル、実行しなければならないことになります。
    </p>
    <p>
      なぜこれが問題なのでしょうか？　なぜなら、これだけの量のJSをロードしているサイトは、一貫してインタラクティブになるまで<a href="https://httparchive.org/reports/loading-speed?start=earliest&amp;end=2019_07_01&amp;view=list#ttci">10秒<span class="fn">https://httparchive.org/reports/loading-speed?start=earliest&amp;end=2019_07_01&amp;view=list#ttci</span></a
      >以上かかるからです。言い換えればページは完全に読み込まれているように見えるかもしれませんが、ユーザーがボタンやメニューをクリックするとJavaScriptの実行が終了していないために、ユーザーは多少の速度低下を経験するかもしれません。最悪の場合、ユーザーは10秒以上ボタンをクリックし続けなければならず、何かが実際に起こる魔法のような瞬間を待つことになります。それがどれほど混乱し、イライラさせるかを考えてみてください。
    </p>
    <figure id="mobile-web-fig-2">
      <iframe class="fig-mobile fig-desktop video-embed" width="560" height="315" src="https://www.youtube.com/embed/Lx1cYJAVnzA" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" aria-labelledby="mobile-web-fig2-caption" aria-describedby="mobile-web-fig2-description"></iframe>
      <a class="video-fallback-image" href="https://www.youtube.com/embed/Lx1cYJAVnzA">
        <img src="/static/images/2019/mobile-web/fig2.png" alt="図2. JS がロードされるのを待つのがいかに苦痛であるかの例。" aria-labelledby="mobile-web-fig2-caption" aria-describedby="mobile-web-fig2-description" width="610" height="343" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="mobile-web-fig2-description" class="visually-hidden">2つのWebページのロードを示すビデオ。各ページは、ビデオ全体でボタンを繰り返しタップする図がありますが、効果はありません。上部には0秒から刻々と刻む時計があり、各Webサイトの最初の幸せな絵文字の顔は、時計が6秒を過ぎると幸せになり始め、8秒で目が大きく、10秒で怒り、 13秒、19秒で泣いてすぐにビデオが終了します。</div>
      <figcaption id="mobile-web-fig2-caption"><a href="#mobile-web-fig-2" class="anchor-link">図 2.</a> JS がロードされるのを待つのがいかに苦痛であるかの例。</figcaption>
    </figure>
    <p>
      さらに深く掘り下げて、各ページがJavaScriptをどの程度利用しているかに焦点を当てた別の指標を見てみましょう。例えば、読み込み中のページは本当に多くのJavaScriptを必要としているのでしょうか？　私たちはこの指標を<a href="https://www.webbloatscore.com/">Web bloat score<span class="fn">https://www.webbloatscore.com/</span></a
      >に基づいた<em>JavaScript Bloat Score</em>と呼んでいます。その背後にある考え方は次のようなものです。
    </p>
    <ul>
      <li>JavaScriptは、ページの読み込みに合わせて生成と変更の両方を行うためによく使われます。</li>
      <li>また、ブラウザにテキストとして配信されます。そのため、よく圧縮され、ただのページのスクリーンショットよりも速く配信されるはずです。</li>
      <li>そのため、ページがダウンロードするJavaScriptの総量がビューポートのPNGスクリーンショットよりも多い場合（画像やCSSなどを含まない）、私たちはあまりにも多くのJavaScriptを使用していることになります。この時点では、スクリーンショットを送信してページの初期状態を取得した方が早いでしょう!</li>
    </ul>
    <p class="note">*JavaScript Bloat Score*は以下のように定義されています。(JavaScriptの総サイズ)/(ビューポートのPNGスクリーンショットのサイズ)で定義されます。1.0より大きい数値は、スクリーンショットを送信するのが速いことを意味します。</p>
    <p>その結果は？　分析した500万以上のウェブサイトのうち75.52％がJavaScriptで肥大化していました。まだまだ先は長いですね。</p>
    <p>分析した500万以上のサイトすべてのスクリーンショットをキャプチャして測定できなかったことに注意してください。代わりに、1000のサイトからランダムにサンプリングして、ビューポートのスクリーンショットサイズの中央値（140KB）を見つけ各サイトのJavaScriptダウンロードサイズをこの数値と比較しました。</p>
    <p>
      JavaScriptの効果をもっと詳しく知りたい方は、Addy Osmaniの<a href="https://medium.com/@addyosmani/the-cost-of-javascript-in-2018-7d8950fbb5d4">The Cost of JavaScript in 2018<span class="fn">https://medium.com/@addyosmani/the-cost-of-javascript-in-2018-7d8950fbb5d4</span></a
      >をチェックしてみてください。
    </p>
    <h3 id="mobile-web-サービスワーカーの使い方"><a href="#mobile-web-サービスワーカーの使い方" class="anchor-link">サービスワーカーの使い方</a></h3>
    <p>
      ブラウザは通常、すべてのページを同じように読み込みます。いくつかのリソースのダウンロードを他のリソースよりも優先したり、同じキャッシュルールに従ったりします。<a href="https://developers.google.com/web/fundamentals/primers/service-workers">サービスワーカー<span class="fn">https://developers.google.com/web/fundamentals/primers/service-workers</span></a
      >のおかげで、リソースがネットワーク層によってどのように処理されるかを直接制御できるようになりました。
    </p>
    <p>2016年から利用可能になり、すべての主要ブラウザに実装されているにもかかわらず、利用しているサイトはわずか0.64％にとどまっています!</p>
    <h3 id="mobile-web-読み込み中にコンテンツを移動する"><a href="#mobile-web-読み込み中にコンテンツを移動する" class="anchor-link">読み込み中にコンテンツを移動する</a></h3>
    <p>ウェブの最も美しい部分の1つは、ウェブページのロードが自然と進んでいくことです。ブラウザはできる限り早くコンテンツをダウンロードして表示するため、ユーザーはできるだけ早くあなたのコンテンツに引き込む事ができます。しかし、このことを念頭に置いてサイトを設計しないと、悪影響を及ぼす可能性があります。具体的には、リソースのロードに合わせてコンテンツの位置がずれることで、ユーザー体験の妨げになることがあります。</p>
    <figure id="mobile-web-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/mobile-web/example-of-a-site-shifting-content-while-it-loads-lookzook.gif">
        <img src="/static/images/2019/mobile-web/example-of-a-site-shifting-content-while-it-loads-lookzook.gif" alt="図3. シフト内容が読者の気を散らす例 CLS合計42.59％。画像提供：LookZook" aria-labelledby="mobile-web-fig3-caption" aria-describedby="mobile-web-fig3-description" width="360" height="640" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="mobile-web-fig3-description" class="visually-hidden">Webサイトの読み込みが進んでいく様子を動画で紹介しています。テキストは素早く表示されますが、画像が読み込まれ続けると、テキストはページの下にどんどん移動していき、読むのに非常にイライラします。この例の計算されたCLSは42.59%です。画像提供：LookZook</div>
      <figcaption id="mobile-web-fig3-caption"><a href="#mobile-web-fig-3" class="anchor-link">図 3.</a> シフト内容が読者の気を散らす例 CLS合計42.59％。画像提供：LookZook</figcaption>
    </figure>
    <p>あなたが記事を読んでいるときに突然、画像が読み込まれ、読んでいるテキストが画面の下に押し出されたと想像してみてください。あなたは今、あなたがいた場所を探すか、ちょうど記事を読むことをあきらめなければなりません。または、おそらくさらに悪いことに、同じ場所に広告がロードされる直前にリンクをクリックし始め、代わりに広告を誤ってクリックしてしまうことになります。</p>
    <p>
      では、どのようにしてサイトの移動量を測定するのでしょうか？　以前はかなり困難でしたが（不可能ではないにしても）、新しい <a href="https://web.dev/layout-instability-api">レイアウトの不安定性API<span class="fn">https://web.dev/layout-instability-api</span></a> のおかげで、2ステップで測定を行うことができます。
    </p>
    <ol>
      <li><p>レイアウトの不安定性APIを使用して、各シフトがページに与える影響を追跡します。これは、ビューポート内のコンテンツがどれだけ移動したかのパーセンテージとして報告されます。</p></li>
      <li>
        <p>
          あなたが追跡したすべてのシフトを取り、それらを一緒に追加します。その結果が <a href="https://web.dev/layout-instability-api#a-cumulative-layout-shift-score">累積レイアウトシフト<span class="fn">https://web.dev/layout-instability-api#a-cumulative-layout-shift-score</span></a
          >(CLS)スコアと呼ばれるものです。
        </p>
      </li>
    </ol>
    <p>訪問者ごとに異なるCLSを持つことができるため、<a href="#methodology-chrome-ux-report">Chrome UX Report</a> (./methodology#chrome-UX-report)(CrUX)を使用してウェブ全体でこのメトリックを分析するために、すべての体験を3つの異なるバケットにまとめています。</p>
    <ul>
      <li><strong>Small</strong>CLSを持っている方。CLSが<em>5%未満</em>になった経験あり。つまり、ページはほとんど安定していて、まったくズレないということです。参考までに、上の動画のページのCLSは42.59％です。</li>
      <li><strong>Large</strong>CLSを持っている方。CLSが<em>100%以上</em>ある経験。これは小さな個別シフトが多い場合と、大きく目立つシフトが多い場合の2つあります。</li>
      <li><strong>Medium</strong> CLSを持っている方。SmallとLargeの間にあるもの。</li>
    </ul>
    <p>では、ウェブをまたいでCLSを見ると、何が見えてくるのでしょうか？</p>
    <ol>
      <li><p>3サイトに2サイト近く（65.32％）が、全ユーザー体験の50％以上を占めるMediumかLargeCLSを持っています。</p></li>
      <li><p>20.52％のサイトでは、全ユーザー体験の少なくとも半分がLargeCLSを持っています。これは、約5つのウェブサイトの1つに相当します。図3の動画のCLSは42.59％に過ぎないことを覚えておいてください - これらの体験はそれよりもさらに悪いのです。</p></li>
    </ol>
    <p>この原因の多くは広告や画像など、テキストが画面にペイントされた後、読み込まれるリソースの幅や高さをウェブサイトが明示的に提供していないことにあるのではないかと考えられています。ブラウザがリソースを画面に表示する前、そのリソースがどのくらいのスペースを占めるかを知る必要があります。そのため、CSSやHTML属性でサイズが明示的に指定されていない限り、ブラウザはリソースが実際にどのくらいの大きさなのかを知ることができず、読み込まれるまでは幅と高さを0pxにして表示します。リソースが読み込まれ、ブラウザがリソースの大きさをようやく知ると、ページの内容がずれるため、不安定なレイアウトになってしまいます。</p>
    <h3 id="mobile-web-パーミッションリクエスト"><a href="#mobile-web-パーミッションリクエスト" class="anchor-link">パーミッションリクエスト</a></h3>
    <p>ここ数年、ウェブサイトと「アプリストア」アプリの境界線が曖昧になり続けています。今でもユーザーのマイク、ビデオカメラ、ジオロケーション、通知を表示する機能などへのアクセスを要求する機能があります。</p>
    <p>これは開発者にとってさらに多くの機能を開放していますが、これらのパーミッションを不必要に要求するとユーザーがあなたのウェブページを警戒していると感じたままになり、不信感を抱くことになりかねません。これは私たちが常に「私の近くの劇場を探す」ボタンをタップするようなユーザーのジェスチャーにパーミッションリクエストを結びつけることをお勧めする理由です。</p>
    <p>現在、1.52％のサイトがユーザーとの対話なしに許可を要求しています。このような低い数字を見ると励みになります。しかし、我々はホームページのみを分析できたことに注意することが重要です。そのため、例えば、コンテンツページ（例えばブログ記事）のみにパーミッションを要求しているサイトは考慮されていませんでした。詳細については、<a href="#methodology">方法論</a>のページを参照してください。</p>
    <h2 id="mobile-web-テキストの内容"><a href="#mobile-web-テキストの内容" class="anchor-link">テキストの内容</a></h2>
    <p>ウェブページの第一の目標は、ユーザーが興味を持ってくれるコンテンツを配信することです。このコンテンツは、YouTubeのビデオや画像の詰め合わせかもしれませんが、多くの場合、ページ上のテキストだけかもしれません。テキストコンテンツが訪問者にとって読みやすいものであることが非常に重要であることは言うまでもありません。なぜなら、訪問者が読めなければ何も残っておらず、離脱してしまうからです。テキストが読みやすいかどうかを確認するには、色のコントラストとフォントサイズの2つが重要です。</p>
    <h3 id="mobile-web-カラーコントラスト"><a href="#mobile-web-カラーコントラスト" class="anchor-link">カラーコントラスト</a></h3>
    <p>
      サイトをデザインするとき、私たちは最適な状態で、多くの訪問者よりもはるかに優れた目を持っている傾向があります。訪問者は色盲で、テキストと背景色の区別をできない場合があります。ヨーロッパ系の人は、<a href="http://www.cvrl.org/people/stockman/pubs/1999%20Genetics%20chapter%20SSJN.pdf">男性の12人に1人、女性の200人に1人<span class="fn">http://www.cvrl.org/people/stockman/pubs/1999%20Genetics%20chapter%20SSJN.pdf</span></a
      >が色盲です。あるいは、太陽の光が画面にまぶしさを与えている間にページを読んでいる可能性があり、同様に読みやすさが損なわれている可能性があります。
    </p>
    <p>
      この問題を軽減するために、テキストや背景色を選択する際に従うことのできる<a href="https://dequeuniversity.com/rules/axe/2.2/color-contrast">アクセシビリティ・ガイドライン<span class="fn">https://dequeuniversity.com/rules/axe/2.2/color-contrast</span></a
      >があります。では、これらの基準を満たすにはどうすればよいのでしょうか？　すべてのテキストに十分な色のコントラストを与えているサイトは22.04％にすぎません。この値は実際には下限値であり、背景が無地のテキストのみを分析したためです。画像やグラデーションの背景は分析できませんでした。
    </p>
    <figure id="mobile-web-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/mobile-web/example-of-good-and-bad-color-contrast-lookzook.svg">
        <img src="/static/images/2019/mobile-web/example-of-good-and-bad-color-contrast-lookzook.svg" alt="図4. 色のコントラストが不十分なテキストがどのように見えるかの例。提供：LookZook" aria-labelledby="mobile-web-fig4-caption" aria-describedby="mobile-web-fig4-description" width="568" height="300" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="mobile-web-fig4-description" class="visually-hidden">褐色とグレーの4色のボックスに白のテキストを重ねて、背景色が白のテキストに比べて薄い色になっている場合と、白のテキストに比べて背景色が推奨されている場合の2つの列を作ります。各色の16進数コードが表示され、白は<code>#FFFFFF</code>、褐色色の背景の薄い色合いは<code>#FCA469</code>、褐色色の背景の推奨色合いは<code>#BD5B0E</code>となっています。同等のグレースケールは、それぞれ<code>＃B8B8B8</code>および<code>＃707070</code>です。画像提供：LookZook</div>
      <figcaption id="mobile-web-fig4-caption"><a href="#mobile-web-fig-4" class="anchor-link">図 4.</a> 色のコントラストが不十分なテキストがどのように見えるかの例。提供：LookZook</figcaption>
    </figure>
    <p>
      他の人口統計における色覚異常の統計については、<a href="https://web.archive.org/web/20180304115406/http://www.allpsych.uni-giessen.de/karl/colbook/sharpe.pdf">本論文<span class="fn">https://web.archive.org/web/20180304115406/http://www.allpsych.uni-giessen.de/karl/colbook/sharpe.pdf</span></a
      >を参照してください。
    </p>
    <h3 id="mobile-web-フォントサイズ"><a href="#mobile-web-フォントサイズ" class="anchor-link">フォントサイズ</a></h3>
    <p>読みやすさの第二の部分は、テキストを読みやすい大きさにすることです。これはすべてのユーザーにとって重要ですが、特に年齢層の高いユーザーにとっては重要です。フォントサイズが12px未満では読みにくくなる傾向があります。</p>
    <p>ウェブ上では、80.66％のウェブページがこの基準を満たしていることがわかりました。</p>
    <h2 id="mobile-web-ページの拡大、縮小、回転"><a href="#mobile-web-ページの拡大、縮小、回転" class="anchor-link">ページの拡大、縮小、回転</a></h2>
    <h3 id="mobile-web-ズームと拡大縮小"><a href="#mobile-web-ズームと拡大縮小" class="anchor-link">ズームと拡大縮小</a></h3>
    <p>何万もの画面サイズやデバイスで完璧に動作するようサイトをデザインすることは、信じられないほど難しいことです。ユーザーの中には読むために大きなフォントサイズを必要としたり、製品画像を拡大したり、ボタンが小さすぎて品質保証チームの前を通り過ぎてしまったためにボタンを大きくしたりする必要がある人もいます。このような理由から、ピンチズームやスケーリングなどのデバイス機能が非常に重要になります。</p>
    <p>問題のページがタッチコントロールを使用したWebベースのゲームである場合など、この機能を無効にしても問題ない場合が非常に稀にあります。この場合この機能を有効にしておくと、プレイヤーがゲームを2回タップするたびにプレイヤーの携帯電話がズームインしたりズームアウトしたりしてしまい、結果的に利用できなくなってしまいます。</p>
    <p>このため、開発者はメタビューポートタグに以下の2つのプロパティのいずれかを設定することで、この機能を無効にできます。</p>
    <ol>
      <li>
        <p><code>user-scalable</code>を<code>0</code>または<code>no</code>に設定</p>
      </li>
      <li>
        <p><code>maximum-scale</code>を<code>1</code>、<code>1.0</code>などに設定</p>
      </li>
    </ol>
    <figure id="mobile-web-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/mobile-web/fig5.png">
        <img src="/static/images/2019/mobile-web/fig5.png" alt="図5. ズーム/スケーリングを有効または無効にしているデスクトップおよびモバイルのウェブサイトの割合。" aria-labelledby="mobile-web-fig5-caption" aria-describedby="mobile-web-fig5-description" width="600" height="370" data-width="600" data-height="370" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQcVHQTKIULwgs3f2Jy8IQiHwVAJjKoHrfcvwYX5UAlb4s3bsEA2owiku4c14YZiJeG8H8acgSUul2N/pubchart?oid=655301645&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="mobile-web-fig5-description" class="visually-hidden">"ズームとスケーリングは有効ですか？"と題された縦方向のグループ化された棒グラフでは、0から80までのデータを20刻みで計測し、デバイスの種類をデスクトップとモバイルに分類しています。デスクトップが有効：75.46％、デスクトップが無効：24.54％、モバイルが有効：67.79％、モバイルが無効：32.21％。</div>
      <figcaption id="mobile-web-fig5-caption"><a href="#mobile-web-fig-5" class="anchor-link">図 5.</a> ズーム/スケーリングを有効または無効にしているデスクトップおよびモバイルのウェブサイトの割合。</figcaption>
    </figure>
    <p>
      しかし開発者はこれを悪用しすぎて、3つのサイトのほぼ1つ(32.21％)がこの機能を無効にしており、Appleは(iOS 10の時点で)ウェブ開発者がズームを無効にすることを許さなくなっています。モバイルSafariは単に<a href="https://archive.org/details/ios-10-beta-release-notes">タグを無視する<span class="fn">https://archive.org/details/ios-10-beta-release-notes</span></a
      >。世界中のウェブトラフィックの<a href="https://gs.statcounter.com/">11%<span class="fn">https://gs.statcounter.com/</span></a
      >以上を占める新しいアップルのデバイスでは、どんなサイトでもズームや拡大縮小が可能です。
    </p>
    <h3 id="mobile-web-ページの回転"><a href="#mobile-web-ページの回転" class="anchor-link">ページの回転</a></h3>
    <p>モバイルデバイスでは、ユーザーが回転できるので、あなたのウェブサイトをユーザーが好む形式で閲覧できます。ただし、ユーザーはセッション中に常に同じ向きを保つわけではありません。フォームに記入するとき、ユーザーはより大きなキーボードを使用するため横向きに回転できます。また、製品を閲覧しているときには、横向きモードの方が大きい製品画像を好む人もいるでしょう。このようなユースケースがあるため、モバイルデバイスに内蔵されているこの機能をユーザーから奪わないことが非常に重要です。そして良いニュースは、この機能を無効にしているサイトは事実上見当たらないということです。この機能を無効にしているサイトは全体の87サイト（または0.0016％）のみです。これは素晴らしいことです。</p>
    <h2 id="mobile-web-ボタンとリンク"><a href="#mobile-web-ボタンとリンク" class="anchor-link">ボタンとリンク</a></h2>
    <h3 id="mobile-web-タップターゲット"><a href="#mobile-web-タップターゲット" class="anchor-link">タップターゲット</a></h3>
    <p>デスクトップではマウスのような精密なデバイスを使うことに慣れていますが、モバイルでは全く違います。モバイルでは、私たちは指と呼ばれる大きくて不正確なツールを使ってサイトにアクセスします。その不正確さゆえに、私たちは常にリンクやボタンを「タップミス」して、意図していないものをタップしています。</p>
    <p>
      この問題を軽減するためにタップターゲットを適切に設計することは、指の大きさが大きく異なるために困難な場合があります。しかし現在では多くの研究が行われており、どの程度の大きさのボタンが必要で、どの程度の間隔で離す必要があるかについては安全な<a href="https://developers.google.com/web/tools/lighthouse/audits/tap-targets">基準<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/tap-targets</span></a> があります。
    </p>
    <figure id="mobile-web-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/mobile-web/example-of-easy-to-hit-tap-targets-lookzook.png">
        <img src="/static/images/2019/mobile-web/example-of-easy-to-hit-tap-targets-lookzook.png" alt="図6. タップターゲットのサイズと間隔の基準。画像提供：LookZook" aria-labelledby="mobile-web-fig6-caption" aria-describedby="mobile-web-fig6-description" width="800" height="430" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="mobile-web-fig6-description" class="visually-hidden">A diagram displaying two examples of difficult to tap buttons. The first example shows two buttons with no spacing between them; An example below it shows the same buttons but with the recommended amount of spacing between them (8px or 1-2mm). The second example shows a button far too small to tap; An example below it shows the same button enlarged to the recommended size of 40-48px (around 8mm). Image courtesy of LookZook</div>
      <figcaption id="mobile-web-fig6-caption"><a href="#mobile-web-fig-6" class="anchor-link">図 6.</a> タップターゲットのサイズと間隔の基準。画像提供：LookZook</figcaption>
    </figure>
    <p>現在のところ、34.43％のサイトで十分なサイズのタップターゲットを持っています。つまり、「タップミス」が過去のものになるまでには、かなりの道のりがあるということです。</p>
    <h3 id="mobile-web-ラベリングボタン"><a href="#mobile-web-ラベリングボタン" class="anchor-link">ラベリングボタン</a></h3>
    <p>デザイナーの中には、テキストの代わりにアイコンを使うのが好きな人もいます。しかし、あなたやあなたのチームのメンバーはアイコンの意味を知っていても、多くのユーザーがそうではありません。これは悪名高いハンバーガーのアイコンにも当てはまります。もし私たちを信じられないのであれば、ユーザーテストをしてみて、どれくらいの頻度でユーザーが混乱しているかを見てみましょう。驚くことでしょう。</p>
    <p>だからこそ、混乱を避けるためにも、ボタンにサポートテキストやラベルを追加することが重要なのです。現在のところ、少なくとも28.59％のサイトでは、補助テキストを含まないアイコン1つだけのボタンが表示されています。</p>
    <p class="note">注：上記の報告されている数字は下限値に過ぎません。今回の分析では、テキストをサポートしないフォントアイコンを使用したボタンのみを対象としました。しかし、現在では多くのボタンがフォントアイコンの代わりにSVGを使用しているため、将来的にはそれらも含める予定です。</p>
    <h2 id="mobile-web-セマンティックフォームフィールド"><a href="#mobile-web-セマンティックフォームフィールド" class="anchor-link">セマンティックフォームフィールド</a></h2>
    <p>新しいサービスへのサインアップ、オンラインでの購入、あるいはブログからの新着情報の通知を受け取るためにフォームフィールドはウェブに欠かせないものであり、私たちが日常的に使用するものです。しかし残念なことに、これらのフィールドはモバイルで入力するのが面倒であることで有名です。ありがたいことに、近年のブラウザは開発者に新しいツールを提供し、私たちがよく知っているこれらのフィールドへの入力の苦痛を和らげることができるようになりました。ここでは、これらのツールがどの程度使われているかを見てみましょう。</p>
    <h3 id="mobile-web-新しい入力タイプ"><a href="#mobile-web-新しい入力タイプ" class="anchor-link">新しい入力タイプ</a></h3>
    <p>過去に、デスクトップでは<code>text</code>と<code>password</code>がほとんどすべてのニーズを満たしていたため、開発者が利用できる入力タイプは<code>text</code>と<code>password</code>だけでした。しかし、モバイルデバイスではそうではありません。モバイルキーボードは信じられないほど小さく、電子メールのアドレスを入力するような単純な作業では、ユーザーは複数のキーボードを切り替える必要があります。電話番号を入力するだけの単純な作業では、デフォルトのキーボードの小さな数字を使うのは難しいかもしれません。</p>
    <p>
      その後、多くの<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/Input">新しい入力タイプ<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/Input</span></a
      >が導入され、開発者はどのようなデータが期待されるかをブラウザに知らせ、ブラウザはこれらの入力タイプに特化したカスタマイズされたキーボードを提供できるようになりました。例えば、<code>email</code>のタイプは"@"記号を含む英数字キーボードをユーザに提供し、<code>tel</code>のタイプはテンキーを表示します。
    </p>
    <p>メール入力を含むサイトを分析する際には、56.42％が<code>type="email"</code>を使用している。同様に、電話入力では、<code>type="tel"</code>が36.7％の割合で使用されています。その他の新しい入力タイプの採用率はさらに低い。</p>
    <figure id="mobile-web-fig-7">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>タイプ</th>
                <th>頻度(ページ数)</th>
              </tr>
              <tr>
                <td>phone</td>
                <td class="numeric">1,917</td>
              </tr>
              <tr>
                <td>name</td>
                <td class="numeric">1,348</td>
              </tr>
              <tr>
                <td>textbox</td>
                <td class="numeric">833</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#mobile-web-fig-7" class="anchor-link">図 7.</a> 最も一般的に使用される無効な入力タイプ</figcaption>
    </figure>
    <p>利用可能な大量の入力タイプについて自分自身や他の人を教育し、上の図7のようなタイプミスがないことを再確認するようにしてください。</p>
    <h3 id="mobile-web-入力のオートコンプリートを有効にする"><a href="#mobile-web-入力のオートコンプリートを有効にする" class="anchor-link">入力のオートコンプリートを有効にする</a></h3>
    <p>
      入力属性<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/autocomplete"><code>autocomplete</code><span class="fn">https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/autocomplete</span></a> は、ユーザーがワンクリックでフォームフィールドへ記入できるようにします。ユーザーは膨大な数のフォームに記入しますが、毎回全く同じ情報を記入することがよくあります。このことに気付いたブラウザは、この情報を安全に保存し、将来のページで使用できるようにし始めました。開発者がすべきことは、この<code>autocomplete</code>属性を使用してどの情報を正確に入力する必要があるかをブラウザに伝えるだけで、あとはブラウザが行います。
    </p>
    <figure id="mobile-web-fig-8">
      <div class="big-number">29.62%</div>
      <figcaption><a href="#mobile-web-fig-8" class="anchor-link">図 8.</a> <code>オートコンプリート</code>を使用しているページの割合。</figcaption>
    </figure>
    <p>現在、入力フィールドを持つページのうち、この機能を利用しているのは29.62％に過ぎません。</p>
    <h3 id="mobile-web-パスワードフィールドへの貼り付け"><a href="#mobile-web-パスワードフィールドへの貼り付け" class="anchor-link">パスワードフィールドへの貼り付け</a></h3>
    <p>ユーザーがパスワードをコピーしてページに貼り付けることができるようにすることは、パスワードマネージャーを使用するための1つの方法です。パスワードマネージャーは、ユーザーが強力なパスワードを生成（記憶）し、ウェブページ上で自動的に記入するのに役立ちます。テストしたウェブページの0.02％だけがこの機能を無効にしています。</p>
    <p class="note">注: これは非常に励みになりますが、<a href="#methodology">方法論</a>ではホームページのみをテストするという要件があるため、過小評価されている可能性があります。ログインページのような内部ページはテストされません。</p>
    <h2 id="mobile-web-結論"><a href="#mobile-web-結論" class="anchor-link">結論</a></h2>
    <p>13年以上もの間、私たちは<em>モバイル</em>ウェブをデスクトップの単なる例外のように後回しにしてきました。しかし、今こそこの状況を変える時です。モバイル・ウェブは今や「<em>ウェブ</em>」であり、デスクトップはレガシーウェブになりつつあります。現在、世界では40億台のアクティブなスマートフォンが存在し、潜在的なユーザーの70％をカバーしています。デスクトップはどうでしょうか？　デスクトップは現在16億台となっており、毎月のウェブ利用の割合は少なくなっています。</p>
    <p>モバイルユーザーへの対応はどの程度できているのでしょうか？　当社の調査によると、71％のサイトがモバイル向けに何らかの努力をしているにもかかわらず、その目標を大きく下回っています。ページの読み込みに時間がかかり、JavaScriptの乱用により使用不能になり、テキストは読めないことが多く、リンクやボタンをクリックしてサイトにアクセスするとエラーが発生しやすくイライラさせられます。</p>
    <p>モバイルウェブは今では十分に長い間存在しています。子供たちの世代全体がこれまでに知っていた唯一のインターネットです。私たちは彼らにどのような経験を与えているのでしょうか？　私たちは本質的にダイヤルアップ時代に彼らを連れ戻しています。(私はAOLがまだ無料のインターネットアクセスの1000時間を提供するCDを販売していると聞いて良かった!)</p>
    <figure id="mobile-web-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/mobile-web/america-online-1000-hours-free.jpg">
        <img alt="A 1000 hour free-trial CD for America Online" src="/static/images/2019/mobile-web/america-online-1000-hours-free.jpg" aria-labelledby="mobile-web-fig9-caption" aria-describedby="mobile-web-fig9-description" width="300" height="285" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="mobile-web-fig9-description" class="visually-hidden">1,000時間無料で提供しているAOLのCD-ROMの写真。</div>
      <figcaption id="mobile-web-fig9-caption">
        <a href="#mobile-web-fig-9" class="anchor-link">図 9.</a> 無料で1000時間の「アメリカオンライン」から。<a href="https://archive.org/details/America_Online_1000_Hours_Free_for_45_Days_Version_7.0_Faster_Than_Ever_AM402R28">archive.org<span class="fn">https://archive.org/details/America_Online_1000_Hours_Free_for_45_Days_Version_7.0_Faster_Than_Ever_AM402R28</span></a
        >.
      </figcaption>
    </figure>
    <p class="note" data-markdown="1"></p>
    <p>注:</p>
    <ol>
      <li><p>モバイルに力を入れているサイトを、より小さな画面に合わせてデザインを調整しているサイトと定義しました。というか、CSSのブレークポイントが600px以下に1つ以上あるサイトを指します。</p></li>
      <li>
        <p>
          潜在的なユーザーとは、15歳以上の年齢層を指します。<a href="https://www.prb.org/international/geography/world">57億人<span class="fn">https://www.prb.org/international/geography/world</span></a
          >。
        </p>
      </li>
      <li>
        <p>
          <a href="https://www.merkleinc.com/thought-leadership/digital-marketing-report">デスクトップ検索<span class="fn">https://www.merkleinc.com/thought-leadership/digital-marketing-report</span></a
          >と<a href="https://gs.statcounter.com/platform-market-share/desktop-mobile-tablet/worldwide/#monthly-201205-201909">ウェブトラフィックシェア<span class="fn">https://gs.statcounter.com/platform-market-share/desktop-mobile-tablet/worldwide/#monthly-201205-201909</span></a
          >はここ数年減少傾向にあります。
        </p>
      </li>
      <li>
        <p>
          アクティブなスマートフォンの総数は、アクティブなAndroidsとiPhone（AppleとGoogleが公開している）の数を合計し、中国のネット接続された電話を考慮し少し計算して判明しました。<a href="https://www.ben-evans.com/benedictevans/2019/5/28/the-end-of-mobile">詳細はこちら<span class="fn">https://www.ben-evans.com/benedictevans/2019/5/28/the-end-of-mobile</span></a
          >。
        </p>
      </li>
      <li>
        <p>
          16億台のデスクトップは、<a href="https://web.archive.org/web/20181030132235/https://news.microsoft.com/bythenumbers/en/windowsdevices">Microsoft<span class="fn">https://web.archive.org/web/20181030132235/https://news.microsoft.com/bythenumbers/en/windowsdevices</span></a
          >と<a href="https://web.archive.org/web/20190628161024/https://appleinsider.com/articles/18/10/30/apple-passes-100m-active-mac-milestone-thanks-to-high-numbers-of-new-users">Apple<span class="fn">https://web.archive.org/web/20190628161024/https://appleinsider.com/articles/18/10/30/apple-passes-100m-active-mac-milestone-thanks-to-high-numbers-of-new-users</span></a
          >が公開している数字で計算しています。リナックスPCユーザーは含まれていません。
        </p>
      </li>
    </ol>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"III","chapter_number":13,"title":"Eコマース","description":"2019年Web AlmanacのEコマースの章では、Eコマースのプラットフォーム、ペイロード、画像、サードパーティ、パフォーマンス、SEO、PWAをカバーしています。","authors":["samdutton","alankent"],"reviewers":["voltek62"],"translators":["ksakae"],"discuss":"1768","results":"https://docs.google.com/spreadsheets/d/1FUMHeOPYBgtVeMU5_pl2r33krZFzutt9vkOpphOSOss/","queries":"13_Ecommerce","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-06-30T00:00:00.000Z","chapter":"ecommerce"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="ecommerce-序章"><a href="#ecommerce-序章" class="anchor-link">序章</a></h2>
    <p>この調査では、ホームページの10％近くがEコマース・プラットフォーム上にあることが判明しました。「Eコマースプラットフォーム」は、オンラインストアを作成し、運営することを可能にするソフトウェアまたはサービスのセットです。Eコマースプラットフォームのいくつかのタイプがあります。</p>
    <ul>
      <li>
        <a href="https://www.shopify.com/">Shopify<span class="fn">https://www.shopify.com/</span></a
        >のような<strong>有料サービス</strong>は、あなたのお店をホストし、あなたが始めるのを手助けしてくれます。彼らはウェブサイトのホスティング、サイトやページのテンプレート、商品データの管理、ショッピングカートや支払いを提供しています。
      </li>
      <li>
        <a href="https://magento.com/products/magento-open-source">Magento Open Source<span class="fn">https://magento.com/products/magento-open-source</span></a
        >のような<strong>ソフトウェアプラットフォーム</strong>は自分で設定し、ホストし、管理できます。これらのプラットフォームは強力で柔軟性がありますが、Shopifyのようなサービスよりもセットアップや運用が複雑になることがあります。
      </li>
      <li>
        <a href="https://magento.com/products/magento-commerce">Magento Commerce<span class="fn">https://magento.com/products/magento-commerce</span></a
        >のような<strong>ホスト付きプラットフォーム</strong>は、ホスティングがサードパーティによってサービスとして管理されていることを除いて、彼らのセルフホスティングされた対応と同じ機能を提供しています。
      </li>
    </ul>
    <figure id="ecommerce-fig-1">
      <div class="big-number">10%</div>
      <figcaption><a href="#ecommerce-fig-1" class="anchor-link">図 1.</a> Eコマースプラットフォーム上のページの割合。</figcaption>
    </figure>
    <p>この分析では、Eコマース・プラットフォーム上に構築されたサイトのみを検出できました。つまり、Amazon、JD、eBayなどの大規模なオンラインストアやマーケットプレイスはここには含まれていません。また、ここでのデータはホームページのみを対象としており、カテゴリ、商品、その他のページは含まれていないことにも注意してください。当社の<a href="#methodology">方法論</a>の詳細については、こちらをご覧ください。</p>
    <h2 id="ecommerce-プラットフォーム検出"><a href="#ecommerce-プラットフォーム検出" class="anchor-link">プラットフォーム検出</a></h2>
    <p>ページがEコマースプラットフォーム上にあるかどうかを確認するにはどうすればいいですか？</p>
    <p>検出は<a href="#methodology-wappalyzer">Wappalyzer</a>で行います。Wappalyzerは、Webサイトで使用されている技術を発見するためのクロスプラットフォームユーティリティです。<a href="#cms">コンテンツ管理システム</a>、Eコマースプラットフォーム、Webサーバー、<a href="#javascript">JavaScript</a>フレームワーク、<a href="#third-parties">アナリティクス</a>ツールなどを検出します。</p>
    <p>ページ検出は常に信頼できるものでなく、サイトによっては自動攻撃から保護するために検出を明示的にブロックしている場合もあります。特定のEコマースプラットフォームを使用しているすべてのウェブサイトを捕捉することはできないかもしれませんが、検出したウェブサイトは実際にそのプラットフォームを使用していると確信しています。</p>
    <figure id="ecommerce-fig-2">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">モバイル</th>
                <th scope="col">デスクトップ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Eコマースページ</td>
                <td class="numeric">500,595</td>
                <td class="numeric">424,441</td>
              </tr>
              <tr>
                <td>総ページ数</td>
                <td class="numeric">5,297,442</td>
                <td class="numeric">4,371,973</td>
              </tr>
              <tr>
                <td>採用率</td>
                <td class="numeric">9.45%</td>
                <td class="numeric">9.70%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#ecommerce-fig-2" class="anchor-link">図 2.</a> 検出されたEコマースプラットフォームの割合。</figcaption>
    </figure>
    <h2 id="ecommerce-eコマースプラットフォーム"><a href="#ecommerce-eコマースプラットフォーム" class="anchor-link">Eコマースプラットフォーム</a></h2>
    <figure id="ecommerce-fig-3">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>プラットフォーム</th>
                <th>モバイル</th>
                <th>デスクトップ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>WooCommerce</td>
                <td class="numeric">3.98</td>
                <td class="numeric">3.90</td>
              </tr>
              <tr>
                <td>Shopify</td>
                <td class="numeric">1.59</td>
                <td class="numeric">1.72</td>
              </tr>
              <tr>
                <td>Magento</td>
                <td class="numeric">1.10</td>
                <td class="numeric">1.24</td>
              </tr>
              <tr>
                <td>PrestaShop</td>
                <td class="numeric">0.91</td>
                <td class="numeric">0.87</td>
              </tr>
              <tr>
                <td>Bigcommerce</td>
                <td class="numeric">0.19</td>
                <td class="numeric">0.22</td>
              </tr>
              <tr>
                <td>Shopware</td>
                <td class="numeric">0.12</td>
                <td class="numeric">0.11</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#ecommerce-fig-3" class="anchor-link">図 3.</a> 上位6つのEコマースプラットフォームの採用。</figcaption>
    </figure>
    <p>検出された116のEコマースプラットフォームのうち、デスクトップまたはモバイルサイトの0.1％以上で検出されたのは6つだけでした。これらの結果には国別、サイトの規模別、その他の類似した指標による変動は示されていません。</p>
    <p>上記の図3を見ると、WooCommerceの採用率が最も高く、デスクトップおよびモバイルサイトの約4％を占めていることがわかります。Shopifyは約1.6％の採用で2位です。Magento、PrestaShop、Bigcommerce、Shopwareが0.1％に近づき、採用率が小さくなっています。</p>
    <h3 id="ecommerce-ロングテール"><a href="#ecommerce-ロングテール" class="anchor-link">ロングテール</a></h3>
    <figure id="ecommerce-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig4.png">
        <img src="/static/images/2019/ecommerce/fig4.png" alt="図4. トップのEコマースプラットフォームの採用。" aria-labelledby="ecommerce-fig4-caption" aria-describedby="ecommerce-fig4-description" width="600" height="414" data-width="600" data-height="414" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=1565776696&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="ecommerce-fig4-description" class="visually-hidden">上位20のEコマースプラットフォームの採用状況の棒グラフ。上位6プラットフォームの採用状況のデータ表は、上記の図3を参照してください。</div>
      <figcaption id="ecommerce-fig4-caption"><a href="#ecommerce-fig-4" class="anchor-link">図 4.</a> トップのEコマースプラットフォームの採用。</figcaption>
    </figure>
    <p>110のEコマースプラットフォームがあり、それぞれがデスクトップまたはモバイルのウェブサイトの0.1％未満を持っています。そのうち約60社は、モバイルかデスクトップのウェブサイトの0.01％未満を占めています。</p>
    <figure id="ecommerce-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig5.png">
        <img src="/static/images/2019/ecommerce/fig5.png" alt="図5. 上位6つのEコマースプラットフォームと他の110のプラットフォームとの複合的な採用。" aria-labelledby="ecommerce-fig5-caption" aria-describedby="ecommerce-fig5-description" width="600" height="361" data-width="600" data-height="361" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=2093212206&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="ecommerce-fig5-description" class="visually-hidden">上位6つのEコマースプラットフォームは、すべてのウェブサイトの8％を占めています。残りの110のプラットフォームはウェブサイトの1.5％を占めているに過ぎません。デスクトップとモバイルの結果は似ています。</div>
      <figcaption id="ecommerce-fig5-caption"><a href="#ecommerce-fig-5" class="anchor-link">図 5.</a> 上位6つのEコマースプラットフォームと他の110のプラットフォームとの複合的な採用。</figcaption>
    </figure>
    <p>モバイルでのリクエストの7.87％、デスクトップでのリクエストの8.06％は、上位6つのEコマース・プラットフォームのうちの1つのホームページが対象となっています。さらにモバイルでのリクエストの1.52％、デスクトップでのリクエストの1.59％は、他の110のEコマース・プラットフォームのホームページが対象となっています。</p>
    <h2 id="ecommerce-eコマース（すべてのプラットフォーム）"><a href="#ecommerce-eコマース（すべてのプラットフォーム）" class="anchor-link">Eコマース（すべてのプラットフォーム）</a></h2>
    <p>合計で、デスクトップページの9.7％、モバイルページの9.5％がEコマースプラットフォームを利用していました。</p>
    <figure id="ecommerce-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig6.png">
        <img src="/static/images/2019/ecommerce/fig6.png" alt="図6. 任意のEコマースプラットフォームを使用しているページの割合。" aria-labelledby="ecommerce-fig6-caption" aria-describedby="ecommerce-fig6-description" width="600" height="363" data-width="600" data-height="363" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=1360307171&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="ecommerce-fig6-description" class="visually-hidden">デスクトップページの9.7%がEコマースプラットフォームを使用しており、モバイルページの9.5%がEコマースプラットフォームを使用しています。</div>
      <figcaption id="ecommerce-fig6-caption"><a href="#ecommerce-fig-6" class="anchor-link">図 6.</a> 任意のEコマースプラットフォームを使用しているページの割合。</figcaption>
    </figure>
    <p>ウェブサイトのデスクトップ比率は全体的に若干高くなっていますが、一部の人気プラットフォーム（WooCommerce、PrestaShop、Shopwareを含む）では、実際にはデスクトップウェブサイトよりもモバイル性が高くなっています。</p>
    <h2 id="ecommerce-ページの重さと要望"><a href="#ecommerce-ページの重さと要望" class="anchor-link">ページの重さと要望</a></h2>
    <p>Eコマースプラットフォームの<a href="#page-weight">ページの重さ</a>は、すべてのHTML、CSS、JavaScript、JSON、XML、画像、オーディオ、およびビデオを含んでいます。</p>
    <figure id="ecommerce-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig7.png">
        <img src="/static/images/2019/ecommerce/fig7.png" alt="図7. Eコマースのページ重量の分布。" aria-labelledby="ecommerce-fig7-caption" aria-describedby="ecommerce-fig7-description" width="600" height="363" data-width="600" data-height="363" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=448248428&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="ecommerce-fig7-description" class="visually-hidden">10、25、50、75、およびEコマースページの重量の90パーセンタイルの分布。中央値のデスクトップEコマースページは2.7MBをロードします。10パーセンタイルは1.0MB、25パーセンタイルは1.6MB、75パーセンタイルは4.5MB、90パーセンタイルは7.6MBです。デスクトップのウェブサイトは、メガバイトの10分の1の割合でモバイルよりもわずかに高くなっています。</div>
      <figcaption id="ecommerce-fig7-caption"><a href="#ecommerce-fig-7" class="anchor-link">図 7.</a> Eコマースのページ重量の分布。</figcaption>
    </figure>
    <figure id="ecommerce-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig8.png">
        <img src="/static/images/2019/ecommerce/fig8.png" alt="図8. Eコマースページごとのリクエストの分布。" aria-labelledby="ecommerce-fig8-caption" aria-describedby="ecommerce-fig8-description" width="600" height="363" data-width="600" data-height="363" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=1968521689&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="ecommerce-fig8-description" class="visually-hidden">Eコマースページあたりのリクエストの10、25、50、75、および 90パーセンタイルの分布。中央値のデスクトップ Eコマースページは108リクエストを行います。10パーセンタイルは53リクエスト、25パーセンタイルは76、75パーセンタイルは153、90パーセンタイルは210です。デスクトップのウェブサイトは、約10リクエストでモバイルよりもわずかに高くなっています。</div>
      <figcaption id="ecommerce-fig8-caption"><a href="#ecommerce-fig-8" class="anchor-link">図 8.</a> Eコマースページごとのリクエストの分布。</figcaption>
    </figure>
    <p>
      デスクトップEコマースプラットフォームのページの読み込み量の中央値は108リクエストと2.7MBです。すべてのデスクトップページの重量の中央値は74リクエストと<a href="#page-weight-ページの重さ">1.9 MB</a> です。言い換えれば、Eコマースページは他のウェブページよりも50％近く多くのリクエストを行い、ペイロードは約35％大きくなっています。比較すると、<a href="https://amazon.com">amazon.com<span class="fn">https://amazon.com</span></a
      >のホームページは、最初のロード時に約5MBのページ重量に対して約300リクエストを行い、<a href="https://ebay.com">ebay.com<span class="fn">https://ebay.com</span></a
      >は約3MBのページウェイトに対して約150リクエストを行います。Eコマースプラットフォーム上のホームページのページ重量とリクエスト数は、各パーセンタイルでモバイルの方が若干小さくなっていますが、すべてのEコマースのホームページの約10％が7MB以上をロードし200以上のリクエストをしています。
    </p>
    <p>このデータは、ホームページのペイロードとスクロールなしのリクエストを含んでいます。明らかに、最初のロードに必要なはずのファイル数よりも多くのファイルを取得しているように見えるサイトがかなりの割合で存在しています(中央値は100以上)。以下の<a href="#ecommerce-サードパーティからのリクエストとバイト">サードパーティのリクエストとバイト数</a>も参照してください。</p>
    <p>Eコマース・プラットフォーム上の多くのホームページが、なぜこれほど多くのリクエストを行い、これほど大きなペイロードを持つのかをよりよく理解するために、さらに調査を行う必要があります。著者らはEコマース・プラットフォーム上のホームページで、最初のロード時に数百回のリクエストを行い、数メガバイトのペイロードを持つホームページを定期的に目にします。リクエスト数とペイロードがパフォーマンスの問題であるならば、どのようにしてそれらを減らすことができるのでしょうか？</p>
    <h2 id="ecommerce-タイプ別のリクエストとペイロード"><a href="#ecommerce-タイプ別のリクエストとペイロード" class="anchor-link">タイプ別のリクエストとペイロード</a></h2>
    <p>以下の表は、デスクトップでのリクエストの場合のものです。</p>
    <figure id="ecommerce-fig-9">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ファイルの種類</th>
                <th>10</th>
                <th>25</th>
                <th>50</th>
                <th>75</th>
                <th>90</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>画像</td>
                <td class="numeric">353</td>
                <td class="numeric">728</td>
                <td class="numeric">1,514</td>
                <td class="numeric">3,104</td>
                <td class="numeric">6,010</td>
              </tr>
              <tr>
                <td>ビデオ</td>
                <td class="numeric">156</td>
                <td class="numeric">453</td>
                <td class="numeric">1,325</td>
                <td class="numeric">2,935</td>
                <td class="numeric">5,965</td>
              </tr>
              <tr>
                <td>スクリプト</td>
                <td class="numeric">199</td>
                <td class="numeric">330</td>
                <td class="numeric">572</td>
                <td class="numeric">915</td>
                <td class="numeric">1,331</td>
              </tr>
              <tr>
                <td>フォント</td>
                <td class="numeric">47</td>
                <td class="numeric">85</td>
                <td class="numeric">144</td>
                <td class="numeric">226</td>
                <td class="numeric">339</td>
              </tr>
              <tr>
                <td>css</td>
                <td class="numeric">36</td>
                <td class="numeric">59</td>
                <td class="numeric">102</td>
                <td class="numeric">180</td>
                <td class="numeric">306</td>
              </tr>
              <tr>
                <td>html</td>
                <td class="numeric">12</td>
                <td class="numeric">20</td>
                <td class="numeric">36</td>
                <td class="numeric">66</td>
                <td class="numeric">119</td>
              </tr>
              <tr>
                <td>オーディオ</td>
                <td class="numeric">7</td>
                <td class="numeric">7</td>
                <td class="numeric">11</td>
                <td class="numeric">17</td>
                <td class="numeric">140</td>
              </tr>
              <tr>
                <td>xml</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">1</td>
                <td class="numeric">3</td>
              </tr>
              <tr>
                <td>その他</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">3</td>
              </tr>
              <tr>
                <td>テキスト</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#ecommerce-fig-9" class="anchor-link">図 9.</a> リソースタイプ別のページ重量分布（KB単位）のパーセンタイル。</figcaption>
    </figure>
    <figure id="ecommerce-fig-10">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>ファイルの種類</th>
                <th>10</th>
                <th>25</th>
                <th>50</th>
                <th>75</th>
                <th>90</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>画像</td>
                <td class="numeric">16</td>
                <td class="numeric">25</td>
                <td class="numeric">39</td>
                <td class="numeric">62</td>
                <td class="numeric">97</td>
              </tr>
              <tr>
                <td>スクリプト</td>
                <td class="numeric">11</td>
                <td class="numeric">21</td>
                <td class="numeric">35</td>
                <td class="numeric">53</td>
                <td class="numeric">75</td>
              </tr>
              <tr>
                <td>css</td>
                <td class="numeric">3</td>
                <td class="numeric">6</td>
                <td class="numeric">11</td>
                <td class="numeric">22</td>
                <td class="numeric">32</td>
              </tr>
              <tr>
                <td>フォント</td>
                <td class="numeric">2</td>
                <td class="numeric">3</td>
                <td class="numeric">5</td>
                <td class="numeric">8</td>
                <td class="numeric">11</td>
              </tr>
              <tr>
                <td>html</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">4</td>
                <td class="numeric">7</td>
                <td class="numeric">12</td>
              </tr>
              <tr>
                <td>ビデオ</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">5</td>
                <td class="numeric">9</td>
              </tr>
              <tr>
                <td>その他</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">4</td>
                <td class="numeric">9</td>
              </tr>
              <tr>
                <td>テキスト</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">3</td>
              </tr>
              <tr>
                <td>xml</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
              </tr>
              <tr>
                <td>オーディオ</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">3</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption>図10リソースタイプ別の1ページあたりのリクエストの分布のパーセンタイル。</figcaption>
    </figure>
    <p>Eコマースページでは、画像が最大のリクエスト数とバイト数の割合を占めています。デスクトップEコマースページの中央値には、1,514KB(1.5MB)の重さの画像が39枚含まれています。</p>
    <p><a href="#javascript">JavaScript</a>リクエストの数は、より良いバンドル(および/または<a href="#http2">HTTP/2</a>多重化)によってパフォーマンスを向上する可能性があることを示しています。JavaScriptファイルの総バイト数はそれほど大きくありませんが、個別のリクエストが多くなっています。<a href="#http2-http2の採用">HTTP/2</a>の章によると、リクエストの40％以上はHTTP/2経由ではないそうです。同様に、CSSファイルは3番目にリクエスト数が多いですが、一般的には少ないです。CSSファイル(またはHTTP/2)をマージすることで、そのようなサイトのパフォーマンスを向上させることができるかもしれません。著者の経験では、多くのEコマースページでは、未使用のCSSとJavaScriptの割合が高い。<a href="#media">ビデオ</a> のリクエスト数は少ないかもしれませんが、(驚くことではありません) 特にペイロードが重いサイトでは、ページの重量の割合が高くなります。</p>
    <h2 id="ecommerce-htmlペイロードサイズ"><a href="#ecommerce-htmlペイロードサイズ" class="anchor-link">HTMLペイロードサイズ</a></h2>
    <figure id="ecommerce-fig-11">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig11.png">
        <img src="/static/images/2019/ecommerce/fig11.png" alt="図11. EコマースページあたりのHTMLバイト数の分布（KB単位）。" aria-labelledby="ecommerce-fig11-caption" aria-describedby="ecommerce-fig11-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=908924961&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig11-description" data-show-text="{{ show_description(11) }}" data-hide-text="{{ hide_description(11) }}">{{ show_description(11) }}</button>
      <div id="ecommerce-fig11-description" class="visually-hidden">EコマースページあたりのHTMLバイトの10、25、50、75、および90パーセンタイルの分布。中央値のデスクトップ Eコマースページには、36KBのHTMLがあります。10パーセンタイルは12KB、25パーセンタイルは20、75パーセンタイルは66、90パーセンタイルは118です。デスクトップWebサイトの HTMLバイト数は、モバイルよりも1～2KB多いです。</div>
      <figcaption id="ecommerce-fig11-caption"><a href="#ecommerce-fig-11" class="anchor-link">図 11.</a> EコマースページあたりのHTMLバイト数の分布（KB単位）。</figcaption>
    </figure>
    <p>HTMLペイロードには、外部リンクとして参照されるのではなく、マークアップ自体にインラインJSON、JavaScript、CSSなどの他のコードが直接含まれている場合があることに注意してください。EコマースページのHTMLペイロードのサイズの中央値は、モバイルで34KB、デスクトップで36KBです。しかし、Eコマースページの10％には、115KB以上のHTMLペイロードがあります。</p>
    <p>モバイルのHTMLペイロードのサイズは、デスクトップとあまり変わりません。言い換えれば、サイトは異なるデバイスやビューポートのサイズに対して、大きく異なるHTMLファイルを配信していないように見えます。多くのEコマースサイトでは、ホームページのHTMLペイロードが大きくなっています。これがHTMLの肥大化によるものなのか、それともHTMLファイル内の他のコード（JSONなど）によるものなのかはわかりません。</p>
    <h2 id="ecommerce-画像の統計"><a href="#ecommerce-画像の統計" class="anchor-link">画像の統計</a></h2>
    <figure id="ecommerce-fig-12">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig12.png">
        <img src="/static/images/2019/ecommerce/fig12.png" alt="図12. Eコマースページごとの画像バイト数の分布（KB単位）。" aria-labelledby="ecommerce-fig12-caption" aria-describedby="ecommerce-fig12-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=323146848&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="ecommerce-fig12-description" class="visually-hidden">Eコマースページあたりの画像バイト数の10、25、50、75、および90パーセンタイルの分布。中央値のモバイルEコマースページには、1,517KBの画像があります。10パーセンタイルは318KB、25パーセンタイルは703、75パーセンタイルは3,132、90パーセンタイルは5,881です。デスクトップとモバイルのウェブサイトでは、同様の分布を示しています。</div>
      <figcaption id="ecommerce-fig12-caption"><a href="#ecommerce-fig-12" class="anchor-link">図 12.</a> Eコマースページごとの画像バイト数の分布（KB単位）。</figcaption>
    </figure>
    <figure id="ecommerce-fig-13">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig13.png">
        <img src="/static/images/2019/ecommerce/fig13.png" alt="図13. Eコマースページごとの画像リクエストの分布。" aria-labelledby="ecommerce-fig13-caption" aria-describedby="ecommerce-fig13-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=1483037371&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig13-description" data-show-text="{{ show_description(13) }}" data-hide-text="{{ hide_description(13) }}">{{ show_description(13) }}</button>
      <div id="ecommerce-fig13-description" class="visually-hidden">Eコマースページあたりの画像リクエストの10、25、50、75、および90パーセンタイルの分布。中央値のデスクトップEコマースページでは、40件の画像リクエストが発生します。10パーセンタイルはリクエストが16件、25パーセンタイルは25件、75パーセンタイルは62件、90パーセンタイルは97件です。デスクトップの分布は、各パーセンタイルで2～10件のリクエストがモバイルよりもわずかに高くなっています。</div>
      <figcaption id="ecommerce-fig13-caption"><a href="#ecommerce-fig-13" class="anchor-link">図 13.</a> Eコマースページごとの画像リクエストの分布。</figcaption>
    </figure>
    <p class="note">私たちのデータ収集<a href="#methodology">方法論</a>はクリックやスクロールなど、ページ上でのユーザー操作をシミュレートしていないため、遅延して読み込まれた画像はこれらの結果には表示されないことに注意してください。</p>
    <p>上記の図12と13で中央値のEコマースページには、モバイルでは37枚の画像と1,517KBの画像ペイロードがあり、デスクトップでは40枚の画像と1,524KBの画像ペイロードがあることを示しています。ホームページの10％は、90以上の画像と6MB近くの画像ペイロードを持っています！</p>
    <figure id="ecommerce-fig-14">
      <div class="big-number">1,517 KB</div>
      <figcaption><a href="#ecommerce-fig-14" class="anchor-link">図 14.</a> モバイルEコマースページあたりの画像バイト数の中央値。</figcaption>
    </figure>
    <p>
      Eコマースページのかなりの割合で、大きな画像ペイロードを持ち、最初のロード時に大量の画像リクエストを行います。詳細については、HTTP Archiveの<a href="https://httparchive.org/reports/state-of-images">State of Images<span class="fn">https://httparchive.org/reports/state-of-images</span></a
      >レポート、および<a href="#media">media</a>と[page weight](./page weight)の章を参照してください。
    </p>
    <p>ウェブサイトの所有者は、自分のサイトを最新のデバイスで見栄えの良いものにしたいと考えています。その結果、多くのサイトでは、画面の解像度やサイズに関係なく、すべてのユーザーに同じ高解像度の製品画像を配信しています。開発者は、異なるユーザーに可能な限り最高の画像を効率的に配信できるレスポンシブ技術に気づいていない（または使いたくない）かもしれません。高解像度の画像が必ずしもコンバージョン率を高めるとは限らないことを覚えておきましょう。逆に重い画像の使いすぎは、ページの速度に影響を与える可能性が高く、それによってコンバージョン率を低下させる可能性があります。サイトレビューやイベントでの著者の経験では、開発者やその他の関係者の中には、画像に遅延ローディングを使用することにSEOなどの懸念を持っている人もいます。</p>
    <p>一部のサイトがレスポンシブ画像技術や遅延読み込みを使用していない理由をよりよく理解するために、より多くの分析を行う必要があります。またEコマースプラットフォームが、ハイエンドのデバイスや接続性の良いサイトに美しい画像を確実に配信すると同時に、ローエンドのデバイスや接続性の悪いサイトにも最高の体験を提供できるようなガイダンスを提供する必要があります。</p>
    <h2 id="ecommerce-popular-image-formats"><a href="#ecommerce-popular-image-formats" class="anchor-link">Popular image formats</a></h2>
    <figure id="ecommerce-fig-15">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig15.png">
        <img src="/static/images/2019/ecommerce/fig15.png" alt="図15. 一般的な画像フォーマット。" aria-labelledby="ecommerce-fig15-caption" aria-describedby="ecommerce-fig15-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=2108999644&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig15-description" data-show-text="{{ show_description(15) }}" data-hide-text="{{ hide_description(15) }}">{{ show_description(15) }}</button>
      <div id="ecommerce-fig15-description" class="visually-hidden">様々な画像フォーマットの人気を示す棒グラフ。JPEGが最も人気のあるフォーマットで、デスクトップEコマースページの画像の54％を占めています。次いでPNGが27％、GIFが14％、SVGが2％、WebPとICOがそれぞれ1％となっています。</div>
      <figcaption id="ecommerce-fig15-caption"><a href="#ecommerce-fig-15" class="anchor-link">図 15.</a> 一般的な画像フォーマット。</figcaption>
    </figure>
    <p class="note">
      画像サービスやCDNの中には、`.jpg`や`.png`という接尾辞を持つURLであっても、WebPをサポートしているプラットフォームには自動的にWebP(JPEGやPNGではなく)を配信するものがあることに注意してください。たとえば、<a href="https://res.cloudinary.com/webdotdev/f_auto/w_500/IMG_20190113_113201.jpg">IMG_20190113_113201.jpg<span class="fn">https://res.cloudinary.com/webdotdev/f_auto/w_500/IMG_20190113_113201.jpg</span></a
      >はChromeでWebP画像を返します。しかし、HTTP Archive<a href="https://github.com/HTTPArchive/legacy.httparchive.org/blob/31a25b9064a365d746d4811a1d6dda516c0e4985/bulktest/batch_lib.inc#L994">画像フォーマットを検出する方法<span class="fn">https://github.com/HTTPArchive/legacy.httparchive.org/blob/31a25b9064a365d746d4811a1d6dda516c0e4985/bulktest/batch_lib.inc#L994</span></a
      >は、最初にMIMEタイプのキーワードをチェックしてから、ファイルの拡張子にフォールバックするというものです。つまり、HTTP ArchiveがユーザーエージェントとしてWebPをサポートしているため、上記のようなURLを持つ画像のフォーマットはWebPとして与えられることになります。
    </p>
    <h3 id="ecommerce-png"><a href="#ecommerce-png" class="anchor-link">PNG</a></h3>
    <p>Eコマースページの4つに1つの画像はPNGです。Eコマースプラットフォーム上のページでPNGのリクエストが多いのは、商品画像のためと思われます。多くのコマースサイトでは、透過性を確保するために写真画像と一緒にPNGを使用しています。</p>
    <p>
      PNGフォールバックでWebPを使用することは、<a href="http://simpl.info/picturetype">画像要素<span class="fn">http://simpl.info/picturetype</span></a
      >を介して、または<a href="https://res.cloudinary.com/webdotdev/f_auto/w_500/IMG_20190113_113201.jpg">Cloudinary<span class="fn">https://res.cloudinary.com/webdotdev/f_auto/w_500/IMG_20190113_113201.jpg</span></a
      >のような画像サービスを介してユーザーエージェントの能力検出を使用することで、はるかに効率的な代替手段となります。
    </p>
    <h3 id="ecommerce-webp"><a href="#ecommerce-webp" class="anchor-link">WebP</a></h3>
    <p>
      Eコマースプラットフォーム上の画像の1％だけがWebPであり、これはサイトレビューやパートナーの仕事での著者の経験と一致しています。WebPは<a href="https://caniuse.com/#feat=webp">Safari以外のすべての最新ブラウザでサポートされています<span class="fn">https://caniuse.com/#feat=webp</span></a
      >し、フォールバックの仕組みも充実しています。WebPは透過性をサポートしており、写真画像のためのPNGよりもはるかに効率的なフォーマットです（上記のPNGのセクションを参照してください）。
    </p>
    <p>
      WebPをPNGのフォールバックで使用したり、無地の色の背景でWebP/JPEGを使用して透明化を可能にするため、Webコミュニティとして、より良いガイダンスや提唱を提供できます。WebPは、<a href="https://web.dev/serve-images-webp">ガイド<span class="fn">https://web.dev/serve-images-webp</span></a> やツール (例:<a href="https://squoosh.app/">Squoosh<span class="fn">https://squoosh.app/</span></a
      >や<a href="https://developers.google.com/speed/webp/docs/cwebp">cwebp<span class="fn">https://developers.google.com/speed/webp/docs/cwebp</span></a
      >など)があるにもかかわらず、電子商取引プラットフォームではほとんど使用されていないようです。現在<a href="https://blog.chromium.org/2010/09/webp-new-image-format-for-web.html">10年近く経っている<span class="fn">https://blog.chromium.org/2010/09/webp-new-image-format-for-web.html</span></a
      >WebPの利用が増えていない理由をさらに調査する必要があります。
    </p>
    <h2 id="ecommerce-画像の寸法"><a href="#ecommerce-画像の寸法" class="anchor-link">画像の寸法</a></h2>
    <figure id="ecommerce-fig-16">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="colgroup" colspan="2">モバイル</th>
                <th scope="colgroup" colspan="2">デスクトップ</th>
              </tr>
              <tr>
                <th scope="col">パーセンタイル</th>
                <th scope="col">横幅(px)</th>
                <th scope="col">高さ(px)</th>
                <th scope="col">横幅(px)</th>
                <th scope="col">高さ(px)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>10</td>
                <td class="numeric">16</td>
                <td class="numeric">16</td>
                <td class="numeric">16</td>
                <td class="numeric">16</td>
              </tr>
              <tr>
                <td>25</td>
                <td class="numeric">100</td>
                <td class="numeric">64</td>
                <td class="numeric">100</td>
                <td class="numeric">60</td>
              </tr>
              <tr>
                <td>50</td>
                <td class="numeric">247</td>
                <td class="numeric">196</td>
                <td class="numeric">240</td>
                <td class="numeric">192</td>
              </tr>
              <tr>
                <td>75</td>
                <td class="numeric">364</td>
                <td class="numeric">320</td>
                <td class="numeric">400</td>
                <td class="numeric">331</td>
              </tr>
              <tr>
                <td>90</td>
                <td class="numeric">693</td>
                <td class="numeric">512</td>
                <td class="numeric">800</td>
                <td class="numeric">546</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#ecommerce-fig-16" class="anchor-link">図 16.</a> Eコマースページごとの固有画像の寸法（ピクセル単位）の分布。</figcaption>
    </figure>
    <p>Eコマースページで要求された画像の中央値（「中間値」）は、モバイルで247X196px、デスクトップで240X192pxです。Eコマースページで要求される画像の10％は、モバイルでは693X512px以上、デスクトップでは800X546px以上です。これらの寸法は画像の本質的なサイズであり、表示サイズではないことに注意してください。</p>
    <p>中央値までの各パーセンタイルでの画像のサイズがモバイルとデスクトップで似ていることを考えると、多くのサイトではビューポートごとに異なるサイズの画像を配信していない、言い換えればレスポンシブ画像技術を使用していないように思えます。モバイル向けに大きな画像が配信されている場合もありますが、これはデバイス検出や画面検出を使用しているサイトによって説明できるかもしれません（そうでないかもしれません！）。</p>
    <p>なぜ多くのサイトが（一見して）異なる画像サイズを異なるビューポートに配信していないのか、もっと研究する必要があります。</p>
    <h2 id="ecommerce-サードパーティからのリクエストとバイト"><a href="#ecommerce-サードパーティからのリクエストとバイト" class="anchor-link">サードパーティからのリクエストとバイト</a></h2>
    <p>
      多くのウェブサイト、特にオンラインストアでは、分析、A/Bテスト、顧客行動追跡、広告、ソーシャルメディアのサポートなどのためにサードパーティのコードやコンテンツを大量にロードしています。サードパーティのコンテンツは、<a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/loading-third-party-javascript">パフォーマンスに大きな影響を与える<span class="fn">https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/loading-third-party-javascript</span></a
      >ことがあります。 <a href="https://twitter.com/patrickhulce">Patrick Hulce<span class="fn">https://twitter.com/patrickhulce</span></a
      >の<a href="https://github.com/patrickhulce/third-party-web">サードパーティウェブツール<span class="fn">https://github.com/patrickhulce/third-party-web</span></a
      >は、本レポートのサードパーティのリクエストを判断するために使用されており、これについては<a href="#third-parties">サードパーティ</a>の章で詳しく説明しています。
    </p>
    <figure id="ecommerce-fig-17">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig17.png">
        <img src="/static/images/2019/ecommerce/fig17.png" alt="図17. Eコマースページごとのサードパーティリクエストの分布。" aria-labelledby="ecommerce-fig17-caption" aria-describedby="ecommerce-fig17-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=865791628&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig17-description" data-show-text="{{ show_description(17) }}" data-hide-text="{{ hide_description(17) }}">{{ show_description(17) }}</button>
      <div id="ecommerce-fig17-description" class="visually-hidden">Eコマースページあたりのサードパーティリクエストの10、25、50、75、90パーセンタイルの分布。デスクトップでのサードパーティリクエストの数の中央値は19です。10、25、75、90パーセンタイルは4、9、34、54となっています。デスクトップの分布は、各パーセンタイルでモバイルよりも1-2件のリクエスト数だけ高くなっています。</div>
      <figcaption id="ecommerce-fig17-caption"><a href="#ecommerce-fig-17" class="anchor-link">図 17.</a> Eコマースページごとのサードパーティリクエストの分布。</figcaption>
    </figure>
    <figure id="ecommerce-fig-18">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig18.png">
        <img src="/static/images/2019/ecommerce/fig18.png" alt="図18. Eコマースページあたりのサードパーティのバイト数の分布。" aria-labelledby="ecommerce-fig18-caption" aria-describedby="ecommerce-fig18-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=164264869&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig18-description" data-show-text="{{ show_description(18) }}" data-hide-text="{{ hide_description(18) }}">{{ show_description(18) }}</button>
      <div id="ecommerce-fig18-description" class="visually-hidden">Eコマースページあたりのサードパーティのバイト数の10、25、50、75、90パーセンタイルの分布。デスクトップでのサードパーティのバイト数の中央値は320KBです。10、25、75、90パーセンタイルは次のとおりです。42、129、651、1,071。デスクトップの分布は、各パーセンタイルでモバイルよりも10～30KB高くなっています。</div>
      <figcaption id="ecommerce-fig18-caption"><a href="#ecommerce-fig-18" class="anchor-link">図 18.</a> Eコマースページあたりのサードパーティのバイト数の分布。</figcaption>
    </figure>
    <p>Eコマースプラットフォーム上の中央値（「中規模」）のホームページでは、サードパーティのコンテンツに対するリクエストは、モバイルで17件、デスクトップで19件となっています。Eコマース・プラットフォーム上のすべてのホームページの10％は、サードパーティのコンテンツに対して50件以上のリクエストを行い、その総ペイロードは1MBを超えています。</p>
    <p>
      <a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/loading-third-party-javascript/">他の研究<span class="fn">https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/loading-third-party-javascript/</span></a
      >で、サードパーティのコンテンツはパフォーマンスの大きなボトルネックになる可能性であることが指摘されています。この調査によると、17以上のリクエスト（上位10％では50以上）がEコマースページの標準となっています。
    </p>
    <h2 id="ecommerce-プラットフォームごとのサードパーティリクエストとペイロード"><a href="#ecommerce-プラットフォームごとのサードパーティリクエストとペイロード" class="anchor-link">プラットフォームごとのサードパーティリクエストとペイロード</a></h2>
    <p>以下の表は、モバイルのみのデータを示しています。</p>
    <figure id="ecommerce-fig-19">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig19.png">
        <img src="/static/images/2019/ecommerce/fig19.png" alt="図19. 各Eコマースプラットフォームのモバイルページごとのサードパーティリクエストの分布。" aria-labelledby="ecommerce-fig19-caption" aria-describedby="ecommerce-fig19-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=1242665725&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig19-description" data-show-text="{{ show_description(19) }}" data-hide-text="{{ hide_description(19) }}">{{ show_description(19) }}</button>
      <div id="ecommerce-fig19-description" class="visually-hidden">各プラットフォームのEコマースページあたりのサードパーティリクエストの10、25、50、75、および90パーセンタイルの分布。ShopifyとBigcommerceは、分布の中央値で約40件のサードパーティのリクエストをロードしています。</div>
      <figcaption id="ecommerce-fig19-caption"><a href="#ecommerce-fig-19" class="anchor-link">図 19.</a> 各Eコマースプラットフォームのモバイルページごとのサードパーティリクエストの分布。</figcaption>
    </figure>
    <figure id="ecommerce-fig-20">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig20.png">
        <img src="/static/images/2019/ecommerce/fig20.png" alt="図20. 各Eコマースプラットフォームのモバイルページあたりのサードパーティのバイト数（KB）分布。" aria-labelledby="ecommerce-fig20-caption" aria-describedby="ecommerce-fig20-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=1017068803&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig20-description" data-show-text="{{ show_description(20) }}" data-hide-text="{{ hide_description(20) }}">{{ show_description(20) }}</button>
      <div id="ecommerce-fig20-description" class="visually-hidden">各プラットフォームのEコマースページあたりのサードパーティのバイト数(KB)の10、25、50、75、および90パーセンタイルの分布。ShopifyとBigcommerceは、中央値で1,000KBを超え、分布全体で最も多くのサードパーティのバイトをロードします。</div>
      <figcaption id="ecommerce-fig20-caption"><a href="#ecommerce-fig-20" class="anchor-link">図 20.</a> 各Eコマースプラットフォームのモバイルページあたりのサードパーティのバイト数（KB）分布。</figcaption>
    </figure>
    <p>Shopifyのようなプラットフォームでは、クライアントサイドのJavaScriptを使ってサービスを拡張することがありますが、Magentoのような他のプラットフォームではサーバーサイドの拡張機能が多く使われています。このアーキテクチャの違いが、ここで見る数字に影響を与えています。</p>
    <p>明らかに、一部のEコマースプラットフォームのページでは、サードパーティコンテンツへのリクエストが多く、サードパーティコンテンツのペイロードが大きくなっています。一部のプラットフォームのページで、サードパーティコンテンツへのリクエストが多く、サードパーティコンテンツのペイロードが他のプラットフォームよりも大きいのはなぜかについて、さらに分析を行うことができます。</p>
    <h2 id="ecommerce-コンテンツの初回ペイントfcp"><a href="#ecommerce-コンテンツの初回ペイントfcp" class="anchor-link">コンテンツの初回ペイント(FCP)</a></h2>
    <figure id="ecommerce-fig-21">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig21.png">
        <img src="/static/images/2019/ecommerce/fig21.png" alt="図21. Eコマースプラットフォーム毎のFCP体験の平均分布。" aria-labelledby="ecommerce-fig21-caption" aria-describedby="ecommerce-fig21-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=1341906463&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig21-description" data-show-text="{{ show_description(21) }}" data-hide-text="{{ hide_description(21) }}">{{ show_description(21) }}</button>
      <div id="ecommerce-fig21-description" class="visually-hidden">上位6つのEコマースプラットフォームのFCPエクスペリエンスの平均分布の棒グラフ。WooCommerceは、遅いFCP体験の密度が43%と最も高くなっています。Shopifyは、高速FCP体験の密度が47%で最も高くなっています。</div>
      <figcaption id="ecommerce-fig21-caption"><a href="#ecommerce-fig-21" class="anchor-link">図 21.</a> Eコマースプラットフォーム毎のFCP体験の平均分布。</figcaption>
    </figure>
    <p><a href="#performance-コンテンツの初回ペイントfirst-contentful-paint">コンテンツの初回ペイント</a>は、ナビゲーションからテキストや画像などのコンテンツが最初に表示されるまでの時間を測定します。この文脈では、<strong>速い</strong>は1秒未満のFCP、<strong>遅い</strong>は3秒以上のFCP、<strong>中程度</strong>はその中間のすべてを意味します。サードパーティのコンテンツやコードは、FCPに大きな影響を与える可能性があることに注意してください。</p>
    <p>上位6つのEコマースプラットフォームはすべて、モバイルでのFCPがデスクトップよりも悪くなっています。FCPは、接続性だけでなく、デバイスの能力（処理能力、メモリなど）にも影響されることに注意してください。</p>
    <p>FCPがデスクトップよりもモバイルの方が悪い理由を明らかにする必要があります。原因は何でしょうか？　接続性やデバイスの能力、それとも何か他の要因でしょうか？</p>
    <h2 id="ecommerce-プログレッシブウェブアプリ（pwa）のスコア"><a href="#ecommerce-プログレッシブウェブアプリ（pwa）のスコア" class="anchor-link">プログレッシブウェブアプリ（PWA）のスコア</a></h2>
    <p>Eコマースサイト以外のこのトピックの詳細については、<a href="#pwa">PWAの章</a>も参照してください。</p>
    <figure id="ecommerce-fig-22">
      <a href="https://almanac.httparchive.org/static/images/2019/ecommerce/fig22.png">
        <img src="/static/images/2019/ecommerce/fig22.png" alt="図22. モバイルEコマースページのLighthouse PWAカテゴリスコアの分布。" aria-labelledby="ecommerce-fig22-caption" aria-describedby="ecommerce-fig22-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vROHKGuMutXmxtzEoBSJNVn7DOzlfpizJh7mOkopFK8OVl_hCUHDOmKgYOojrpVsGnGWaletE7Uc5oX/pubchart?oid=1148584930&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig22-description" data-show-text="{{ show_description(22) }}" data-hide-text="{{ hide_description(22) }}">{{ show_description(22) }}</button>
      <div id="ecommerce-fig22-description" class="visually-hidden">EコマースページのLighthouseのPWAカテゴリスコアの分布。0（失敗）から1（完璧）のスケールで、ページの40％が0.33のスコアを取得します。ページの1％が0.6以上のスコアを取得しています。</div>
      <figcaption id="ecommerce-fig22-caption"><a href="#ecommerce-fig-22" class="anchor-link">図 22.</a> モバイルEコマースページのLighthouse PWAカテゴリスコアの分布。</figcaption>
    </figure>
    <p>
      Eコマースのプラットフォーム上のホームページの60％以上は、0.25と0.35の間に<a href="https://developers.google.com/web/ilt/pwa/lighthouse-pwa-analysis-tool">Lighthouse PWAスコア<span class="fn">https://developers.google.com/web/ilt/pwa/lighthouse-pwa-analysis-tool</span></a
      >を取得します。Eコマースのプラットフォーム上のホームページの20％未満は、0.5以上のスコアを取得し、ホームページの1％未満は0.6以上のスコアを取得します。
    </p>
    <p>
      Lighthouseは、プログレッシブWebアプリ（PWA）のスコアを0から1の間で返します。PWAの監査は、14の要件をリストアップした<a href="https://developers.google.com/web/progressive-web-apps/checklist">Baseline PWA Checklist<span class="fn">https://developers.google.com/web/progressive-web-apps/checklist</span></a
      >に基づいています。Lighthouseは、14の要件のうち11の要件について自動監査を実施しています。残りの3つは手動でしかテストできません。11の自動PWA監査はそれぞれ均等に重み付けされているため、それぞれがPWAスコアに約9ポイント寄与します。
    </p>
    <p>PWA監査のうち少なくとも1つがnullスコアを取得した場合、LighthouseはPWAカテゴリ全体のスコアをnullアウトします。これは、モバイルページの2.32％が該当しました。</p>
    <p>
      明らかに、大多数のEコマースページは、ほとんどの<a href="https://developers.google.com/web/progressive-web-apps/checklist">PWA チェックリスト監査<span class="fn">https://developers.google.com/web/progressive-web-apps/checklist</span></a> に失敗しています。どの監査が失敗しているのか、なぜ失敗しているのかをよりよく理解するために、さらに分析を行う必要があります。
    </p>
    <h2 id="ecommerce-結論"><a href="#ecommerce-結論" class="anchor-link">結論</a></h2>
    <p>Eコマースの使用法のこの包括的な研究はいくつかの興味深いデータを示し、また同じEコマースのプラットフォーム上に構築されたものの間でも、Eコマースのサイトの広いバリエーションを示しています。ここでは多くの詳細を説明しましたが、この分野ではもっと多くの分析が可能です。例えば、今年はアクセシビリティのスコアを取得していませんでした（それについての詳細は<a href="#accessibility">アクセシビリティの章</a>をチェックアウトしてください）。同様に、これらのメトリクスを地域別にセグメント化することも興味深いことでしょう。この調査では、Eコマース・プラットフォームのホームページ上で246の広告プロバイダーが検出されました。さらなる調査（おそらく来年のWeb Almanacに掲載されるかもしれません）では、Eコマースプラットフォーム上で広告を表示しているサイトの割合を計算できます。この調査ではWooCommerceが非常に高い数値を記録していますので、来年の調査では一部のホスティングプロバイダーがWooCommerceをインストールしているにもかかわらず、有効にしていないために数値が膨らんでいるのではないかという興味深い統計を見ることができます。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"III","chapter_number":14,"title":"CMS","description":"2019年版Web AlmanacCMS章では、CMSの採用、CMS組み合わせの構築方法、CMSを搭載したWebサイトのユーザーエクスペリエンス、CMSのイノベーションを取り上げています。","authors":["ernee","amedina"],"reviewers":["sirjonathan"],"translators":["ksakae"],"discuss":"1769","results":"https://docs.google.com/spreadsheets/d/1FDYe6QdoY3UtXodE2estTdwMsTG-hHNrOe9wEYLlwAw/","queries":"14_CMS","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-07-20T00:00:00.000Z","chapter":"cms"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="cms-序章"><a href="#cms-序章" class="anchor-link">序章</a></h2>
    <p><strong>コンテンツ管理システム（CMS）</strong>とは、個人や組織がコンテンツを作成・管理・公開するためのシステムを総称しています。具体的には、オープンウェブを介して消費・体験できるコンテンツを作成・管理・公開することを目的としたシステムのことを指します。</p>
    <p>各CMSは、ユーザーがコンテンツを中心に簡単かつ効果的にウェブサイトを構築できるように、幅広いコンテンツ管理機能とそれに対応するメカニズムのサブセットを実装しています。このようなコンテンツは多くの場合、何らかのデータベースに保存されており、ユーザーはコンテンツ戦略のために必要な場所であればどこでも再利用できる柔軟性を持っています。CMSはまた、ユーザーが必要に応じてコンテンツを簡単にアップロードして管理できるようにすることを目的とした管理機能を提供します。</p>
    <p>サイト構築のためにCMSが提供するサポートの種類と範囲には大きなばらつきがあり、ユーザーコンテンツで「水増し」されたすぐに使えるテンプレートを提供するものもあれば、サイト構造の設計と構築にユーザーの関与を必要とするものもあります。</p>
    <p>CMSについて考えるとき、ウェブ上にコンテンツを公開するためのプラットフォームを提供するシステムの実行可能性に関わるすべてのコンポーネントを考慮に入れる必要があります。これらのコンポーネントはすべて、CMSプラットフォームを取り巻くエコシステムを形成しており、ホスティングプロバイダ、拡張機能開発、開発代理、サイトビルダーなどが含まれています。このように、CMSというと、通常はプラットフォームそのものとそれを取り巻くエコシステムの両方を指すことになります。</p>
    <h3 id="cms-コンテンツ制作者はなぜcmsを使うのか？"><a href="#cms-コンテンツ制作者はなぜcmsを使うのか？" class="anchor-link">コンテンツ制作者はなぜCMSを使うのか？</a></h3>
    <p>(ウェブの進化）時代の初期にはウェブのエコシステムはユーザーがウェブページのソースを見て、必要に応じてコピーペーストし画像などの個別の要素で新しいバージョンをカスタマイズするだけでクリエイターになれるという、単純な成長ループで動いていました。</p>
    <p>
      ウェブが進化するにつれ、ウェブはより強力になる一方で、より複雑になりました。その結果、その単純な成長のループは破られ、誰でもクリエイターになれるような状況ではなくなってしまいました。コンテンツ制作の道を追求できる人にとっては、その道のりは険しく困難なものになってしまいました。ウェブでできることと実際にできることの差である<a href="https://medinathoughts.com/2018/05/17/progressive-wordpress/">利用可能性ギャップ<span class="fn">https://medinathoughts.com/2018/05/17/progressive-wordpress/</span></a
      >は着実に拡大していきました。
    </p>
    <figure id="cms-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/web-evolution.png">
        <img src="/static/images/2019/cms/web-evolution.png" aria-labelledby="cms-fig1-caption" aria-describedby="cms-fig1-description" alt="図1. 1999年から2018年までのWeb機能の増加を示すグラフ。" width="600" height="492" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="cms-fig1-description" class="visually-hidden">左側の1999年頃と書かれたラベルには2本の棒グラフがありますが、できることは、実際に行われていることに近いことを示しています。右側の2018年と書かれたものは、同じような棒グラフですが、できることの方がはるかに大きく、実際に行われていることの方がわずかに大きくなっています。できることと実際にできることのギャップが大きくなっています。</div>
      <figcaption id="cms-fig1-caption"><a href="#cms-fig-1" class="anchor-link">図 1.</a> 1999年から2018年までのWeb機能の増加を示すグラフ。</figcaption>
    </figure>
    <p>ここでCMSが果たす役割は、技術的な専門性の異なるユーザーがコンテンツ制作者としてウェブのエコシステムのループに入りやすくするという非常に重要なものです。コンテンツ制作への参入障壁を下げることで、ユーザーをクリエイターに変えることで、ウェブの成長ループを活性化させます。それが人気の理由です。</p>
    <h3 id="cms-この章の目標"><a href="#cms-この章の目標" class="anchor-link">この章の目標</a></h3>
    <p>私たちはCMS空間とウェブの現在と未来におけるその役割を理解するための探求の中で、分析すべき多くの興味深い重要な側面があり、答えるべき質問があります。私たちはCMSプラットフォーム空間の広大さと複雑さを認識しており、そこにあるすべてのプラットフォームに関わるすべての側面を完全にカバーする全知全能の知識を主張しているわけではありませんが、私たちはこの空間への魅力を主張しこの空間の主要なプレイヤーのいくつかについて深い専門知識を持っています。</p>
    <p>この章では広大なCMSの空間の表面領域のスクラッチを試み、CMSエコシステムの現状とコンテンツがウェブ上でどのように消費され、どのように体験されるかについてのユーザーの認識を形成する上でのCMSの役割について私たちの全体的な理解に光を当てようとしています。私たちの目標はCMSの状況を網羅的に見ることではなく、CMSの状況全般に関連するいくつかの側面と、これらのシステムによって生成されたウェブページの特徴について論じていきたいと思います。このWeb Almanacの初版はベースラインを確立するものであり、将来的には、トレンド分析のためにこのバージョンとデータを比較できるようになるでしょう。</p>
    <h2 id="cms-cms導入"><a href="#cms-cms導入" class="anchor-link">CMS導入</a></h2>
    <figure id="cms-fig-2">
      <div class="big-number">40%</div>
      <figcaption><a href="#cms-fig-2" class="anchor-link">図 2.</a> CMSを搭載したウェブページの割合。</figcaption>
    </figure>
    <p>今日では、ウェブページの40％以上が何らかのCMSプラットフォームを利用していることがわかります。40.01％がモバイル用で、39.61％がデスクトップ用です。</p>
    <p>
      他にも<a href="https://w3techs.com/technologies/history_overview/content_management">W3Techs<span class="fn">https://w3techs.com/technologies/history_overview/content_management</span></a
      >のようにCMSプラットフォームの市場シェアを追跡しているデータセットがあり、CMSプラットフォームを利用したウェブページの割合が50％を超えていることを反映しています。さらに、これらのデータはCMSプラットフォームが成長しており、場合によっては前年比12％の成長率を記録しています。弊社の分析とW3Techの分析との乖離は、調査方法の違いによって説明できるかもしれません。我々の分析については、<a href="#methodology">方法論</a>のページを参照してください。
    </p>
    <p>要するに、多くのCMSプラットフォームが存在するということです。下の写真は、CMSの風景を縮小したものです。</p>
    <figure id="cms-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/cms-logos.png">
        <img src="/static/images/2019/cms/cms-logos.png" aria-labelledby="cms-fig3-caption" aria-describedby="cms-fig3-description" alt="図3. 上位のコンテンツ管理システム。" width="600" height="559" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="cms-fig3-description" class="visually-hidden">Logos of the top CMS providers, including WordPress, Drupal, Wix, etc.</div>
      <figcaption id="cms-fig3-caption"><a href="#cms-fig-3" class="anchor-link">図 3.</a> 上位のコンテンツ管理システム。</figcaption>
    </figure>
    <p>その中には、オープンソース（WordPress、Drupalなど）のものもあれば、有償（AEMなど）のものもあります。CMSプラットフォームの中には「無料」のホスティングプランやセルフホスティングプランで利用できるものもありますし、企業レベルでも、より高い階層のプランで利用できる高度なオプションもあります。CMS空間全体として複雑で連携した<em>CMSエコシステム</em>の世界であり、全てが分離され、同時にウェブの広大な構造に絡み合っています。</p>
    <p>またCMSプラットフォームを利用したウェブサイトが何億もあり、これらのプラットフォームを利用してウェブにアクセスし、コンテンツを消費するユーザーが桁違いに増えていることを意味しています。このように、これらのプラットフォームは、常緑で健康的で活力に満ちたウェブを目指す私たちの集団的な探求を成功させるために重要な役割を果たしています。</p>
    <h3 id="cms-cmsの風景"><a href="#cms-cmsの風景" class="anchor-link">CMSの風景</a></h3>
    <p>今日のウェブの大部分は、ある種のCMSプラットフォームを利用しています。この現実を反映して、さまざまな組織が収集した統計となります。<a href="#methodology-chrome-ux-report">Chrome UXレポート</a>(CrUX)とHTTP Archiveのデータセットを見ると、データセットの特殊性を反映して定量的には記載されている割合は異なるかもしれませんが、他の場所で発表されている統計と一致している図が得られます。</p>
    <p>デスクトップとモバイルデバイスで提供されているウェブページを見てみると、何らかのCMSプラットフォームによって生成されたページとそうでないページの割合が約60-40％に分かれていることがわかります。</p>
    <figure id="cms-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig4.png">
        <img src="/static/images/2019/cms/fig4.png" alt="図4. CMSを使用しているデスクトップおよびモバイルサイトの割合。" aria-labelledby="cms-fig4-caption" aria-describedby="cms-fig4-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=1644425372&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="cms-fig4-description" class="visually-hidden">デスクトップサイトの40％、モバイルサイトの40％がCMSを使用して構築されていることを示す棒グラフ。</div>
      <figcaption id="cms-fig4-caption"><a href="#cms-fig-4" class="anchor-link">図 4.</a> CMSを使用しているデスクトップおよびモバイルサイトの割合。</figcaption>
    </figure>
    <p>CMSを搭載したウェブページは、利用可能なCMSプラットフォームの大規模なセットによって生成されます。そのようなプラットフォームの中から選択するには多くのものがあり、1つを使用することを決定する際に考慮できる多くの要因があり、以下のようなものがあります。</p>
    <ul>
      <li>コア機能</li>
      <li>作成・編集のワークフローと体験</li>
      <li>参入障壁</li>
      <li>カスタマイズ性</li>
      <li>コミュニティ</li>
      <li>他にもたくさん</li>
    </ul>
    <p>
      CrUXとHTTP Archiveのデータセットには、約103のCMSプラットフォームが、混在したウェブページが含まれています。これらのプラットフォームのほとんどは、相対的な市場シェアが非常に小さいものです。今回の分析では、データに反映されているウェブ上でのフットプリントという観点から、上位のCMSプラットフォームに焦点を当ててみたいと思います。完全な分析については、<a href="https://docs.google.com/spreadsheets/d/1FDYe6QdoY3UtXodE2estTdwMsTG-hHNrOe9wEYLlwAw/edit#gid=0">この章の結果のスプレッドシートを参照してください<span class="fn">https://docs.google.com/spreadsheets/d/1FDYe6QdoY3UtXodE2estTdwMsTG-hHNrOe9wEYLlwAw/edit#gid=0</span></a
      >。
    </p>
    <figure id="cms-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig5.png">
        <img src="/static/images/2019/cms/fig5.png" alt="図5. 全CMSウェブサイトに占めるトップCMSプラットフォームの割合。" aria-labelledby="cms-fig5-caption" aria-describedby="cms-fig5-description" width="600" height="600" data-width="600" data-height="600" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=1652315665&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="cms-fig5-description" class="visually-hidden">WordPressがCMSサイト全体の75％を占めていることを示す棒グラフ。次に大きなCMSであるDrupalは、CMS市場の約6%のシェアを持っています。残りのCMSは急速に採用率が1%未満に縮小しています。</div>
      <figcaption id="cms-fig5-caption"><a href="#cms-fig-5" class="anchor-link">図 5.</a> 全CMSウェブサイトに占めるトップCMSプラットフォームの割合。</figcaption>
    </figure>
    <p>データセットに含まれる最も顕著なCMSプラットフォームを図5に示す。WordPressはモバイルサイトの74.19%、デスクトップサイトの73.47% を占めています。CMSの世界におけるWordPressの優位性は、後述するいくつかの要因に起因していますが、WordPressは主要なプレイヤーです。DrupalやJoomlaのようなオープンソースのプラットフォームと、SquarespaceやWixのようなクローズドなSaaSが上位5つのCMSを占めています。これらのプラットフォームの多様性は、多くのプラットフォームからなるCMSエコシステムを物語っています。また、興味深いのは、上位20位までの小規模CMSプラットフォームのロングテールです。企業向けに提供されているものから、業界特有の用途のために社内で開発された独自のアプリケーションまで、コンテンツ管理システムは、グループがウェブ上で管理、公開、ビジネスを行うためのカスタマイズ可能なインフラストラクチャを提供しています。</p>
    <p>
      WordPressプロジェクト](<a href="https://wordpress.org/about/)は、そのミッションを「*出版の民主化*」と定義しています。その主な目標のいくつかは、使いやすさと、誰もがウェブ上でコンテンツを作成できるようにソフトウェアを無料で利用できるようにすることです。もう1つの大きな要素は、このプロジェクトが育んでいる包括的なコミュニティです。世界のほとんどの大都市ではWordPressプラットフォームを理解し、構築しようと定期的に集まり、つながりを持ち共有し、コードを書く人々のグループを見つけることができます。地域のミートアップや年次イベントに参加したり、ウェブベースのチャンネルに参加したりすることは、WordPressの貢献者、専門家、ビジネス、愛好家がそのグローバルなコミュニティに参加する方法の一部となっています。">https://wordpress.org/about/)は、そのミッションを「*出版の民主化*」と定義しています。その主な目標のいくつかは、使いやすさと、誰もがウェブ上でコンテンツを作成できるようにソフトウェアを無料で利用できるようにすることです。もう1つの大きな要素は、このプロジェクトが育んでいる包括的なコミュニティです。世界のほとんどの大都市ではWordPressプラットフォームを理解し、構築しようと定期的に集まり、つながりを持ち共有し、コードを書く人々のグループを見つけることができます。地域のミートアップや年次イベントに参加したり、ウェブベースのチャンネルに参加したりすることは、WordPressの貢献者、専門家、ビジネス、愛好家がそのグローバルなコミュニティに参加する方法の一部となっています。<span class="fn">https://wordpress.org/about/)は、そのミッションを「*出版の民主化*」と定義しています。その主な目標のいくつかは、使いやすさと、誰もがウェブ上でコンテンツを作成できるようにソフトウェアを無料で利用できるようにすることです。もう1つの大きな要素は、このプロジェクトが育んでいる包括的なコミュニティです。世界のほとんどの大都市ではWordPressプラットフォームを理解し、構築しようと定期的に集まり、つながりを持ち共有し、コードを書く人々のグループを見つけることができます。地域のミートアップや年次イベントに参加したり、ウェブベースのチャンネルに参加したりすることは、WordPressの貢献者、専門家、ビジネス、愛好家がそのグローバルなコミュニティに参加する方法の一部となっています。</span></a>
    </p>
    <p>WordPressの人気は参入障壁の低さと、ユーザー（オンラインと対面）がプラットフォーム上でのパブリッシングをサポートし、拡張機能（プラグイン）やテーマを開発するためのリソースが要因となっています。またWordPressのプラグインやテーマは、ウェブデザインや機能性を追求した実装の複雑さを軽減してくれるので、利用しやすく経済的です。これらの側面が、新規参入者によるリーチと採用を促進するだけでなく、長期的な使用を維持しています。</p>
    <p>オープンソースのWordPressプラットフォームは、ボランティア、WordPress Foundation、そしてウェブエコシステムの主要なプレイヤーによって運営されサポートされています。これらの要素を考慮すると、WordPressを主要なCMSとすることは理にかなっています。</p>
    <h2 id="cms-cmsを搭載したサイトはどのように構築されているのか"><a href="#cms-cmsを搭載したサイトはどのように構築されているのか" class="anchor-link">CMSを搭載したサイトはどのように構築されているのか</a></h2>
    <p>それぞれのCMSプラットフォームのニュアンスや特殊性とは無関係に、最終的な目標は、オープンウェブの広大なリーチを介してユーザーに提供するウェブページを出力することにあります。CMSを搭載したウェブページとそうでないウェブページの違いは、前者では最終的な結果の構築方法のほとんどをCMSプラットフォームが決定するのに対し後者ではそのような抽象化された層がなく、すべての決定は開発者が直接またはライブラリの設定を介して行うという点にあります。</p>
    <p>このセクションでは、CMS空間の現状を出力の特徴（使用された総リソース、画像統計など）の観点から簡単に見ていき、ウェブエコシステム全体とどのように比較するかを見ていきます。</p>
    <h3 id="cms-リソースの総使用量"><a href="#cms-リソースの総使用量" class="anchor-link">リソースの総使用量</a></h3>
    <p>どんなWebサイトでも、その構成要素がCMSサイトを作っています。<a href="#markup">HTML</a>、<a href="#css">CSS</a>、<a href="#javascript">JavaScript</a>、<a href="#media">media</a>（画像や動画）です。CMSプラットフォームは、これらのリソースを統合してWeb体験を作成するための強力に合理化された管理機能をユーザーに提供します。これは、これらのアプリケーションの最も包括的な側面の1つですが、より広いウェブに悪影響を及ぼす可能性があります。</p>
    <figure id="cms-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig6.png">
        <img src="/static/images/2019/cms/fig6.png" alt="図6. CMSページ重量の分布。" aria-labelledby="cms-fig6-caption" aria-describedby="cms-fig6-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=991628102&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="cms-fig6-description" class="visually-hidden">CMSページの重さの分布を示す棒グラフ。デスクトップCMSページの重さの中央値は2.3MBです。10パーセンタイルでは0.7MB、25パーセンタイルでは1.2MB、75パーセンタイルでは4.2MB、90パーセンタイルでは7.4MBとなっています。デスクトップの値は、モバイルよりもわずかに高くなっています。</div>
      <figcaption id="cms-fig6-caption"><a href="#cms-fig-6" class="anchor-link">図 6.</a> CMSページ重量の分布。</figcaption>
    </figure>
    <figure id="cms-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig7.png">
        <img src="/static/images/2019/cms/fig7.png" alt="図7. ページあたりのCMSリクエストの分布。" aria-labelledby="cms-fig7-caption" aria-describedby="cms-fig7-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=140872807&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="cms-fig7-description" class="visually-hidden">ページあたりのCMSリクエストの分布を示す棒グラフ。中央値のデスクトップCMSページは86リソースをロードします。10パーセンタイルでは39リソース、25パーセンタイルでは57リソース、75パーセンタイルでは127リソース、90パーセンタイルでは183リソースをロードします。デスクトップはモバイルよりも3～6リソースの僅差で一貫して高い。</div>
      <figcaption id="cms-fig7-caption"><a href="#cms-fig-7" class="anchor-link">図 7.</a> ページあたりのCMSリクエストの分布。</figcaption>
    </figure>
    <p>上の図6と7では、デスクトップCMSページの中央値は86のリソースと2.29MBの重さをロードしていることがわかります。モバイルページのリソース使用量は、83のリソースと2.25 MBと、それほど大きくはありません。</p>
    <p>中央値は、すべてのCMSページが上か下かの中間点を示しています。つまり全CMSページの半分はリクエスト数が少なく、重量が少ないのに対し、半分はリクエスト数が多く、重量が多いということになります。10パーセンタイルではモバイルとデスクトップのページはリクエスト数が40以下で重量が1MBですが、90パーセンタイルではリクエスト数が170以上で重量が7MBとなり、中央値の3倍近くになっています。</p>
    <p>CMSのページは、ウェブ全体のページと比較してどうでしょうか？ <a href="#page-weight">ページ重量</a>の章では、リソースの使用量についてのデータを見つけることができます。中央値では、デスクトップページは74リクエストで1.9MBを読み込み、ウェブ上のモバイルページは69リクエストで1.7MBを読み込みます。中央値では、CMSページはこれを上回っています。また、CMSページは90パーセンタイルでウェブ上のリソースを上回っていますが、その差はもっと小さいです。要するに、CMSページは最も重いページの1つと考えられます。</p>
    <figure id="cms-fig-8">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>パーセンタイル</th>
                <th>image</th>
                <th>video</th>
                <th>script</th>
                <th>font</th>
                <th>css</th>
                <th>audio</th>
                <th>html</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="numeric">50</td>
                <td class="numeric">1,233</td>
                <td class="numeric">1,342</td>
                <td class="numeric">456</td>
                <td class="numeric">140</td>
                <td class="numeric">93</td>
                <td class="numeric">14</td>
                <td class="numeric">33</td>
              </tr>
              <tr>
                <td class="numeric">75</td>
                <td class="numeric">2,766</td>
                <td class="numeric">2,735</td>
                <td class="numeric">784</td>
                <td class="numeric">223</td>
                <td class="numeric">174</td>
                <td class="numeric">97</td>
                <td class="numeric">66</td>
              </tr>
              <tr>
                <td class="numeric">90</td>
                <td class="numeric">5,699</td>
                <td class="numeric">5,098</td>
                <td class="numeric">1,199</td>
                <td class="numeric">342</td>
                <td class="numeric">310</td>
                <td class="numeric">287</td>
                <td class="numeric">120</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cms-fig-8" class="anchor-link">図 8.</a> リソースタイプごとのデスクトップCMSページのキロバイト数の分布。</figcaption>
    </figure>
    <figure id="cms-fig-9">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>パーセンタイル</th>
                <th>image</th>
                <th>video</th>
                <th>script</th>
                <th>css</th>
                <th>font</th>
                <th>audio</th>
                <th>html</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="numeric">50</td>
                <td class="numeric">1,264</td>
                <td class="numeric">1,056</td>
                <td class="numeric">438</td>
                <td class="numeric">89</td>
                <td class="numeric">109</td>
                <td class="numeric">14</td>
                <td class="numeric">32</td>
              </tr>
              <tr>
                <td class="numeric">75</td>
                <td class="numeric">2,812</td>
                <td class="numeric">2,191</td>
                <td class="numeric">756</td>
                <td class="numeric">171</td>
                <td class="numeric">177</td>
                <td class="numeric">38</td>
                <td class="numeric">67</td>
              </tr>
              <tr>
                <td class="numeric">90</td>
                <td class="numeric">5,531</td>
                <td class="numeric">4,593</td>
                <td class="numeric">1,178</td>
                <td class="numeric">317</td>
                <td class="numeric">286</td>
                <td class="numeric">473</td>
                <td class="numeric">123</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cms-fig-9" class="anchor-link">図 9.</a> リソースタイプごとのモバイルCMSページのキロバイト分布。</figcaption>
    </figure>
    <p>モバイルやデスクトップのCMSページにロードされるリソースの種類を詳しく見ると、画像や動画は、その重さの主な貢献者としてすぐに目立ちます。</p>
    <p>影響は必ずしもリクエスト数と相関するわけではなく、個々のリクエストにどれだけのデータが関連付けられているかということです。例えば、中央値で2つのリクエストしかない動画リソースの場合、1MB以上の負荷がかかります。マルチメディア体験には、スクリプトを使用してインタラクティブ性を統合したり、機能やデータを提供したりすることもあります。モバイルページとデスクトップページの両方で、これらは3番目に重いリソースです。</p>
    <p>
      CMSの経験がこれらのリソースで飽和状態にある中で、フロントエンドのウェブサイト訪問者に与える影響を考慮しなければなりません。さらに、モバイルとデスクトップのリソース使用量を比較すると、リクエストの量と重さにはほとんど差がありません。つまり、同じ量と重量のリソースがモバイルとデスクトップの両方のCMS体験を動かしていることになります。接続速度とモバイルデバイスの品質のばらつきは、<a href="https://medinathoughts.com/2017/12/03/the-perils-of-mobile-web-performance-part-iii/">もう一つの複雑さの層<span class="fn">https://medinathoughts.com/2017/12/03/the-perils-of-mobile-web-performance-part-iii/</span></a
      >を追加します。この章の後半では、CrUXのデータを使用して、CMS空間でのユーザー体験を評価します。
    </p>
    <h3 id="cms-サードパーティのリソース"><a href="#cms-サードパーティのリソース" class="anchor-link">サードパーティのリソース</a></h3>
    <p>リソースの特定のサブセットを強調して、CMSの世界での影響を評価してみましょう。<a href="#third-parties">サードパーティ</a>リソースとは、送信先サイトのドメイン名やサーバーに属さないオリジンからのリソースです。画像、動画、スクリプト、その他のリソースタイプがあります。これらのリソースは、例えば<code>iframe</code>を埋め込むなど、組み合わせてパッケージ化されていることもあります。当社のデータによると、デスクトップとモバイルの両方で、サードパーティのリソースの中央値は近いことがわかります。</p>
    <p>モバイルCMSページのサードパーティリクエストの中央値は15、重さ264.72KBでデスクトップCMSページのサードパーティリクエストの中央値は16、重さ271.56KBです。(これは「ホスティング」の一部とみなされる3Pリソースを除いたものであることに注意)。</p>
    <figure id="cms-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig10.png">
        <img src="/static/images/2019/cms/fig10.png" alt="図10. CMSページにおけるサードパーティウェイト（KB）の分布。" aria-labelledby="cms-fig10-caption" aria-describedby="cms-fig10-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=354803312&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="cms-fig10-description" class="visually-hidden">デスクトップとモバイルのCMSページにおけるサードパーティのキロバイトの分布を示すパーセンタイル10、25、50、75、90の棒グラフ。デスクトップのサードパーティ重量の中央値（50パーセンタイル）は272KB。10パーセンタイルは27KB、25位104KB、75位577KB、90位940KBとなっています。モバイルはパーセンタイルが小さい方がわずかに小さく、大きい方がわずかに大きくなっています。</div>
      <figcaption id="cms-fig10-caption"><a href="#cms-fig-10" class="anchor-link">図 10.</a> CMSページにおけるサードパーティウェイト（KB）の分布。</figcaption>
    </figure>
    <figure id="cms-fig-11">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig11.png">
        <img src="/static/images/2019/cms/fig11.png" alt="図11. CMSページの第三者リクエスト数の分布。" aria-labelledby="cms-fig11-caption" aria-describedby="cms-fig11-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=699762709&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig11-description" data-show-text="{{ show_description(11) }}" data-hide-text="{{ hide_description(11) }}">{{ show_description(11) }}</button>
      <div id="cms-fig11-description" class="visually-hidden">デスクトップとモバイル用のCMSページのサードパーティリクエストの分布を示すパーセンタイル10、25、50、75、90の棒グラフ。デスクトップのサードパーティリクエスト数の中央値（50パーセンタイル）は16。10パーセンタイルは3、25パーセンタイルは7、75パーセンタイルは31、90パーセンタイルは52です。デスクトップとモバイルでは、ほぼ同等の分布となっています。</div>
      <figcaption id="cms-fig11-caption"><a href="#cms-fig-11" class="anchor-link">図 11.</a> CMSページの第三者リクエスト数の分布。</figcaption>
    </figure>
    <p>中央値は、少なくとも半分のCMSウェブページが、ここで報告している値よりも多くのサードパーティのリソースを提供していることを示しています。90パーセンタイルではCMSページは約940KBで52のリソースを配信できますが、これはかなりの増加です。</p>
    <p>サードパーティのリソースがリモートドメインやサーバーからのものであることを考えると、送信先のサイトは、これらのリソースの品質やパフォーマンスへの影響をほとんどコントロールできません。この予測不可能性が速度の変動につながり、ユーザー体験に影響を与える可能性があります。</p>
    <h3 id="cms-画像の統計"><a href="#cms-画像の統計" class="anchor-link">画像の統計</a></h3>
    <figure id="cms-fig-12">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig12.png">
        <img src="/static/images/2019/cms/fig12.png" alt="図12. CMSページにおける画像の重み（KB）の分布。" aria-labelledby="cms-fig12-caption" aria-describedby="cms-fig12-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=1615220952&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="cms-fig12-description" class="visually-hidden">デスクトップとモバイルのCMSページの画像キロバイトの分布を示すパーセンタイル10、25、50、75、90の棒グラフ。デスクトップの画像重量の中央値（50パーセンタイル）は1,232KB。10パーセンタイルは198KB、25パーセンタイル507KB、75パーセンタイル2,763KB、90パーセンタイル5,694KBとなっています。デスクトップとモバイルでは、ほぼ同等の分布となっています。</div>
      <figcaption id="cms-fig12-caption"><a href="#cms-fig-12" class="anchor-link">図 12.</a> CMSページにおける画像の重み（KB）の分布。</figcaption>
    </figure>
    <figure id="cms-fig-13">
      <div class="big-number">1,232 KB</div>
      <figcaption><a href="#cms-fig-13" class="anchor-link">図 13.</a> デスクトップCMSページあたりの画像の読み込みキロバイト数の中央値。</figcaption>
    </figure>
    <p>先に図8と9を見て、画像はCMSページの総重量に大きく寄与していることを思い出してください。上記の図12と13は、デスクトップCMSページの中央値は31枚の画像とペイロードが1,232KBであるのに対し、モバイルCMSページの中央値は29枚の画像とペイロードが1,263KBであることを示しています。ここでも私たちは、デスクトップとモバイルの両方の経験のためのこれらのリソースの重量のための非常に近いマージンを持っています。<a href="#page-weight">ページ重量</a>の章では、さらに、画像リソースがウェブ全体で同じ量の画像を持つページの重量の中央値を十分に上回っていることが示されています。その結果は以下の通りです。CMSページは重い画像を供給している。</p>
    <p>モバイルやデスクトップのCMSページでよく見られるフォーマットは何ですか？　当社のデータによると、平均的にJPG画像が最も人気のある画像フォーマットです。次いでPNG、GIFが続き、SVG、ICO、WebPのようなフォーマットが2％強、1％強と大きく後れを取っています。</p>
    <figure id="cms-fig-14">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig14.png">
        <img src="/static/images/2019/cms/fig14.png" alt="図14. CMSページでの画像フォーマットの採用。" aria-labelledby="cms-fig14-caption" aria-describedby="cms-fig14-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=98218771&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig14-description" data-show-text="{{ show_description(14) }}" data-hide-text="{{ hide_description(14) }}">{{ show_description(14) }}</button>
      <div id="cms-fig14-description" class="visually-hidden">デスクトップとモバイルのCMSページにおける画像フォーマットの採用状況の棒グラフ。JPEGが全体の半分近くを占め、PNGが3分の1、GIFが5分の1を占め、残りの5%はSVG、ICO、WebPで占められています。デスクトップとモバイルでは、ほぼ同等の採用率となっています。</div>
      <figcaption id="cms-fig14-caption"><a href="#cms-fig-14" class="anchor-link">図 14.</a> CMSページでの画像フォーマットの採用。</figcaption>
    </figure>
    <p>
      おそらく、これらの画像タイプの一般的な使用例を考えると、このようなセグメンテーションは驚くべきものでありません。ロゴやアイコン用のSVGは、JPEGがユビキタスであるのと同様に一般的です。WebPはまだ比較的新しい最適化されたフォーマットであり、<a href="https://caniuse.com/#search=webp">ブラウザの普及が進んでいます<span class="fn">https://caniuse.com/#search=webp</span></a
      >。これが今後数年の間にCMS空間での使用にどのような影響を与えるかを見るのは興味深いことでしょう。
    </p>
    <h2 id="cms-cmsを搭載したウェブサイトのユーザー体験"><a href="#cms-cmsを搭載したウェブサイトのユーザー体験" class="anchor-link">CMSを搭載したウェブサイトのユーザー体験</a></h2>
    <p>ウェブコンテンツ制作者として成功するには、ユーザー体験がすべてです。リソースの使用量やウェブページの構成方法に関するその他の統計などの要因は、サイトを構築する際のベストプラクティスの観点から、サイトの品質を示す重要な指標となります。しかし私たちは最終的に、これらのプラットフォームで生成されたコンテンツを消費したり、利用したりする際にユーザーが実際にどのようにウェブを体験しているのかを明らかにしたいと考えています。</p>
    <p>
      これを実現するために、CrUXデータセットに収録されているいくつかの<a href="https://developers.google.com/web/fundamentals/performance/user-centric-performance-metrics">利用者目線のパフォーマンス指標<span class="fn">https://developers.google.com/web/fundamentals/performance/user-centric-performance-metrics</span></a
      >に向けて分析を行います。これらのメトリクスは、<a href="https://paulbakaus.com/tutorials/performance/the-illusion-of-speed/">人として私たちが時間をどのように感じるか<span class="fn">https://paulbakaus.com/tutorials/performance/the-illusion-of-speed/</span></a
      >に何らかの形で関連しています。
    </p>
    <figure id="cms-fig-15">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>持続時間</th>
                <th>知覚</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>&lt; 0.1秒</td>
                <td>瞬間</td>
              </tr>
              <tr>
                <td>0.5-1秒</td>
                <td>即時</td>
              </tr>
              <tr>
                <td>2-5秒</td>
                <td>放棄されるポイント</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cms-fig-15" class="anchor-link">図 15.</a> 人間がどのようにして短い時間を知覚するのか。</figcaption>
    </figure>
    <p>0.1秒（100ミリ秒）以内に起こることは、私たちにとっては事実上瞬時に起こっていることです。そして、数秒以上の時間がかかる場合、私たちはそれ以上待たずに生活を続ける可能性が非常に高くなります。これは、ウェブでの持続的な成功を目指すコンテンツ制作者にとって非常に重要なことです。なぜならユーザーを獲得し、魅了し、ユーザーベースを維持したいのであればサイトの読み込み速度がどれだけ速くなければならないかを教えてくれるからです。</p>
    <p>このセクションでは、ユーザーがCMSを搭載したウェブページをどのように体験しているのかを理解するために、3つの重要な次元を見てみましょう。</p>
    <ul>
      <li>コンテンツの初回ペイント (FCP)</li>
      <li>入力の推定待ち時間 (FID)</li>
      <li>Lighthouseスコア</li>
    </ul>
    <h3 id="cms-コンテンツの初回ペイント"><a href="#cms-コンテンツの初回ペイント" class="anchor-link">コンテンツの初回ペイント</a></h3>
    <p>
      <a href="https://developers.google.com/web/tools/lighthouse/audits/first-contentful-paint">コンテンツの初回ペイント<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/first-contentful-paint</span></a> は、ナビゲーションからテキストや画像などのコンテンツが最初に表示されるまでの時間を測定します。成功したFCPの経験、つまり「速い」と認定される経験とは、ウェブサイトの読み込みが正常に行われていることをユーザーへ保証するため、DOM内の要素がどれだけ速くロードされるかということです。FCPのスコアが良ければ対応するサイトが良いUXを提供していることを保証するものではありませんが、FCPが悪ければ、ほぼ確実にその逆を保証することになります。
    </p>
    <figure id="cms-fig-16">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig16.png">
        <img src="/static/images/2019/cms/fig16.png" alt="図16. CMS全体のFCP経験の平均分布。" aria-labelledby="cms-fig16-caption" aria-describedby="cms-fig16-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=1644531590&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig16-description" data-show-text="{{ show_description(16) }}" data-hide-text="{{ hide_description(16) }}">{{ show_description(16) }}</button>
      <div id="cms-fig16-description" class="visually-hidden">CMSごとのFCP経験値の平均分布を棒グラフにしたもの。以下の図17を参照して、上位5つのCMSデータ表を作成した。</div>
      <figcaption id="cms-fig16-caption"><a href="#cms-fig-16" class="anchor-link">図 16.</a> CMS全体のFCP経験の平均分布。</figcaption>
    </figure>
    <figure id="cms-fig-17">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>CMS</th>
                <th>速い<br />(&lt; 1000ms)</th>
                <th>中程度</th>
                <th>遅い<br />(&gt;= 3000ms)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>WordPress</td>
                <td class="numeric">24.33%</td>
                <td class="numeric">40.24%</td>
                <td class="numeric">35.42%</td>
              </tr>
              <tr>
                <td>Drupal</td>
                <td class="numeric">37.25%</td>
                <td class="numeric">39.39%</td>
                <td class="numeric">23.35%</td>
              </tr>
              <tr>
                <td>Joomla</td>
                <td class="numeric">22.66%</td>
                <td class="numeric">46.48%</td>
                <td class="numeric">30.86%</td>
              </tr>
              <tr>
                <td>Wix</td>
                <td class="numeric">14.25%</td>
                <td class="numeric">62.84%</td>
                <td class="numeric">22.91%</td>
              </tr>
              <tr>
                <td>Squarespace</td>
                <td class="numeric">26.23%</td>
                <td class="numeric">43.79%</td>
                <td class="numeric">29.98%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cms-fig-17" class="anchor-link">図 17.</a> 上位5つのCMSのFCP経験値の平均分布。</figcaption>
    </figure>
    <p>CMSの世界におけるFCPの傾向は、ほとんどが中程度の範囲にあります。CMSプラットフォームがデータベースからコンテンツを照会し、送信し、その後ブラウザでレンダリングする必要があるため、ユーザーが体験する遅延の一因となっている可能性があります。前のセクションで説明したリソース負荷も一役買っている可能性があります。さらに、これらのインスタンスの中には共有ホスティング上にあるものやパフォーマンスが最適化されていない環境もあり、これもブラウザ上での体験に影響を与える可能性があります。</p>
    <p>WordPressはモバイルとデスクトップで、中程度のFCP体験と遅いFCP体験を示しています。Wixはクローズドなプラットフォームで中程度のFCP体験が強みです。企業向けオープンソースCMSプラットフォームであるTYPO3は、モバイルとデスクトップの両方で一貫して高速な体験を提供しています。TYPO3は、フロントエンドに組み込まれたパフォーマンスとスケーラビリティ機能がウェブサイトの訪問者にプラスの影響を与える可能性があると宣伝しています。</p>
    <h3 id="cms-入力の推定待ち時間"><a href="#cms-入力の推定待ち時間" class="anchor-link">入力の推定待ち時間</a></h3>
    <p>
      <a href="https://developers.google.com/web/updates/2018/05/first-input-delay">入力の推定待ち時間<span class="fn">https://developers.google.com/web/updates/2018/05/first-input-delay</span></a> (FID) は、ユーザーが最初にサイトとやり取りをした時（リンクをクリックした時、ボタンをタップした時、カスタムのJavaScriptを使用したコントロールを使用した時など）から、ブラウザが実際にそのやり取りへ応答できるようになるまでの時間を測定します。ユーザーの視点から見た「速い」FIDとは、サイト上でのアクションからの即時フィードバックであり、停滞した体験ではありません。この遅延(痛いところ)は、ユーザーがサイトと対話しようとしたときに、サイトの読み込みの他の側面からの干渉と相関する可能性があります。
    </p>
    <p>CMS領域のFIDは一般的に、デスクトップとモバイルの両方で平均的に高速なエクスペリエンスを提供する傾向にある。しかし、注目すべきは、モバイルとデスクトップの体験の間に大きな違いがあることです。</p>
    <figure id="cms-fig-18">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig18.png">
        <img src="/static/images/2019/cms/fig18.png" alt="図18. CMS全体のFID経験の平均分布。" aria-labelledby="cms-fig18-caption" aria-describedby="cms-fig18-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=625179047&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig18-description" data-show-text="{{ show_description(18) }}" data-hide-text="{{ hide_description(18) }}">{{ show_description(18) }}</button>
      <div id="cms-fig18-description" class="visually-hidden">CMSごとのFCP経験値の平均分布を棒グラフにしたもの。上位5つのCMSデータ表については、下記の図19を参照のこと。</div>
      <figcaption id="cms-fig18-caption"><a href="#cms-fig-18" class="anchor-link">図 18.</a> CMS全体のFID経験の平均分布。</figcaption>
    </figure>
    <figure id="cms-fig-19">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>CMS</th>
                <th>速い<br />(&lt; 100ms)</th>
                <th>中程度</th>
                <th>遅い<br />(&gt;= 300ms)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>WordPress</td>
                <td class="numeric">80.25%</td>
                <td class="numeric">13.55%</td>
                <td class="numeric">6.20%</td>
              </tr>
              <tr>
                <td>Drupal</td>
                <td class="numeric">74.88%</td>
                <td class="numeric">18.64%</td>
                <td class="numeric">6.48%</td>
              </tr>
              <tr>
                <td>Joomla</td>
                <td class="numeric">68.82%</td>
                <td class="numeric">22.61%</td>
                <td class="numeric">8.57%</td>
              </tr>
              <tr>
                <td>Squarespace</td>
                <td class="numeric">84.55%</td>
                <td class="numeric">9.13%</td>
                <td class="numeric">6.31%</td>
              </tr>
              <tr>
                <td>Wix</td>
                <td class="numeric">63.06%</td>
                <td class="numeric">16.99%</td>
                <td class="numeric">19.95%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cms-fig-19" class="anchor-link">図 19.</a> 上位5つのCMSのFID経験値の平均分布。</figcaption>
    </figure>
    <p>この差はFCPのデータにも見られますが、FIDではパフォーマンスに大きなギャップが見られます。例えば、Joomlaのモバイルとデスクトップの高速FCP体験の差は約12.78％ですが、FIDの体験では27.76％と大きな差があります。モバイルデバイスと接続品質が、ここで見られるパフォーマンスの格差に一役買っている可能性があります。以前に強調したように、ウェブサイトのデスクトップ版とモバイル版に出荷されるリソースにはわずかな差があります。モバイル（インタラクティブ）体験のための最適化は、これらの結果から明らかになります。</p>
    <h3 id="cms-lighthouseスコア"><a href="#cms-lighthouseスコア" class="anchor-link">Lighthouseスコア</a></h3>
    <p><a href="#methodology-lighthouse">Lighthouse</a> は、開発者がWebサイトの品質を評価して改善するのに役立つように設計された、オープンソースの自動化ツールです。このツールの重要な側面の1つは、<strong>パフォーマンス</strong>、<strong>アクセシビリティ</strong>、<strong>プログレッシブなWebアプリ</strong>などの観点からWebサイトの状態を評価するための監査のセットを提供することです。この章の目的のために、2つの特定の監査カテゴリに興味を持っています。PWAとアクセシビリティです。</p>
    <h4 id="cms-pwa"><a href="#cms-pwa" class="anchor-link">PWA</a></h4>
    <p>
      <strong>プログレッシブウェブアプリ</strong> (<a href="#pwa">PWA</a>)という用語は、<a href="https://developers.google.com/web/progressive-web-apps#reliable">信頼できる<span class="fn">https://developers.google.com/web/progressive-web-apps#reliable</span></a
      >、<a href="https://developers.google.com/web/progressive-web-apps#fast">速い<span class="fn">https://developers.google.com/web/progressive-web-apps#fast</span></a
      >、<a href="https://developers.google.com/web/progressive-web-apps#engaging">魅力的<span class="fn">https://developers.google.com/web/progressive-web-apps#engaging</span></a
      >とみなされるウェブベースのユーザー体験を指します。Lighthouseは、0（最悪）から1（最高）の間のPWAスコアを返す一連の監査を提供しています。これらの監査は、14の要件をリストアップした<a href="https://developers.google.com/web/progressive-web-apps/checklist#baseline">ベースラインPWAチェックリスト<span class="fn">https://developers.google.com/web/progressive-web-apps/checklist#baseline</span></a
      >に基づいています。Lighthouseは、14の要件のうち11の要件について自動監査を実施しています。残りの3つは手動でしかテストできません。11の自動PWA監査はそれぞれ均等に重み付けされているため、それぞれがPWAスコアに約9ポイント寄与します。
    </p>
    <figure id="cms-fig-20">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig20.png">
        <img src="/static/images/2019/cms/fig20.png" alt="図20. CMSページのLighthouse PWAカテゴリスコアの分布。" aria-labelledby="cms-fig20-caption" aria-describedby="cms-fig20-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=1812566020&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig20-description" data-show-text="{{ show_description(20) }}" data-hide-text="{{ hide_description(20) }}">{{ show_description(20) }}</button>
      <div id="cms-fig20-description" class="visually-hidden">全CMSページのLighthouse PWAカテゴリスコアの分布を示す棒グラフです。最も一般的なスコアは0.3で、CMSページの22%です。この分布には他にも2つのピークがあります。スコアが0.15のページが11％、スコアが0.56のページが8％です。0.6以上のスコアを取得しているページは1%未満です。</div>
      <figcaption id="cms-fig20-caption"><a href="#cms-fig-20" class="anchor-link">図 20.</a> CMSページのLighthouse PWAカテゴリスコアの分布。</figcaption>
    </figure>
    <figure id="cms-fig-21">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig21.png">
        <img src="/static/images/2019/cms/fig21.png" alt="図21. CMSごとの灯台PWAカテゴリスコアの中央値。" aria-labelledby="cms-fig21-caption" aria-describedby="cms-fig21-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=1071586621&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig21-description" data-show-text="{{ show_description(21) }}" data-hide-text="{{ hide_description(21) }}">{{ show_description(21) }}</button>
      <div id="cms-fig21-description" class="visually-hidden">CMSごとのLighthouse PWAスコアの中央値を示す棒グラフ。WordPressサイトのスコア中央値は0.33です。次の5つのCMS（Joomla、Drupal、Wix、Squarespace、1C-Bitrix）のスコア中央値はすべて0.3です。PWAのスコアがトップのCMSは、Jimdoが0.56、TYPO3が0.41となっています。</div>
      <figcaption id="cms-fig21-caption"><a href="#cms-fig-21" class="anchor-link">図 21.</a> CMSごとの灯台PWAカテゴリスコアの中央値。</figcaption>
    </figure>
    <h4 id="cms-アクセシビリティ"><a href="#cms-アクセシビリティ" class="anchor-link">アクセシビリティ</a></h4>
    <p>
      アクセシブルなウェブサイトとは、障害者が利用できるように設計・開発されたサイトのことです。Lighthouseは、一連のアクセシビリティ監査を提供し、それらすべての監査の加重平均を返します（各監査の加重方法の完全なリストについては、<a href="https://docs.google.com/spreadsheets/d/1Cxzhy5ecqJCucdf1M0iOzM8mIxNc7mmx107o5nj38Eo/edit#gid=1567011065">スコアリングの詳細<span class="fn">https://docs.google.com/spreadsheets/d/1Cxzhy5ecqJCucdf1M0iOzM8mIxNc7mmx107o5nj38Eo/edit#gid=1567011065</span></a
      >を参照してください）。
    </p>
    <p>各アクセシビリティ監査は合格か、不合格かですが他のLighthouseの監査とは異なり、アクセシビリティ監査に部分的に合格してもページはポイントをもらえません。例えば、いくつかの要素がスクリーンリーダーに優しい名前を持っていて他の要素がそうでない場合、そのページは<em>screenreader-friendly-names</em>監査で0点を獲得します。</p>
    <figure id="cms-fig-22">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig22.png">
        <img src="/static/images/2019/cms/fig22.png" alt="図22. CMSページのLighthouseアクセシビリティカテゴリスコアの分布。" aria-labelledby="cms-fig22-caption" aria-describedby="cms-fig22-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=764428981&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig22-description" data-show-text="{{ show_description(22) }}" data-hide-text="{{ hide_description(22) }}">{{ show_description(22) }}</button>
      <div id="cms-fig22-description" class="visually-hidden">CMSページのLighthouseアクセシビリティスコアの分布を示す棒グラフ。この分布は、約0.85のモードで、高いスコアに大きく傾いています。</div>
      <figcaption id="cms-fig22-caption"><a href="#cms-fig-22" class="anchor-link">図 22.</a> CMSページのLighthouseアクセシビリティカテゴリスコアの分布。</figcaption>
    </figure>
    <figure id="cms-fig-23">
      <a href="https://almanac.httparchive.org/static/images/2019/cms/fig23.png">
        <img src="/static/images/2019/cms/fig23.png" alt="図23. CMSごとのLighthouseアクセシビリティカテゴリスコアの中央値。" aria-labelledby="cms-fig23-caption" aria-describedby="cms-fig23-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vRlIvQce5DSZ4KnDyHErJhLJvnond89U_cNFewvtIhI2uV4Ff4og0e7X8bRFO28eBGKJ2uYlJyXLUBH/pubchart?oid=940747460&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig23-description" data-show-text="{{ show_description(23) }}" data-hide-text="{{ hide_description(23) }}">{{ show_description(23) }}</button>
      <div id="cms-fig23-description" class="visually-hidden">CMSごとのLighthouseアクセシビリティカテゴリスコアの中央値を示す棒グラフ。ほとんどのCMSのスコアは約0.75です。注目すべき例外としては、Wixのスコア中央値が0.93、1C-Bitrixのスコアが0.65のものがあります。</div>
      <figcaption id="cms-fig23-caption"><a href="#cms-fig-23" class="anchor-link">図 23.</a> CMSごとのLighthouseアクセシビリティカテゴリスコアの中央値。</figcaption>
    </figure>
    <p>現在、モバイルCMSのホームページで100％のパーフェクトスコアを獲得しているのは1.27％しかありません。上位のCMSの中では、Wixがモバイルページのアクセシビリティスコアの中央値が最も高く、トップに立っています。全体的に見て、これらの数字は、私たちの人口のかなりの部分がアクセスできないウェブサイトはどれだけ多いか（CMSによって駆動されているウェブのどれだけの部分か）を考えると悲惨なものとなります。デジタル体験が私たちの生活の多くの側面に影響を与えるのと同様に、この数字は私たちに <em>最初からアクセシブルなウェブ体験を構築すること</em> を奨励し、ウェブを包括的な空間にする作業を継続するための指令であるべきです。</p>
    <h2 id="cms-cmsイノベーション"><a href="#cms-cmsイノベーション" class="anchor-link">CMSイノベーション</a></h2>
    <p>ここまでCMSエコシステムの現状をスナップショットで紹介してきましたが、この分野は進化しています。<a href="#performance">パフォーマンス</a>とユーザー体験の欠点に対処するため、実験的なフレームワークがCMSインフラストラクチャに統合されているのを目の当たりにしています。React.jsやGatsby.js、Next.jsなどの派生フレームワーク、Vue.jsの派生フレームワークであるNuxt.jsなどのライブラリやフレームワークが少しずつ採用されてきています。</p>
    <figure id="cms-fig-24">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>CMS</th>
                <th>React</th>
                <th>Nuxt.js,<br />React</th>
                <th>Nuxt.js</th>
                <th>Next.js,<br />React</th>
                <th>Gatsby,<br />React</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>WordPress</td>
                <td class="numeric">131,507</td>
                <td class="numeric"></td>
                <td class="numeric">21</td>
                <td class="numeric">18</td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>Wix</td>
                <td class="numeric">50,247</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>Joomla</td>
                <td class="numeric">3,457</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>Drupal</td>
                <td class="numeric">2,940</td>
                <td class="numeric"></td>
                <td class="numeric">8</td>
                <td class="numeric">15</td>
                <td class="numeric">1</td>
              </tr>
              <tr>
                <td>DataLife Engine</td>
                <td class="numeric">1,137</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>Adobe Experience Manager</td>
                <td class="numeric">723</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric">7</td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>Contentful</td>
                <td class="numeric">492</td>
                <td class="numeric">7</td>
                <td class="numeric">114</td>
                <td class="numeric">909</td>
                <td class="numeric">394</td>
              </tr>
              <tr>
                <td>Squarespace</td>
                <td class="numeric">385</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>1C-Bitrix</td>
                <td class="numeric">340</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>TYPO3 CMS</td>
                <td class="numeric">265</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric">1</td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>Weebly</td>
                <td class="numeric">263</td>
                <td class="numeric"></td>
                <td class="numeric">1</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>Jimdo</td>
                <td class="numeric">248</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric">2</td>
              </tr>
              <tr>
                <td>PrestaShop</td>
                <td class="numeric">223</td>
                <td class="numeric"></td>
                <td class="numeric">1</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>SDL Tridion</td>
                <td class="numeric">152</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
              <tr>
                <td>Craft CMS</td>
                <td class="numeric">123</td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
                <td class="numeric"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cms-fig-24" class="anchor-link">図 24.</a> CMSごとのReactとコンパニオンフレームワークの採用率（モバイルサイト数）。</figcaption>
    </figure>
    <p>また、ホスティングプロバイダーや代理店が企業の顧客に焦点を当てた戦略のためのツールボックスとして、CMSやその他の統合技術を使用した総合的なソリューションとしてデジタルエクスペリエンスプラットフォーム（DXP）を提供しているのも見受けられます。これらのイノベーションは、ユーザー（とそのエンドユーザー）がこれらのプラットフォームのコンテンツを作成し、消費する際に最高のUXを得ることを可能にするターンキーのCMSベースのソリューションを作成するための努力を示しています。目的は、デフォルトでの優れたパフォーマンス、豊富な機能、優れたホスティング環境です。</p>
    <h2 id="cms-結論"><a href="#cms-結論" class="anchor-link">結論</a></h2>
    <p>CMS空間は最も重要な意味を持っています。これらのアプリケーションが力を発揮するウェブの大部分と様々なデバイスや接続でページを作成し、それに遭遇するユーザーの数は、些細なことであってはなりません。この章やこのWeb Almanacに掲載されている他の章が、この空間をより良いものにするためのより多くの研究と技術革新を促してくれることを願っています。深い調査を行うことで、これらのプラットフォームがウェブ全体に提供する強み、弱み、機会について、より良いコンテキストを提供できます。コンテンツ管理システムは、オープン・ウェブの完全性を維持するために影響を与えることができます。コンテンツ管理システムを前進させていきましょう！</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"IV","chapter_number":15,"title":"圧縮","description":"HTTP圧縮、アルゴリズム、コンテンツタイプ、ファーストパーティとサードパーティの圧縮および機会をカバーする2019 Web Almanacの圧縮の章。","authors":["paulcalvano"],"reviewers":["obto","yoavweiss"],"translators":["ksakae"],"discuss":"1770","results":"https://docs.google.com/spreadsheets/d/1IK9kaScQr_sJUwZnWMiJcmHEYJV292C9DwCfXH6a50o/","queries":"15_Compression","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-07-06T00:00:00.000Z","chapter":"compression"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="compression-序章"><a href="#compression-序章" class="anchor-link">序章</a></h2>
    <p>HTTP圧縮は、元の表現よりも少ないビットを使用して情報をエンコードできる技術です。 Webコンテンツの配信に使用すると、Webサーバーはクライアントに送信されるデータ量を削減できます。これにより、クライアントの利用可能な帯域幅の効率が向上し、<a href="#page-weight">ページの重さ</a>が軽減され、<a href="#performance">Webパフォーマンス</a>が向上します。</p>
    <p>圧縮アルゴリズムは、多くの場合、非可逆または可逆に分類されます。</p>
    <ul>
      <li>非可逆圧縮アルゴリズムが使用される場合、プロセスは不可逆的であり、元のファイルを圧縮解除しても復元できません。これは一般に、一部のデータを失ってもリソースに重大な影響を与えない画像やビデオコンテンツなどのメディアリソースを圧縮するために使用されます。</li>
      <li>ロスレス圧縮は完全に可逆的なプロセスであり、<a href="#markup">HTML</a>、<a href="#javascript">JavaScript</a>、<a href="#css">CSS</a>などのテキストベースのリソースを圧縮するために一般的に使用されます。</li>
    </ul>
    <p>この章では、テキストベースのコンテンツがWeb上でどのように圧縮されるかを検討します。非テキストベースのコンテンツの分析は、<a href="#media">メディア</a>の章の一部を形成します。</p>
    <h2 id="compression-http圧縮の仕組み"><a href="#compression-http圧縮の仕組み" class="anchor-link">HTTP圧縮の仕組み</a></h2>
    <p>
      クライアントがHTTPリクエストを作成する場合、多くの場合、デコード可能な圧縮アルゴリズムを示す<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding"><code>Accept-Encoding</code><span class="fn">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding</span></a
      >ヘッダーが含まれます。サーバーは、示されたエンコードのいずれかを選択してサポートし、圧縮されたレスポンスを提供できます。圧縮されたレスポンスには<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Encoding"><code>Content-Encoding</code><span class="fn">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Encoding</span></a
      >ヘッダーが含まれるため、クライアントはどの圧縮が使用されたかを認識できます。また、提供されるリソースの<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types">MIME<span class="fn">https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types</span></a
      >タイプを示すために、<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code><span class="fn">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type</span></a
      >ヘッダーがよく使用されます。
    </p>
    <p>以下の例では、クライアントはgzip、brotli、およびdeflate圧縮のサポートを示してます。サーバーは、<code>text/html</code>ドキュメントを含むgzip圧縮された応答を返すことにしました。</p>
    <pre><code>    &gt; GET / HTTP/1.1
    &gt; Host: httparchive.org
    &gt; Accept-Encoding: gzip, deflate, br

    &lt; HTTP/1.1 200  
    &lt; Content-type: text/html; charset=utf-8
    &lt; Content-encoding: gzip</code></pre>
    <p>HTTP Archiveには、530万のWebサイトの測定値が含まれており、各サイトには少なくとも1つの圧縮テキストリソースがホームページにロードされています。さらに、リソースはWebサイトの81％のプライマリドメインで圧縮されました。</p>
    <h2 id="compression-圧縮アルゴリズム"><a href="#compression-圧縮アルゴリズム" class="anchor-link">圧縮アルゴリズム</a></h2>
    <p>
      IANAは、<code>Accept-Encoding</code>および<code>Content-Encoding</code>ヘッダーで使用できる有効な<a href="https://www.iana.org/assignments/http-parameters/http-parameters.xml#content-coding">HTTPコンテンツエンコーディングのリスト<span class="fn">https://www.iana.org/assignments/http-parameters/http-parameters.xml#content-coding</span></a
      >を保持しています。これらには、gzip、deflate、br（brotli）などが含まれます。これらのアルゴリズムの簡単な説明を以下に示します。
    </p>
    <ul>
      <li>
        <a href="https://tools.ietf.org/html/rfc1952">Gzip<span class="fn">https://tools.ietf.org/html/rfc1952</span></a
        >は、<a href="https://ja.wikipedia.org/wiki/LZ77">LZ77<span class="fn">https://ja.wikipedia.org/wiki/LZ77</span></a
        >および<a href="https://ja.wikipedia.org/wiki/%E3%83%8F%E3%83%95%E3%83%9E%E3%83%B3%E7%AC%A6%E5%8F%B7">ハフマンコーディング<span class="fn">https://ja.wikipedia.org/wiki/%E3%83%8F%E3%83%95%E3%83%9E%E3%83%B3%E7%AC%A6%E5%8F%B7</span></a
        >圧縮技術を使用しており、Web自体よりも古い。もともと1992年にUNIX gzipプログラム用として開発されました。HTTP/ 1.1以降、Web配信の実装が存在し、ほとんどのブラウザーとクライアントがそれをサポートしています。
      </li>
      <li>
        <a href="https://tools.ietf.org/html/rfc1951">Deflate<span class="fn">https://tools.ietf.org/html/rfc1951</span></a
        >はgzipと同じアルゴリズムを使用しますが、コンテナは異なります。一部のサーバーおよびブラウザとの互換性の問題のため、Webでの使用は広く採用されていません。
      </li>
      <li>
        <a href="https://tools.ietf.org/html/rfc7932">Brotli<span class="fn">https://tools.ietf.org/html/rfc7932</span></a
        >は、<a href="https://github.com/google/brotli">Googleが発明<span class="fn">https://github.com/google/brotli</span></a
        >した新しい圧縮アルゴリズムです。 LZ77アルゴリズムの最新のバリアント、ハフマンコーディング、および2次コンテキストモデリングの組み合わせを使用します。 Brotliを介した圧縮はgzipと比較して計算コストが高くなりますが、アルゴリズムはgzip圧縮よりもファイルを<a href="https://cran.r-project.org/web/packages/brotli/vignettes/brotli-2015-09-22.pdf">15〜25％<span class="fn">https://cran.r-project.org/web/packages/brotli/vignettes/brotli-2015-09-22.pdf</span></a
        >削減できます。 Brotliは2015年にWebコンテンツの圧縮に初めて使用され、<a href="https://caniuse.com/#feat=brotli">すべての最新のWebブラウザーでサポートされています<span class="fn">https://caniuse.com/#feat=brotli</span></a
        >。
      </li>
    </ul>
    <p>HTTPレスポンスの約38％はテキストベースの圧縮で配信されます。これは驚くべき統計のように思えるかもしれませんが、データセット内のすべてのHTTP要求に基づいていることに留意してください。画像などの一部のコンテンツは、これらの圧縮アルゴリズムの恩恵を受けません。次の表は、各コンテンツエンコーディングで処理されるリクエストの割合をまとめたものです。</p>
    <figure id="compression-fig-1">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="colgroup" colspan="2">リクエストの割合</th>
                <th scope="colgroup" colspan="2">リクエスト</th>
              </tr>
              <tr>
                <th scope="col">コンテンツエンコーディング</th>
                <th scope="col">デスクトップ</th>
                <th scope="col">モバイル</th>
                <th scope="col">デスクトップ</th>
                <th scope="col">モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><em>テキスト圧縮なし</em></td>
                <td class="numeric">62.87%</td>
                <td class="numeric">61.47%</td>
                <td class="numeric">260,245,106</td>
                <td class="numeric">285,158,644</td>
              </tr>
              <tr>
                <td>gzip</td>
                <td class="numeric">29.66%</td>
                <td class="numeric">30.95%</td>
                <td class="numeric">122,789,094</td>
                <td class="numeric">143,549,122</td>
              </tr>
              <tr>
                <td>br</td>
                <td class="numeric">7.43%</td>
                <td class="numeric">7.55%</td>
                <td class="numeric">30,750,681</td>
                <td class="numeric">35,012,368</td>
              </tr>
              <tr>
                <td>deflate</td>
                <td class="numeric">0.02%</td>
                <td class="numeric">0.02%</td>
                <td class="numeric">68,802</td>
                <td class="numeric">70,679</td>
              </tr>
              <tr>
                <td><em>Other / Invalid</em></td>
                <td class="numeric">0.02%</td>
                <td class="numeric">0.01%</td>
                <td class="numeric">67,527</td>
                <td class="numeric">68,352</td>
              </tr>
              <tr>
                <td>identity</td>
                <td class="numeric">0.000709%</td>
                <td class="numeric">0.000563%</td>
                <td class="numeric">2,935</td>
                <td class="numeric">2,611</td>
              </tr>
              <tr>
                <td>x-gzip</td>
                <td class="numeric">0.000193%</td>
                <td class="numeric">0.000179%</td>
                <td class="numeric">800</td>
                <td class="numeric">829</td>
              </tr>
              <tr>
                <td>compress</td>
                <td class="numeric">0.000008%</td>
                <td class="numeric">0.000007%</td>
                <td class="numeric">33</td>
                <td class="numeric">32</td>
              </tr>
              <tr>
                <td>x-compress</td>
                <td class="numeric">0.000002%</td>
                <td class="numeric">0.000006%</td>
                <td class="numeric">8</td>
                <td class="numeric">29</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#compression-fig-1" class="anchor-link">図 1.</a>圧縮アルゴリズムの採用。</figcaption>
    </figure>
    <p>圧縮されて提供されるリソースの大半は、gzip（80％）またはbrotli（20％）のいずれかを使用しています。他の圧縮アルゴリズムはあまり使用されません。</p>
    <figure id="compression-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig2.png">
        <img src="/static/images/2019/compression/fig2.png" alt="図2.デスクトップページでの圧縮アルゴリズムの採用。" aria-labelledby="compression-fig2-caption" aria-describedby="compression-fig2-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=2052550005&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="compression-fig2-description" class="visually-hidden">図1のデータテーブルの円グラフ。</div>
      <figcaption id="compression-fig2-caption"><a href="#compression-fig-2" class="anchor-link">図 2.</a>デスクトップページでの圧縮アルゴリズムの採用。</figcaption>
    </figure>
    <p>さらに「none」「UTF-8」「base64」「text」など、無効な<code>Content-Encoding</code>を返す67Kのリクエストがあります。これらのリソースは圧縮されていない状態で提供される可能性があります。</p>
    <p>HTTP Archiveによって収集された診断から圧縮レベルを判断することはできませんが、コンテンツを圧縮するためのベストプラクティスは次のとおりです。</p>
    <ul>
      <li>
        少なくとも、テキストベースのアセットに対してgzip圧縮レベル6を有効にします。これは、計算コストと圧縮率の間の公平なトレードオフを提供し、<a href="https://paulcalvano.com/index.php/2018/07/25/brotli-compression-how-much-will-it-reduce-your-content/">多くのWebサーバーのデフォルト<span class="fn">https://paulcalvano.com/index.php/2018/07/25/brotli-compression-how-much-will-it-reduce-your-content/</span></a
        >にもかかわらず、<a href="http://nginx.org/en/docs/http/ngx_http_gzip_module.html#gzip_comp_level">Nginxは依然として低すぎることが多いレベル1のままです<span class="fn">http://nginx.org/en/docs/http/ngx_http_gzip_module.html#gzip_comp_level</span></a
        >。
      </li>
      <li>brotliおよびprecompressリソースをサポートできる場合は、brotliレベル11に圧縮します。これはgzipよりも計算コストが高くなります。したがって、遅延を避けるためには、事前圧縮が絶対に必要です。</li>
      <li>brotliをサポートでき、事前圧縮できない場合は、brotliレベル5に圧縮します。このレベルでは、gzipと比較してペイロードが小さくなり、同様の計算オーバーヘッドが発生します。</li>
    </ul>
    <h2 id="compression-どの種類のコンテンツを圧縮していますか？"><a href="#compression-どの種類のコンテンツを圧縮していますか？" class="anchor-link">どの種類のコンテンツを圧縮していますか？</a></h2>
    <p>ほとんどのテキストベースのリソース（HTML、CSS、JavaScriptなど）は、gzipまたはbrotli圧縮の恩恵を受けることができます。ただし、多くの場合、これらの圧縮技術をバイナリリソースで使用する必要はありません。画像、ビデオ、一部のWebフォントなどが既に圧縮されているため。</p>
    <p>次のグラフでは、上位25のコンテンツタイプが、リクエストの相対数を表すボックスサイズで表示されています。各ボックスの色は、これらのリソースのうちどれだけ圧縮されて提供されたかを表します。ほとんどのメディアコンテンツはオレンジ色で網掛けされていますが、これはgzipとbrotliにはほとんどまたはまったく利点がないためです。テキストコンテンツのほとんどは、それらが圧縮されていることを示すために青色で網掛けされています。ただし、一部のコンテンツタイプの水色の網掛けは、他のコンテンツタイプほど一貫して圧縮されていないことを示しています。</p>
    <figure id="compression-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig3.png">
        <img src="/static/images/2019/compression/fig3.png" alt="図3.上位25の圧縮コンテンツタイプ。" aria-labelledby="compression-fig3-caption" aria-describedby="compression-fig3-description" width="780" height="482" data-width="780" data-height="482" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=1790056981&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="compression-fig3-description" class="visually-hidden">image/jpeg（167,912,373リクエスト-3.23％圧縮）、application/javascript（121,058,259リクエスト-81.29％圧縮）、image/png（113,530,400リクエスト-3.81％圧縮）、text/css（86,634,570リクエスト-81.81％圧縮）を示すツリーマップグラフ、text/html（81,975,252リクエスト-43.44％圧縮）、image/gif（70,838,761リクエスト-3.87％圧縮）、text/javascript（60,645,767リクエスト-89.52％圧縮）、application/x-javascript（38,816,387リクエスト-91.02％圧縮） 、font/woff2（22,622,918リクエスト-3.87％圧縮）、application/json（16,501,326リクエスト-59.02％圧縮）、image/webp（12,911,688リクエスト-1.66％圧縮）、image/svg + xml（9,862,643リクエスト-64.42％圧縮） 、text/plain（6,622,361リクエスト-24.72％圧縮）、application/octet-stream（3,884,287リクエスト-6.01％圧縮）、image/x-icon（3,737,030リクエスト-37.60％圧縮）、application/font-woff2（3,061,857リクエスト- 5.90％圧縮）、application/font-woff（2,117,999リクエスト-23.61％圧縮） d）、image/vnd.microsoft.icon（1,774,995リクエスト-15.55％圧縮）、video/mp4（1,472,880リクエスト-0.03％圧縮）、font/woff（1,255,093リクエスト-24.33％圧縮）、font/ttf（1,062,747リクエスト- 84.27％圧縮）、application/x-font-woff（1,048,398リクエスト-30.77％圧縮）、image/jpg（951,610リクエスト-6.66％圧縮）、application/ocsp-response（883,603リクエスト-0.00％圧縮）。</div>
      <figcaption id="compression-fig3-caption"><a href="#compression-fig-3" class="anchor-link">図 3.</a>上位25の圧縮コンテンツタイプ。</figcaption>
    </figure>
    <p>最も人気のある8つのコンテンツタイプを除外すると、これらのコンテンツタイプの残りの圧縮統計をより明確に確認できます。</p>
    <figure id="compression-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig4.png">
        <img src="/static/images/2019/compression/fig4.png" alt="図4.トップ8を除く圧縮コンテンツタイプ" aria-labelledby="compression-fig4-caption" aria-describedby="compression-fig4-description" width="780" height="482" data-width="780" data-height="482" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=495358423&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="compression-fig4-description" class="visually-hidden">font/woff2（22,622,918リクエスト-3.87％圧縮）、application/json（16,501,326リクエスト-59.02％圧縮）、image/webp（12,911,688リクエスト-1.66％圧縮）、image/svg + xml（9,862,643リクエスト-64.42％）を示すツリーマップグラフ圧縮）、text/plain（6,622,361リクエスト-24.72％圧縮）、application/octet-stream（3,884,287リクエスト-6.01％圧縮）、image/x-icon（3,737,030リクエスト-37.60％圧縮）、application/font-woff2（3,061,857リクエスト-5.90％圧縮）、application/font-woff（2,117,999リクエスト-23.61％圧縮）、image/vnd.microsoft.icon（1,774,995リクエスト-15.55％圧縮）、video/mp4（1,472,880リクエスト-0.03％圧縮）、フォント/ woff（1,255,093リクエスト-24.33％圧縮）、font/ttf（1,062,747リクエスト-84.27％圧縮）、application/x-font-woff（1,048,398リクエスト-30.77％圧縮）、image/jpg（951,610リクエスト-6.66％圧縮） 、application/ocsp-response（883,603リクエスト-0.00％圧縮）</div>
      <figcaption id="compression-fig4-caption"><a href="#compression-fig-4" class="anchor-link">図 4.</a>トップ8を除く圧縮コンテンツタイプ</figcaption>
    </figure>
    <p><code>application/json</code>および<code>image/svg+xml</code>コンテンツタイプは、65％未満の時間で圧縮されます。</p>
    <p>カスタムWebフォントのほとんどは、すでに圧縮形式になっているため、圧縮せずに提供されます。ただし、<code>font/ttf</code>は圧縮可能ですが、TTFフォント要求の84％のみが圧縮で提供されているため、ここにはまだ改善の余地があります。</p>
    <p>以下のグラフは、各コンテンツタイプに使用される圧縮技術の内訳を示しています。上位3つのコンテンツタイプを見ると、デスクトップとモバイルの両方で、最も頻繁に要求されるコンテンツタイプの圧縮に大きなギャップがあります。 <code>text/html</code>の56％と<code>application/javascript</code>および<code>text/css</code>リソースの18％は圧縮されていません。これにより、パフォーマンスが大幅に向上します。</p>
    <figure id="compression-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig5.png">
        <img src="/static/images/2019/compression/fig5.png" alt="図5.デスクトップのコンテンツタイプによる圧縮。" aria-labelledby="compression-fig5-caption" aria-describedby="compression-fig5-description" width="760" height="470" data-width="760" data-height="470" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=148811764&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="compression-fig5-description" class="visually-hidden">application/javascriptを示す積み上げ棒グラフは、圧縮タイプ（Gzip/Brotli/None）別で3618万/897万/1047万、text/cssは24.29M/8.31M/7.20M、text/htmlは11.37M/4.89M/20.57Mです。text/javascriptは23.21M/1.72M/3.03M、application/x-javascriptは11.86M/4.97M/1.66M、application/jsonは4.06M/0.50M/3.23M、image/svg+xmlは2.54M/0.46M/1.74M、text/plainは0.71M/0.06M/2.42M、image/x-iconは0.58M/0.10M/1.11Mです。Deflateはいつでもほとんど使用されず、登録されません。チャート上。。</div>
      <figcaption id="compression-fig5-caption"><a href="#compression-fig-5" class="anchor-link">図 5.</a>デスクトップのコンテンツタイプによる圧縮。</figcaption>
    </figure>
    <figure id="compression-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig6.png">
        <img src="/static/images/2019/compression/fig6.png" alt="図6.モバイルのコンテンツタイプによる圧縮。" aria-labelledby="compression-fig6-caption" aria-describedby="compression-fig6-description" width="760" height="470" data-width="760" data-height="470" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=2009060762&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="compression-fig6-description" class="visually-hidden">application/javascriptを示す積み上げ棒グラフは、圧縮タイプ（Gzip/Brotli/None）で4307万/1017万/1219万、text/cssは28.3M/9.91M/8.56M、text/htmlは13.86M/5.48M/25.79Mです。text/javascriptは27.41M/1.94M/3.33M、application/x-javascriptは12.77M/5.70M/1.82M、application/jsonは4.67M/0.50M/3.53M、image/svg + xmlは2.91M/0.44M/1.77M、text/plainは0.80M/0.06M/1.77M、image/x-iconは0.62M/0.11M/1.22Mです。デフレートはいつでもほとんど使用されず、チャートに登録されません。</div>
      <figcaption id="compression-fig6-caption"><a href="#compression-fig-6" class="anchor-link">図 6.</a>モバイルのコンテンツタイプによる圧縮。</figcaption>
    </figure>
    <p>圧縮率が最も低いコンテンツタイプには、<code>application/json</code>、<code>text/xml</code>、および<code>text/plain</code>が含まれます。これらのリソースは通常、XHRリクエストに使用され、Webアプリケーションが豊かな体験を創造するために使用できるデータを提供します。それらを圧縮すると、ユーザー体験は向上する可能性があります。 <code>image/svg+xml</code>や<code>image/x-icon</code>などのベクターグラフィックスは、テキストベースと見なされることはあまりありませんが、これらを使用するサイトは圧縮の恩恵を受けるでしょう。</p>
    <figure id="compression-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig7.png">
        <img src="/static/images/2019/compression/fig7.png" alt="図7.コンテンツタイプによる圧縮のデスクトップ割合。" aria-labelledby="compression-fig7-caption" aria-describedby="compression-fig7-description" width="760" height="470" data-width="760" data-height="470" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=1923565332&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="compression-fig7-description" class="visually-hidden">圧縮タイプ（Gzip/Brotli/None）別にapplication/javascriptが65.1％/16.1％/18.8％、text/cssが61.0％/20.9％/18.1％、text/htmlが30.9％/13.3％/55.8％を示す積み上げ棒グラフ、text/javascriptは83.0％/6.1％/10.8％、application/x-javascriptは64.1％/26.9％/9.0％、application/jsonは52.1％/6.4％/41.4％、image/svg+xmlは53.5％/9.8％/36.7％、text/plainは22.2％/2.0％/75.8％、image/x-iconは32.6％/5.3％/62.1％です。デフレートはいつでもほとんど使用されず、チャートに登録されません。</div>
      <figcaption id="compression-fig7-caption"><a href="#compression-fig-7" class="anchor-link">図 7.</a>コンテンツタイプによる圧縮のデスクトップ割合。</figcaption>
    </figure>
    <figure id="compression-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig8.png">
        <img src="/static/images/2019/compression/fig8.png" alt="図8.コンテンツタイプによる圧縮のモバイル割合。" aria-labelledby="compression-fig6-caption" aria-describedby="compression-fig6-description" width="760" height="470" data-width="760" data-height="470" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=673629979&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="compression-fig8-description" class="visually-hidden">圧縮タイプ（Gzip/Brotli/None）別にapplication/javascriptが65.8％/15.5％/18.6％である積み上げ棒グラフ、text/cssは60.5％/21.2％/18.3％、text/htmlは30.7％/12.1％/57.1％、text/javascriptは83.9％/5.9％/10.2％、application/x-javascriptは62.9％/28.1％/9.0％、application/jsonは53.6％/8.6％/34.6％、image/svg+xmlは23.4％/1.8％/74.8％、text/plainは23.4％/1.8％/74.8％、image/x-iconは31.8％/5.5％/62.7％です。デフレートはいつでもほとんど使用されず、チャートに登録されません。</div>
      <figcaption id="compression-fig8-caption"><a href="#compression-fig-8" class="anchor-link">図 8.</a>コンテンツタイプによる圧縮のモバイル割合。</figcaption>
    </figure>
    <p>すべてのコンテンツタイプで、gzipは最も一般的な圧縮アルゴリズムです。新しいbrotli圧縮はあまり頻繁に使用されず、最も多く表示されるコンテンツタイプは<code>application/javascript</code>、<code>text/css</code>、<code>application/x-javascript</code>です。これは、CDNが通過するトラフィックにbrotli圧縮を自動的に適用することの原因である可能性があります。</p>
    <h2 id="compression-ファーストパーティとサードパーティの圧縮"><a href="#compression-ファーストパーティとサードパーティの圧縮" class="anchor-link">ファーストパーティとサードパーティの圧縮</a></h2>
    <p><a href="#third-parties">サードパーティ</a>の章では、サードパーティとパフォーマンスへの影響について学びました。ファーストパーティとサードパーティの圧縮技術を比較すると、サードパーティのコンテンツはファーストパーティのコンテンツよりも圧縮される傾向であることがわかります。</p>
    <p>さらに、サードパーティのコンテンツの場合、brotli圧縮の割合が高くなります。これは、GoogleやFacebookなど、通常brotliをサポートする大規模なサードパーティから提供されるリソースの数が原因である可能性と考えられます。</p>
    <figure id="compression-fig-9">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="colgroup" colspan="2">デスクトップ</th>
                <th scope="colgroup" colspan="2">モバイル</th>
              </tr>
              <tr>
                <th scope="col">コンテンツエンコーディング</th>
                <th scope="col">ファーストパーティ</th>
                <th scope="col">サードパーティ</th>
                <th scope="col">ファーストパーティ</th>
                <th scope="col">サードパーティ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><em>テキスト圧縮なし</em></td>
                <td class="numeric">66.23%</td>
                <td class="numeric">59.28%</td>
                <td class="numeric">64.54%</td>
                <td class="numeric">58.26%</td>
              </tr>
              <tr>
                <td>gzip</td>
                <td class="numeric">29.33%</td>
                <td class="numeric">30.20%</td>
                <td class="numeric">30.87%</td>
                <td class="numeric">31.22%</td>
              </tr>
              <tr>
                <td>br</td>
                <td class="numeric">4.41%</td>
                <td class="numeric">10.49%</td>
                <td class="numeric">4.56%</td>
                <td class="numeric">10.49%</td>
              </tr>
              <tr>
                <td>deflate</td>
                <td class="numeric">0.02%</td>
                <td class="numeric">0.01%</td>
                <td class="numeric">0.02%</td>
                <td class="numeric">0.01%</td>
              </tr>
              <tr>
                <td><em>Other / Invalid</em></td>
                <td class="numeric">0.01%</td>
                <td class="numeric">0.02%</td>
                <td class="numeric">0.01%</td>
                <td class="numeric">0.02%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#compression-fig-9" class="anchor-link">図 9.</a>デバイスタイプ別のファーストパーティとサードパーティの圧縮。</figcaption>
    </figure>
    <h2 id="compression-圧縮の機会を見分ける"><a href="#compression-圧縮の機会を見分ける" class="anchor-link">圧縮の機会を見分ける</a></h2>
    <p>
      Googleの<a href="https://developers.google.com/web/tools/lighthouse">Lighthouse<span class="fn">https://developers.google.com/web/tools/lighthouse</span></a
      >ツールを使用すると、ユーザーはWebページに対して一連の監査を実行できます。<a href="https://developers.google.com/web/tools/lighthouse/audits/text-compression">テキスト圧縮監査<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/text-compression</span></a
      >は、サイトが追加のテキストベースの圧縮の恩恵を受けることができるかどうかを評価します。これは、リソースを圧縮し、オブジェクトのサイズを少なくとも10％と1,400バイト削減できるかどうかを評価することでこれを行います。スコアに応じて、圧縮可能な特定のリソースのリストとともに、結果に圧縮の推奨事項を表示する場合があります。
    </p>
    <figure id="compression-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/ch15_fig8_lighthouse.jpg">
        <img src="/static/images/2019/compression/ch15_fig8_lighthouse.jpg" alt="図10.Lighthouse圧縮の提案" aria-labelledby="compression-fig10-caption" aria-describedby="compression-fig10-description" width="600" height="303" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="compression-fig10-description" class="visually-hidden">リソースのリスト（名前は編集済み）およびサイズと節約の可能性を示すLighthouseレポートのスクリーンショット。最初の項目では、91KBから73KBに大幅に節約できる可能性がありますが、6KB以下の他の小さなファイルでは、4KBから1KBの小さい節約になります。</div>
      <figcaption id="compression-fig10-caption"><a href="#compression-fig-10" class="anchor-link">図 10.</a>Lighthouse圧縮の提案</figcaption>
    </figure>
    <p>各モバイルページに対して<a href="#methodology-lighthouse">HTTP ArchiveはLighthouse監査を実行する</a>ため、すべてのサイトのスコアを集計して、より多くのコンテンツを圧縮する機会があるかどうかを知ることができます。全体として、ウェブサイトの62％がこの監査に合格しており、ウェブサイトのほぼ23％が40を下回っています。これは、120万を超えるウェブサイトが追加のテキストベースの圧縮を有効にすることを意味します。</p>
    <figure id="compression-fig-11">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig11.png">
        <img src="/static/images/2019/compression/fig11.png" alt="図11. Lighthouseの「テキスト圧縮を有効にする」監査スコア。" aria-labelledby="compression-fig11-caption" aria-describedby="compression-fig11-description" width="760" height="331" data-width="760" data-height="331" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=2048155673&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig11-description" data-show-text="{{ show_description(11) }}" data-hide-text="{{ hide_description(11) }}">{{ show_description(11) }}</button>
      <div id="compression-fig11-description" class="visually-hidden">7.6％の圧縮が10％未満であり、13.2％のサイトが10-39％のスコア、13.7％のサイトが40-79％のスコア、2.9％のサイトが80-99％のスコア、62.5％のスコアを示す積み上げ棒グラフのサイトにはパスがあり、100％を超えるテキストアセットが圧縮されています。</div>
      <figcaption id="compression-fig11-caption"><a href="#compression-fig-11" class="anchor-link">図 11.</a> Lighthouseの「テキスト圧縮を有効にする」監査スコア。</figcaption>
    </figure>
    <p>Lighthouseは、テキストベースの圧縮を有効にすることで、保存できるバイト数も示します。テキスト圧縮の恩恵を受ける可能性のあるサイトのうち、82％がページの重さを最大1MB削減できます！</p>
    <figure id="compression-fig-12">
      <a href="https://almanac.httparchive.org/static/images/2019/compression/fig12.png">
        <img src="/static/images/2019/compression/fig12.png" alt="図12.潜在的なバイト削減を監査するLighthouseの「テキスト圧縮を有効にする」" aria-labelledby="compression-fig12-caption" aria-describedby="compression-fig12-description" width="760" height="331" data-width="760" data-height="331" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQNIyMEGYE_1W0OdFYLIKsxg6M3o_ZsTTuaX73Zzv6Alw4x4D6oH0jdg9BSgw-jy4E-MmX_Qaf-B98W/pubchart?oid=738657382&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="compression-fig12-description" class="visually-hidden">82.11％のサイトが1Mb未満、15.88％のサイトが1〜2Mbを、2％のサイトが3MB以上を節約できることを示す積み上げ棒グラフ。</div>
      <figcaption id="compression-fig12-caption"><a href="#compression-fig-12" class="anchor-link">図 12.</a>潜在的なバイト削減を監査するLighthouseの「テキスト圧縮を有効にする」</figcaption>
    </figure>
    <h2 id="compression-結論"><a href="#compression-結論" class="anchor-link">結論</a></h2>
    <p>HTTP圧縮は、Webコンテンツのサイズを削減するために広く使用されている非常に貴重な機能です。 gzipとbrotliの両方の圧縮が使用される主要なアルゴリズムであり、圧縮されたコンテンツの量はコンテンツの種類によって異なります。 Lighthouseなどのツールは、コンテンツを圧縮する機会を発見するのに役立ちます。</p>
    <p>多くのサイトがHTTP圧縮をうまく利用していますが、特にWebが構築されている<code>text/html</code>形式については、まだ改善の余地があります！　同様に、<code>font/ttf</code>、<code>application/json</code>、<code>text/xml</code>、<code>text/plain</code>、<code>image/svg+xml</code>、<code>image/x-icon</code>のようなあまり理解されていないテキスト形式は、多くのWebサイトで見落とされる余分な構成を取る場合があります。</p>
    <p>Webサイトは広くサポートされており、簡単に実装で処理のオーバーヘッドが低いため、少なくともすべてのテキストベースのリソースにgzip圧縮を使用する必要があります。 brotli圧縮を使用するとさらに節約できますが、リソースを事前に圧縮できるかどうかに基づいて圧縮レベルを慎重に選択する必要があります。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"IV","chapter_number":16,"title":"キャッシング","description":"2019 Web Almanacのキャッシュの章は、キャッシュコントロール、有効期限、TTL、有効性、変化、Cookieの設定、アプリケーションキャッシュ、Service Worker、および機会について説明します。","authors":["paulcalvano"],"reviewers":["obto","bkardell"],"translators":["ksakae"],"discuss":"1771","results":"https://docs.google.com/spreadsheets/d/1mnq03DqrRBwxfDV05uEFETK0_hPbYOynWxZkV3tFgNk/","queries":"16_Caching","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-07-06T00:00:00.000Z","chapter":"caching"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="caching-導入"><a href="#caching-導入" class="anchor-link">導入</a></h2>
    <p>キャッシングは、以前にダウンロードしたコンテンツの再利用を可能にする手法です。コストのかかるネットワークリクエストを回避することにより、<a href="#performance">パフォーマンス</a>が大幅に向上します。また、Webサイトのオリジンインフラストラクチャへのトラフィックを削減することで、アプリケーションの拡張にも役立ちます。「最速のリクエストはあなたがする必要のないものです」という古い格言があり、キャッシュはリクエストを行わなくて済むようにするための重要な方法の1つです。</p>
    <p>Webコンテンツのキャッシュには、3つの基本原則があります。可能な限りキャッシュする、できる限りキャッシュする、エンドユーザーのできるだけ近くでキャッシュする。</p>
    <p><strong>可能な限りキャッシュする。</strong> キャッシュできる量を検討する場合、レスポンスが静的か動的かを理解することが重要です。静的なレスポンスとして提供される要求は、リソースとそれを要求するユーザーとの間に1対多の関係があるため、通常はキャッシュ可能です。動的に生成されたコンテンツはより微妙である可能性があり、慎重に検討する必要があります。</p>
    <p><strong>できるだけ長くキャッシュする。</strong>リソースをキャッシュする時間の長さは、キャッシュされるコンテンツの機密性に大きく依存します。バージョン管理されたJavaScriptリソースは非常に長い時間キャッシュされる可能性がありますが、バージョン管理されていないリソースはユーザーが最新バージョンを取得できるように、より短いキャッシュ期間を必要とする場合があります。</p>
    <p><strong>エンドユーザーのできるだけ近くでキャッシュする。</strong>エンドユーザーの近くでコンテンツをキャッシュすると、待ち時間がなくなり、ダウンロード時間が短縮されます。たとえば、リソースがエンドユーザーのブラウザにキャッシュされている場合、リクエストはネットワークに送信されず、ダウンロード時間はマシンのI/Oと同じくらい高速です。初めての訪問者、またはキャッシュにエントリがない訪問者の場合、通常、キャッシュされたリソースが返される場所はCDNになります。ほとんどの場合、オリジンサーバーと比較して、ローカルキャッシュかCDNからリソースをフェッチする方が高速です。</p>
    <p>
      通常、Webアーキテクチャには<a href="https://blog.yoav.ws/tale-of-four-caches/">複数のキャッシュ層<span class="fn">https://blog.yoav.ws/tale-of-four-caches/</span></a
      >が含まれます。たとえば、HTTPリクエストは次の場所にキャッシュされる可能性があります。
    </p>
    <ul>
      <li>エンドユーザーのブラウザ</li>
      <li>ユーザーのブラウザーのService Workerキャッシュ</li>
      <li>共有ゲートウェイ</li>
      <li>エンドユーザーに近い側でキャッシュする機能を提供するCDN</li>
      <li>バックエンドの仕事長を削減するための、アプリケーションの前のキャッシングプロキシ</li>
      <li>アプリケーション層とデータベース層</li>
    </ul>
    <p>この章では、Webブラウザー内でリソースがキャッシュされる方法について見ていきましょう。</p>
    <h2 id="caching-httpキャッシングの概要"><a href="#caching-httpキャッシングの概要" class="anchor-link">HTTPキャッシングの概要</a></h2>
    <p>HTTPクライアントがリソースをキャッシュするには、2つの情報を理解する必要があります。</p>
    <ul>
      <li>「これをキャッシュできる期間はどれくらいですか？」</li>
      <li>「コンテンツがまだ新しいことを検証するにはどうすればよいですか？」</li>
    </ul>
    <p>
      Webブラウザーがクライアントにレスポンスを送信するとき、通常リソースにキャッシュ可能か、キャッシュする期間、リソースの古さを示すヘッダーが含まれます。 RFC 7234は、これをセクション<a href="https://tools.ietf.org/html/rfc7234#section-4.2">4.2（新しさ）<span class="fn">https://tools.ietf.org/html/rfc7234#section-4.2</span></a
      >および<a href="https://tools.ietf.org/html/rfc7234#section-4.3">4.3（検証）<span class="fn">https://tools.ietf.org/html/rfc7234#section-4.3</span></a
      >でより詳細にカバーしています。
    </p>
    <p>通常、有効期間を伝えるために使用されるHTTPレスポンスヘッダーは次のとおりです。</p>
    <ul>
      <li><code>Cache-Control</code> キャッシュの生存期間（つまり、有効期間）を設定できます。</li>
      <li><code>Expires</code> 有効期限の日付または時刻を提供します（つまり、期限切れになるとき）。</li>
    </ul>
    <p><code>Cache-Control</code> 両方が存在する場合に優先されます。これらについては、<a href="#caching-cache-controlとexpires">以下で詳しく説明します</a>。</p>
    <p>キャッシュ内に保存された応答を検証するためのHTTPレスポンスヘッダー、つまりサーバー側で比較するため、条件付き要求を提供するHTTPレスポンスヘッダーは次のとおりです。</p>
    <ul>
      <li><code>Last-Modified</code> オブジェクトが最後に変更された日時を示します。</li>
      <li>エンティティタグ (<code>ETag</code>) コンテンツの一意の識別子を提供します。</li>
    </ul>
    <p><code>ETag</code> 両方が存在する場合に優先されます。これらについては、以下で詳しく説明します。</p>
    <p>以下の例には、HTTP Archiveのmain.jsファイルからのリクエスト/レスポンスヘッダーの抜粋が含まれています。これらのヘッダーは、リソースを43,200秒（12時間）キャッシュでき、最後は2か月以上前に変更されたことを示します（<code>Last-Modified</code>ヘッダーと<code>Date</code>ヘッダーの違い）。</p>
    <pre><code>&gt; GET /static/js/main.js HTTP/1.1
&gt; Host: httparchive.org
&gt; User-agent: curl/7.54.0
&gt; Accept: */*

&lt; HTTP/1.1 200
&lt; Date: Sun, 13 Oct 2019 19:36:57 GMT
&lt; Content-Type: application/javascript; charset=utf-8
&lt; Content-Length: 3052
&lt; Vary: Accept-Encoding
&lt; Server: gunicorn/19.7.1
&lt; Last-Modified: Sun, 25 Aug 2019 16:00:30 GMT
&lt; Cache-Control: public, max-age=43200
&lt; Expires: Mon, 14 Oct 2019 07:36:57 GMT
&lt; ETag: "1566748830.0-3052-3932359948"</code></pre>
    <p>
      <a href="https://redbot.org/">RedBot.org<span class="fn">https://redbot.org/</span></a
      >というツールにURLを入力すると、レスポンスのヘッダーを元としたキャッシュ方法の詳細な説明が表示できます。たとえば、<a href="https://redbot.org/?uri=https%3A%2F%2Fhttparchive.org%2Fstatic%2Fjs%2Fmain.js">上記のURLのテスト<span class="fn">https://redbot.org/?uri=https%3A%2F%2Fhttparchive.org%2Fstatic%2Fjs%2Fmain.js</span></a
      >は次のような内容を出力します。
    </p>
    <figure id="caching-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/ch16_fig1_redbot_example.jpg">
        <img alt="図1. RedBotからのCache-Control情報。" src="/static/images/2019/caching/ch16_fig1_redbot_example.jpg" aria-labelledby="caching-fig10-caption" aria-describedby="caching-fig10-description" width="600" height="138" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="caching-fig1-description" class="visually-hidden">リソースがいつ変更されたか、キャッシュがそれを保存できるかどうか、リソースが新鮮であると見なされる期間、および警告に関する詳細情報を示すRedbotの応答例。</div>
      <figcaption id="caching-fig1-caption"><a href="#caching-fig-1" class="anchor-link">図 1.</a> ロボットからの<code>Cache-Control</code>情報</figcaption>
    </figure>
    <p>
      レスポンスにキャッシュヘッダーが存在しない場合、<a href="https://paulcalvano.com/index.php/2018/03/14/http-heuristic-caching-missing-cache-control-and-expires-headers-explained/">クライアントはレスポンスをヒューリスティクスにキャッシュできます<span class="fn">https://paulcalvano.com/index.php/2018/03/14/http-heuristic-caching-missing-cache-control-and-expires-headers-explained/</span></a
      >。ほとんどのクライアントは、RFCの推奨ヒューリスティックバリエーションを実装します。これは、<code>Last-Modified</code>から経過した時間の10％です。ただし、レスポンスを無期限にキャッシュする可能性もあります。そのため、特定のキャッシュルールを設定して、キャッシュ可能性を確実に制御することが重要です。
    </p>
    <p>レスポンスの72％は<code>Cache-Control</code>ヘッダーで提供され、レスポンスの56％は<code>Expires</code>ヘッダーで提供されます。ただし、レスポンスの27％はどちらのヘッダーも使用していないため、ヒューリスティックキャッシュの対象となります。これは、デスクトップとモバイルサイトの両方で一貫しています。</p>
    <figure id="caching-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig2.png">
        <img src="/static/images/2019/caching/fig2.png" alt="図2. HTTP Cache-ControlおよびExpiresヘッダーの存在" aria-labelledby="caching-fig2-caption" aria-describedby="caching-fig2-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=1611664016&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="caching-fig2-description" class="visually-hidden">リクエストの72％がCache-Controlヘッダーを使用し、56％がExpiresを使用し、27％がどちらも使用しないことを示す、モバイルとデスクトップの棒グラフ。</div>
      <figcaption id="caching-fig2-caption"><a href="#caching-fig-2" class="anchor-link">図 2.</a> HTTP <code>Cache-Control</code>および<code>Expires</code>ヘッダーの存在</figcaption>
    </figure>
    <h2 id="caching-キャッシュするコンテンツの種類は何ですか？"><a href="#caching-キャッシュするコンテンツの種類は何ですか？" class="anchor-link">キャッシュするコンテンツの種類は何ですか？</a></h2>
    <p>キャッシュ可能なリソースは、クライアントによって一定期間保存され、後続のリクエストで再利用できます。すべてのHTTPリクエスト全体で、レスポンスの80％はキャッシュ可能と見なされます。つまり、キャッシュがそれらを格納することを許可されています。</p>
    <ul>
      <li>要求の6％のTime To Time（TTL）は0秒で、キャッシュされたエントリはすぐに無効になります。</li>
      <li>27％は<code>Cache-Control</code>ヘッダーがないため、ヒューリスティックにキャッシュされます。</li>
      <li>47％は0秒以上キャッシュされます。</li>
    </ul>
    <p>残りのレスポンスは、ブラウザーのキャッシュに保存できません。</p>
    <figure id="caching-fig-3">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig3.png">
        <img src="/static/images/2019/caching/fig3.png" alt="図3.キャッシュ可能なレスポンスの分布。" aria-labelledby="caching-fig3-caption" aria-describedby="caching-fig3-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=1868559586&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig3-description" data-show-text="{{ show_description(3) }}" data-hide-text="{{ hide_description(3) }}">{{ show_description(3) }}</button>
      <div id="caching-fig3-description" class="visually-hidden">デスクトップレスポンスの20％がキャッシュ不可、47％が0秒以上のキャッシュ、27％がヒューリスティックにキャッシュ、6％が0秒のTTLを示す積み上げ棒グラフ。モバイルの統計は非常に似ています（19％、47％ 、27％および7％）</div>
      <figcaption id="caching-fig3-caption"><a href="#caching-fig-3" class="anchor-link">図 3.</a>キャッシュ可能なレスポンスの分布。</figcaption>
    </figure>
    <p>次の表は、デスクトップリクエストのキャッシュTTL値をタイプ別に詳細に示しています。ほとんどのコンテンツタイプはキャッシュされますが、CSSリソースは高いTTLで一貫してキャッシュされるようです。</p>
    <figure id="caching-fig-4">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="colgroup" colspan="5">デスクトップキャッシュTTLパーセンタイル（時間）</th>
              </tr>
              <tr>
                <td></td>
                <th scope="col">10</th>
                <th scope="col">25</th>
                <th scope="col">50</th>
                <th scope="col">75</th>
                <th scope="col">90</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">Audio</th>
                <td class="numeric">12</td>
                <td class="numeric">24</td>
                <td class="numeric">720</td>
                <td class="numeric">8,760</td>
                <td class="numeric">8,760</td>
              </tr>
              <tr>
                <th scope="row">CSS</th>
                <td class="numeric">720</td>
                <td class="numeric">8,760</td>
                <td class="numeric">8,760</td>
                <td class="numeric">8,760</td>
                <td class="numeric">8,760</td>
              </tr>
              <tr>
                <th scope="row">Font</th>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">3</td>
                <td class="numeric">336</td>
                <td class="numeric">8,760</td>
                <td class="numeric">87,600</td>
              </tr>
              <tr>
                <th scope="row">HTML</th>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">168</td>
                <td class="numeric">720</td>
                <td class="numeric">8,760</td>
                <td class="numeric">8,766</td>
              </tr>
              <tr>
                <th scope="row">Image</th>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">1</td>
                <td class="numeric">28</td>
                <td class="numeric">48</td>
                <td class="numeric">8,760</td>
              </tr>
              <tr>
                <th scope="row">Other</th>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">2</td>
                <td class="numeric">336</td>
                <td class="numeric">8,760</td>
                <td class="numeric">8,760</td>
              </tr>
              <tr>
                <th scope="row">Script</th>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">1</td>
                <td class="numeric">6</td>
                <td class="numeric">720</td>
              </tr>
              <tr>
                <th scope="row">Text</th>
                <td class="numeric">21</td>
                <td class="numeric">336</td>
                <td class="numeric">7,902</td>
                <td class="numeric">8,357</td>
                <td class="numeric">8,740</td>
              </tr>
              <tr>
                <th scope="row">Video</th>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">4</td>
                <td class="numeric">24</td>
                <td class="numeric">24</td>
                <td class="numeric">336</td>
              </tr>
              <tr>
                <th scope="row">XML</th>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">&lt; 1</td>
                <td class="numeric">&lt; 1</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#caching-fig-4" class="anchor-link">図 4.</a>リソースタイプ別のデスクトップキャッシュTTLパーセンタイル。</figcaption>
    </figure>
    <p>TTLの中央値のほとんどは高いですが、低いパーセンタイルは、見逃されたキャッシングの機会の一部を強調しています。たとえば画像のTTLの中央値は28時間ですが、25パーセンタイルは1〜2時間であり、10パーセンタイルはキャッシュ可能な画像コンテンツの10％が1時間未満キャッシュされることを示します。</p>
    <p>以下の図5でコンテンツタイプごとのキャッシュ可能性を詳細に調べると、すべてのHTMLレスポンスの約半分がキャッシュ不可と見なされていることがわかります。さらに、画像とスクリプトの16％はキャッシュ不可です。</p>
    <figure id="caching-fig-5">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig5.png">
        <img src="/static/images/2019/caching/fig5.png" alt="図5.デスクトップのコンテンツタイプごとのキャッシュ可能性の分布。" aria-labelledby="caching-fig5-caption" aria-describedby="caching-fig5-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=1493610744&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig5-description" data-show-text="{{ show_description(5) }}" data-hide-text="{{ hide_description(5) }}">{{ show_description(5) }}</button>
      <div id="caching-fig5-description" class="visually-hidden">キャッシュ不可、0秒を超えたキャッシュ、デスクトップのタイプごとに0秒だけキャッシュの分割を示す積み上げ棒グラフ。小さいがかなりの割合でキャッシュ不可能でHTMLでは最大50％になり、ほとんどはキャッシュが大きく0で、小さいキャッシュは0 TTLです。</div>
      <figcaption id="caching-fig5-caption"><a href="#caching-fig-5" class="anchor-link">図 5.</a>デスクトップのコンテンツタイプごとのキャッシュ可能性の分布。</figcaption>
    </figure>
    <p>モバイルの同じデータを以下に示します。ご覧のとおり、コンテンツタイプのキャッシュ可能性はデスクトップとモバイルで一貫しています。</p>
    <figure id="caching-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig6.png">
        <img src="/static/images/2019/caching/fig6.png" alt="図6.モバイルのコンテンツタイプ別のキャッシュ可能性の分布。" aria-labelledby="caching-fig6-caption" aria-describedby="caching-fig6-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=1713903788&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="caching-fig6-description" class="visually-hidden">キャッシュ不可、0秒を超えたキャッシュ、デスクトップのタイプごとに0秒だけキャッシュの分割を示す積み上げ棒グラフ。小さいがかなりの割合でキャッシュ不可能でHTMLでは最大50％になり、ほとんどはキャッシュが大きく0で、小さいキャッシュは0 TTLです。</div>
      <figcaption id="caching-fig6-caption"><a href="#caching-fig-6" class="anchor-link">図 6.</a>モバイルのコンテンツタイプ別のキャッシュ可能性の分布。</figcaption>
    </figure>
    <h2 id="caching-cache-controlとexpires"><a href="#caching-cache-controlとexpires" class="anchor-link">Cache-ControlとExpires</a></h2>
    <p>HTTP/1.0では、<code>Expires</code>ヘッダーは、レスポンスが古くなったと見なされる日時を示すために使用されました。その値は、次のような日付のタイムスタンプです。</p>
    <p><code>Expires: Thu, 01 Dec 1994 16:00:00 GMT</code></p>
    <p>HTTP/1.1は<code>Cache-Control</code>ヘッダーを導入し、最新のクライアントのほとんどは両方のヘッダーをサポートしています。このヘッダーは、キャッシングディレクティブを介して、はるかに高い拡張性を提供します。例えば。</p>
    <ul>
      <li><code>no-store</code> リソースをキャッシュしないことを示すために使用できます。</li>
      <li><code>max-age</code> 鮮度の寿命を示すために使用できます。</li>
      <li><code>must-revalidate</code> キャッシュされたエントリは、使用する前に条件付きリクエストで検証する必要があることをクライアントに伝えます。</li>
      <li><code>private</code> レスポンスはブラウザによってのみキャッシュされ、複数のクライアントにサービスを提供する仲介者によってキャッシュされるべきではないことを示します。</li>
    </ul>
    <p>HTTPレスポンスの53％は、<code>max-age</code>ディレクティブを持つ<code>Cache-Control</code>ヘッダーが含まれ、54％はExpiresヘッダーが含まれます。ただし、これらのレスポンスの41％のみが両方のヘッダーを使用します。つまり、レスポンスの13％が古い<code>Expires</code>ヘッダーのみに基づいてキャッシュされます。</p>
    <figure id="caching-fig-7">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig7.png">
        <img src="/static/images/2019/caching/fig7.png" alt="図7. Cache-ControlとExpiresヘッダーの使用法。" aria-labelledby="caching-fig7-caption" aria-describedby="caching-fig7-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=1909701542&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig7-description" data-show-text="{{ show_description(7) }}" data-hide-text="{{ hide_description(7) }}">{{ show_description(7) }}</button>
      <div id="caching-fig7-description" class="visually-hidden">レスポンスの53％を示す棒グラフには、「Cache-Control：max-age」、54％-55％が「Expires」、41％-42％が両方を使用し、34％がどちらも使用していません。数字は、デスクトップとモバイルの両方について示されていますが、有効期限の使用率が高いモバイルとほぼ同じです。</div>
      <figcaption id="caching-fig7-caption"><a href="#caching-fig-7" class="anchor-link">図 7.</a> <code>Cache-Control</code>と<code>Expires</code>ヘッダーの使用法。</figcaption>
    </figure>
    <h2 id="caching-cache-controlディレクティブ"><a href="#caching-cache-controlディレクティブ" class="anchor-link">Cache-Controlディレクティブ</a></h2>
    <p>
      HTTP/1.1<a href="https://tools.ietf.org/html/rfc7234#section-5.2.1">仕様<span class="fn">https://tools.ietf.org/html/rfc7234#section-5.2.1</span></a
      >には、<code>Cache-Control</code>レスポンスヘッダーで使用できる複数のディレクティブが含まれており、以下で詳しく説明します。1つのレスポンスで複数を使用できることに注意してください。
    </p>
    <figure id="caching-fig-8">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>ディレクティブ</th>
                <th>説明</th>
              </tr>
              <tr>
                <td>max-age</td>
                <td>リソースをキャッシュできる秒数を示します。</td>
              </tr>
              <tr>
                <td>public</td>
                <td>任意のキャッシュにレスポンスを保存できます。</td>
              </tr>
              <tr>
                <td>no-cache</td>
                <td>キャッシュされたエントリは、使用する前に再検証する必要があります。</td>
              </tr>
              <tr>
                <td>must-revalidate</td>
                <td>古いキャッシュエントリは、使用する前に再検証する必要があります。</td>
              </tr>
              <tr>
                <td>no-store</td>
                <td>レスポンスがキャッシュ不可能なことを示します。</td>
              </tr>
              <tr>
                <td>private</td>
                <td>レスポンスは特定のユーザー向けであり、共有キャッシュに保存しない。</td>
              </tr>
              <tr>
                <td>no-transform</td>
                <td>このリソースに対して変換を行わないでください。</td>
              </tr>
              <tr>
                <td>proxy-revalidate</td>
                <td>must-revalidateと同じですが、共有キャッシュに適用されます。</td>
              </tr>
              <tr>
                <td>s-maxage</td>
                <td>max ageと同じですが、共有キャッシュにのみ適用されます。</td>
              </tr>
              <tr>
                <td>immutable</td>
                <td>キャッシュされたエントリは決して変更されず、再検証は不要であることを示します。</td>
              </tr>
              <tr>
                <td>stale-while-revalidate</td>
                <td>クライアントがバックグラウンドで新しいレスポンスを非同期にチェックしながら、古いレスポンスを受け入れようとしていることを示します。</td>
              </tr>
              <tr>
                <td>stale-if-error</td>
                <td>新しいレスポンスのチェックが失敗した場合に、クライアントが古いレスポンスを受け入れる意思があることを示します。</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#caching-fig-8" class="anchor-link">図 8.</a> <code>Cache-Control</code> ディレクティブ。</figcaption>
    </figure>
    <p>たとえば、<code>cache-control：public、max-age = 43200</code>は、キャッシュされたエントリを43,200秒間保存し、共有キャッシュに保存できることを示します。</p>
    <figure id="caching-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig9.png">
        <img src="/static/images/2019/caching/fig9.png" alt="図9.モバイルでのCache-Controlディレクティブの使用。" aria-labelledby="caching-fig9-caption" aria-describedby="caching-fig9-description" width="600" height="662" data-width="600" data-height="662" data-seamless="" data-rameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=1054108345&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="caching-fig9-description" class="visually-hidden">15のcache-controlディレクティブとその使用量の棒グラフ。74.8％のmax-age、37.8％のpublic、27.8％のno-cache、18％のno-store、14.3％のprivate、3.4％のimmutable、3.3％のno-transform、2.4％のstale-while-revalidate、2.2％のpre-check、2.2％のpost-check、1.9％のs-maxage、1.6％のproxy-revalidate、0.3％set-cookieおよび0.2％のstale-if-error。統計は、デスクトップとモバイルでほぼ同じです。</div>
      <figcaption id="caching-fig9-caption"><a href="#caching-fig-9" class="anchor-link">図 9.</a>モバイルでの<code>Cache-Control</code>ディレクティブの使用。</figcaption>
    </figure>
    <p>上記の図9は、モバイルWebサイトで使用されている上位15の<code>Cache-Control</code>ディレクティブを示しています。デスクトップとモバイルの結果は非常に似ています。これらのキャッシュディレクティブの人気について、興味深い観察結果がいくつかあります。</p>
    <ul>
      <li><code>max-age</code>は<code>Cache-Control</code>ヘッダーのほぼ75％で使用され、<code>no-store</code>は18％で使用されます。</li>
      <li><code>private</code>が指定されない限り、キャッシュされたエントリは<code>public</code>であると想定されるため、<code>public</code>が必要になることはほとんどありません。回答の約38％に<code>public</code>が含まれています。</li>
      <li>
        <code>immutable</code>ディレクティブは比較的新しく、<a href="https://code.facebook.com/posts/557147474482256/this-browser-tweak-saved-60-of-requests-to-facebook">2017年に導入<span class="fn">https://code.facebook.com/posts/557147474482256/this-browser-tweak-saved-60-of-requests-to-facebook</span></a
        >され、<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#Browser_compatibility">FirefoxおよびSafariでサポート<span class="fn">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#Browser_compatibility</span></a
        >されています。その使用率は3.4％に拡大し、<a href="https://discuss.httparchive.org/t/cache-control-immutable-a-year-later/1195">Facebook、Googleのサードパーティのレスポンス<span class="fn">https://discuss.httparchive.org/t/cache-control-immutable-a-year-later/1195</span></a
        >で広く使用されています。
      </li>
    </ul>
    <p>
      このリストに表示される別の興味深いディレクティブセットは、<code>pre-check</code>と<code>post-check</code>です。これらは、<code>Cache-Control</code>レスポンスヘッダーの2.2％（約780万件のレスポンス）で使用されます。このヘッダーのペアは、<a href="https://blogs.msdn.microsoft.com/ieinternals/2009/07/20/internet-explorers-cache-control-extensions/">バックグラウンドで検証を提供するためにInternet Explorer 5で導入された<span class="fn">https://blogs.msdn.microsoft.com/ieinternals/2009/07/20/internet-explorers-cache-control-extensions/</span></a
      >ものですが、Webサイトによって正しく実装されることはほとんどありませんでした。これらのヘッダーを使用したレスポンスの99.2％は、<code>pre-check=0</code>と<code>post-check=0</code>の組み合わせを使用していました。これらのディレクティブの両方が0に設定されている場合、両方のディレクティブは無視されます。したがって、これらのディレクティブは正しく使用されなかったようです！
    </p>
    <p>ロングテールでは、レスポンスの0.28％で1,500を超える間違ったディレクティブが使用されています。これらはクライアントによって無視され、「nocache」「s-max-age」「smax-age」「maxage」などのスペルミスが含まれます。「max-stale」「proxy-public」「surrogate-control」など存在しないディレクティブも多数あります。</p>
    <h2 id="caching-cache-control-no-store-no-cache-and-max-age0"><a href="#caching-cache-control-no-store-no-cache-and-max-age0" class="anchor-link">Cache-Control: no-store, no-cache and max-age=0</a></h2>
    <p>レスポンスがキャッシュ可能でない場合、<code>Cache-Control</code> <code>no-store</code>ディレクティブを使用する必要があります。このディレクティブを使用しない場合、レスポンスはキャッシュ可能です。</p>
    <p>レスポンスをキャッシュ不可に設定しようとすると、いくつかの一般的なエラーが発生します。</p>
    <ul>
      <li><code>Cache-Control: no-cache</code>の設定は、リソースがキャッシュできないように聞こえるかもしれません。ただし、<code>no-cache</code>ディレクティブでは、使用する前にキャッシュされたエントリを再検証する必要があり、キャッシュ不可と同じではありません。</li>
      <li><code>Cache-Control: max-age = 0</code>を設定すると、TTLが0秒に設定されますが、これはキャッシュ不可と同じではありません。 max-ageを0に設定すると、リソースはブラウザーのキャッシュに保存され、すぐに無効になります。これにより、ブラウザは条件付きリクエストを実行してリソースの新しさを検証する必要があります。</li>
    </ul>
    <p>機能的には、<code>no-cache</code>と<code>max-age=0</code>は似ています。どちらもキャッシュされたリソースの再検証を必要とするためです。 <code>no-cache</code>ディレクティブは、0より大きい<code>max-age</code>ディレクティブと一緒に使用することもできます。</p>
    <p>300万を超えるレスポンスには、<code>no-store</code>、<code>no-cache</code>、<code>max-age=0</code>の組み合わせが含まれます。これらのディレクティブのうち、<code>no-store</code>が優先され、他のディレクティブは単に冗長です。</p>
    <p>レスポンスの18％には<code>no-store</code>が含まれ、レスポンスの16.6％には<code>no-store</code>と<code>no-cache</code>の両方が含まれます。<code>no-store</code>が優先されるため、リソースは最終的にキャッシュ不可になります。</p>
    <p><code>max-age=0</code>ディレクティブは、<code>no-store</code>が存在しないレスポンスの1.1％（400万を超えるレスポンス）に存在します。これらのリソースはブラウザにキャッシュされますが、すぐに期限切れになるため、再検証が必要になります。</p>
    <h2 id="caching-キャッシュttlとリソースの経過時間はどのように比較されますか？"><a href="#caching-キャッシュttlとリソースの経過時間はどのように比較されますか？" class="anchor-link">キャッシュTTLとリソースの経過時間はどのように比較されますか？</a></h2>
    <p>これまで、Webサーバーがキャッシュ可能なものをクライアントに通知する方法と、キャッシュされる期間について説明してきました。キャッシュルールを設計するときは、提供しているコンテンツの古さを理解することも重要です。</p>
    <p>キャッシュTTLを選択するときは、「これらのアセットをどのくらいの頻度で更新しますか？」と自問してください。そして「彼らのコンテンツの感度は何ですか？」。たとえば、ヒーローのイメージがたまに更新される場合、非常に長いTTLでキャッシュします。 JavaScriptリソースが頻繁に変更されることが予想される場合は、バージョン管理して長いTTLでキャッシュするか、短いTTLでキャッシュします。</p>
    <p>
      以下のグラフは、コンテンツタイプごとのリソースの相対的な年を示しています。ここで、<a href="https://discuss.httparchive.org/t/analyzing-resource-age-by-content-type/1659">より詳細な分析<span class="fn">https://discuss.httparchive.org/t/analyzing-resource-age-by-content-type/1659</span></a
      >を読むことができます。 HTMLは最も短い年齢のコンテンツタイプである傾向があり、伝統的にキャッシュ可能なリソース（<a href="#javascript">スクリプト</a>、<a href="#css">CSS</a>、および<a href="#fonts">フォント</a>）の非常に大きな割合が1年以上古いです！
    </p>
    <figure id="caching-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/ch16_fig8_resource_age.jpg">
        <img src="/static/images/2019/caching/ch16_fig8_resource_age.jpg" alt="図10.コンテンツタイプ別のリソース年分布。" aria-labelledby="caching-fig10-caption" aria-describedby="caching-fig10-description" width="600" height="325" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="caching-fig10-description" class="visually-hidden">コンテンツの年を示すスタック棒グラフ。0〜52週に分割され、1年以上と2年以上で、nullと負の数字も表示されます。統計は、ファーストパーティとサードパーティに分かれています。値0は、特にファーストパーティのHTML、テキスト、およびxml、およびすべてのアセットタイプのサードパーティリクエストの最大50％に使用されます。中間年を使用し、その後1年と2年の間かなりの使用量を使用するミックスがあります。</div>
      <figcaption id="caching-fig10-caption"><a href="#caching-fig-10" class="anchor-link">図 10.</a>コンテンツタイプ別のリソース年分布。</figcaption>
    </figure>
    <p>リソースのキャッシュ可能性をその経過時間と比較することにより、TTLが適切であるか短すぎるかを判断できます。たとえば、以下のレスポンスによって提供されるリソースは、2019年8月25日に最後の変更がされました。つまり、配信時に49日経過していました。 <code>Cache-Control</code>ヘッダーは、43,200秒（12時間）キャッシュできることを示しています。より長いTTLが適切かどうかを調査するのに十分古いものです。</p>
    <pre><code>&lt; HTTP/1.1 200
&lt; Date: Sun, 13 Oct 2019 19:36:57 GMT
&lt; Content-Type: application/javascript; charset=utf-8
&lt; Content-Length: 3052
&lt; Vary: Accept-Encoding
&lt; Server: gunicorn/19.7.1
&lt; Last-Modified: Sun, 25 Aug 2019 16:00:30 GMT
&lt; Cache-Control: public, max-age=43200
&lt; Expires: Mon, 14 Oct 2019 07:36:57 GMT
&lt; ETag: "1566748830.0-3052-3932359948" </code></pre>
    <p>全体的に、Webで提供されるリソースの59％のキャッシュTTLは、コンテンツの年齢に比べて短すぎます。さらに、TTLと経過時間のデルタの中央値は25日です。</p>
    <p>これをファーストパーティとサードパーティで分けると、ファーストパーティのリソースの70％がより長いTTLの恩恵を受けることもわかります。これは、キャッシュ可能なものに特に注意を払い、キャッシュが正しく構成されていることを確認する必要があることを明確に強調しています。</p>
    <figure id="caching-fig-11">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>クライアント</th>
                <th>ファーストパーティ</th>
                <th>サードパーティ</th>
                <th>全体</th>
              </tr>
              <tr>
                <td>デスクトップ</td>
                <td class="numeric">70.7%</td>
                <td class="numeric">47.9%</td>
                <td class="numeric">59.2%</td>
              </tr>
              <tr>
                <td>モバイル</td>
                <td class="numeric">71.4%</td>
                <td class="numeric">46.8%</td>
                <td class="numeric">59.6%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#caching-fig-11" class="anchor-link">図 11.</a> TTLが短いリクエストの割合。</figcaption>
    </figure>
    <h2 id="caching-鮮度の検証"><a href="#caching-鮮度の検証" class="anchor-link">鮮度の検証</a></h2>
    <p>キャッシュ内に格納されたレスポンスの検証に使用されるHTTPレスポンスヘッダーは、<code>Last-Modified</code>および<code>ETag</code>です。 <code>Last-Modified</code>ヘッダーは、その名前が示すとおりに機能し、オブジェクトが最後に変更された時刻を提供します。 <code>ETag</code>ヘッダーは、コンテンツの一意の識別子を提供します。</p>
    <p>たとえば、以下のレスポンスは2019年8月25日に変更され、<code>「1566748830.0-3052-3932359948」</code>の<code>ETag</code>値があります。</p>
    <pre><code>&lt; HTTP/1.1 200
&lt; Date: Sun, 13 Oct 2019 19:36:57 GMT
&lt; Content-Type: application/javascript; charset=utf-8
&lt; Content-Length: 3052
&lt; Vary: Accept-Encoding
&lt; Server: gunicorn/19.7.1
&lt; Last-Modified: Sun, 25 Aug 2019 16:00:30 GMT
&lt; Cache-Control: public, max-age=43200
&lt; Expires: Mon, 14 Oct 2019 07:36:57 GMT
&lt; ETag: "1566748830.0-3052-3932359948"</code></pre>
    <p>クライアントは、<code>If-Modified-Since</code>という名前のリクエストヘッダーの<code>Last-Modified</code>値を使用して、キャッシュされたエントリを検証する条件付きリクエストを送信できます。同様に、<code>If-None-Match</code>リクエストヘッダーを使用してリソースを検証することもできます。これは、クライアントがキャッシュ内のリソースに対して持っている<code>ETag</code>値に対して検証します。</p>
    <p>以下の例では、キャッシュエントリはまだ有効であり、<code>HTTP 304</code>がコンテンツなしで返されました。これにより、リソース自体のダウンロードが保存されます。キャッシュエントリが最新ではない場合、サーバーは<code>200</code>で更新されたリソースを応答し、再度ダウンロードする必要があります。</p>
    <pre><code>&gt; GET /static/js/main.js HTTP/1.1
&gt; Host: www.httparchive.org
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*
&gt; If-Modified-Since: Sun, 25 Aug 2019 16:00:30 GMT

&lt; HTTP/1.1 304
&lt; Date: Thu, 17 Oct 2019 02:31:08 GMT
&lt; Server: gunicorn/19.7.1
&lt; Cache-Control: public, max-age=43200
&lt; Expires: Thu, 17 Oct 2019 14:31:08 GMT
&lt; ETag: "1566748830.0-3052-3932359948"
&lt; Accept-Ranges: bytes</code></pre>
    <p>全体としてレスポンスの65％は<code>Last-Modified</code>ヘッダーで、42％は<code>ETag</code>で提供され、38％は両方を使用します。ただし、レスポンスの30％には<code>Last-Modified</code>ヘッダー、<code>ETag</code>ヘッダーは含まれていません。</p>
    <figure id="caching-fig-12">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig12.png">
        <img src="/static/images/2019/caching/fig12.png" alt="図12.デスクトップWebサイトのLast-ModifiedおよびETa`ヘッダーを介した鮮度の検証の採用。" aria-labelledby="caching-fig12-caption" aria-describedby="caching-fig12-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=20297100&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig12-description" data-show-text="{{ show_description(12) }}" data-hide-text="{{ hide_description(12) }}">{{ show_description(12) }}</button>
      <div id="caching-fig12-description" class="visually-hidden">デスクトップリクエストの64.4％が最後に変更され、42.8％がETagを持ち、37.9％が両方を持ち、30.7％がどちらも持たないことを示す棒グラフ。モバイルの統計は、最終変更が65.3％、ETagが42.8％、両方が38.0％、どちらも29.9％というほぼ同じです。</div>
      <figcaption id="caching-fig12-caption"><a href="#caching-fig-12" class="anchor-link">図 12.</a>デスクトップWebサイトの<code>Last-Modified</code>および<code>ETag</code>ヘッダーを介した鮮度の検証の採用。</figcaption>
    </figure>
    <h2 id="caching-日付文字列の有効性"><a href="#caching-日付文字列の有効性" class="anchor-link">日付文字列の有効性</a></h2>
    <p>タイムスタンプの伝達に使用されるHTTPヘッダーがいくつかあり、これらの形式は非常に重要です。 <code>Date</code>レスポンスヘッダーは、リソースがいつクライアントに提供されたかを示します。 <code>Last-Modified</code>レスポンスヘッダーは、サーバーでリソースが最後に変更された日時を示します。また、<code>Expires</code>ヘッダーは、（<code>Cache-Control</code>ヘッダーの存在しない場合）リソースがキャッシュ可能な期間を示すために使用されます。</p>
    <p>これら3つのHTTPヘッダーはすべて、日付形式の文字列を使用してタイムスタンプを表します。</p>
    <p>例えば。</p>
    <pre><code>&gt; GET /static/js/main.js HTTP/1.1
&gt; Host: httparchive.org
&gt; User-Agent: curl/7.54.0
&gt; Accept: */*

&lt; HTTP/1.1 200
&lt; Date: Sun, 13 Oct 2019 19:36:57 GMT
&lt; Content-Type: application/javascript; charset=utf-8
&lt; Content-Length: 3052
&lt; Vary: Accept-Encoding
&lt; Server: gunicorn/19.7.1
&lt; Last-modified: Sun, 25 Aug 2019 16:00:30 GMT
&lt; Cache-Control: public, max-age=43200
&lt; Expires: Mon, 14 Oct 2019 07:36:57 GMT
&lt; ETag: "1566748830.0-3052-3932359948"</code></pre>
    <p>ほとんどのクライアントは、無効な日付文字列を無視します。これにより、提供されているレスポンスを無視します。これは、誤った<code>Last-Modified</code>ヘッダーがLast-Modifiedタイムスタンプなしでキャッシュされるため、条件付きリクエストを実行できなくなるため、キャッシュ可能性に影響を与える可能性があります。</p>
    <p>通常、<code>Date</code> HTTPレスポンスヘッダーは、クライアントにレスポンスを提供するWebサーバーまたはCDNによって生成されます。ヘッダーは通常、サーバーによって自動的に生成されるため、エラーが発生しにくい傾向はあります。これは、無効な<code>Date</code>ヘッダーの割合が非常に低いことを反映しています。 <code>Last-Modified</code>ヘッダーは非常に類似しており、無効なヘッダーは0.67％のみでした。しかし、驚いたのは、3.64％の<code>Expires</code>ヘッダーが無効な日付形式を使用していたことです！</p>
    <figure id="caching-fig-13">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig13.png">
        <img src="/static/images/2019/caching/fig13.png" alt="図13.レスポンスヘッダーの無効な日付形式。" aria-labelledby="caching-fig13-caption" aria-describedby="caching-fig13-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=1500819114&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig13-description" data-show-text="{{ show_description(13) }}" data-hide-text="{{ hide_description(13) }}">{{ show_description(13) }}</button>
      <div id="caching-fig13-description" class="visually-hidden">デスクトップレスポンスの0.10％に無効な日付があり、0.67％に無効なLast-Modifiedがあり、3.64％に無効なExpiresがあることを示す棒グラフ。モバイルの統計は非常によく似ており、レスポンスの0.06％に無効な日付があり、0.68％に無効なLast-Modifiedがあり、3.50％に無効な有効期限があります。</div>
      <figcaption id="caching-fig13-caption"><a href="#caching-fig-13" class="anchor-link">図 13.</a>レスポンスヘッダーの無効な日付形式。</figcaption>
    </figure>
    <p><code>Expires</code>ヘッダーの無効な使用の例は次のとおりです。</p>
    <ul>
      <li><p>有効な日付形式ですが、GMT以外のタイムゾーンを使用しています</p></li>
      <li><p>0や-1などの数値</p></li>
      <li>
        <p><code>Cache-Control</code>ヘッダーで有効な値</p>
        <p>無効な<code>Expires</code>ヘッダーの最大のソースは、人気のあるサードパーティから提供されるアセットからのものです。たとえば、<code>Expires：Tue、27 Apr 1971 19:44:06 EST</code>など、日付/時刻はESTタイムゾーンを使用します。</p>
      </li>
    </ul>
    <h2 id="caching-ヘッダーを変更"><a href="#caching-ヘッダーを変更" class="anchor-link">ヘッダーを変更</a></h2>
    <p>キャッシングで最も重要な手順の1つは、要求されているリソースがキャッシュされているかどうかを判断することです。これは単純に見えるかもしれませんが、多くの場合、URLだけではこれを判断するには不十分です。たとえば同じURLのリクエストは、使用する<a href="#compression">圧縮</a>（gzip、brotliなど）が異なる場合や、モバイルの訪問者に合わせて変更および調整できます。</p>
    <p>この問題を解決するために、クライアントはキャッシュされた各リソースに一意の識別子（キャッシュキー）を与えます。デフォルトでは、このキャッシュキーは単にリソースのURLですが、開発者はVaryヘッダーを使用して他の要素（圧縮方法など）を追加できます。</p>
    <p>Varyヘッダーは、1つ以上の要求ヘッダー値の値をキャッシュキーに追加するようにクライアントに指示します。この最も一般的な例は、<code>Vary：Accept-Encoding</code>です。これにより、<code>Accept-Encoding</code>リクエストヘッダー値（<code>gzip</code>、<code>br</code>、<code>deflate</code>など）のキャッシュエントリが別になります。</p>
    <p>別の一般的な値は<code>Vary：Accept-Encoding</code>、<code>User-Agent</code>です。これは、Accept-Encoding値と<code>User-Agent</code>文字列の両方によってキャッシュエントリを変更するようにクライアントに指示します。共有プロキシとCDNを扱う場合、<code>Accept-Encoding</code>以外の値を使用すると、キャッシュキーが弱められ、キャッシュから提供されるトラフィックの量が減少するため、問題発生の可能性があります。</p>
    <p>一般に、そのヘッダーに基づいてクライアントに代替コンテンツを提供する場合のみ、キャッシュを変更する必要があります。</p>
    <p><code>Vary</code>ヘッダーは、HTTPレスポンスの39％、および<code>Cache-Control</code>ヘッダーを含むレスポンスの45％で使用されます。</p>
    <p>以下のグラフは、上位10個の<code>Vary</code>ヘッダー値の人気を示しています。 <code>Accept-Encoding</code>はVaryの使用の90％を占め、<code>User-Agent</code>（11％）、<code>Origin</code>（9％）、<code>Accept</code>（3％）が残りの大部分を占めています。</p>
    <figure id="caching-fig-14">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig14.png">
        <img src="/static/images/2019/caching/fig14.png" alt="図14.Varyヘッダーの使用率。" aria-labelledby="caching-fig14-caption" aria-describedby="caching-fig14-description" width="600" height="655" data-width="600" data-height="655" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=384675253&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig14-description" data-show-text="{{ show_description(14) }}" data-hide-text="{{ hide_description(14) }}">{{ show_description(14) }}</button>
      <div id="caching-fig14-description" class="visually-hidden">accept-encodingは90％で使用、ユーザーエージェントは10％-11％、オリジンは約7％-8％、acceptは少なく、cookie、x-forward-proto、accept-language、host、x-origin、access-control-request-method、およびaccess-control-request-headersの使用はほとんどありません</div>
      <figcaption id="caching-fig14-caption"><a href="#caching-fig-14" class="anchor-link">図 14.</a>Varyヘッダーの使用率。</figcaption>
    </figure>
    <h2 id="caching-キャッシュ可能なレスポンスにcookieを設定する"><a href="#caching-キャッシュ可能なレスポンスにcookieを設定する" class="anchor-link">キャッシュ可能なレスポンスにCookieを設定する</a></h2>
    <p>レスポンスがキャッシュされると、そのヘッダー全体もキャッシュにスワップされます。これが、DevToolsを介してキャッシュされたレスポンスを検査するときにレスポンスヘッダーを表示できる理由です。</p>
    <figure id="caching-fig-15">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/ch16_fig12_header_example_with_cookie.jpg">
        <img src="/static/images/2019/caching/ch16_fig12_header_example_with_cookie.jpg" alt="図15.キャッシュされたリソースのChrome開発ツール。" aria-labelledby="caching-fig15-caption" aria-describedby="caching-fig15-description" width="600" height="359" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig15-description" data-show-text="{{ show_description(15) }}" data-hide-text="{{ hide_description(15) }}">{{ show_description(15) }}</button>
      <div id="caching-fig15-description" class="visually-hidden">キャッシュされたレスポンスのHTTPレスポンスヘッダーを示すChrome開発者ツールのスクリーンショット。</div>
      <figcaption id="caching-fig15-caption"><a href="#caching-fig-15" class="anchor-link">図 15.</a>キャッシュされたリソースのChrome開発ツール。</figcaption>
    </figure>
    <p>
      しかし、レスポンスに<code>Set-Cookie</code>がある場合はどうなりますか？ <a href="https://tools.ietf.org/html/rfc7234#section-8">RFC 7234セクション8<span class="fn">https://tools.ietf.org/html/rfc7234#section-8</span></a
      >によると、<code>Set-Cookie</code>レスポンスヘッダーはキャッシングを禁止しません。これは、キャッシュされたエントリが<code>Set-Cookie</code>でキャッシュされている場合、それが含まれている可能性があることを意味します。 RFCでは、適切な<code>Cache-Control</code>ヘッダーを構成して、レスポンスのキャッシュ方法を制御することを推奨しています。
    </p>
    <p><code>Set-Cookie</code>を使用してレスポンスをキャッシュすることのリスクの1つは、Cookieの値を保存し、後続の要求に提供できることです。 Cookieの目的によっては、心配な結果になる可能性があります。たとえば、ログインCookieまたはセッションCookieが共有キャッシュに存在する場合、そのCookieは別のクライアントによって再利用される可能性があります。これを回避する1つの方法は、<code>Cache-Control``プライベート</code>ディレクティブを使用することです。これにより、クライアントブラウザーによるレスポンスのキャッシュのみが許可されます。</p>
    <p>キャッシュ可能なレスポンスの3％に<code>Set-Cookieヘッダー</code>が含まれています。これらのレスポンスのうち、<code>プライベート</code>ディレクティブを使用しているのは18％のみです。残りの82％には、パブリックおよびプライベートキャッシュサーバーでキャッシュできる<code>Set-Cookie</code>を含む530万のHTTPレスポンスが含まれています。</p>
    <figure id="caching-fig-16">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/ch16_fig16_cacheable_responses_set_cookie.jpg">
        <img src="/static/images/2019/caching/ch16_fig16_cacheable_responses_set_cookie.jpg" alt="図16. Set-Cookieレスポンスのキャッシュ可能なレスポンス。" aria-labelledby="caching-fig16-caption" aria-describedby="caching-fig16-description" width="600" height="567" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig16-description" data-show-text="{{ show_description(16) }}" data-hide-text="{{ hide_description(16) }}">{{ show_description(16) }}</button>
      <div id="caching-fig16-description" class="visually-hidden">レスポンスの97％を示す棒グラフはSet-Cookieを使用せず、3％が使用します。この3％の内、15.3％がプライベート、84.7％がデスクトップ、モバイルは18.4％がパブリック、81.6％がプライベートであるという別の棒グラフに拡大されています。</div>
      <figcaption id="caching-fig16-caption"><a href="#caching-fig-16" class="anchor-link">図 16.</a> <code>Set-Cookie</code>レスポンスのキャッシュ可能なレスポンス。</figcaption>
    </figure>
    <h2 id="caching-appcacheおよびservice-worker"><a href="#caching-appcacheおよびservice-worker" class="anchor-link">AppCacheおよびService Worker</a></h2>
    <p>
      アプリケーションキャッシュまたはAppCacheはHTML5の機能であり、開発者はブラウザがキャッシュするリソースを指定し、オフラインユーザーが利用できるようにできます。この機能は<a href="https://html.spec.whatwg.org/multipage/offline.html#offline">廃止されており、Web標準からも削除<span class="fn">https://html.spec.whatwg.org/multipage/offline.html#offline</span></a
      >され、ブラウザーのサポートは減少しています。実際、使われているのが見つかった場合、<a href="https://developer.mozilla.org/ja-JP/docs/Web/API/Service_Worker_API/Using_Service_Workers">Firefox v44 +は、開発者に対して代わりにService Workerを使用することを推奨しています<span class="fn">https://developer.mozilla.org/ja-JP/docs/Web/API/Service_Worker_API/Using_Service_Workers</span></a
      >。 <a href="https://www.chromestatus.com/feature/5714236168732672">Chrome 70は、アプリケーションキャッシュをセキュリティで保護されたコンテキストのみに制限します<span class="fn">https://www.chromestatus.com/feature/5714236168732672</span></a
      >。業界では、このタイプの機能をService Workerに実装する方向へ移行しており、<a href="https://caniuse.com/#feat=serviceworkers">ブラウザサポート<span class="fn">https://caniuse.com/#feat=serviceworkers</span></a
      >は急速に成長しています。
    </p>
    <p>
      実際、<a href="https://httparchive.org/reports/progressive-web-apps#swControlledPages">HTTP Archiveトレンドレポートの1つは、以下に示すService Worker<span class="fn">https://httparchive.org/reports/progressive-web-apps#swControlledPages</span></a
      >の採用を示しています。
    </p>
    <figure id="caching-fig-17">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/ch16_fig14_service_worker_adoption.jpg">
        <img src="/static/images/2019/caching/ch16_fig14_service_worker_adoption.jpg" alt="図17.Service Workerが制御するページの時系列。" aria-labelledby="caching-fig17-caption" aria-describedby="caching-fig17-description" width="600" height="311" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig17-description" data-show-text="{{ show_description(17) }}" data-hide-text="{{ hide_description(17) }}">{{ show_description(17) }}</button>
      <div id="caching-fig17-description" class="visually-hidden">2016年10月から2019年7月までのService Workerが制御するサイトの使用状況を示す時系列チャート。モバイルとデスクトップの両方で使用量は年々着実に増加していますが、依然として両方で0.6％未満です。</div>
      <figcaption id="caching-fig17-caption">
        <a href="#caching-fig-17" class="anchor-link">図 17.</a>Service Workerが制御するページの時系列。 (引用: <a href="https://httparchive.org/reports/progressive-web-apps#swControlledPages">HTTP Archive<span class="fn">https://httparchive.org/reports/progressive-web-apps#swControlledPages</span></a
        >)
      </figcaption>
    </figure>
    <p>採用率はまだウェブサイトの1％を下回っていますが、2017年1月から着実に増加しています。<a href="#pwa">プログレッシブWebアプリ</a>の章では、人気サイトでの使用によりこのグラフが示唆するよりも多く使用されているという事実を含め、上記のグラフでは1回のみカウントされます。</p>
    <p>次の表では、AppCacheとService Workerの使用状況の概要を確認できます。 32,292のWebサイトでService Workerが実装されていますが、1,867のサイトでは非推奨のAppCache機能が引き続き使用されています。</p>
    <figure id="caching-fig-18">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">Service Workerを使用しない</th>
                <th scope="col">Service Workerを使用する</th>
                <th scope="col">合計</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>AppCacheを使用しない</td>
                <td class="numeric">5,045,337</td>
                <td class="numeric">32,241</td>
                <td class="numeric">5,077,578</td>
              </tr>
              <tr>
                <td>AppCacheを使用する</td>
                <td class="numeric">1,816</td>
                <td class="numeric">51</td>
                <td class="numeric">1,867</td>
              </tr>
              <tr>
                <td>合計</td>
                <td class="numeric">5,047,153</td>
                <td class="numeric">32,292</td>
                <td class="numeric">5,079,445</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#caching-fig-18" class="anchor-link">図 18.</a> AppCacheを使用するWebサイトとService Workerの数。</figcaption>
    </figure>
    <p>これをHTTPとHTTPSで分類すると、さらに興味深いものになります。 581のAppCache対応サイトはHTTP経由で提供されます。つまり、Chromeがこの機能を無効にしている可能性があります。 HTTPSはService Workerを使用するための要件ですが、それらを使用するサイトの907はHTTP経由で提供されます。</p>
    <figure id="caching-fig-19">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <td></td>
                <th scope="col">Service Workerを使用しない</th>
                <th scope="col">Service Workerを使用する</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="rowgroup" rowspan="2">HTTP</th>
                <td>AppCacheを使用しない</td>
                <td class="numeric">1,968,736</td>
                <td class="numeric">907</td>
              </tr>
              <tr>
                <td>AppCacheを使用する</td>
                <td class="numeric">580</td>
                <td class="numeric">1</td>
              </tr>
              <tr>
                <th scope="rowgroup" rowspan="2">HTTPS</th>
                <td>AppCacheを使用しない</td>
                <td class="numeric">3,076,601</td>
                <td class="numeric">31,334</td>
              </tr>
              <tr>
                <td>AppCacheを使用する</td>
                <td class="numeric">1,236</td>
                <td class="numeric">50</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#caching-fig-19" class="anchor-link">図 19.</a> AppCacheを使用するWebサイト数とHTTP/HTTPSによるService Workerの使用量。</figcaption>
    </figure>
    <h2 id="caching-キャッシングの機会を特定する"><a href="#caching-キャッシングの機会を特定する" class="anchor-link">キャッシングの機会を特定する</a></h2>
    <p>
      Googleの<a href="https://developers.google.com/web/tools/lighthouse">Lighthouse<span class="fn">https://developers.google.com/web/tools/lighthouse</span></a
      >ツールを使用すると、ユーザーはWebページに対して一連の監査を実行できます。<a href="https://developers.google.com/web/tools/lighthouse/audits/cache-policy">キャッシュポリシー監査<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/cache-policy</span></a
      >では、サイトが追加のキャッシュの恩恵を受けることができるかどうかを評価します。これは、コンテンツの経過時間（<code>Last-Modified</code>ヘッダー経由）をキャッシュTTLと比較し、リソースがキャッシュから提供される可能性を推定することによりこれを行います。スコアに応じて、結果にキャッシュの推奨事項が表示され、キャッシュできる特定のリソースのリストが表示される場合があります。
    </p>
    <figure id="caching-fig-20">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/ch16_fig15_lighthouse_example.jpg">
        <img src="/static/images/2019/caching/ch16_fig15_lighthouse_example.jpg" alt="図20.キャッシュポリシーの改善の可能性を強調したLighthouseレポート。" aria-labelledby="caching-fig20-caption" aria-describedby="caching-fig20-description" width="600" height="459" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig20-description" data-show-text="{{ show_description(20) }}" data-hide-text="{{ hide_description(20) }}">{{ show_description(20) }}</button>
      <div id="caching-fig20-description" class="visually-hidden">Google Lighthouseツールからのレポートの一部のスクリーンショット。「効率的なキャッシュポリシーを使用した静的アセットの提供」セクションが開いており、多数のリソース、名前が編集された人、キャッシュTTLとサイズのリストが表示されます。</div>
      <figcaption id="caching-fig20-caption"><a href="#caching-fig-20" class="anchor-link">図 20.</a>キャッシュポリシーの改善の可能性を強調したLighthouseレポート。</figcaption>
    </figure>
    <p>
      Lighthouseは、監査ごとに0％〜100％の範囲のスコアを計算し、それらのスコアは全体のスコアに組み込まれます。<a href="https://developers.google.com/web/tools/lighthouse/audits/cache-policy">キャッシングスコア<span class="fn">https://developers.google.com/web/tools/lighthouse/audits/cache-policy</span></a
      >は、潜在的なバイト節約に基づいています。 Lighthouseの結果を調べると、キャッシュポリシーでどれだけのサイトがうまく機能しているかを把握できます。
    </p>
    <figure id="caching-fig-21">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig21.png">
        <img src="/static/images/2019/caching/fig21.png" alt="図21.モバイルWebページの「Use Long Cache TTL」監査のLighthouseスコアの分布。" aria-labelledby="caching-fig21-caption" aria-describedby="caching-fig21-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=827424070&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig21-description" data-show-text="{{ show_description(21) }}" data-hide-text="{{ hide_description(21) }}">{{ show_description(21) }}</button>
      <div id="caching-fig21-description" class="visually-hidden">積み上げ棒グラフの38.2％のウェブサイトのスコアは10％未満、29.0％のウェブサイトのスコアは10％〜39％、18.7％のウェブサイトのスコアは40％〜79％、10.7％のウェブサイトは80％から99％のスコア、および3.4​​％のWebサイトが100％のスコアを取得します。</div>
      <figcaption id="caching-fig21-caption"><a href="#caching-fig-21" class="anchor-link">図 21.</a>モバイルWebページの「Use Long Cache TTL」監査のLighthouseスコアの分布。</figcaption>
    </figure>
    <p>100％を獲得したサイトは3.4％のみです。これは、ほとんどのサイトがキャッシュの最適化の恩恵を受けることができることを意味します。サイトの圧倒的多数が40％未満で、38％が10％未満のスコアを記録しています。これに基づいて、Webにはかなりの量のキャッシュの機会があります。</p>
    <p>Lighthouseは、より長いキャッシュポリシーを有効にすることで、繰り返しビューで保存できるバイト数も示します。追加のキャッシュの恩恵を受ける可能性のあるサイトのうち、82％がページの重みを最大で1MB削減できます。</p>
    <figure id="caching-fig-22">
      <a href="https://almanac.httparchive.org/static/images/2019/caching/fig22.png">
        <img src="/static/images/2019/caching/fig22.png" alt="図22. Lighthouseキャッシング監査による潜在的なバイト節約の分布。" aria-labelledby="caching-fig21-caption" aria-describedby="caching-fig21-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vT3GWCs19Wq0mu0zgIlKRc8zcXgmVEk2xFHuzZACiWVtqOv8FO5gfHwBxa0mhU6O9TBY8ODdN4Zjd_O/pubchart?oid=1698914500&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig22-description" data-show-text="{{ show_description(22) }}" data-hide-text="{{ hide_description(22) }}">{{ show_description(22) }}</button>
      <div id="caching-fig22-description" class="visually-hidden">Webサイトの56.8％が1MB未満の潜在的なバイト節約を示す積み上げ棒グラフ、22.1％は1〜2MBの節約、8.3％は2〜3MBの節約になります。 4.3％は3〜4MB節約でき、6.0％は4MB以上節約できました。</div>
      <figcaption id="caching-fig22-caption"><a href="#caching-fig-22" class="anchor-link">図 22.</a> Lighthouseキャッシング監査による潜在的なバイト節約の分布。</figcaption>
    </figure>
    <h2 id="caching-結論"><a href="#caching-結論" class="anchor-link">結論</a></h2>
    <p>キャッシングは非常に強力な機能であり、ブラウザ、プロキシ、その他の仲介者（CDNなど）がWebコンテンツを保存し、エンドユーザーへ提供できるようにします。これにより、往復時間が短縮され、コストのかかるネットワーク要求が最小限に抑えられるため、パフォーマンス上のメリットは非常に大きくなります。</p>
    <p>
      キャッシュも非常に複雑なトピックです。キャッシュエントリを検証するだけでなく、新鮮さを伝えることができるHTTPレスポンスヘッダーは多数あります。<code>Cache-Control</code>ディレクティブは、非常に多くの柔軟性と制御を提供します。ただし、開発者は、それがもたらす間違いの追加の機会に注意する必要があります。キャッシュ可能なリソースが適切にキャッシュされていることを確認するためにサイトを定期的に監査することをお勧めします。<a href="https://developers.google.com/web/tools/lighthouse">Lighthouse<span class="fn">https://developers.google.com/web/tools/lighthouse</span></a
      >や<a href="https://redbot.org/">REDbot<span class="fn">https://redbot.org/</span></a
      >などのツールは、分析の簡素化に役立ちます。
    </p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"IV","chapter_number":17,"title":"CDN","description":"CDNの採用と使用法、RTTとTLSの管理、HTTP/2の採用、キャッシング、および共通ライブラリとコンテンツCDNをカバーする2019 Web AlmanacのCDNの章。","authors":["andydavies","colinbendell"],"reviewers":["yoavweiss","paulcalvano","pmeenan","enygren"],"translators":["ksakae"],"discuss":"1772","results":"https://docs.google.com/spreadsheets/d/1Y7kAxjxUl8puuTToe6rL3kqJLX1ftOb0nCcD8m3lZBw/","queries":"17_CDN","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-05-19T00:00:00.000Z","chapter":"cdn"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="cdn-導入"><a href="#cdn-導入" class="anchor-link">導入</a></h2>
    <p>
      「コンテンツ配信ネットワーク」は、Webサイトの読み込みを高速化するための<a href="http://stevesouders.com/examples/rules.php">Steve Soudersによる独自の推奨事項<span class="fn">http://stevesouders.com/examples/rules.php</span></a
      >の1つでした。昨今でも有効なアドバイスです。Web Almanacのこの章ではSteveの推奨事項がどの程度広く採用されているか、サイトがコンテンツ配信ネットワーク（CDN）をどのように使用しているか、およびそれらが使用している機能のいくつかを検討します。
    </p>
    <p>基本的にCDNは待ち時間（パケットがネットワーク上の2つのポイント間、たとえば訪問者のデバイスからサーバーに移動する時間）を短縮します、待ち時間はページの読み込み速度の重要な要素です。</p>
    <p>CDNは、2つの方法で待機時間を短縮します。ユーザーに近い場所からコンテンツを提供すること、2番目はエンドユーザーに近いTCP接続を終了することです。</p>
    <p>歴史的にユーザーからバイトへの論理パスが短くなるように、CDNはバイトのキャッシュまたはコピーに使用されていました。多くの人が要求するファイルは、origin（サーバー）から一度取得してユーザーに近いサーバーへ保存できるため、転送時間を節約できます。</p>
    <p>CDNは、TCP遅延にも役立ちます。 TCPの遅延により、ブラウザーとサーバー間の接続を確立するのにかかる時間、接続を保護するのにかかる時間、および最終的にコンテンツをダウンロードする速度が決まります。せいぜいネットワークパケットは光の速度の約3分の2で移動するため、その往復にかかる時間は通信の両端がどれだけ離れているか、その間に何があるかによって決まります。混雑したネットワーク、過負荷の機器、ネットワークのタイプすべてがさらなる遅延を追加します。 CDNを使用して接続のサーバー側を訪問者の近くに移動すると、この遅延のペナルティが減少し、接続時間、TLSネゴシエーション時間が短縮されコンテンツのダウンロード速度が向上します。</p>
    <p>CDNは、多くの場合、訪問者の近くで静的コンテンツを保存および提供する単なるキャッシュと考えられていますが、さらに多くの機能を備えています。 CDNは、遅延のペナルティを克服するだけでなく、パフォーマンスとセキュリティの向上に役立つ他の機能を提供するものが増えています。</p>
    <ul>
      <li>CDNを使用して動的コンテンツ（ベースHTMLページ、API応答など）をプロキシすることにより、ブラウザーとCDN自身のネットワークとの間の遅延が短縮され、元の速度に戻ることができます。</li>
      <li>一部のCDNは、ページを最適化してダウンロードとレンダリングを高速化する変換を提供するか、画像を最適化して表示するデバイスに適したサイズ（画像の大きさとファイルサイズの両方）に変換します。</li>
      <li><a href="#security">セキュリティ</a>の観点から、悪意のあるトラフィックとボットは要求がoriginへ到達する前にCDNによって除外される可能性があり、その幅広い顧客ベースによりCDNが新しい脅威をより早く発見して対応できることを意味します。</li>
      <li>
        <a href="https://en.wikipedia.org/wiki/Edge_computing">エッジコンピューティング<span class="fn">https://en.wikipedia.org/wiki/Edge_computing</span></a
        >の台頭により、サイトは訪問者の近くで独自のコードを実行できるようになりパフォーマンスが向上し、originの負荷が軽減されました。
      </li>
    </ul>
    <p>最後にCDNもまた、originサーバーがサポートしていない場合でもエッジからブラウザーまでHTTP/2、TLS1.3、またはIPv6を有効にできるなどoriginでの変更を必要とせずにサイトが新しいテクノロジーを採用できるようにします。</p>
    <h3 id="cdn-警告と免責事項"><a href="#cdn-警告と免責事項" class="anchor-link">警告と免責事項</a></h3>
    <p>他の観察研究と同様に、測定できる範囲と影響には限界があります。 Web AlmanacのCDN使用に関して収集された統計は、特定のCDNベンダーのパフォーマンスや有効性を意味するものではありません。</p>
    <p>Web Almanacに使用されるテスト<a href="#methodology">方法</a>には多くの制限があります。これらには以下が含まれます。</p>
    <ul>
      <li><strong>シミュレートされたネットワーク遅延</strong>：Web Almanacは、<a href="#methodology-webpagetest">トラフィックを総合的に形成する</a>専用ネットワーク接続を使用します。</li>
      <li>
        <strong>単一の地理的場所</strong>：テストは<a href="https://httparchive.org/faq#how-is-the-data-gathered">単一のデータセンター<span class="fn">https://httparchive.org/faq#how-is-the-data-gathered</span></a
        >から実行されるため、多くのCDNベンダーの地理的分布をテストすることはできません。
      </li>
      <li><strong>キャッシュの有効性</strong>：各CDNは独自の技術を使用しており、多くの場合、セキュリティ上の理由により、キャッシュのパフォーマンスは公開されていません。</li>
      <li><strong>ローカライゼーションと国際化</strong>：地理的分布と同様に言語、地理固有のドメインの影響もテストに対して不透明です。</li>
      <li>
        <a href="https://github.com/WPO-Foundation/wptagent/blob/master/internal/optimization_checks.py#L51">CDN検出<span class="fn">https://github.com/WPO-Foundation/wptagent/blob/master/internal/optimization_checks.py#L51</span></a
        >は、主にDNS解決とHTTPヘッダーを介して行われます。ほとんどのCDNは、DNS CNAMEを使用してユーザーを最適なデータセンターにマッピングします。ただし、一部のCDNはAnyCast IPを使用するか、DNSチェインを隠す委任されたドメインからのA+AAAA応答を直接使用します。それ以外の場合、Webページは複数のCDNを使用して、<a href="#methodology-webpagetest">WebPageTest</a>のシングルリクエストパスから隠されているベンダー間でバランスを取ります。これらはすべて、測定の有効性を制限します。
      </li>
    </ul>
    <p>最も重要なことは、これらの結果は潜在的な使用率を反映しているが、実際の影響を反映していないことです。 YouTubeは「ShoesByColin」よりも人気がありますが、使用率を比較するとどちらも同じ値として表示されます。</p>
    <p>これを念頭に置いて、CDNのコンテキストで測定されなかったいくつかの意図的な統計があります。</p>
    <ul>
      <li><strong>TTFB</strong>：CDNによる最初のバイトまでの時間について、キャッシュ可能とキャッシュの有効性についての正しい知識がなければ正しく測定できません。1つのサイトには、<strong>ラウンドトリップタイム</strong>（RTT）の管理にCDNを使用してるがキャッシュには使用してない場合、別のCDNベンダーを使用してコンテンツをキャッシュしてる別サイトと比較する時不利になります（注：これは、個々のCDNの<a href="#performance-最初のバイトまでの時間time-to-first-byte-ttfb">パフォーマンス</a>についての結論を出していないので、パフォーマンスの章でTTFB分析には適用されません）。</li>
      <li><strong>キャッシュヒットとキャッシュミスのパフォーマンス</strong>：前述のようにこれは正確にテストできません、なのでコールドキャッシュとホットキャッシュでページのパフォーマンステストを繰り返すことは信頼できません。</li>
    </ul>
    <h3 id="cdn-さらなる統計"><a href="#cdn-さらなる統計" class="anchor-link">さらなる統計</a></h3>
    <p>Web Almanacの将来のバージョンでは、CDNベンダー間のTLSおよびRTTの管理をより詳細に検討する予定です。興味深いのは、OCSP Staplingの影響、TLS暗号パフォーマンスの違いです。 CWND（TCP輻輳ウィンドウ）成長率、特にBBR v1、v2、従来のTCP Cubicの採用。</p>
    <h2 id="cdn-cdnの採用と使い方"><a href="#cdn-cdnの採用と使い方" class="anchor-link">CDNの採用と使い方</a></h2>
    <p>ウェブサイトの場合、CDNはプライマリドメイン（<code>www.shoesbycolin.com</code>）、サブドメインまたは兄弟ドメイン（<code>images.shoesbycolin.com</code>または<code>checkout.shoesbycolin.com</code>）、そして最後にサードパーティ（Google Analyticsなど）のパフォーマンスを改善できます。これらの各ユースケースにCDNを使用すると、さまざまな方法でパフォーマンスが向上します。</p>
    <p>歴史的に、CDNは<a href="#css">CSS</a>、<a href="#javascript">JavaScript</a>、<a href="#media">画像</a>などの静的リソース専用に使用されていました。これらのリソースはおそらくバージョン管理され（パスに一意の番号を含む）、長期的にキャッシュされます。このようにして、ベースHTMLドメインと比較して、サブドメインまたは兄弟ドメインでのCDNの採用が増加することを期待する必要があります。従来のデザインパターンでは、<code>www.shoesbycolin.com</code>がデータセンター（又は<strong>origin</strong>）から直接HTMLを提供し、<code>static.shoesbycolin.com</code>がCDNを使用することを想定していました。</p>
    <figure id="cdn-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig1.png">
        <img src="/static/images/2019/cdn/fig1.png" alt="図 1. CDN使用量 vs. originがホストするリソース" aria-labelledby="cdn-fig1-caption" aria-describedby="cdn-fig1-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=777938536&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="cdn-fig1-description" class="visually-hidden">HTMLがoriginから提供される80％、CDNから20％、サブドメインが61％と39％、サードパーティが34％と66％である積層棒グラフ。</div>
      <figcaption id="cdn-fig1-caption"><a href="#cdn-fig-1" class="anchor-link">図 1.</a> CDN使用量 vs. originがホストするリソース</figcaption>
    </figure>
    <p>実際、この伝統的なパターンは、クロールされたWebサイトの大部分で見られるものです。 Webページの大部分（80％）は、元のベースHTMLを提供しています。この内訳はモバイルとデスクトップでほぼ同じであり、デスクトップでのCDNの使用率は0.4％しか低下していません。このわずかな差異は、CDNをより頻繁に使用するモバイル固有のWebページ（「mDot」）の小規模な継続使用に起因する可能性があります。</p>
    <p>同様に、サブドメインから提供されるリソースは、サブドメインリソースの40％でCDNを利用する可能性が高くなります。サブドメインは、画像やCSSなどのリソースを分割するために使用されるか、チェックアウトやAPIなどの組織チームを反映するために使用されます。</p>
    <p>ファーストパーティのリソースの大部分は依然としてoriginから直接提供されていますが、サードパーティのリソースはCDNの採用が大幅に増えています。すべてのサードパーティリソースのほぼ66％がCDNから提供されています。サードパーティのドメインはSaaS統合である可能性が高いため、CDNの使用はこれらのビジネス製品のコアになる可能性が高くなります。ほとんどのサードパーティコンテンツは共有リソース（JavaScriptまたはフォントCDN）、拡張コンテンツ（広告）、または統計に分類されます。これらすべての場合においてCDNを使用すると、SaaSソリューションのパフォーマンスとオフロードが向上します。</p>
    <h2 id="cdn-トップcdnプロバイダー"><a href="#cdn-トップcdnプロバイダー" class="anchor-link">トップCDNプロバイダー</a></h2>
    <p>CDNプロバイダーには、汎用CDNと目的別CDNの2つのカテゴリがあります。汎用CDNプロバイダーは、多くの業界のあらゆる種類のコンテンツを提供するカスタマイズと柔軟性を提供します。対照的に、目的に合ったCDNプロバイダーは同様のコンテンツ配信機能を提供しますが、特定のソリューションに焦点を絞っています。</p>
    <p>これは、ベースHTMLコンテンツを提供していることが判明した上位のCDNを見ると明確に表されています。 HTMLを提供する最も頻繁なCDNは、汎用CDN（Cloudflare、Akamai、Fastly）およびプラットフォームサービスの一部としてバンドルされたCDN（Google、Amazon）を提供するクラウドソリューションプロバイダーです。対照的に、WordpressやNetlifyなど、ベースHTMLマークアップを提供する目的に合ったCDNプロバイダーはわずかです。</p>
    <p class="note">注：これにはトラフィックや使用量は反映されず、それらを使用するサイトの数のみが反映されます。</p>
    <figure id="cdn-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/html_cdn_usage.png">
        <img alt="ベースHTMLページの提供に使用される最も人気のあるCDN" aria-labelledby="cdn-fig2-caption" aria-describedby="cdn-fig2-description" src="/static/images/2019/cdn/html_cdn_usage.png" width="600" height="371" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="cdn-fig2-description" class="visually-hidden">表3のデータを示すツリーマップグラフ。</div>
      <figcaption id="cdn-fig2-caption">図 2: HTML CDNの使用</figcaption>
    </figure>
    <figure id="cdn-fig-3">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">HTML CDNの使用率 (%)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>ORIGIN</td>
                <td class="numeric">80.39</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td class="numeric">9.61</td>
              </tr>
              <tr>
                <td>Google</td>
                <td class="numeric">5.54</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td class="numeric">1.08</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td class="numeric">1.05</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td class="numeric">0.79</td>
              </tr>
              <tr>
                <td>WordPress</td>
                <td class="numeric">0.37</td>
              </tr>
              <tr>
                <td>Sucuri Firewall</td>
                <td class="numeric">0.31</td>
              </tr>
              <tr>
                <td>Incapsula</td>
                <td class="numeric">0.28</td>
              </tr>
              <tr>
                <td>Myra Security CDN</td>
                <td class="numeric">0.1</td>
              </tr>
              <tr>
                <td>OVH CDN</td>
                <td class="numeric">0.08</td>
              </tr>
              <tr>
                <td>Netlify</td>
                <td class="numeric">0.06</td>
              </tr>
              <tr>
                <td>Edgecast</td>
                <td class="numeric">0.04</td>
              </tr>
              <tr>
                <td>GoCache</td>
                <td class="numeric">0.03</td>
              </tr>
              <tr>
                <td>Highwinds</td>
                <td class="numeric">0.03</td>
              </tr>
              <tr>
                <td>CDNetworks</td>
                <td class="numeric">0.02</td>
              </tr>
              <tr>
                <td>Limelight</td>
                <td class="numeric">0.01</td>
              </tr>
              <tr>
                <td>Level 3</td>
                <td class="numeric">0.01</td>
              </tr>
              <tr>
                <td>NetDNA</td>
                <td class="numeric">0.01</td>
              </tr>
              <tr>
                <td>StackPath</td>
                <td class="numeric">0.01</td>
              </tr>
              <tr>
                <td>Instart Logic</td>
                <td class="numeric">0.01</td>
              </tr>
              <tr>
                <td>Azion</td>
                <td class="numeric">0.01</td>
              </tr>
              <tr>
                <td>Yunjiasu</td>
                <td class="numeric">0.01</td>
              </tr>
              <tr>
                <td>section.io</td>
                <td class="numeric">0.01</td>
              </tr>
              <tr>
                <td>Microsoft Azure</td>
                <td class="numeric">0.01</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cdn-fig-3" class="anchor-link">図 3.</a>サイトごとのHTML上位25のCDN。</figcaption>
    </figure>
    <p>サブドメインリクエストの構成は非常に似ています。多くのWebサイトは静的コンテンツにサブドメインを使用しているため、CDNの使用量は増加する傾向があります。ベースページリクエストと同様に、これらのサブドメインから提供されるリソースは、一般的なCDN提供を利用します。</p>
    <figure id="cdn-fig-4">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/subdomain_resource_cdn_usage.png">
        <img alt="サブドメインから提供されるリソースに使用される最も一般的なCDN" aria-labelledby="cdn-fig4-caption" aria-describedby="cdn-fig4-description" src="/static/images/2019/cdn/subdomain_resource_cdn_usage.png" width="600" height="371" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig4-description" data-show-text="{{ show_description(4) }}" data-hide-text="{{ hide_description(4) }}">{{ show_description(4) }}</button>
      <div id="cdn-fig4-description" class="visually-hidden">表5のデータを示すツリーマップグラフ。</div>
      <figcaption id="cdn-fig4-caption"><a href="#cdn-fig-4" class="anchor-link">図 4.</a>サブドメインリソースのCDNの使用。</figcaption>
    </figure>
    <figure id="cdn-fig-5">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">サブドメインのCDN使用率(%)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>ORIGIN</td>
                <td class="numeric">60.56</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td class="numeric">10.06</td>
              </tr>
              <tr>
                <td>Google</td>
                <td class="numeric">8.86</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td class="numeric">6.24</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td class="numeric">3.5</td>
              </tr>
              <tr>
                <td>Edgecast</td>
                <td class="numeric">1.97</td>
              </tr>
              <tr>
                <td>WordPress</td>
                <td class="numeric">1.69</td>
              </tr>
              <tr>
                <td>Highwinds</td>
                <td class="numeric">1.24</td>
              </tr>
              <tr>
                <td>Limelight</td>
                <td class="numeric">1.18</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td class="numeric">0.8</td>
              </tr>
              <tr>
                <td>CDN77</td>
                <td class="numeric">0.43</td>
              </tr>
              <tr>
                <td>KeyCDN</td>
                <td class="numeric">0.41</td>
              </tr>
              <tr>
                <td>NetDNA</td>
                <td class="numeric">0.37</td>
              </tr>
              <tr>
                <td>CDNetworks</td>
                <td class="numeric">0.36</td>
              </tr>
              <tr>
                <td>Incapsula</td>
                <td class="numeric">0.29</td>
              </tr>
              <tr>
                <td>Microsoft Azure</td>
                <td class="numeric">0.28</td>
              </tr>
              <tr>
                <td>Reflected Networks</td>
                <td class="numeric">0.28</td>
              </tr>
              <tr>
                <td>Sucuri Firewall</td>
                <td class="numeric">0.16</td>
              </tr>
              <tr>
                <td>BunnyCDN</td>
                <td class="numeric">0.13</td>
              </tr>
              <tr>
                <td>OVH CDN</td>
                <td class="numeric">0.12</td>
              </tr>
              <tr>
                <td>Advanced Hosters CDN</td>
                <td class="numeric">0.1</td>
              </tr>
              <tr>
                <td>Myra Security CDN</td>
                <td class="numeric">0.07</td>
              </tr>
              <tr>
                <td>CDNvideo</td>
                <td class="numeric">0.07</td>
              </tr>
              <tr>
                <td>Level 3</td>
                <td class="numeric">0.06</td>
              </tr>
              <tr>
                <td>StackPath</td>
                <td class="numeric">0.06</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption>表5のデータを示すツリーマップグラフ。</figcaption>
    </figure>
    <p>上位CDNプロバイダーの構成は、サードパーティのリソースに対して劇的に変化します。サードパーティのリソースをホストするCDNが頻繁に監視されるだけでなく、Facebook、Twitter、Googleなどの目的に合ったCDNプロバイダーも増加しています。</p>
    <figure id="cdn-fig-6">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/thirdparty_resource_cdn_usage.png">
        <img alt="サードパーティのリソースで使用される最も人気のあるCDN" aria-labelledby="cdn-fig6-caption" aria-describedby="cdn-fig6-description" src="/static/images/2019/cdn/thirdparty_resource_cdn_usage.png" width="600" height="376" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig6-description" data-show-text="{{ show_description(6) }}" data-hide-text="{{ hide_description(6) }}">{{ show_description(6) }}</button>
      <div id="cdn-fig6-description" class="visually-hidden">表7のデータを示すツリーマップグラフ。</div>
      <figcaption id="cdn-fig6-caption"><a href="#cdn-fig-6" class="anchor-link">図 6.</a>サードパーティのリソースCDN使用。</figcaption>
    </figure>
    <figure id="cdn-fig-7">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">サードパーティのCDN使用率(%)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>ORIGIN</td>
                <td class="numeric">34.27</td>
              </tr>
              <tr>
                <td>Google</td>
                <td class="numeric">29.61</td>
              </tr>
              <tr>
                <td>Facebook</td>
                <td class="numeric">8.47</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td class="numeric">5.25</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td class="numeric">5.14</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td class="numeric">4.21</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td class="numeric">3.87</td>
              </tr>
              <tr>
                <td>WordPress</td>
                <td class="numeric">2.06</td>
              </tr>
              <tr>
                <td>Edgecast</td>
                <td class="numeric">1.45</td>
              </tr>
              <tr>
                <td>Twitter</td>
                <td class="numeric">1.27</td>
              </tr>
              <tr>
                <td>Highwinds</td>
                <td class="numeric">0.94</td>
              </tr>
              <tr>
                <td>NetDNA</td>
                <td class="numeric">0.77</td>
              </tr>
              <tr>
                <td>Cedexis</td>
                <td class="numeric">0.3</td>
              </tr>
              <tr>
                <td>CDNetworks</td>
                <td class="numeric">0.22</td>
              </tr>
              <tr>
                <td>section.io</td>
                <td class="numeric">0.22</td>
              </tr>
              <tr>
                <td>jsDelivr</td>
                <td class="numeric">0.2</td>
              </tr>
              <tr>
                <td>Microsoft Azure</td>
                <td class="numeric">0.18</td>
              </tr>
              <tr>
                <td>Yahoo</td>
                <td class="numeric">0.18</td>
              </tr>
              <tr>
                <td>BunnyCDN</td>
                <td class="numeric">0.17</td>
              </tr>
              <tr>
                <td>CDNvideo</td>
                <td class="numeric">0.16</td>
              </tr>
              <tr>
                <td>Reapleaf</td>
                <td class="numeric">0.15</td>
              </tr>
              <tr>
                <td>CDN77</td>
                <td class="numeric">0.14</td>
              </tr>
              <tr>
                <td>KeyCDN</td>
                <td class="numeric">0.13</td>
              </tr>
              <tr>
                <td>Azion</td>
                <td class="numeric">0.09</td>
              </tr>
              <tr>
                <td>StackPath</td>
                <td class="numeric">0.09</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cdn-fig-7" class="anchor-link">図 7.</a>サードパーティのリクエストの上位25のリソースCDN。</figcaption>
    </figure>
    <h2 id="cdn-rttとtls管理"><a href="#cdn-rttとtls管理" class="anchor-link">RTTとTLS管理</a></h2>
    <p>
      CDNは、Webサイトのパフォーマンスのために単純なキャッシング以上のものを提供できます。多くのCDNは、コンテンツのキャッシュを禁止する法的要件またはその他のビジネス要件がある場合、動的またはパーソナライズされたコンテンツのパススルーモードもサポートします。 CDNの物理的な配布を利用すると、エンドユーザーのTCP RTTのパフォーマンスが向上します。<a href="https://www.igvita.com/2012/07/19/latency-the-new-web-performance-bottleneck/">他の人が指摘したように<span class="fn">https://www.igvita.com/2012/07/19/latency-the-new-web-performance-bottleneck/</span></a
      >、<a href="https://hpbn.co/primer-on-latency-and-bandwidth/">RTTを減らすことは、帯域幅を増やすことに比べてWebページのパフォーマンスを向上させる最も効果的な手段です<span class="fn">https://hpbn.co/primer-on-latency-and-bandwidth/</span></a
      >。
    </p>
    <p>この方法でCDNを使用すると、次の2つの方法でページのパフォーマンスを改善できます。</p>
    <ol>
      <li>
        <p>TCPおよびTLSネゴシエーションのRTTを削減します。光の速度は非常に高速であり、CDNはエンドユーザーにより近い、高度に分散したデータセンターのセットを提供します。このようにして、TCP接続をネゴシエートしてTLSハンドシェイクを実行するためにパケットを通過する必要がある論理（そして物理）距離を大幅に短縮できます。</p>
        <p>RTTの削減には、3つの直接的な利点があります。まず、TCP + TLS接続時間はRTTにバインドされているため、ユーザーがデータを受信する時間を短縮します。第二に、これにより輻輳ウィンドウを拡大し、ユーザーが利用できる帯域幅を最大限活用するのにかかる時間が改善されます。最後に、パケット損失の可能性を減らします。 RTTが高い場合、ネットワークインタフェースは要求をタイムアウトし、パケットを再送信します。これにより、二重パケットを配信される可能性があります。</p>
      </li>
      <li><p>CDNは、バックエンドoriginへの事前に暖められたTCP接続を利用できます。ユーザーに近い接続を終了すると、輻輳ウィンドウの拡大にかかる時間が改善されるのと同様に、CDNは輻輳ウィンドウを既に最大化して事前に確立したTCP接続で要求をoriginにリレーできます。このようにして、originはより少ないTCPラウンドトリップで動的コンテンツを返すことができ、コンテンツを待機中のユーザーに配信する準備をより効果的に行うことができます。</p></li>
    </ol>
    <h2 id="cdn-tlsネゴシエーション時間：originはcdnの3倍遅い"><a href="#cdn-tlsネゴシエーション時間：originはcdnの3倍遅い" class="anchor-link">TLSネゴシエーション時間：originはCDNの3倍遅い</a></h2>
    <p>TLSネゴシエーションでは、サーバーからデータを送信する前に複数のTCPラウンドトリップが必要になるため、RTTを改善するだけでページのパフォーマンスを大幅に改善できます。たとえば、ベースHTMLページを見ると、発信元リクエストのTLSネゴシエーション時間の中央値は207ミリ秒です（デスクトップWebPageTestの場合）。これだけで、2秒のパフォーマンス予算の10％を占めます。これは、要求に遅延が適用されない理想的なネットワーク条件下です。</p>
    <p>対照的に、大半のCDNプロバイダーのTLSネゴシエーションの中央値は60〜70ミリ秒です。 HTMLページに対するOrigin要求は、CDNを使用するWebページよりも、TLSネゴシエーションを完了するのにほぼ3倍時間がかかります。 90パーセンタイルでも、140ミリ秒未満で完了するほとんどのCDNと比較して、この格差は427ミリ秒のoriginTLSネゴシエーションレートで永続します。</p>
    <p class="note">これらのチャートを解釈する際の注意事項：実際のTLSネゴシエーションのパフォーマンスに影響する多くの要因があるため、ベンダーを比較するとき、桁の違いに焦点を合わせることが重要です。これらのテストは、制御された条件下で単一のデータセンターから完了したものであり、インターネットおよびユーザーエクスペリエンスの変動を反映していません。</p>
    <figure id="cdn-fig-8">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/html_tls_negotiation_time.png">
        <img alt="CDNによって分類された初期HTML要求のTLSネゴシエーション時間の分布" aria-labelledby="cdn-fig8-caption" aria-describedby="cdn-fig8-description" src="/static/images/2019/cdn/html_tls_negotiation_time.png" width="600" height="371" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig8-description" data-show-text="{{ show_description(8) }}" data-hide-text="{{ hide_description(8) }}">{{ show_description(8) }}</button>
      <div id="cdn-fig8-description" class="visually-hidden">表9のデータを示すグラフ。</div>
      <figcaption id="cdn-fig8-caption"><a href="#cdn-fig-8" class="anchor-link">図 8.</a> HTML TLSネゴシエーション時間。</figcaption>
    </figure>
    <figure id="cdn-fig-9">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">p10</th>
                <th scope="col">p25</th>
                <th scope="col">p50</th>
                <th scope="col">p75</th>
                <th scope="col">p90</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Highwinds</td>
                <td class="numeric">58</td>
                <td class="numeric">58</td>
                <td class="numeric">60</td>
                <td class="numeric">66</td>
                <td class="numeric">94</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td class="numeric">56</td>
                <td class="numeric">59</td>
                <td class="numeric">63</td>
                <td class="numeric">69</td>
                <td class="numeric">75</td>
              </tr>
              <tr>
                <td>WordPress</td>
                <td class="numeric">58</td>
                <td class="numeric">62</td>
                <td class="numeric">76</td>
                <td class="numeric">77</td>
                <td class="numeric">80</td>
              </tr>
              <tr>
                <td>Sucuri Firewall</td>
                <td class="numeric">63</td>
                <td class="numeric">66</td>
                <td class="numeric">77</td>
                <td class="numeric">80</td>
                <td class="numeric">86</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td class="numeric">59</td>
                <td class="numeric">61</td>
                <td class="numeric">62</td>
                <td class="numeric">83</td>
                <td class="numeric">128</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td class="numeric">62</td>
                <td class="numeric">68</td>
                <td class="numeric">80</td>
                <td class="numeric">92</td>
                <td class="numeric">103</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td class="numeric">57</td>
                <td class="numeric">59</td>
                <td class="numeric">72</td>
                <td class="numeric">93</td>
                <td class="numeric">134</td>
              </tr>
              <tr>
                <td>Microsoft Azure</td>
                <td class="numeric">62</td>
                <td class="numeric">93</td>
                <td class="numeric">97</td>
                <td class="numeric">98</td>
                <td class="numeric">101</td>
              </tr>
              <tr>
                <td>Edgecast</td>
                <td class="numeric">94</td>
                <td class="numeric">97</td>
                <td class="numeric">100</td>
                <td class="numeric">110</td>
                <td class="numeric">221</td>
              </tr>
              <tr>
                <td>Google</td>
                <td class="numeric">47</td>
                <td class="numeric">53</td>
                <td class="numeric">79</td>
                <td class="numeric">119</td>
                <td class="numeric">184</td>
              </tr>
              <tr>
                <td>OVH CDN</td>
                <td class="numeric">114</td>
                <td class="numeric">115</td>
                <td class="numeric">118</td>
                <td class="numeric">120</td>
                <td class="numeric">122</td>
              </tr>
              <tr>
                <td>section.io</td>
                <td class="numeric">105</td>
                <td class="numeric">108</td>
                <td class="numeric">112</td>
                <td class="numeric">120</td>
                <td class="numeric">210</td>
              </tr>
              <tr>
                <td>Incapsula</td>
                <td class="numeric">96</td>
                <td class="numeric">100</td>
                <td class="numeric">111</td>
                <td class="numeric">139</td>
                <td class="numeric">243</td>
              </tr>
              <tr>
                <td>Netlify</td>
                <td class="numeric">53</td>
                <td class="numeric">64</td>
                <td class="numeric">73</td>
                <td class="numeric">145</td>
                <td class="numeric">166</td>
              </tr>
              <tr>
                <td>Myra Security CDN</td>
                <td class="numeric">95</td>
                <td class="numeric">106</td>
                <td class="numeric">118</td>
                <td class="numeric">226</td>
                <td class="numeric">365</td>
              </tr>
              <tr>
                <td>GoCache</td>
                <td class="numeric">217</td>
                <td class="numeric">219</td>
                <td class="numeric">223</td>
                <td class="numeric">234</td>
                <td class="numeric">260</td>
              </tr>
              <tr>
                <td><em>ORIGIN</em></td>
                <td class="numeric"><em>100</em></td>
                <td class="numeric"><em>138</em></td>
                <td class="numeric"><em>207</em></td>
                <td class="numeric"><em>342</em></td>
                <td class="numeric"><em>427</em></td>
              </tr>
              <tr>
                <td>CDNetworks</td>
                <td class="numeric">85</td>
                <td class="numeric">143</td>
                <td class="numeric">229</td>
                <td class="numeric">369</td>
                <td class="numeric">452</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cdn-fig-9" class="anchor-link">図 9.</a> HTML TLS接続時間（ミリ秒）。</figcaption>
    </figure>
    <p>リソース要求（同一ドメインおよびサードパーティを含む）の場合、TLSネゴシエーション時間が長くなり、差異が増加します。これは、ネットワークの飽和とネットワークの輻輳のためと予想されます。サードパーティの接続が確立されるまでに（リソースヒントまたはリソースリクエストにより）、ブラウザはレンダリングと他の並列リクエストの実行でビジー状態となります。これにより、ネットワーク上で競合が発生します。この欠点にもかかわらず、originソリューションを使用するよりもCDNを使用するサードパーティリソースに明らかな利点があります。</p>
    <figure id="cdn-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/resource_tls_negotiation_time.png">
        <img alt="CDNによって分類されたサイトリソースのTLSネゴシエーション時間の分布" aria-labelledby="cdn-fig10-caption" aria-describedby="cdn-fig10-description" src="/static/images/2019/cdn/resource_tls_negotiation_time.png" width="600" height="371" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="cdn-fig10-description" class="visually-hidden">ほとんどのCDNを示すグラフのTLSネゴシエーション時間は約80ミリ秒ですが、一部（Microsoft Azure、Yahoo、Edgecast、ORIGIN、およびCDNetworks）は、特にp50パーセンタイルを超えると、200ミリ秒に向かって徐々に変化し始めます。</div>
      <figcaption id="cdn-fig10-caption"><a href="#cdn-fig-10" class="anchor-link">図 10.</a>リソースTLSネゴシエーション時間。</figcaption>
    </figure>
    <p>TLSハンドシェイクのパフォーマンスは、さまざまな要因の影響を受けます。これらには、RTT、TLSレコードサイズ、およびTLS証明書サイズが含まれます。 RTTはTLSハンドシェイクに最大の影響を与えますが、TLSパフォーマンスの2番目に大きな要因はTLS証明書のサイズです。</p>
    <p>
      <a href="https://hpbn.co/transport-layer-security-tls/#tls-handshake">TLSハンドシェイク<span class="fn">https://hpbn.co/transport-layer-security-tls/#tls-handshake</span></a
      >の最初のラウンドトリップ中に、サーバーは証明書を添付します。この証明書は、次へ進む前にクライアントによって検証されます。この証明書交換では、サーバーは検証可能な証明書チェインを含む場合があります。この証明書の交換後、通信を暗号化するために追加のキーが確立されます。ただし、証明書の長さとサイズはTLSネゴシエーションのパフォーマンスに悪影響を与え、場合によってはクライアントライブラリをクラッシュさせる可能性があります。
    </p>
    <p>
      証明書の交換はTLSハンドシェイクの基礎であり、通常、エクスプロイトの攻撃対象領域を最小限に抑えるため、分離されたコードパスによって処理されます。低レベルの性質のため、バッファは通常動的に割り当てられず、固定されます。この方法では、クライアントが無制限のサイズの証明書を処理できると単純に想定することはできません。たとえば、OpenSSL CLIツールとSafariは<a href="https://10000-sans.badssl.com"><code>https://10000-sans.badssl.com</code><span class="fn">https://10000-sans.badssl.com</span></a
      >に対して正常にネゴシエートできます。ただし、証明書のサイズが原因でChromeとFirefoxは失敗します。
    </p>
    <p>極端なサイズの証明書は障害を引き起こす可能性がありますが、適度に大きな証明書を送信してもパフォーマンスに影響があります。証明書は、<code>Subject-Alternative-Name</code>（SAN）にリストされている1つ以上のホスト名に対して有効です。 SANが多いほど、証明書は大きくなります。パフォーマンスの低下を引き起こすのは、検証中のこれらのSANの処理です。明確にするため、証明書サイズのパフォーマンスはTCPオーバーヘッドに関するものではなく、クライアントの処理パフォーマンスに関するものです。</p>
    <p>技術的に、TCPスロースタートはこのネゴシエーションに影響を与える可能性がありますが、そんなことはありません。 TLSレコードの長さは16KBに制限されており、通常の初期の10の輻輳ウィンドウに適合します。一部のISPはパケットスプライサーを使用し、他のツールは輻輳ウィンドウを断片化して帯域幅を人為的に絞る場合がありますが、これはWebサイトの所有者が変更または操作できるものではありません。</p>
    <p>ただし、多くのCDNは共有TLS証明書に依存しており、証明書のSANの多くの顧客をリストします。これはIPv4アドレスが不足しているため、必要になることがよくあります。エンドユーザーが<code>Server-Name-Indicator</code>（SNI）を採用する前は、クライアントはサーバーに接続し証明書を検査した後にのみ、クライアントはユーザーが探しているホスト名を示唆します（HTTPで<code>Host</code>ヘッダーを使用する）。これにより、IPアドレスと証明書が1：1で関連付けられます。物理的な場所が多数あるCDNの場合、各場所に専用IPが必要になる可能性があり、IPv4アドレスの枯渇をさらに悪化させます。したがって、SNIをサポートしていないユーザーがまだいるWebサイトにCDNがTLS証明書を提供する最も簡単で効率的な方法は、共有証明書を提供することです。</p>
    <p>
      アカマイによると、SNIの採用はまだ世界的に<a href="https://datatracker.ietf.org/meeting/101/materials/slides-101-maprg-update-on-tls-sni-and-ipv6-client-adoption-00">100％ではありません<span class="fn">https://datatracker.ietf.org/meeting/101/materials/slides-101-maprg-update-on-tls-sni-and-ipv6-client-adoption-00</span></a
      >。幸いなことに、近年急速な変化がありました。最大の犯人はもはやWindows XPとVistaではなく、Androidアプリ、ボット、および企業アプリケーションです。SNI採用率が99％であっても、インターネット上の35億人のユーザーの残り1％は、Webサイトの所有者が非SNI証明書を要求する非常に魅力的な動機を生み出すことができます。別の言い方をすれば、特定製品、活動に注力してる(pure play)Webサイトは、標準ブラウザ間でほぼ100％SNIを採用できます。それでもアプリ、特にAndroidアプリでAPIまたはWebViewをサポートするためにWebサイトが使用されている場合、この分布は急速に低下する可能性があります。
    </p>
    <p>
      ほとんどのCDNは、共有証明書の必要性とパフォーマンスのバランスをとります。ほとんどの場合、SANの数の上限は100〜150です。この制限は多くの場合、証明書プロバイダーに由来します。たとえば、<a href="https://letsencrypt.org/docs/rate-limits/">LetsEncrypt<span class="fn">https://letsencrypt.org/docs/rate-limits/</span></a
      >、<a href="https://www.websecurity.digicert.com/security-topics/san-ssl-certificates">DigiCert<span class="fn">https://www.websecurity.digicert.com/security-topics/san-ssl-certificates</span></a
      >、<a href="https://www.godaddy.com/web-security/multi-domain-san-ssl-certificate">GoDaddy<span class="fn">https://www.godaddy.com/web-security/multi-domain-san-ssl-certificate</span></a
      >はすべて、SAN証明書を100個のホスト名に制限しますが、<a href="https://comodosslstore.com/comodo-mdc-ssl.aspx">Comodo<span class="fn">https://comodosslstore.com/comodo-mdc-ssl.aspx</span></a
      >の制限は2,000個です。これにより、一部のCDNがこの制限を超えて、単一の証明書で800を超えるSANを使用できるようになります。 TLSパフォーマンスと証明書のSANの数には強い負の相関があります。
    </p>
    <figure id="cdn-fig-11">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig11.png">
        <img src="/static/images/2019/cdn/fig11.png" alt="図11. HTMLのTLS SANカウント。" aria-labelledby="cdn-fig11-caption" aria-describedby="cdn-fig11-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=753130748&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig11-description" data-show-text="{{ show_description(11) }}" data-hide-text="{{ hide_description(11) }}">{{ show_description(11) }}</button>
      <div id="cdn-fig11-description" class="visually-hidden">表12のデータを示す棒グラフ。</div>
      <figcaption id="cdn-fig11-caption"><a href="#cdn-fig-11" class="anchor-link">図 11.</a> HTMLのTLS SANカウント。</figcaption>
    </figure>
    <figure id="cdn-fig-12">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">p10</th>
                <th scope="col">p25</th>
                <th scope="col">p50</th>
                <th scope="col">p75</th>
                <th scope="col">p90</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>section.io</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
              </tr>
              <tr>
                <td>ORIGIN</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">7</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">8</td>
              </tr>
              <tr>
                <td>WordPress</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
              </tr>
              <tr>
                <td>Sucuri Firewall</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
              </tr>
              <tr>
                <td>Netlify</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">3</td>
              </tr>
              <tr>
                <td>Highwinds</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
              </tr>
              <tr>
                <td>GoCache</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">4</td>
              </tr>
              <tr>
                <td>Google</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">3</td>
                <td class="numeric">53</td>
              </tr>
              <tr>
                <td>OVH CDN</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">3</td>
                <td class="numeric">8</td>
                <td class="numeric">19</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">3</td>
                <td class="numeric">39</td>
                <td class="numeric">59</td>
              </tr>
              <tr>
                <td>Microsoft Azure</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">43</td>
                <td class="numeric">47</td>
              </tr>
              <tr>
                <td>Edgecast</td>
                <td class="numeric">2</td>
                <td class="numeric">4</td>
                <td class="numeric">46</td>
                <td class="numeric">56</td>
                <td class="numeric">130</td>
              </tr>
              <tr>
                <td>Incapsula</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">11</td>
                <td class="numeric">78</td>
                <td class="numeric">140</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td class="numeric">2</td>
                <td class="numeric">18</td>
                <td class="numeric">57</td>
                <td class="numeric">85</td>
                <td class="numeric">95</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">77</td>
                <td class="numeric">100</td>
                <td class="numeric">100</td>
              </tr>
              <tr>
                <td>Myra Security CDN</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">18</td>
                <td class="numeric">139</td>
                <td class="numeric">145</td>
              </tr>
              <tr>
                <td>CDNetworks</td>
                <td class="numeric">2</td>
                <td class="numeric">7</td>
                <td class="numeric">100</td>
                <td class="numeric">360</td>
                <td class="numeric">818</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cdn-fig-12" class="anchor-link">図 12.</a> HTMLのTLS SANカウント。</figcaption>
    </figure>
    <figure id="cdn-fig-13">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig13.png">
        <img src="/static/images/2019/cdn/fig13.png" alt="図13.リソースSANカウント（p50）。" aria-labelledby="cdn-fig13-caption" aria-describedby="cdn-fig13-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=528008536&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig13-description" data-show-text="{{ show_description(13) }}" data-hide-text="{{ hide_description(13) }}">{{ show_description(13) }}</button>
      <div id="cdn-fig13-description" class="visually-hidden">p50パーセンタイルの表14のデータを示す棒グラフ。</div>
      <figcaption id="cdn-fig13-caption"><a href="#cdn-fig-13" class="anchor-link">図 13.</a>リソースSANカウント（p50）。</figcaption>
    </figure>
    <figure id="cdn-fig-14">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">p10</th>
                <th scope="col">p25</th>
                <th scope="col">p50</th>
                <th scope="col">p75</th>
                <th scope="col">p90</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>section.io</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
              </tr>
              <tr>
                <td>ORIGIN</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">3</td>
                <td class="numeric">10</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td class="numeric">1</td>
                <td class="numeric">1</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">6</td>
              </tr>
              <tr>
                <td>Highwinds</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">3</td>
                <td class="numeric">79</td>
              </tr>
              <tr>
                <td>WordPress</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
              </tr>
              <tr>
                <td>NetDNA</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
              </tr>
              <tr>
                <td>CDN77</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">10</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td class="numeric">2</td>
                <td class="numeric">3</td>
                <td class="numeric">3</td>
                <td class="numeric">3</td>
                <td class="numeric">35</td>
              </tr>
              <tr>
                <td>Edgecast</td>
                <td class="numeric">2</td>
                <td class="numeric">4</td>
                <td class="numeric">4</td>
                <td class="numeric">4</td>
                <td class="numeric">4</td>
              </tr>
              <tr>
                <td>Twitter</td>
                <td class="numeric">2</td>
                <td class="numeric">4</td>
                <td class="numeric">4</td>
                <td class="numeric">4</td>
                <td class="numeric">4</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">5</td>
                <td class="numeric">20</td>
                <td class="numeric">54</td>
              </tr>
              <tr>
                <td>Google</td>
                <td class="numeric">1</td>
                <td class="numeric">10</td>
                <td class="numeric">11</td>
                <td class="numeric">55</td>
                <td class="numeric">68</td>
              </tr>
              <tr>
                <td>Facebook</td>
                <td class="numeric">13</td>
                <td class="numeric">13</td>
                <td class="numeric">13</td>
                <td class="numeric">13</td>
                <td class="numeric">13</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td class="numeric">2</td>
                <td class="numeric">4</td>
                <td class="numeric">16</td>
                <td class="numeric">98</td>
                <td class="numeric">128</td>
              </tr>
              <tr>
                <td>Yahoo</td>
                <td class="numeric">6</td>
                <td class="numeric">6</td>
                <td class="numeric">79</td>
                <td class="numeric">79</td>
                <td class="numeric">79</td>
              </tr>
              <tr>
                <td>Cedexis</td>
                <td class="numeric">2</td>
                <td class="numeric">2</td>
                <td class="numeric">98</td>
                <td class="numeric">98</td>
                <td class="numeric">98</td>
              </tr>
              <tr>
                <td>Microsoft Azure</td>
                <td class="numeric">2</td>
                <td class="numeric">43</td>
                <td class="numeric">99</td>
                <td class="numeric">99</td>
                <td class="numeric">99</td>
              </tr>
              <tr>
                <td>jsDelivr</td>
                <td class="numeric">2</td>
                <td class="numeric">116</td>
                <td class="numeric">116</td>
                <td class="numeric">116</td>
                <td class="numeric">116</td>
              </tr>
              <tr>
                <td>CDNetworks</td>
                <td class="numeric">132</td>
                <td class="numeric">178</td>
                <td class="numeric">397</td>
                <td class="numeric">398</td>
                <td class="numeric">645</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cdn-fig-14" class="anchor-link">図 14.</a>リソースSANカウントの分布の10、25、50、75、および90パーセンタイル。</figcaption>
    </figure>
    <h2 id="cdn-tlsの採用"><a href="#cdn-tlsの採用" class="anchor-link">TLSの採用</a></h2>
    <p>TLSおよびRTTのパフォーマンスにCDNを使用することに加えて、TLS暗号およびTLSバージョンのパッチ適用および採用を確実とするため、CDNがよく使用されます。一般に、メインHTMLページでのTLSの採用は、CDNを使用するWebサイトの方がはるかに高くなっています。 HTMLページの76％以上がTLSで提供されているのに対し、originホストページからは62％です。</p>
    <figure id="cdn-fig-15">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig15.png">
        <img src="/static/images/2019/cdn/fig15.png" alt="図15. HTML TLSバージョンの採用（CDNとorigin）。" aria-labelledby="cdn-fig15-caption" aria-describedby="cdn-fig15-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=1183502256&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig15-description" data-show-text="{{ show_description(15) }}" data-hide-text="{{ hide_description(15) }}">{{ show_description(15) }}</button>
      <div id="cdn-fig15-description" class="visually-hidden">TLS1.0が発信元の時間の0.86％、TLS1.2が55％、TLS1.3が6％、暗号化されていない38％の時間を示す積み上げ棒グラフ。 CDNの場合、これはTLS1.2では35％、TLS1.3では41％、暗号化されていない場合は24％に変更されます。</div>
      <figcaption id="cdn-fig15-caption"><a href="#cdn-fig-15" class="anchor-link">図 15.</a> HTML TLSバージョンの採用（CDNとorigin）。</figcaption>
    </figure>
    <p>各CDNは、TLSと提供される相対的な暗号とバージョンの両方に異なる採用率を提供します。一部のCDNはより積極的で、これらの変更をすべての顧客に展開しますが他のCDNはWebサイトの所有者に最新の変更をオプトインして、これらの暗号とバージョンを容易にする変更管理を提供することを要求します。</p>
    <figure id="cdn-fig-16">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig16.png">
        <img src="/static/images/2019/cdn/fig16.png" alt="図16. CDNによるHTML TLSの採用。" aria-labelledby="cdn-fig16-caption" aria-describedby="cdn-fig16-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=2053476423&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig16-description" data-show-text="{{ show_description(16) }}" data-hide-text="{{ hide_description(16) }}">{{ show_description(16) }}</button>
      <div id="cdn-fig16-description" class="visually-hidden">いくつかのCDN（Wordpressなど）が100％、ほとんどは80％-100％で、次にORIGINを62％、Googleを51％、ChinaNetCenterをCDNで分解した最初のHTML要求に対して確立されたセキュア接続と非セキュア接続の区分36％、ユンジアスは29％。</div>
      <figcaption id="cdn-fig16-caption"><a href="#cdn-fig-16" class="anchor-link">図 16.</a> CDNによるHTML TLSの採用。</figcaption>
    </figure>
    <figure id="cdn-fig-17">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig17.png">
        <img src="/static/images/2019/cdn/fig17.png" alt="図17. CDNによるサードパーティTLSの採用。" aria-labelledby="cdn-fig17-caption" aria-describedby="cdn-fig17-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=991037479&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig17-description" data-show-text="{{ show_description(17) }}" data-hide-text="{{ hide_description(17) }}">{{ show_description(17) }}</button>
      <div id="cdn-fig17-description" class="visually-hidden">CDNの大部分を示す積み上げ棒グラフは、サードパーティリクエストの90％以上でTLSを使用し、75％から90％の範囲のストラグラーがいくつかあり、ORIGINはそれらすべてよりも68％低くなっています。</div>
      <figcaption id="cdn-fig17-caption"><a href="#cdn-fig-17" class="anchor-link">図 17.</a> CDNによるサードパーティTLSの採用。</figcaption>
    </figure>
    <p>このTLSの一般的な採用に加えて、CDNの使用では、TLS1.3などの新しいTLSバージョンの採用も増えています。</p>
    <p>一般にCDNの使用は、TLS1.0のような非常に古くて侵害されたTLSバージョンの使用率が高いoriginホストサービスと比較して、強力な暗号およびTLSバージョンの迅速な採用と高い相関があります。</p>
    <p class="note">Web Almanacで使用されるChromeは、ホストが提供する最新のTLSバージョンと暗号にバイアスをかけることを強調することが重要です。また、これらのWebページは2019年7月にクロールされ、新しいバージョンを有効にしたWebサイトの採用を反映しています。</p>
    <figure id="cdn-fig-18">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig18.png">
        <img src="/static/images/2019/cdn/fig18.png" alt="図18. CDNによるHTML TLSバージョン。" aria-labelledby="cdn-fig18-caption" aria-describedby="cdn-fig18-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=659795773&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig18-description" data-show-text="{{ show_description(18) }}" data-hide-text="{{ hide_description(18) }}">{{ show_description(18) }}</button>
      <div id="cdn-fig18-description" class="visually-hidden">TLSが使用される場合、TLS1.3またはTLS1.2がすべてのCDNによって使用されることを示す棒グラフ。いくつかのCDNはTLS1.3を完全に採用していますが、一部ではTLS1.2が大部分を採用されています。</div>
      <figcaption id="cdn-fig18-caption"><a href="#cdn-fig-18" class="anchor-link">図 18.</a> CDNによるHTML TLSバージョン。</figcaption>
    </figure>
    <p>TLSバージョンと暗号の詳細については、<a href="#security">セキュリティ</a>と<a href="#http2">HTTP/2</a>の章を参照してください。</p>
    <h2 id="cdn-http2採用"><a href="#cdn-http2採用" class="anchor-link">HTTP/2採用</a></h2>
    <p>RTT管理とTLSパフォーマンスの向上に加えて、CDNはHTTP/2やIPv6などの新しい標準も有効にします。ほとんどのCDNはHTTP/2のサポートを提供し、多くはまだ標準以下の開発HTTP/3の早期サポートを示していますが、これらの新機能を有効にするかどうかは依然としてWebサイト所有者に依存しています。変更管理のオーバーヘッドにもかかわらず、CDNから提供されるHTMLの大部分ではHTTP/2が有効になっています。</p>
    <p>CDNのHTTP/2の採用率は70％を超えていますが、originページはほぼ27％です。同様にCDNのサブドメインリソースとサードパーティリソースでは90％以上がHTTP/2を採用していて、さらに高くなりますが、originインフラストラクチャから提供されるサードパーティリソースは31％しか採用されていません。 <a href="#http2">HTTP/2</a> のパフォーマンス向上およびその他の機能については、HTTP/2の章でさらに説明します。</p>
    <p class="note">注：すべてのリクエストは、HTTP/2をサポートするChromeの最新バージョンで行われました。 HTTP/1.1のみが報告される場合、これは暗号化されていない（非TLS）サーバーまたはHTTP/2をサポートしないサーバーを示します。</p>
    <figure id="cdn-fig-19">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig19.png">
        <img src="/static/images/2019/cdn/fig19.png" alt="図19. HTTP / 2の採用（CDNとorigin）。" aria-labelledby="cdn-fig19-caption" aria-describedby="cdn-fig19-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=1166990011&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig19-description" data-show-text="{{ show_description(19) }}" data-hide-text="{{ hide_description(19) }}">{{ show_description(19) }}</button>
      <div id="cdn-fig19-description" class="visually-hidden">origin接続の73％がHTTP/1.1を使用し、27％がHTTP/2を使用する積み上げ棒グラフ。これは、29％がHTTP/1.1と71％がHTTP/2を使用しているCDNと比較しています。</div>
      <figcaption id="cdn-fig19-caption"><a href="#cdn-fig-19" class="anchor-link">図 19.</a> HTTP/2の採用（CDNとorigin）。</figcaption>
    </figure>
    <figure id="cdn-fig-20">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig20.png">
        <img src="/static/images/2019/cdn/fig20.png" alt="図20. HTTP/2のHTML採用。" aria-labelledby="cdn-fig20-caption" aria-describedby="cdn-fig20-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=1896876288&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig20-description" data-show-text="{{ show_description(20) }}" data-hide-text="{{ hide_description(20) }}">{{ show_description(20) }}</button>
      <div id="cdn-fig20-description" class="visually-hidden">表21のデータを示す棒グラフ。</div>
      <figcaption id="cdn-fig20-caption"><a href="#cdn-fig-20" class="anchor-link">図 20.</a> HTTP/2のHTML採用。</figcaption>
    </figure>
    <figure id="cdn-fig-21">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <td></td>
                <th scope="col">HTTP/0.9</th>
                <th scope="col">HTTP/1.0</th>
                <th scope="col">HTTP/1.1</th>
                <th scope="col">HTTP/2</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>WordPress</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0.38</td>
                <td class="numeric">100</td>
              </tr>
              <tr>
                <td>Netlify</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">1.07</td>
                <td class="numeric">99</td>
              </tr>
              <tr>
                <td>section.io</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">1.56</td>
                <td class="numeric">98</td>
              </tr>
              <tr>
                <td>GoCache</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">7.97</td>
                <td class="numeric">92</td>
              </tr>
              <tr>
                <td>NetDNA</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">12.03</td>
                <td class="numeric">88</td>
              </tr>
              <tr>
                <td>Instart Logic</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">12.36</td>
                <td class="numeric">88</td>
              </tr>
              <tr>
                <td>Microsoft Azure</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">14.06</td>
                <td class="numeric">86</td>
              </tr>
              <tr>
                <td>Sucuri Firewall</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">15.65</td>
                <td class="numeric">84</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">16.34</td>
                <td class="numeric">84</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">16.43</td>
                <td class="numeric">84</td>
              </tr>
              <tr>
                <td>Highwinds</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">17.34</td>
                <td class="numeric">83</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">18.19</td>
                <td class="numeric">82</td>
              </tr>
              <tr>
                <td>OVH CDN</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">25.53</td>
                <td class="numeric">74</td>
              </tr>
              <tr>
                <td>Limelight</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">33.16</td>
                <td class="numeric">67</td>
              </tr>
              <tr>
                <td>Edgecast</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">37.04</td>
                <td class="numeric">63</td>
              </tr>
              <tr>
                <td>Cedexis</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">43.44</td>
                <td class="numeric">57</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">47.17</td>
                <td class="numeric">53</td>
              </tr>
              <tr>
                <td>Myra Security CDN</td>
                <td class="numeric">0</td>
                <td class="numeric">0.06</td>
                <td class="numeric">50.05</td>
                <td class="numeric">50</td>
              </tr>
              <tr>
                <td>Google</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">52.45</td>
                <td class="numeric">48</td>
              </tr>
              <tr>
                <td>Incapsula</td>
                <td class="numeric">0</td>
                <td class="numeric">0.01</td>
                <td class="numeric">55.41</td>
                <td class="numeric">45</td>
              </tr>
              <tr>
                <td>Yunjiasu</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">70.96</td>
                <td class="numeric">29</td>
              </tr>
              <tr>
                <td>ORIGIN</td>
                <td class="numeric">0</td>
                <td class="numeric">0.1</td>
                <td class="numeric">72.81</td>
                <td class="numeric">27</td>
              </tr>
              <tr>
                <td>Zenedge</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">87.54</td>
                <td class="numeric">12</td>
              </tr>
              <tr>
                <td>CDNetworks</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">88.21</td>
                <td class="numeric">12</td>
              </tr>
              <tr>
                <td>ChinaNetCenter</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">94.49</td>
                <td class="numeric">6</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cdn-fig-21" class="anchor-link">図 21.</a> CDNによるHTTP/2のHTML採用。</figcaption>
    </figure>
    <figure id="cdn-fig-22">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig22.png">
        <img src="/static/images/2019/cdn/fig22.png" alt="図22. HTML/2の採用：サードパーティのリソース。" aria-labelledby="cdn-fig22-caption" aria-describedby="cdn-fig22-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=397209603&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig22-description" data-show-text="{{ show_description(22) }}" data-hide-text="{{ hide_description(22) }}">{{ show_description(22) }}</button>
      <div id="cdn-fig22-description" class="visually-hidden">表23のデータを示す棒グラフ。</div>
      <figcaption id="cdn-fig22-caption"><a href="#cdn-fig-22" class="anchor-link">図 22.</a> HTML/2の採用：サードパーティのリソース。</figcaption>
    </figure>
    <figure id="cdn-fig-23">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>cdn</th>
                <th>HTTP/0.9</th>
                <th>HTTP/1.0</th>
                <th>HTTP/1.1</th>
                <th>HTTP/2</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>jsDelivr</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">100</td>
              </tr>
              <tr>
                <td>Facebook</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">100</td>
              </tr>
              <tr>
                <td>Twitter</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">1</td>
                <td class="numeric">99</td>
              </tr>
              <tr>
                <td>section.io</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">2</td>
                <td class="numeric">98</td>
              </tr>
              <tr>
                <td>BunnyCDN</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">2</td>
                <td class="numeric">98</td>
              </tr>
              <tr>
                <td>KeyCDN</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">4</td>
                <td class="numeric">96</td>
              </tr>
              <tr>
                <td>Microsoft Azure</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">6</td>
                <td class="numeric">94</td>
              </tr>
              <tr>
                <td>WordPress</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">7</td>
                <td class="numeric">93</td>
              </tr>
              <tr>
                <td>CDN77</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">7</td>
                <td class="numeric">93</td>
              </tr>
              <tr>
                <td>NetDNA</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">7</td>
                <td class="numeric">93</td>
              </tr>
              <tr>
                <td>Google</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">8</td>
                <td class="numeric">92</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">10</td>
                <td class="numeric">90</td>
              </tr>
              <tr>
                <td>Sucuri Firewall</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">14</td>
                <td class="numeric">86</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">16</td>
                <td class="numeric">84</td>
              </tr>
              <tr>
                <td>Yahoo</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">17</td>
                <td class="numeric">83</td>
              </tr>
              <tr>
                <td>OVH CDN</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">26</td>
                <td class="numeric">75</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">26</td>
                <td class="numeric">74</td>
              </tr>
              <tr>
                <td>Cedexis</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">27</td>
                <td class="numeric">73</td>
              </tr>
              <tr>
                <td>CDNetworks</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">30</td>
                <td class="numeric">70</td>
              </tr>
              <tr>
                <td>Edgecast</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">42</td>
                <td class="numeric">58</td>
              </tr>
              <tr>
                <td>Highwinds</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">43</td>
                <td class="numeric">57</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td class="numeric">0</td>
                <td class="numeric">0.01</td>
                <td class="numeric">47</td>
                <td class="numeric">53</td>
              </tr>
              <tr>
                <td>Incapsula</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">56</td>
                <td class="numeric">44</td>
              </tr>
              <tr>
                <td>CDNvideo</td>
                <td class="numeric">0</td>
                <td class="numeric">0</td>
                <td class="numeric">68</td>
                <td class="numeric">31</td>
              </tr>
              <tr>
                <td>ORIGIN</td>
                <td class="numeric">0</td>
                <td class="numeric">0.07</td>
                <td class="numeric">69</td>
                <td class="numeric">31</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#cdn-fig-23" class="anchor-link">図 23.</a> HTML/2の採用：サードパーティのリソース。</figcaption>
    </figure>
    <h2 id="cdn-cdnキャッシュ動作の制御"><a href="#cdn-cdnキャッシュ動作の制御" class="anchor-link">CDNキャッシュ動作の制御</a></h2>
    <h3 id="cdn-vary">
      <a href="#cdn-vary" class="anchor-link"><code>Vary</code></a>
    </h3>
    <p>Webサイトは、さまざまなHTTPヘッダーを使用して、ブラウザーとCDNのキャッシュ動作を制御できます。 最も一般的なのは、最新のものであることを保証するためにoriginへ戻る前に何かをキャッシュできる期間を具体的に決定する <code>Cache-Control</code>ヘッダーです。</p>
    <p>別の便利なツールは、<code>Vary</code> HTTPヘッダーの使用です。このヘッダーは、キャッシュをフラグメント化する方法をCDNとブラウザーの両方に指示します。<code>Vary</code>ヘッダーにより、originはリソースの表現が複数あることを示すことができ、CDNは各バリエーションを個別にキャッシュする必要があります。最も一般的な例は<a href="#compression">圧縮</a>です。リソースを<code>Vary：Accept-Encoding</code>を使用すると、CDNは同じコンテンツを、非圧縮、gzip、Brotliなどの異なる形式でキャッシュできます。一部のCDNでは、使用可能なコピーを1つだけ保持するために、この圧縮を急いで実行します。同様に、この<code>Vary</code>ヘッダーは、コンテンツをキャッシュする方法と新しいコンテンツを要求するタイミングをブラウザーに指示します。</p>
    <figure id="cdn-fig-24">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/use_of_vary_on_cdn.png">
        <img alt="CDNから提供されるHTMLコンテンツのVaryヘッダー値の内訳" src="/static/images/2019/cdn/use_of_vary_on_cdn.png" aria-labelledby="cdn-fig24-caption" aria-describedby="cdn-fig24-description" width="600" height="376" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig24-description" data-show-text="{{ show_description(24) }}" data-hide-text="{{ hide_description(24) }}">{{ show_description(24) }}</button>
      <div id="cdn-fig24-description" class="visually-hidden">accept-encodingを示すツリーマップグラフは使用率が異なり、チャートの73％が使用されます。 Cookie（13％）とユーザーエージェント（8％）がある程度使用され、その後に他のヘッダーが完全に混在しています。</div>
      <figcaption id="cdn-fig24-caption"><a href="#cdn-fig-24" class="anchor-link">図 24.</a> CDNから提供されるHTMLの<code>Vary</code>の使用法。</figcaption>
    </figure>
    <p><code>Vary</code>の主な用途は<code>Content-Encoding</code>の調整ですが、Webサイトがキャッシュの断片化を知らせるために使用する他の重要なバリエーションがあります。 <code>Vary</code>を使用すると、DuckDuckGo、Google、BingBotなどのSEOボットに、異なる条件下で代替コンテンツが返されるように指示します。これは、「クローキング」（ランキングを戦うためにSEO固有のコンテンツを送信する）に対するSEOペナルティを回避するために重要でした。</p>
    <p>HTMLページの場合、<code>Vary</code>の最も一般的な使用法は、<code>User-Agent</code>に基づいてコンテンツが変更されることを通知することです。これは、Webサイトがデスクトップ、電話、タブレット、およびリンク展開エンジン（Slack、iMessage、Whatsappなど）に対して異なるコンテンツを返すことを示す略記です。 <code>Vary：User-Agent</code>の使用は、コンテンツがバックエンドの「mDot」サーバーと「通常」サーバーに分割された初期モバイル時代の名残でもあります。レスポンシブWebの採用が広く知られるようになりましたが、この<code>Vary</code>形式は残ります。</p>
    <p>同様に、<code>Vary：Cookie</code>は通常、ユーザーのログイン状態またはその他のパーソナライズに基づいてコンテンツが変化することを示します。</p>
    <figure id="cdn-fig-25">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/use_of_vary.png">
        <img src="/static/images/2019/cdn/use_of_vary.png" alt="図25. HTMLとoriginとCDNから提供されるリソースのVary使用の比較。" aria-labelledby="cdn-fig25-caption" aria-describedby="cdn-fig25-description" width="600" height="371" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig25-description" data-show-text="{{ show_description(25) }}" data-hide-text="{{ hide_description(25) }}">{{ show_description(25) }}</button>
      <div id="cdn-fig25-description" class="visually-hidden">ホームページを提供するCDNの場合、Varyの最大の用途はCookieであり、その後にuser-agentが続くことを示す4つのツリーマップグラフのセット、他のリソースを提供するCDNの場合は、originであり、その後にaccept、user-agent、x-origin、およびreferrerが続きます。 originsとホームページの場合、それはuser-agentであり、その後にcookieが続きます。最後に、originsおよびその他のリソースについては、主にuser-agentであり、その後にorigin、accept、range、hostが続きます。</div>
      <figcaption id="cdn-fig25-caption"><a href="#cdn-fig-25" class="anchor-link">図 25.</a> HTMLとoriginとCDNから提供されるリソースの<code>Vary</code>使用の比較。</figcaption>
    </figure>
    <p>対照的に、リソースはHTMLリソースほど<code>Vary：Cookie</code>を使用しません。代わりに、これらのリソースは<code>Accept</code>、<code>Origin</code>、または<code>Referer</code>に基づいて適応する可能性が高くなります。たとえば、ほとんどのメディアは、<code>Vary：Accept</code>を使用してブラウザが提供する<code>Accept</code>ヘッダーに応じて画像がJPEG、WebP、JPEG 2000、またはJPEG XRであることを示します。同様に、サードパーティの共有リソースは、埋め込まれているWebサイトによってXHR APIが異なることを通知します。このように、広告サーバーAPIの呼び出しは、APIを呼び出した親Webサイトに応じて異なるコンテンツを返します。</p>
    <p><code>Vary</code>ヘッダーには、CDNチェインの証拠も含まれています。これらは、<code>Accept-Encoding、Accept-Encoding</code>、または<code>Accept-Encoding、Accept-Encoding、Accept-Encoding</code>などの<code>Vary</code>ヘッダーで確認できます。これらのチェインと<code>Via</code>ヘッダーエントリをさらに分析すると、たとえば、サードパーティタグをプロキシしているサイトの数など興味深いデータが明らかになる可能性があります。</p>
    <p><code>Vary</code>の使用の多くは無関係です。ほとんどのブラウザがダブルキーキャッシングを採用しているため、<code>Vary：Origin</code>の使用は冗長です。<code>Vary：Range</code>または<code>Vary：Host</code>または<code>Vary：*</code>のように。 <code>Vary</code>のワイルドで可変的な使用は、インターネットが奇妙であることの実証可能な証拠です。</p>
    <h3 id="cdn-surrogate-control-s-maxage-pre-check">
      <a href="#cdn-surrogate-control-s-maxage-pre-check" class="anchor-link"><code>Surrogate-Control</code>, <code>s-maxage</code>, <code>Pre-Check</code></a>
    </h3>
    <p><code>Cache-Control</code>ヘッダーの<code>Surrogate-Control</code>、<code>s-maxage</code>、<code>pre-check</code>、<code>post-check</code>の値など、特にCDNまたは他のプロキシキャッシュを対象とする他のHTTPヘッダーがあります。一般的に、これらのヘッダーを使う事は少ないでしょう。</p>
    <p><code>Surrogate-Control</code>を使用すると、originはCDNに対してのみキャッシュルールを指定できます。CDNは応答を提供する前にヘッダーを削除する可能性が高いため、使用量が低いと驚くことはありません（いくつかのCDNもヘッダーを削除しているように見えました）。</p>
    <p>一部のCDNは、リソースが古くなった場合にリソースを更新できるようにする方法として<code>pre-check</code>をサポートし、最大値<code>maxage</code>として<code>pre-check</code>をサポートしています。ほとんどのCDNでは、<code>pre-check</code>と<code>post-check</code>の使用率は1％未満でした。Yahoo!はこの例外であり、リクエストの約15％に<code>pre-check = 0、post-check = 0</code>がありました。残念ながら、これは積極的な使用ではなく、古いInternet Explorerパターンの名残です。この上のより多くの議論では、<a href="#caching">キャッシング</a>の章に記載されています。</p>
    <p><code>s-maxage</code>ディレクティブは、応答をキャッシュできる期間をプロキシに通知します。 Web Almanacデータセット全体で、jsDelivrは複数のリソースで高いレベルの使用が見られた唯一のCDNです。これは、jsDelivrのライブラリのパブリックCDNとしての役割を考えると驚くことではありません。他のCDNでの使用は、個々の顧客、たとえばその特定のCDNを使用するサードパーティのスクリプトまたはSaaSプロバイダーによって推進されているようです。</p>
    <figure id="cdn-fig-26">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig26.png">
        <img src="/static/images/2019/cdn/fig26.png" alt="図26. CDN応答全体でのs-maxageの採用。" aria-labelledby="cdn-fig26-caption" aria-describedby="cdn-fig26-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=1215102767&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig26-description" data-show-text="{{ show_description(26) }}" data-hide-text="{{ hide_description(26) }}">{{ show_description(26) }}</button>
      <div id="cdn-fig26-description" class="visually-hidden">jsDelivrの82％がs-maxage、レベル3の14％、Amazon CloudFrontの6.3％、Akamaiの3.3％、Fastlyの3.1％、Highwindsの3％、Cloudflareの2％、ORIGINの0.91％の応答を提供する棒グラフ、Edgecastの0.75％、Googleの0.07％。</div>
      <figcaption id="cdn-fig26-caption"><a href="#cdn-fig-26" class="anchor-link">図 26.</a> CDN応答全体での<code>s-maxage</code>の採用。</figcaption>
    </figure>
    <p>サイトの40％がリソースにCDNを使用しており、これらのリソースが静的でキャッシュ可能であると仮定すると、<code>s-maxage</code>の使用は低いようです。</p>
    <p>今後の研究では、キャッシュの有効期間とリソースの経過時間、および<code>s-maxage</code>の使用法と<code>stale-while-revalidate</code>などの他の検証ディレクティブの使用法を検討する可能性があります。</p>
    <h2 id="cdn-一般的なライブラリとコンテンツのcdn"><a href="#cdn-一般的なライブラリとコンテンツのcdn" class="anchor-link">一般的なライブラリとコンテンツのCDN</a></h2>
    <p>これまでのところ、この章ではサイトが独自のコンテンツをホストするために使用している可能性のあるコマーシャルCDNの使用、またはサイトに含まれるサードパーティリソースによって使用されている可能性について検討しました。</p>
    <p>jQueryやBootstrapなどの一般的なライブラリは、Google、Cloudflare、MicrosoftなどがホストするパブリックCDNからも利用できます。コンテンツを自己ホストする代わりに、パブリックCDNの1つのコンテンツを使用することはトレードオフです。コンテンツがCDNでホストされている場合でも、新しい接続を作成して輻輳ウィンドウを拡大すると、CDNを使用する際の低遅延が無効になる場合があります。</p>
    <p>GoogleフォントはコンテンツCDNの中で最も人気があり、55％のWebサイトで使用されています。非フォントコンテンツの場合、Google API、CloudflareのJS CDN、およびBootstrapのCDNが次に人気です。</p>
    <figure id="cdn-fig-27">
      <a href="https://almanac.httparchive.org/static/images/2019/cdn/fig27.png">
        <img src="/static/images/2019/cdn/fig27.png" alt="図27.パブリックコンテンツCDNの使用。" aria-labelledby="cdn-fig27-caption" aria-describedby="cdn-fig27-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRzPn-1SGVa3rNCT0U9QeQNODE97fsmXyaJX1ZOoBNR8nPpclhC6fg8R_UpoodeiX6HkdHrp50WBQ5Q/pubchart?oid=123086113&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig27-description" data-show-text="{{ show_description(27) }}" data-hide-text="{{ hide_description(27) }}">{{ show_description(27) }}</button>
      <div id="cdn-fig27-description" class="visually-hidden">パブリックコンテンツのCDNの55.33％がfonts.googleapis.com、19.86％がajax.googleapis.com、10.47％がcdnjs.cloudflare.com、9.83％がmaxcdn.bootstrapcdn.com、コードが5.95％の棒グラフです。 jquery.com、cdn.jsdelivr.netに4.29％、use.fontawesome.comに3.22％、stackpath.bootstrapcdn.comに0.7％、unpkg.comに0.67％、ajax.aspnetcdn.comに0.52％。</div>
      <figcaption id="cdn-fig27-caption"><a href="#cdn-fig-27" class="anchor-link">図 27.</a>パブリックコンテンツCDNの使用。</figcaption>
    </figure>
    <p>分割キャッシュを実装するブラウザが増えると、共通ライブラリをホストするためのパブリックCDNの有効性が低下し、この研究の今後の反復で人気が低くなるかどうかを見るのは興味深いでしょう。</p>
    <h2 id="cdn-結論"><a href="#cdn-結論" class="anchor-link">結論</a></h2>
    <p>CDN配信によるレイテンシーの短縮と、訪問者の近くにコンテンツを保存する機能により、サイトはoriginの負荷を軽減しながらより高速な体験を提供できます。</p>
    <p>Steve SoudersによるCDNの使用の推奨は、12年前と同じように今日でも有効ですがCDNを介してHTMLコンテンツを提供しているサイトは20％のみであり、リソースにCDNを使用しているサイトは40％のみです。それらの使用法はさらに成長します。</p>
    <p>この分析に含まれていないCDNの採用にはいくつかの側面があります、これはデータセットの制限と収集方法が原因である場合で、他の場合は分析中に新しい研究の質問が出てきました。</p>
    <p>Webの進化に伴い、CDNベンダーは革新しサイトの新しいプラクティスを使用します、CDNの採用はWeb Almanacの将来のエディションでのさらなる研究のために豊富な領域のままです。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"IV","chapter_number":18,"title":"Page Weight","description":"ページの重さが重要な理由、帯域幅、複雑なページ、経時的なページの重み、ページ要求、およびファイル形式をカバーする2019 Web Almanacのページの重さの章。","authors":["tammyeverts","khempenius"],"reviewers":["paulcalvano"],"translators":["ksakae"],"discuss":"1773","results":"https://docs.google.com/spreadsheets/d/1nWOo8efqDgzmA0wt1ipplziKhlReAxnVCW1HkjuFAxU/","queries":"18_PageWeight","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-03-02T00:00:00.000Z","chapter":"page-weight"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="page-weight-序章"><a href="#page-weight-序章" class="anchor-link">序章</a></h2>
    <p>中央Webページのサイズは約1900KBで、74のリクエストが含まれています。悪くないですね。</p>
    <p>ここに中央値の問題があります：それらは問題を隠します。定義上、それらは分布の中間にのみ焦点を合わせています。全体像を理解するには、両極端のパーセンタイルを考慮する必要があります。</p>
    <p>90パーセンタイルを見ると、不快なものが明らかになります。疑いを持たない人々に向けてプッシュしているページのおよそ10％は6MBを超えており、179のリクエストが含まれています。これは、率直に言ってひどいです。もしあなたがひどくないと思うのであれば、間違いなくこの章を読む必要があります。</p>
    <h3 id="page-weight-神話：ページサイズは関係ない"><a href="#page-weight-神話：ページサイズは関係ない" class="anchor-link">神話：ページサイズは関係ない</a></h3>
    <p>ページサイズが重要ではなくなった理由に関する一般的な論点は、高速インターネットと強化されたデバイスのおかげで、大規模で複雑な（そして非常に複雑な）ページを一般の人々に提供できるということです。この仮定は、高速インターネットや強化されたデバイスでアクセスできない巨大なインターネットユーザー層を無視しても問題ない限り、うまく機能します。</p>
    <p>はい。一部のユーザーにとっては、高速で堅牢なページを構築できます。ただし、すべてのユーザー、特に帯域幅の制約やデータ制限へ対処するモバイル専用ユーザーにどのように影響するかという観点からページの肥大化に注意する必要があります。</p>
    <p class="note" data-markdown="1"></p>
    <p>
      Tim Kadlecの魅力的なオンライン計算機、[What Does My Site Cost?]（<a href="https://whatdoesmysitecost.com/）をチェックしてください。これは、世界中の国のページのコスト（1人あたりのドルと国民総所得）を計算します。それは目を見張るものです。たとえば、執筆時点で2.79MBのAmazonのホームページの費用は、モーリタニアの1人当たりGNIの1日あたり1.89％です。世界のいくつかの地域の人々が数十ページを訪問するだけで一日の賃金をあきらめなければならないとき、ワールドワイドウェブはどれほどグローバルなのでしょうか？">https://whatdoesmysitecost.com/）をチェックしてください。これは、世界中の国のページのコスト（1人あたりのドルと国民総所得）を計算します。それは目を見張るものです。たとえば、執筆時点で2.79MBのAmazonのホームページの費用は、モーリタニアの1人当たりGNIの1日あたり1.89％です。世界のいくつかの地域の人々が数十ページを訪問するだけで一日の賃金をあきらめなければならないとき、ワールドワイドウェブはどれほどグローバルなのでしょうか？<span class="fn">https://whatdoesmysitecost.com/）をチェックしてください。これは、世界中の国のページのコスト（1人あたりのドルと国民総所得）を計算します。それは目を見張るものです。たとえば、執筆時点で2.79MBのAmazonのホームページの費用は、モーリタニアの1人当たりGNIの1日あたり1.89％です。世界のいくつかの地域の人々が数十ページを訪問するだけで一日の賃金をあきらめなければならないとき、ワールドワイドウェブはどれほどグローバルなのでしょうか？</span></a>
    </p>
    <h3 id="page-weight-帯域幅を増やすことは、webパフォーマンスの魔法の弾丸ではありません"><a href="#page-weight-帯域幅を増やすことは、webパフォーマンスの魔法の弾丸ではありません" class="anchor-link">帯域幅を増やすことは、Webパフォーマンスの魔法の弾丸ではありません</a></h3>
    <p>
      より多くの人がより良いデバイスとより安価な接続にアクセスできたとしても、それは完全なソリューションではありません。帯域幅を2倍にしても、2倍速くなるわけではありません。実際、帯域幅を最大1,233％増やすと、ページが55％速くなるだけであることが<a href="https://developer.akamai.com/blog/2015/06/09/heres-why-more-bandwidth-isnt-magic-bullet-web-performance">実証<span class="fn">https://developer.akamai.com/blog/2015/06/09/heres-why-more-bandwidth-isnt-magic-bullet-web-performance</span></a
      >されています。
    </p>
    <p>問題は遅延です。私たちのネットワークプロトコルのほとんどは、多くの往復を必要とし、それらの各往復は遅延ペナルティを課します。遅延がパフォーマンスの問題である限り（つまり、近い将来）パフォーマンスの主な原因は、今日の典型的なWebページには数十の異なるサーバーでホストされている100程度のアセットが含まれていることです。これらのアセットの多くは、最適化されておらず、測定と監視がされていないため予測不能です。</p>
    <h3 id="page-weight-http-archiveはどのような種類のアセットを追跡し、どの程度の重要性を持ちますか？"><a href="#page-weight-http-archiveはどのような種類のアセットを追跡し、どの程度の重要性を持ちますか？" class="anchor-link">HTTP Archiveはどのような種類のアセットを追跡し、どの程度の重要性を持ちますか？</a></h3>
    <p>HTTP Archiveが追跡するページ構成メトリックの簡単な用語集と、パフォーマンスとユーザーエクスペリエンスの観点から重要なメトリックを以下に示します。</p>
    <ul>
      <li>
        <p><strong>合計サイズ</strong>は、ページのバイト単位の合計重量です。特に、限られたデータや測定データがあるモバイルユーザーにとって重要です。</p>
      </li>
      <li><p>通常、<strong>HTML</strong>はページ上の最小のリソースです。そのパフォーマンスリスクはごくわずかです。</p></li>
      <li><p>多くの場合、最適化されていない<strong>画像</strong>がページの肥大化の最大の原因です。ページの重さの分布の90パーセンタイルを見ると、約7MBのページの5.2MBを画像が占めています。つまり画像は総ページ重量のほぼ75％を占めます。そして、それだけでは不十分な場合、ページ上の画像の数は、小売サイトでのコンバージョン率の低下につながります（これについては後で詳しく説明します）。</p></li>
      <li>
        <p><strong>JavaScript</strong>が重要です。ページのJavaScriptの重さは比較的小さい場合がありますが、それでもJavaScriptによるパフォーマンスの問題が生じます。単一の100KBのサードパーティスクリプトでさえ、ページに大損害を与える可能性があります。ページ上のスクリプトが多いほど、リスクは大きくなります。</p>
        <p>JavaScriptのブロックだけに集中するだけでは十分でありません。 JavaScriptのレンダリング方法により、ページにブロッキングリソースが含まれていなくても、パフォーマンスが最適とは言えない可能性があります。 JavaScriptが他のすべてのブラウザーアクティビティを組み合わせた場合よりも多くのCPUを消費するため、ページ上のCPU使用率を理解することが非常に重要です。 JavaScriptがCPUをブロックしますてる間、ブラウザーはユーザー入力に応答できません。これにより、一般に「ジャンク」と呼ばれるものが作成されます。これは不安定なページレンダリングの不快な感覚です。</p>
      </li>
      <li>
        <p><strong>CSS</strong>は、現代のWebページにとって信じられないほどの恩恵です。ブラウザの互換性から設計の保守と更新まで、無数の設計上の問題を解決します。 CSSがなければ、レスポンシブデザインのような素晴らしいものはありません。しかし、JavaScriptのように、CSSは問題を引き起こすためにかさばる必要はありません。スタイルシートの実行が不十分な場合、ダウンロードと解析に時間がかかりすぎるスタイルシート、ページの残りの部分のレンダリングをブロックする不適切に配置されたスタイルシートに至るまで、パフォーマンスの問題が多数発生する可能性はあります。またJavaScriptと同様にCSSファイルが多くなると潜在的な問題が発生します。</p>
      </li>
    </ul>
    <h3 id="page-weight-大きくて複雑なページはビジネスに悪い場合があります"><a href="#page-weight-大きくて複雑なページはビジネスに悪い場合があります" class="anchor-link">大きくて複雑なページはビジネスに悪い場合があります</a></h3>
    <p>
      あなたが、あなたのサイト訪問者を気にしない心無いモンスターでないと仮定しましょう。しかしあなたがそうであれば、より大きく、より複雑なページを提供することもあなたを傷つけることを知っておくべきです。これは、小売サイトから100万以上のビーコンに相当する実際のユーザーデータを収集した<a href="https://www.thinkwithgoogle.com/marketing-resources/experience-design/mobile-page-speed-load-time/">Google主導の機械学習<span class="fn">https://www.thinkwithgoogle.com/marketing-resources/experience-design/mobile-page-speed-load-time/</span></a
      >の調査結果の1つでした。
    </p>
    <p>この研究から、3つの重要なポイントがありました。</p>
    <ol>
      <li>
        <p><strong>ページ上の要素の総数は、コンバージョンの最大の予測因子でした。</strong> 最新のWebページを構成するさまざまなアセットによって課されるパフォーマンスリスクについて説明したことを考えると、これが大きな驚きにならないことを願っています。</p>
      </li>
      <li><p>ページ上の画像の数は、コンバージョンの2番目に大きな予測因子でした。ユーザーが変換したセッションでは、変換しなかったセッションよりも画像が38％少なくなりました。</p></li>
    </ol>
    <figure id="page-weight-fig-1">
      <a href="https://almanac.httparchive.org/static/images/2019/18_Page_Weight/ch18_fig1_conversion_difference.png">
        <img src="/static/images/2019/18_Page_Weight/ch18_fig1_conversion_difference.png" alt="図1.変換されたセッションと変換されないセッション。" aria-labelledby="page-weight-fig1-caption" aria-describedby="page-weight-fig1-description" width="600" height="432" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig1-description" data-show-text="{{ show_description(1) }}" data-hide-text="{{ hide_description(1) }}">{{ show_description(1) }}</button>
      <div id="page-weight-fig1-description" class="visually-hidden">19の変換済みセッションと31の非変換セッションを示すグラフ</div>
      <figcaption id="page-weight-fig1-caption"><a href="#page-weight-fig-1" class="anchor-link">図 1.</a>変換されたセッションと変換されないセッション。</figcaption>
    </figure>
    <ol start="3">
      <li><strong>スクリプトが多いセッションは、変換される可能性が低くなりました。</strong> このグラフで本当に魅力的なのは、約240個のスクリプトを実行した後の変換確率の急激な低下だけではありません。最大1,440個のスクリプトが含まれる小売セッションの数を示すのはロングテールです！</li>
    </ol>
    <figure id="page-weight-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/18_Page_Weight/ch18_fig2_conversion_graph.jpg">
        <img src="/static/images/2019/18_Page_Weight/ch18_fig2_conversion_graph.jpg" alt="図2.スクリプトが増加すると変換率は低下します。" aria-labelledby="page-weight-fig2-caption" aria-describedby="page-weight-fig2-description" width="600" height="336" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="page-weight-fig2-description" class="visually-hidden">変換率が80スクリプトまで上昇し、その後スクリプトが1440スクリプトまで増加すると低下することを示すグラフ。</div>
      <figcaption id="page-weight-fig2-caption"><a href="#page-weight-fig-2" class="anchor-link">図 2.</a>スクリプトが増加すると変換率は低下します。</figcaption>
    </figure>
    <p>ページサイズと複雑さが重要である理由について説明したので、Webの現在の状態とページの肥大化の影響をよりよく理解できるように、ジューシーなHTTP Archiveの統計を見てみましょう。</p>
    <h2 id="page-weight-分析"><a href="#page-weight-分析" class="anchor-link">分析</a></h2>
    <p>このセクションの統計はすべて、ページとそのリソースの転送サイズに基づいています。 Web上のすべてのリソースが送信前に圧縮されるわけではありませんが、圧縮されている場合、この分析では圧縮サイズが使用されます。</p>
    <h3 id="page-weight-ページの重さ"><a href="#page-weight-ページの重さ" class="anchor-link">ページの重さ</a></h3>
    <p>大まかに言って、モバイルサイトはデスクトップの対応サイトよりも約10％小さくなっています。違いの大部分は、モバイルサイトが対応するデスクトップよりも少ない画像バイトを読み込んでいるためです。</p>
    <h4 id="page-weight-モバイル"><a href="#page-weight-モバイル" class="anchor-link">モバイル</a></h4>
    <figure id="page-weight-fig-3">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>合計 (KB)</th>
                <th>HTML (KB)</th>
                <th>JS (KB)</th>
                <th>CSS (KB)</th>
                <th>画像 (KB)</th>
                <th>ドキュメント (KB)</th>
              </tr>
              <tr>
                <td>90</td>
                <td>6226</td>
                <td>107</td>
                <td>1060</td>
                <td>234</td>
                <td>4746</td>
                <td>49</td>
              </tr>
              <tr>
                <td>75</td>
                <td>3431</td>
                <td>56</td>
                <td>668</td>
                <td>122</td>
                <td>2270</td>
                <td>25</td>
              </tr>
              <tr>
                <td>50</td>
                <td>1745</td>
                <td>26</td>
                <td>360</td>
                <td>56</td>
                <td>893</td>
                <td>13</td>
              </tr>
              <tr>
                <td>25</td>
                <td>800</td>
                <td>11</td>
                <td>164</td>
                <td>22</td>
                <td>266</td>
                <td>7</td>
              </tr>
              <tr>
                <td>10</td>
                <td>318</td>
                <td>6</td>
                <td>65</td>
                <td>5</td>
                <td>59</td>
                <td>4</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-3" class="anchor-link">図 3.</a>リソースタイプ別のモバイルのページウェイト。</figcaption>
    </figure>
    <h4 id="page-weight-デスクトップ"><a href="#page-weight-デスクトップ" class="anchor-link">デスクトップ</a></h4>
    <figure id="page-weight-fig-4">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>合計 (KB)</th>
                <th>HTML (KB)</th>
                <th>JS (KB)</th>
                <th>CSS (KB)</th>
                <th>画像 (KB)</th>
                <th>ドキュメント (KB)</th>
              </tr>
              <tr>
                <td>90</td>
                <td>6945</td>
                <td>110</td>
                <td>1131</td>
                <td>240</td>
                <td>5220</td>
                <td>52</td>
              </tr>
              <tr>
                <td>75</td>
                <td>3774</td>
                <td>58</td>
                <td>721</td>
                <td>129</td>
                <td>2434</td>
                <td>26</td>
              </tr>
              <tr>
                <td>50</td>
                <td>1934</td>
                <td>27</td>
                <td>391</td>
                <td>62</td>
                <td>983</td>
                <td>14</td>
              </tr>
              <tr>
                <td>25</td>
                <td>924</td>
                <td>12</td>
                <td>186</td>
                <td>26</td>
                <td>319</td>
                <td>8</td>
              </tr>
              <tr>
                <td>10</td>
                <td>397</td>
                <td>6</td>
                <td>76</td>
                <td>8</td>
                <td>78</td>
                <td>4</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-4" class="anchor-link">図 4.</a>リソースタイプ別に分類されたデスクトップ上のページの重み</figcaption>
    </figure>
    <h3 id="page-weight-時間と共に変化するページの重さ"><a href="#page-weight-時間と共に変化するページの重さ" class="anchor-link">時間と共に変化するページの重さ</a></h3>
    <p>過去1年間に、デスクトップサイトのサイズの中央値は434KB増加し、モバイルサイトのサイズの中央値は179KB増加しました。画像はこの増加を圧倒的に促進しています。</p>
    <h4 id="page-weight-モバイル-1"><a href="#page-weight-モバイル-1" class="anchor-link">モバイル</a></h4>
    <figure id="page-weight-fig-5">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>合計 (KB)</th>
                <th>HTML (KB)</th>
                <th>JS (KB)</th>
                <th>CSS (KB)</th>
                <th>画像 (KB)</th>
                <th>ドキュメント (KB)</th>
              </tr>
              <tr>
                <td>90</td>
                <td>+376</td>
                <td>-50</td>
                <td>+46</td>
                <td>+36</td>
                <td>+648</td>
                <td>+2</td>
              </tr>
              <tr>
                <td>75</td>
                <td>+304</td>
                <td>-7</td>
                <td>+34</td>
                <td>+21</td>
                <td>+281</td>
                <td>0</td>
              </tr>
              <tr>
                <td>50</td>
                <td>+179</td>
                <td>-1</td>
                <td>+27</td>
                <td>+10</td>
                <td>+106</td>
                <td>0</td>
              </tr>
              <tr>
                <td>25</td>
                <td>+110</td>
                <td>-1</td>
                <td>+16</td>
                <td>+5</td>
                <td>+36</td>
                <td>0</td>
              </tr>
              <tr>
                <td>10</td>
                <td>+72</td>
                <td>0</td>
                <td>+13</td>
                <td>+2</td>
                <td>+20</td>
                <td>+1</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-5" class="anchor-link">図 5.</a> 2018年以降のモバイルページのウェイトの変化。</figcaption>
    </figure>
    <h4 id="page-weight-デスクトップ-1"><a href="#page-weight-デスクトップ-1" class="anchor-link">デスクトップ</a></h4>
    <figure id="page-weight-fig-6">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>合計 (KB)</th>
                <th>HTML (KB)</th>
                <th>JS (KB)</th>
                <th>CSS (KB)</th>
                <th>画像 (KB)</th>
                <th>ドキュメント (KB)</th>
              </tr>
              <tr>
                <td>90</td>
                <td>+1106</td>
                <td>-75</td>
                <td>+22</td>
                <td>+45</td>
                <td>+1291</td>
                <td>+5</td>
              </tr>
              <tr>
                <td>75</td>
                <td>+795</td>
                <td>-12</td>
                <td>+9</td>
                <td>+32</td>
                <td>+686</td>
                <td>+1</td>
              </tr>
              <tr>
                <td>50</td>
                <td>+434</td>
                <td>-1</td>
                <td>+10</td>
                <td>+15</td>
                <td>+336</td>
                <td>0</td>
              </tr>
              <tr>
                <td>25</td>
                <td>+237</td>
                <td>0</td>
                <td>+12</td>
                <td>+7</td>
                <td>+138</td>
                <td>0</td>
              </tr>
              <tr>
                <td>10</td>
                <td>+120</td>
                <td>0</td>
                <td>+10</td>
                <td>+2</td>
                <td>+39</td>
                <td>+1</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-6" class="anchor-link">図 6.</a> 2018年以降のデスクトップページの重みの変化。</figcaption>
    </figure>
    <p>
      ページの重さが時間とともにどのように変化するかについての長期的な視点については、HTTP Archiveから<a href="https://httparchive.org/reports/page-weight#bytesTotal">この時系列グラフ<span class="fn">https://httparchive.org/reports/page-weight#bytesTotal</span></a
      >をご覧ください。ページサイズの中央値は、HTTP Archiveが2010年11月にこのメトリックの追跡を開始して以来ほぼ一定の割合で成長しており、過去1年間に見られたページウェイトの増加はこれと一致しています。
    </p>
    <h3 id="page-weight-ページリクエスト"><a href="#page-weight-ページリクエスト" class="anchor-link">ページリクエスト</a></h3>
    <p>デスクトップページの中央値は74リクエストで、モバイルページの中央値は69リクエストです。これらのリクエストの大部分は画像とJavaScriptアカウントです。昨年、リクエストの量や分布に大きな変化はありませんでした。</p>
    <h4 id="page-weight-モバイル-2"><a href="#page-weight-モバイル-2" class="anchor-link">モバイル</a></h4>
    <figure id="page-weight-fig-7">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>合計 (KB)</th>
                <th>HTML (KB)</th>
                <th>JS (KB)</th>
                <th>CSS (KB)</th>
                <th>画像 (KB)</th>
                <th>ドキュメント (KB)</th>
              </tr>
              <tr>
                <td>90</td>
                <td>168</td>
                <td>15</td>
                <td>52</td>
                <td>20</td>
                <td>79</td>
                <td>7</td>
              </tr>
              <tr>
                <td>75</td>
                <td>111</td>
                <td>7</td>
                <td>32</td>
                <td>12</td>
                <td>49</td>
                <td>2</td>
              </tr>
              <tr>
                <td>50</td>
                <td>69</td>
                <td>3</td>
                <td>18</td>
                <td>6</td>
                <td>28</td>
                <td>0</td>
              </tr>
              <tr>
                <td>25</td>
                <td>40</td>
                <td>2</td>
                <td>9</td>
                <td>3</td>
                <td>15</td>
                <td>0</td>
              </tr>
              <tr>
                <td>10</td>
                <td>22</td>
                <td>1</td>
                <td>4</td>
                <td>1</td>
                <td>7</td>
                <td>0</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-7" class="anchor-link">図 7.</a>リソースタイプ別に分類されたモバイルページリクエスト。</figcaption>
    </figure>
    <h4 id="page-weight-デスクトップ-2"><a href="#page-weight-デスクトップ-2" class="anchor-link">デスクトップ</a></h4>
    <figure id="page-weight-fig-8">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>合計 (KB)</th>
                <th>HTML (KB)</th>
                <th>JS (KB)</th>
                <th>CSS (KB)</th>
                <th>画像 (KB)</th>
                <th>ドキュメント (KB)</th>
              </tr>
              <tr>
                <td>90</td>
                <td>179</td>
                <td>14</td>
                <td>53</td>
                <td>20</td>
                <td>90</td>
                <td>6</td>
              </tr>
              <tr>
                <td>75</td>
                <td>118</td>
                <td>7</td>
                <td>33</td>
                <td>12</td>
                <td>54</td>
                <td>2</td>
              </tr>
              <tr>
                <td>50</td>
                <td>74</td>
                <td>4</td>
                <td>19</td>
                <td>6</td>
                <td>31</td>
                <td>0</td>
              </tr>
              <tr>
                <td>25</td>
                <td>44</td>
                <td>2</td>
                <td>10</td>
                <td>3</td>
                <td>16</td>
                <td>0</td>
              </tr>
              <tr>
                <td>10</td>
                <td>24</td>
                <td>1</td>
                <td>4</td>
                <td>1</td>
                <td>7</td>
                <td>0</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-8" class="anchor-link">図 8.</a>リソースタイプ別に分類されたデスクトップページリクエスト。</figcaption>
    </figure>
    <h3 id="page-weight-ファイル形式"><a href="#page-weight-ファイル形式" class="anchor-link">ファイル形式</a></h3>
    <p>前述の分析では、リソースタイプのレンズを通してページの重さを分析することに焦点を当ててきました。ただし、画像とメディアの場合、特定のファイル形式間のリソースサイズの違いを調べて、さらに深く掘り下げることができます。</p>
    <h4 id="page-weight-画像形式によるファイルサイズ（モバイル）"><a href="#page-weight-画像形式によるファイルサイズ（モバイル）" class="anchor-link">画像形式によるファイルサイズ（モバイル）</a></h4>
    <figure id="page-weight-fig-9">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>GIF (KB)</th>
                <th>ICO (KB)</th>
                <th>JPG (KB)</th>
                <th>PNG (KB)</th>
                <th>SVG (KB)</th>
                <th>WEBP (KB)</th>
              </tr>
              <tr>
                <td>10</td>
                <td>0</td>
                <td>0</td>
                <td>3.08</td>
                <td>0.37</td>
                <td>0.25</td>
                <td>2.54</td>
              </tr>
              <tr>
                <td>25</td>
                <td>0.03</td>
                <td>0.26</td>
                <td>7.96</td>
                <td>1.14</td>
                <td>0.43</td>
                <td>4.89</td>
              </tr>
              <tr>
                <td>50</td>
                <td>0.04</td>
                <td>1.12</td>
                <td>21</td>
                <td>4.31</td>
                <td>0.88</td>
                <td>13</td>
              </tr>
              <tr>
                <td>75</td>
                <td>0.06</td>
                <td>2.72</td>
                <td>63</td>
                <td>22</td>
                <td>2.41</td>
                <td>33</td>
              </tr>
              <tr>
                <td>90</td>
                <td>2.65</td>
                <td>13</td>
                <td>155</td>
                <td>90</td>
                <td>7.91</td>
                <td>78</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-9" class="anchor-link">図 9.</a>モバイルの画像ファイルサイズを画像形式別に分類したもの。</figcaption>
    </figure>
    <p>これらの結果の一部、特にGIFの結果は、本当に驚くべきものです。 GIFが非常に小さい場合、なぜそれらはJPG、PNG、およびWEBPなどの形式に置き換えられるのですか？</p>
    <p>上記のデータは、Web上のGIFの大部分が実際には小さな1×1ピクセルであるという事実を覆い隠しています。これらのピクセルは通常「トラッキングピクセル」として使用されますが、さまざまなCSS効果を生成するためのハックとしても使用できます。これらの1×1ピクセルは文字通りのイメージですが、その使用の精神はおそらくスクリプトまたはCSSに関連付けるものと近いでしょう。</p>
    <p>データセットをさらに調査すると、GIFの62％が43バイト以下（43バイトは透明な1×1ピクセルGIFのサイズ）であり、GIFの84％は1KB以下であることが明らかになりました。</p>
    <figure id="page-weight-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/18_Page_Weight/ch18_fig3_gif_cdf.png">
        <img src="/static/images/2019/18_Page_Weight/ch18_fig3_gif_cdf.png" alt="図10. GIFファイルサイズの累積分布関数。" aria-labelledby="page-weight-fig10-caption" aria-describedby="page-weight-fig10-description" width="600" height="330" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="page-weight-fig10-description" class="visually-hidden">GIFの25％が35バイト以下（1x1ホワイトGIFの最適サイズ）であり、GIFの62％が43バイト以下（1x1透明GIFの最適サイズ）であることを示すグラフ。これは、GIFの75％を100バイト以下に増やすだけです。</div>
      <figcaption id="page-weight-fig10-caption"><a href="#page-weight-fig-10" class="anchor-link">図 10.</a> GIFファイルサイズの累積分布関数。</figcaption>
    </figure>
    <p>以下の表は、これらの小さな画像をデータセットから削除するための2つの異なるアプローチを示しています。最初の方法は、ファイルサイズが100バイトを超える画像に基づいており、2番目はファイルサイズが1024バイトを超える画像に基づいています。</p>
    <h4 id="page-weight-画像の画像形式ごとのファイルサイズ-100バイト"><a href="#page-weight-画像の画像形式ごとのファイルサイズ-100バイト" class="anchor-link">画像の画像形式ごとのファイルサイズ&gt; 100バイト</a></h4>
    <figure id="page-weight-fig-11">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>GIF (KB)</th>
                <th>ICO (KB)</th>
                <th>JPG (KB)</th>
                <th>PNG (KB)</th>
                <th>SVG (KB)</th>
                <th>WEBP (KB)</th>
              </tr>
              <tr>
                <td>10</td>
                <td>0.27</td>
                <td>0.31</td>
                <td>3.08</td>
                <td>0.4</td>
                <td>0.28</td>
                <td>2.1</td>
              </tr>
              <tr>
                <td>25</td>
                <td>0.75</td>
                <td>0.6</td>
                <td>7.7</td>
                <td>1.17</td>
                <td>0.46</td>
                <td>4.4</td>
              </tr>
              <tr>
                <td>50</td>
                <td>2.14</td>
                <td>1.12</td>
                <td>20.47</td>
                <td>4.35</td>
                <td>0.95</td>
                <td>11.54</td>
              </tr>
              <tr>
                <td>75</td>
                <td>7.34</td>
                <td>4.19</td>
                <td>61.13</td>
                <td>21.39</td>
                <td>2.67</td>
                <td>31.21</td>
              </tr>
              <tr>
                <td>90</td>
                <td>35</td>
                <td>14.73</td>
                <td>155.46</td>
                <td>91.02</td>
                <td>8.26</td>
                <td>76.43</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-11" class="anchor-link">図 11.</a> 100バイトを超える画像の画像形式ごとのファイルサイズ。</figcaption>
    </figure>
    <h4 id="page-weight-画像の画像形式ごとのファイルサイズ--1024バイト"><a href="#page-weight-画像の画像形式ごとのファイルサイズ--1024バイト" class="anchor-link">画像の画像形式ごとのファイルサイズ &gt; 1024バイト</a></h4>
    <figure id="page-weight-fig-12">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>GIF (KB)</th>
                <th>ICO (KB)</th>
                <th>JPG (KB)</th>
                <th>PNG (KB)</th>
                <th>SVG (KB)</th>
                <th>WEBP (KB)</th>
              </tr>
              <tr>
                <td>10</td>
                <td>1.28</td>
                <td>1.12</td>
                <td>3.4</td>
                <td>1.5</td>
                <td>1.2</td>
                <td>3.08</td>
              </tr>
              <tr>
                <td>25</td>
                <td>1.9</td>
                <td>1.12</td>
                <td>8.21</td>
                <td>2.88</td>
                <td>1.52</td>
                <td>5</td>
              </tr>
              <tr>
                <td>50</td>
                <td>4.01</td>
                <td>2.49</td>
                <td>21.19</td>
                <td>8.33</td>
                <td>2.81</td>
                <td>12.52</td>
              </tr>
              <tr>
                <td>75</td>
                <td>11.92</td>
                <td>7.87</td>
                <td>62.54</td>
                <td>33.17</td>
                <td>6.88</td>
                <td>32.83</td>
              </tr>
              <tr>
                <td>90</td>
                <td>67.15</td>
                <td>22.13</td>
                <td>157.96</td>
                <td>127.15</td>
                <td>19.06</td>
                <td>79.53</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-12" class="anchor-link">図 12.</a> 1024バイトを超える画像の画像形式ごとのファイルサイズ。</figcaption>
    </figure>
    <p>
      JPEG画像に比べてPNG画像のファイルサイズが小さいことは驚くべきことです。 JPEGは<a href="https://ja.wikipedia.org/wiki/%E9%9D%9E%E5%8F%AF%E9%80%86%E5%9C%A7%E7%B8%AE">非可逆圧縮<span class="fn">https://ja.wikipedia.org/wiki/%E9%9D%9E%E5%8F%AF%E9%80%86%E5%9C%A7%E7%B8%AE</span></a
      >を使用します。非可逆圧縮によりデータが失われるため、ファイルサイズを小さくできます。一方、PNGは<a href="https://ja.wikipedia.org/wiki/%E5%8F%AF%E9%80%86%E5%9C%A7%E7%B8%AE">可逆圧縮<span class="fn">https://ja.wikipedia.org/wiki/%E5%8F%AF%E9%80%86%E5%9C%A7%E7%B8%AE</span></a
      >を使用します。これによりデータが失われることはありません。これにより、より高品質で大きな画像が生成されます。ただし、このファイルサイズの違いはエンコーディングと圧縮の違いではなく、透過性のサポートによるアイコンのグラフィックのPNGの人気を反映している可能性があります。
    </p>
    <h4 id="page-weight-メディア形式ごとのファイルサイズ"><a href="#page-weight-メディア形式ごとのファイルサイズ" class="anchor-link">メディア形式ごとのファイルサイズ</a></h4>
    <p>MP4は、今日のWebで圧倒的に最も人気のあるビデオ形式です。人気の点では、それぞれWebMとMPEG-TSが続きます。</p>
    <p>このデータセットの他のテーブルの一部とは異なり、このテーブルにはほとんど満足のいく結果があります。動画はモバイルでは常に小さく表示されるのですばらしいです。さらに、MP4ビデオのサイズの中央値は、モバイルでは18KB、デスクトップでは39KBと非常に合理的です。 WebMの数値の中央値はさらに優れていますが、一度見てください。複数のクライアントとパーセンタイルでの0.29KBの重複測定は少し疑わしいです。考えられる説明の1つは、非常に小さなWebMビデオの同一のコピーが多くのページに含まれていることです。 3つの形式のうち、MPEG-TSは常にすべてのパーセンタイルで最高のファイルサイズを持っています。これは1995年にリリースされたという事実に関連している可能性があり、これらの3つのメディア形式の中で最も古いものになっています。</p>
    <h5 id="page-weight-モバイル-3"><a href="#page-weight-モバイル-3" class="anchor-link">モバイル</a></h5>
    <figure id="page-weight-fig-13">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>MP4 (KB)</th>
                <th>WebM (KB)</th>
                <th>MPEG-TS (KB)</th>
              </tr>
              <tr>
                <td>10</td>
                <td>0.89</td>
                <td>0.29</td>
                <td>0.01</td>
              </tr>
              <tr>
                <td>25</td>
                <td>2.07</td>
                <td>0.29</td>
                <td>55</td>
              </tr>
              <tr>
                <td>50</td>
                <td>18</td>
                <td>1.44</td>
                <td>153</td>
              </tr>
              <tr>
                <td>75</td>
                <td>202</td>
                <td>223</td>
                <td>278</td>
              </tr>
              <tr>
                <td>90</td>
                <td>928</td>
                <td>390</td>
                <td>475</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-13" class="anchor-link">図 13.</a>モバイルのメディア形式によるビデオサイズ。</figcaption>
    </figure>
    <h5 id="page-weight-デスクトップ-3"><a href="#page-weight-デスクトップ-3" class="anchor-link">デスクトップ</a></h5>
    <figure id="page-weight-fig-14">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>パーセンタイル</th>
                <th>MP4 (KB)</th>
                <th>WebM (KB)</th>
                <th>MPEG-TS (KB)</th>
              </tr>
              <tr>
                <td>10</td>
                <td>0.27</td>
                <td>0.29</td>
                <td>34</td>
              </tr>
              <tr>
                <td>25</td>
                <td>1.05</td>
                <td>0.29</td>
                <td>121</td>
              </tr>
              <tr>
                <td>50</td>
                <td>39</td>
                <td>17</td>
                <td>286</td>
              </tr>
              <tr>
                <td>75</td>
                <td>514</td>
                <td>288</td>
                <td>476</td>
              </tr>
              <tr>
                <td>90</td>
                <td>2142</td>
                <td>896</td>
                <td>756</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#page-weight-fig-14" class="anchor-link">図 14.</a>デスクトップ上のメディア形式によるビデオサイズ。</figcaption>
    </figure>
    <h2 id="page-weight-結論"><a href="#page-weight-結論" class="anchor-link">結論</a></h2>
    <p>過去1年間で、ページのサイズは約10％増加しました。 Brotli、パフォーマンスバジェット、および基本的な画像最適化のベストプラクティスは、おそらくページウェイトを維持または改善すると同時に広く適用可能で実装が非常に簡単な3つのテクニックです。そうは言っても、近年ではページの重さの改善は、テクノロジー自体よりもベストプラクティスの採用が少ないことにより制約されています。言い換えれば、ページの重さを改善するための多くの既存のテクニックがありますが、それらが使用されなければ違いはありません。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"IV","chapter_number":19,"title":"リソースヒント","description":"2019年のWeb Almanacのリソースヒントの章では、dns-prefetch、preconnect、preload、prefetch、priority hints、ネイティブの遅延ローディングの使用法をカバーしています。","authors":["khempenius"],"reviewers":["andydavies","bazzadp","yoavweiss"],"translators":["ksakae"],"discuss":"1774","results":"https://docs.google.com/spreadsheets/d/14QBP8XGkMRfWRBbWsoHm6oDVPkYhAIIpfxRn4iOkbUU/","queries":"19_Resource_Hints","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-06-30T00:00:00.000Z","chapter":"resource-hints"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="resource-hints-序章"><a href="#resource-hints-序章" class="anchor-link">序章</a></h2>
    <p>
      <a href="https://www.w3.org/TR/resource-hints/">リソースヒント<span class="fn">https://www.w3.org/TR/resource-hints/</span></a> は、どのようなリソースがすぐに必要になるかについての「ヒント」をブラウザに提供します。このヒントを受け取った結果としてブラウザが取るアクションは、リソースヒントの種類によって異なります。リソースヒントは正しく使用されると、重要なアクションを先取りすることでページのパフォーマンスを向上させることができます。
    </p>
    <p>
      <a href="https://youtu.be/YJGCZCaIZkQ?t=1956">例<span class="fn">https://youtu.be/YJGCZCaIZkQ?t=1956</span></a
      >は、リソースヒントの結果としてパフォーマンスが向上しています。
    </p>
    <ul>
      <li>Jabongは、重要なスクリプトをプリロードすることで、対話までの時間を1.5秒短縮しました。</li>
      <li>Barefoot Wineは、目に見えるリンクを先読みすることで、将来のページの対話までの時間を2.7秒短縮しました。</li>
      <li>Chrome.comは、クリティカルなオリジンに事前接続することで、待ち時間を0.7秒短縮しました。</li>
    </ul>
    <p>今日、ほとんどのブラウザでサポートされているリソースヒントには、4つの独立したものがあります。<code>dns-prefetch</code>, <code>preconnect</code>, <code>preload</code>, <code>prefetch</code> です。</p>
    <h3 id="resource-hints-dns-prefetch">
      <a href="#resource-hints-dns-prefetch" class="anchor-link"><code>dns-prefetch</code></a>
    </h3>
    <p>
      <a href="https://developer.mozilla.org/en-US/docs/Learn/Performance/dns-prefetch"><code>dns-prefetch</code><span class="fn">https://developer.mozilla.org/en-US/docs/Learn/Performance/dns-prefetch</span></a
      >の役割は、初期のDNS検索を開始することである。サードパーティのDNSルックアップを完了させるのに便利です。たとえば、CDN、フォントプロバイダー、サードパーティAPIのDNSルックアップなどです。
    </p>
    <h3 id="resource-hints-preconnect">
      <a href="#resource-hints-preconnect" class="anchor-link"><code>preconnect</code></a>
    </h3>
    <p>
      <a href="https://web.dev/uses-rel-preconnect"><code>preconnect</code><span class="fn">https://web.dev/uses-rel-preconnect</span></a
      >は、DNSルックアップ、TCPハンドシェイク、TLSネゴシエーションを含む早期接続を開始します。このヒントはサードパーティとの接続を設定する際に有用である。<code>preconnect</code>の用途は<code>dns-prefetch</code>の用途と非常によく似ているが、<code>preconnect</code>はブラウザのサポートが少ない。しかし、IE 11のサポートを必要としないのであれば、preconnectの方が良い選択であろう。
    </p>
    <h3 id="resource-hints-preload">
      <a href="#resource-hints-preload" class="anchor-link"><code>preload</code></a>
    </h3>
    <p>
      <a href="https://medium.com/reloading/preload-prefetch-and-priorities-in-chrome-776165961bbf"><code>preload</code><span class="fn">https://medium.com/reloading/preload-prefetch-and-priorities-in-chrome-776165961bbf</span></a
      >ヒントは、早期のリクエストを開始します。これは、パーサによって発見されるのが遅れてしまうような重要なリソースをロードするのに便利です。たとえば、ブラウザがスタイルシートを受信し解析したあとでしか重要な画像を発見できない場合、画像をプリロードすることは意味があるかもしれません。
    </p>
    <h3 id="resource-hints-prefetch">
      <a href="#resource-hints-prefetch" class="anchor-link"><code>prefetch</code></a>
    </h3>
    <p>
      <a href="https://calendar.perfplanet.com/2018/all-about-prefetching/"><code>prefetch</code><span class="fn">https://calendar.perfplanet.com/2018/all-about-prefetching/</span></a
      >は優先度の低いリクエストを開始します。これは、次の（現在のページではなく）ページの読み込みで使われるであろうリソースを読み込むのに便利です。プリフェッチの一般的な使い方は、アプリケーションが次のページロードで使われると「予測」したリソースをロードすることです。これらの予測は、ユーザーのマウスの動きや、一般的なユーザーの流れ/旅のようなシグナルに基づいているかもしれません。
    </p>
    <h2 id="resource-hints-文法"><a href="#resource-hints-文法" class="anchor-link">文法</a></h2>
    <p>
      リソースヒント使用率の97%は、リソースヒントを指定するために<a href="https://developer.mozilla.org/ja/docs/Web/HTML/Element/link"><code>&lt;link&gt;</code><span class="fn">https://developer.mozilla.org/ja/docs/Web/HTML/Element/link</span></a
      >タグを使用しています。たとえば、以下のようになります。
    </p>
    <pre><code>&lt;link rel="prefetch" href="shopping-cart.js"&gt;</code></pre>
    <p>
      リソースヒント使用率のわずか3%は、リソースヒントの指定に<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Link">HTTPヘッダ<span class="fn">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Link</span></a
      >を使用しました。たとえば、以下のようになります。
    </p>
    <pre><code>Link: &lt;https://example.com/shopping-cart.js&gt;; rel=prefetch</code></pre>
    <p>HTTPヘッダー内のリソースヒントの使用量が非常に少ないため、本章の残りの部分では、<code>&lt;link&gt;</code>タグと組み合わせたリソースヒントの使用量の分析のみに焦点を当てています。しかし、今後、<a href="#http2-http2プッシュ">HTTP/2 Push</a>が採用されるようになると、HTTPヘッダーでのリソースヒントの使用量が増える可能性のあることは注目に値します。これは、HTTP/2 Pushがリソースをプッシュするためのシグナルとして、HTTPのプリロード <code>Link</code> ヘッダーを再利用していることに起因しています。</p>
    <h2 id="resource-hints-リソースヒント"><a href="#resource-hints-リソースヒント" class="anchor-link">リソースヒント</a></h2>
    <p class="note">注: モバイルとデスクトップでは、リソースヒントの利用パターンに目立った違いはありませんでした。そのため、簡潔にするために、本章ではモバイルの統計のみを掲載しています。</p>
    <figure id="resource-hints-fig-1">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>リソースヒント</th>
                <th>利用状況（サイトの割合）</th>
              </tr>
              <tr>
                <td><code>dns-prefetch</code></td>
                <td>29%</td>
              </tr>
              <tr>
                <td><code>preload</code></td>
                <td>16%</td>
              </tr>
              <tr>
                <td><code>preconnect</code></td>
                <td>4%</td>
              </tr>
              <tr>
                <td><code>prefetch</code></td>
                <td>3%</td>
              </tr>
              <tr>
                <td><code>prerender</code> (非推奨)</td>
                <td>0.13%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#resource-hints-fig-1" class="anchor-link">図 1.</a> リソースヒントの採用。</figcaption>
    </figure>
    <p>
      <code>dns-prefetch</code>の相対的な人気は驚くに値しません。これはよく知られたAPIであり（<a href="https://caniuse.com/#feat=link-rel-dns-prefetch">2009<span class="fn">https://caniuse.com/#feat=link-rel-dns-prefetch</span></a
      >ではじめて登場しました）、すべての主要なブラウザでサポートされており、すべてのリソースヒントの中でもっとも「安価」なものです。<code>dns-prefetch</code>はDNSの検索を行うだけなので、データの消費量が非常に少なく、使用する上でのデメリットはほとんどありません。<code>dns-prefetch</code>はレイテンシの高い状況でもっとも有用である。
    </p>
    <p>
      つまり、IE11以下をサポートする必要がないサイトであれば、<code>dns-prefetch</code>から<code>preconnect</code>に切り替えるのが良いでしょう。HTTPSがユビキタスな時代には、<code>preconnect</code>は安価でありながら、より大きな<a href="#performance">パフォーマンス</a>の向上をもたらします。<code>dns-prefetch</code>とは異なり、<code>preconnect</code>はDNSの検索だけでなく、TCPハンドシェイクとTLSネゴシエーションも開始することに注意してください。<a href="https://knowledge.digicert.com/solution/SO16297.html">証明書チェーン<span class="fn">https://knowledge.digicert.com/solution/SO16297.html</span></a
      >はTLSネゴシエーション中にダウンロードされるが、これには通常数キロバイトのコストがかかります。
    </p>
    <p><code>prefetch</code>は3%のサイトで利用されており、もっとも広く利用されていないリソースヒントである。この使用率の低さは、<code>prefetch</code>が現在のページの読み込みよりも後続のページの読み込みを改善するのに有用であるという事実によって説明できるかもしれません。したがって、ランディングページの改善や最初に閲覧されたページのパフォーマンスを向上させることだけに焦点を当てているサイトでは、これは見過ごされてしまうだろう。</p>
    <figure id="resource-hints-fig-2">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th>リソースヒント</th>
                <th>ページごとのリソースヒント<br />中央値</th>
                <th>ページごとのリソースヒント<br />90パーセンタイル</th>
              </tr>
              <tr>
                <td><code>dns-prefetch</code></td>
                <td>2</td>
                <td>8</td>
              </tr>
              <tr>
                <td><code>preload</code></td>
                <td>2</td>
                <td>4</td>
              </tr>
              <tr>
                <td><code>preconnect</code></td>
                <td>2</td>
                <td>8</td>
              </tr>
              <tr>
                <td><code>prefetch</code></td>
                <td>1</td>
                <td>3</td>
              </tr>
              <tr>
                <td><code>prerender</code> (非推奨)</td>
                <td>1</td>
                <td>1</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#resource-hints-fig-2" class="anchor-link">図 2.</a> そのリソースヒントを使用している全ページのうち、1ページあたりに使用されているリソースヒントの数の中央値と90パーセンタイル。</figcaption>
    </figure>
    <p>リソースヒントは、選択的に使用されるときにもっとも効果的です（<em>"すべてが重要なときには、何も重要ではない"</em>）。上の図2は、少なくとも1つのリソースヒントを使用しているページの1ページあたりのリソースヒントの数を示しています。適切なリソースヒントの数を定義する明確なルールはありませんが、ほとんどのサイトが適切にリソースヒントを使用しているように見えます。</p>
    <h2 id="resource-hints-crossorigin属性">
      <a href="#resource-hints-crossorigin属性" class="anchor-link"><code>crossorigin</code>属性</a>
    </h2>
    <p>
      ウェブ上に取り込まれるほとんどの「伝統的な」リソース（<a href="#media">images</a>、<a href="#css">stylesheets</a>、<a href="#javascript">script</a>）は、クロスオリジンリソース共有（<a href="https://developer.mozilla.org/ja/docs/Web/HTTP/CORS">CORS<span class="fn">https://developer.mozilla.org/ja/docs/Web/HTTP/CORS</span></a
      >）を選択せずに取り込まれています。つまり、これらのリソースがクロスオリジンサーバーからフェッチされた場合、デフォルトでは同一オリジンポリシーのために、その内容をページで読み返すことができないということです。
    </p>
    <p>場合によっては、ページはコンテンツを読む必要がある場合、CORSを使用してリソースを取得するようにオプトインできます。CORSは、ブラウザが「許可を求める」ことを可能にし、それらのクロスオリジンリソースへのアクセスを取得します。</p>
    <p>新しいリソースタイプ（フォント、<code>fetch()</code> リクエスト、ESモジュールなど）では、ブラウザはデフォルトでCORSを使用してリソースをリクエストし、サーバーがアクセス許可を与えていない場合はリクエストを完全に失敗させます。</p>
    <figure id="resource-hints-fig-3">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <tbody>
              <tr>
                <th><code>クロスオリジン</code>値</th>
                <th>使用方法</th>
                <th>説明</th>
              </tr>
              <tr>
                <td>未設定</td>
                <td>92%</td>
                <td>crossorigin属性がない場合、リクエストはシングルオリジンポリシーに従います。</td>
              </tr>
              <tr>
                <td>anonymous(に相当する)</td>
                <td>7%</td>
                <td>クレデンシャルを含まないクロスオリジンリクエストを実行します。</td>
              </tr>
              <tr>
                <td>use-credentials</td>
                <td>0.47%</td>
                <td>クレデンシャルを含むクロスオリジンリクエストを実行します。</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#resource-hints-fig-3" class="anchor-link">図 3.</a> リソースヒントインスタンスの割合としての<code>クロスオリジン</code>属性の採用。</figcaption>
    </figure>
    <p>リソースヒントのコンテキストでは、<code>crossorigin</code>属性を使用することで、マッチすることになっているリソースのCORSモードにマッチし、リクエストに含めるべき資格情報を示すことができます。たとえば、<code>anonymous</code>はCORSを有効にし、クロスオリジンリクエストには資格情報を含めるべきではないことを示します。</p>
    <pre><code>&lt;link rel="prefetch" href="https://other-server.com/shopping-cart.css" crossorigin="anonymous"&gt;</code></pre>
    <p>他のHTML要素はcrossorigin属性をサポートしていますが、この分析では、リソースヒントを使った使用法のみを見ています。</p>
    <h2 id="resource-hints-as属性">
      <a href="#resource-hints-as属性" class="anchor-link"><code>as</code>属性</a>
    </h2>
    <p>
      <code>as</code>は<code>preload</code>リソースヒントと一緒に使用されるべき属性で、要求されたリソースの種類（画像、スクリプト、スタイルなど）をブラウザに知らせるため使用されます。これにより、ブラウザがリクエストに正しく優先順位をつけ、正しいコンテンツセキュリティポリシー(<a href="https://developers.google.com/web/fundamentals/security/csp">CSP<span class="fn">https://developers.google.com/web/fundamentals/security/csp</span></a
      >)を適用するのに役立ちます。CSPはHTTPヘッダーで表現される<a href="#security">セキュリティ</a>メカニズムです、信頼できるソースのセーフリストを宣言することで、XSSやその他の悪意のある攻撃の影響を緩和するのに役立ちます。
    </p>
    <figure id="resource-hints-fig-4">
      <div class="big-number">88%</div>
      <figcaption><a href="#resource-hints-fig-4" class="anchor-link">図 4.</a> <code>as</code>属性を使用したリソースヒントインスタンスの割合。</figcaption>
    </figure>
    <p>リソースヒントインスタンスの88%は<code>as</code>属性を使用しています。<code>as</code>が指定されている場合、圧倒的にスクリプトに使われています。92%がスクリプト、3%がフォント、3%がスタイルです。これはスクリプトがほとんどのサイトのアーキテクチャで重要な役割を果たしていることと、スクリプトが攻撃のベクターとして使用される頻度が高いことを考えると当然のことです（したがって、スクリプトが正しいCSPを適用されることがとくに重要です）。</p>
    <h2 id="resource-hints-将来のこと"><a href="#resource-hints-将来のこと" class="anchor-link">将来のこと</a></h2>
    <p>現時点では、現在のリソースヒントのセットを拡張する提案はありません。しかし、優先度ヒントとネイティブの遅延ローディングは、ローディングプロセスを最適化するためのAPIを提供するという点で、リソースヒントに似た精神を持つ2つの技術が提案されています。</p>
    <h3 id="resource-hints-優先順位のヒント"><a href="#resource-hints-優先順位のヒント" class="anchor-link">優先順位のヒント</a></h3>
    <p>
      <a href="https://wicg.github.io/priority-hints/">優先度ヒント<span class="fn">https://wicg.github.io/priority-hints/</span></a
      >は、リソースのフェッチの優先度を<code>high</code>,<code>low</code>,<code>auto</code>のいずれかで表現するためのAPIです。これらは幅広いHTMLタグで利用できます。とくに<code>&lt;image&gt;</code>,<code>&lt;link</code>&gt;,<code>&lt;script&gt;</code>,<code>&lt;iframe&gt;</code>などです。
    </p>
    <figure id="resource-hints-fig-5">
      <div class="code-block floating-card">
        <pre><code>&lt;carousel&gt;
  &lt;img src="cat1.jpg" importance="high"&gt;
  &lt;img src="cat2.jpg" importance="low"&gt;
  &lt;img src="cat3.jpg" importance="low"&gt;
&lt;/carousel&gt;</code></pre>
      </div>
      <figcaption><a href="#resource-hints-fig-5" class="anchor-link">図 5.</a> 画像のカルーセルで優先度ヒントを使用するHTMLの例。</figcaption>
    </figure>
    <p>たとえば、画像カルーセルがある場合、優先度ヒントを使用して、ユーザーがすぐに見る画像に優先順位をつけ、後の画像に優先順位をつけることができます。</p>
    <figure id="resource-hints-fig-6">
      <div class="big-number">0.04%</div>
      <figcaption><a href="#resource-hints-fig-6" class="anchor-link">図 6.</a> 優先ヒントの採用率。</figcaption>
    </figure>
    <p>
      優先度ヒントは<a href="https://www.chromestatus.com/feature/5273474901737472">実装<span class="fn">https://www.chromestatus.com/feature/5273474901737472</span></a
      >されており、Chromiumブラウザのバージョン70以降では機能フラグを使ってテストできます。まだ実験的な技術であることを考えると、0.04%のサイトでしか使用されていないのは当然のことです。
    </p>
    <p>優先度ヒントの85%は<code>&lt;img&gt;</code>タグを使用しています。優先度ヒントはほとんどがリソースの優先順位を下げるために使われます。使用率の72%は<code>importance="low"</code>で、28%は<code>importance="high"</code>です。</p>
    <h3 id="resource-hints-ネイティブの遅延ローディング"><a href="#resource-hints-ネイティブの遅延ローディング" class="anchor-link">ネイティブの遅延ローディング</a></h3>
    <p>
      <a href="https://web.dev/native-lazy-loading">ネイティブの遅延ローディング<span class="fn">https://web.dev/native-lazy-loading</span></a
      >は、画面外の画像やiframeの読み込みを遅延させるためのネイティブAPIです。これにより、最初のページ読み込み時にリソースを解放し、使用されないアセットの読み込みを回避できます。以前は、この技術はサードパーティの<a href="#javascript">JavaScript</a>ライブラリでしか実現できませんでした。
    </p>
    <p>ネイティブな遅延読み込みのためのAPIはこのようになります。<code>&lt;img src="cat.jpg"&gt;</code>.</p>
    <p>ネイティブな遅延ローディングは、Chromium76以上をベースにしたブラウザで利用可能です。このAPIは発表が遅すぎて今年のWeb Almanacのデータセットには含まれていませんが、来年に向けて注目しておきたいものです。</p>
    <h2 id="resource-hints-結論"><a href="#resource-hints-結論" class="anchor-link">結論</a></h2>
    <p>全体的に、このデータはリソースヒントをさらに採用する余地があることを示唆しているように思われる。ほとんどのサイトでは、<code>dns-prefetch</code>から<code>preconnect</code>に切り替えることで恩恵を受けることができるだろう。もっと小さなサブセットのサイトでは、<code>prefetch</code>や<code>preload</code>を採用することで恩恵を受けることができるだろう。<code>prefetch</code>と<code>preload</code>をうまく使うには、より大きなニュアンスがあり、それが採用をある程度制限していますが、潜在的な利益はより大きくなります。HTTP/2 Pushや機械学習技術の成熟により、<code>preload</code>や<code>prefetch</code>の採用が増える可能性もあります。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% set metadata = {"part_number":"IV","chapter_number":20,"title":"HTTP/2","description":"HTTP/2、HTTP/2プッシュ、HTTP/2の問題、およびHTTP/3の採用と影響をカバーするWeb Almanac 2019のHTTP/2章","authors":["bazzadp"],"reviewers":["bagder","rmarx","dotjs"],"translators":["ksakae"],"discuss":"1775","results":"https://docs.google.com/spreadsheets/d/1z1gdS3YVpe8J9K3g2UdrtdSPhRywVQRBz5kgBeqCnbw/","queries":"20_HTTP_2","published":"2019-11-11T00:00:00.000Z","last_updated":"2020-05-19T00:00:00.000Z","chapter":"http2"} %} {% set chapter_image_dir = ("/static/images/2019/%s" % metadata.chapter) %}
<section class="chapter" id="chapter-{{ metadata.get('chapter_number') }}">
  <div class="body" id="{{ metadata.get('chapter') }}">
    <div class="subtitle">
      {{ self.part() }} {{ metadata.get('part_number') }} {{ self.chapter() }} {{ metadata.get('chapter_number') }}
    </div>
    <h1 class="title title-lg">
      {{ metadata.get('title') }} {% if metadata.get('unedited', false) %}
      <span class="chapter-unedited">{{ self.unedited() }}</span>
      {% endif %}
    </h1>

    <!-- Show large image for large screens and high density screens and use webp when supported -->
    <picture>
      <source media="(min-width: 327px)" type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp" />
      <source media="(min-width: 327px)" type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_lg.webp 2x" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_lg.jpg 2x" />
      <source type="image/webp" srcset="{{ chapter_image_dir }}/hero_sm.webp" />
      <source type="image/jpeg" srcset="{{ chapter_image_dir }}/hero_sm.jpg" />
      <img src="{{ chapter_image_dir }}/hero_lg.jpg" class="content-banner" alt="" width="866" height="433" />
    </picture>

    <div class="byline">{{ self.written_by_before() }} {% for author in metadata.get('authors') %} <a class="author" href="#contributors-{{ author }}">{{ config.contributors[author].name if author in config.contributors else author }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.written_by_after() }}</div>

    <div class="byline reviewers">{{ self.reviewed_by_before() }} {% for reviewer in metadata.get('reviewers') %} <a class="reviewer" href="#contributors-{{ reviewer }}">{{ config.contributors[reviewer].name if reviewer in config.contributors else reviewer }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.reviewed_by_after() }}</div>

    {% if metadata.get('translators') | length >= 1 %}
    <div class="byline translators">{{ self.translated_by_before() }} {% for translator in metadata.get('translators') %} <a class="translator" href="#contributors-{{ translator }}">{{ config.contributors[translator].name if translator in config.contributors else translator }}</a>{% if loop.index != loop.length and loop.length != 2 %},{% endif %} {% if loop.index == loop.length - 1 %}{{ self.and() }}{% endif %} {% endfor %}{{ self.translated_by_after() }}</div>
    {% endif %}
    <h2 id="http2-導入"><a href="#http2-導入" class="anchor-link">導入</a></h2>
    <p>HTTP/2は、ほぼ20年ぶりになるWebのメイン送信プロトコルの初となるメジャーアップデートでした。それは多くの期待を持って到来し、欠点なしで無料のパフォーマンス向上を約束しました。それ以上に、HTTP/1.1が非効率なため強制されていたすべてのハックや回避策をやめることができました。デフォルトでパフォーマンスが向上するため、ドメインのバンドル、分割、インライン化、さらにはシャーディングなどはすべてHTTP/2の世界でアンチパターンになります。</p>
    <p>
      これは、<a href="#performance">Webパフォーマンス</a>に集中するスキルとリソースを持たない人でも、すぐにパフォーマンスの高いWebサイトにできます。しかし現実はほぼ相変わらずです。 2015年5月に<a href="https://tools.ietf.org/html/rfc7540">RFC 7540<span class="fn">https://tools.ietf.org/html/rfc7540</span></a
      >で標準としてHTTP/2に正式承認されてから4年以上経過してます。ということでこの比較的新しい技術が現実の世界でどのように発展したかを見てみる良い機会です。
    </p>
    <h2 id="http2-http2とは"><a href="#http2-http2とは" class="anchor-link">HTTP/2とは?</a></h2>
    <p>この技術に精通していない人にとって、この章のメトリックと調査結果を最大限に活用するには、ちょっとした背景が役立ちます。最近までHTTPは常にテキストベースのプロトコルでした。 WebブラウザーのようなHTTPクライアントがサーバーへのTCP接続を開き、<code>GET /index.html</code>のようなHTTPコマンドを送信して、リソースを要求します。</p>
    <p>これは<em>HTTPヘッダー</em>を追加するためにHTTP/1.0で拡張されました、なのでリクエストに加えてブラウザの種類、理解できる形式などさまざまなメタデータを含めることができます。これらのHTTPヘッダーもテキストベースであり改行文字で区切られていました。サーバーは、要求とHTTPヘッダーを1行ずつ読み取ることで着信要求を解析し、サーバーは要求されている実際のリソースに加えて独自のHTTP応答ヘッダーで応答しました。</p>
    <p>プロトコルはシンプルに見えましたが制限もありました。 なぜならHTTPは本質的に同期であるため、HTTP要求が送信されると応答が返され、読み取られ、処理されるまでTCP接続全体が基本的に他のすべてに対して制限されていました。これは非常に効率が悪く、限られた形式の並列化を可能にするため複数のTCP接続（ブラウザーは通常6接続を使用）が必要でした。</p>
    <p>特に暗号化を設定するための追加の手順を必要とするHTTPSを使用する場合、TCP接続は設定と完全な効率を得るのに時間とリソースを要するため、それ自体に問題が生じます。 HTTP/1.1はこれを幾分改善し、後続のリクエストでTCP接続を再利用できるようにしましたが、それでも並列化の問題は解決しませんでした。</p>
    <p>HTTPはテキストベースですが、実際、少なくとも生の形式でテキストを転送するために使用されることはほとんどありませんでした。 HTTPヘッダーがテキストのままであることは事実でしたが、ペイロード自体しばしばそうではありませんでした。 <a href="#markup">HTML</a>、<a href="#javascript">JS</a>、<a href="#css">CSS</a>などのテキストファイルは通常、gzip、brotliなどを使用してバイナリ形式に転送するため<a href="#compression">圧縮</a>されます。<a href="#media">画像や動画</a> などの非テキストファイルは、独自の形式で提供されます。その後、<a href="#security">セキュリティ</a>上の理由からメッセージ全体を暗号化するために、HTTPメッセージ全体がHTTPSでラップされることがよくあります。</p>
    <p>そのため、Webは基本的に長い間テキストベースの転送から移行していましたが、HTTPは違いました。この停滞の1つの理由は、HTTPのようなユビキタスプロトコルに重大な変更を導入することが非常に困難だったためです（以前努力しましたが、失敗しました）。多くのルーター、ファイアウォール、およびその他のミドルボックスはHTTPを理解しており、HTTPへの大きな変更に対して過剰に反応します。それらをすべてアップグレードして新しいバージョンをサポートすることは、単に不可能でした。</p>
    <p>
      2009年に、Googleは<a href="https://www.chromium.org/spdy">SPDY<span class="fn">https://www.chromium.org/spdy</span></a
      >と呼ばれるテキストベースのHTTPに代わるものへ取り組んでいると発表しましたが、SPDYは非推奨です。これはHTTPメッセージがしばしばHTTPSで暗号化されるという事実を利用しており、メッセージが読み取られ途中で干渉されるのを防ぎます。
    </p>
    <p>Googleは、最も人気のあるブラウザー（Chrome）と最も人気のあるWebサイト（Google、YouTube、Gmailなど）の1つを制御しました。 Googleのアイデアは、HTTPメッセージを独自の形式にパックし、インターネット経由で送信してから反対側でアンパックすることでした。独自の形式であるSPDYは、テキストベースではなくバイナリベースでした。これにより、単一のTCP接続をより効率的に使用できるようになり、HTTP/1.1で標準になっていた6つの接続を開く必要がなくなりHTTP/1.1の主要なパフォーマンス問題の一部が解決しました。</p>
    <p>現実の世界でSPDYを使用することで、ラボベースの実験結果だけでなく、実際のユーザーにとってより高性能であることを証明できました。すべてのGoogle WebサイトにSPDYを展開した後、他のサーバーとブラウザーが実装を開始し、この独自の形式をインターネット標準に標準化するときが来たため、HTTP/2が誕生しました。</p>
    <p>HTTP/2には次の重要な概念があります。</p>
    <ul>
      <li>バイナリ形式</li>
      <li>多重化</li>
      <li>フロー制御</li>
      <li>優先順位付け</li>
      <li>ヘッダー圧縮</li>
      <li>プッシュ</li>
    </ul>
    <p>
      <strong>バイナリ形式</strong>とは、HTTP/2メッセージが事前定義された形式のフレームに包まれることを意味しHTTPメッセージの解析が容易になり、改行文字のスキャンが不要になります。これは、以前のバージョンのHTTPに対して多くの<a href="https://www.owasp.org/index.php/HTTP_Response_Splitting">脆弱性<span class="fn">https://www.owasp.org/index.php/HTTP_Response_Splitting</span></a
      >があったため、セキュリティにとってより優れています。また、HTTP/2接続を<strong>多重化</strong>できることも意味します。各フレームにはストリーム識別子とその長さが含まれているため、異なるストリームの異なるフレームを互いに干渉することなく同じ接続で送信できます。多重化により、追加の接続を開くオーバーヘッドなしで、単一のTCP接続をより効率的に使用できます。理想的にはドメインごと、または<a href="https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing/">複数のドメイン<span class="fn">https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing/</span></a
      >に対しても単一の接続を開きます！
    </p>
    <p>個別のストリームを使用すると、潜在的な利点とともにいくつかの複雑さが取り入れられます。 HTTP/2は異なるストリームが異なるレートでデータを送信できるようにする<strong>フロー制御</strong>の概念を必要としますが、以前応答は1つに1つだけで、これはTCPフロー制御によって接続レベルで制御されていました。同様に、<strong>優先順位付け</strong>では複数のリクエストを一緒に送信できますが、最も重要なリクエストではより多くの帯域幅を取得できます。</p>
    <p>
      最後に、HTTP/2には、<strong>ヘッダー圧縮</strong>と<strong>HTTP/2プッシュと</strong>いう2つの新しい概念が導入されました。ヘッダー圧縮により、セキュリティ上の理由からHTTP/2固有の<a href="https://tools.ietf.org/html/rfc7541">HPACK<span class="fn">https://tools.ietf.org/html/rfc7541</span></a
      >形式を使用して、これらのテキストベースのHTTPヘッダーをより効率的に送信できました。 HTTP/2プッシュにより、要求への応答として複数の応答を送信できるようになり、クライアントが必要と認識する前にサーバーがリソースを「プッシュ」できるようになりました。プッシュは、CSSやJavaScriptなどのリソースをHTMLに直接インライン化して、それらのリソースが要求されている間、ページが保持されないようにするというパフォーマンスの回避策を解決することになっています。 HTTP/2を使用するとCSSとJavaScriptは外部ファイルとして残りますが、最初のHTMLと共にプッシュされるため、すぐに利用できました。これらのリソースはキャッシュされるため後続のページリクエストはこれらのリソースをプッシュしません。したがって、帯域幅を浪費しません。
    </p>
    <p>
      急ぎ足で紹介したこのHTTP/2は、新しいプロトコルの主な歴史と概念を提供します。この説明から明らかなように、HTTP/2の主な利点は、HTTP/1.1プロトコルのパフォーマンス制限に対処することです。また、セキュリティの改善も行われました。恐らく最も重要なのは、HTTP/2以降のHTTPSを使用するパフォーマンスの問題に対処することです、HTTPSを使用しても<a href="https://www.httpvshttps.com/">通常のHTTPよりもはるかに高速<span class="fn">https://www.httpvshttps.com/</span></a
      >です。 HTTPメッセージを新しいバイナリ形式に包むWebブラウザーと、反対側でWebサーバーがそれを取り出す以外は、HTTP自体の中核的な基本はほぼ同じままでした。これは、ブラウザーとサーバーがこれを処理するため、WebアプリケーションがHTTP/2をサポートするために変更を加える必要がないことを意味します。オンにすることで、無料でパフォーマンスを向上させることができるため、採用は比較的簡単です。もちろん、Web開発者がHTTP/2を最適化して、その違いを最大限に活用する方法もあります。
    </p>
    <h2 id="http2-http2の採用"><a href="#http2-http2の採用" class="anchor-link">HTTP/2の採用</a></h2>
    <p>
      前述のように、インターネットプロトコルはインターネットを構成するインフラストラクチャの多くに深く浸透しているため、しばしば採用を難しくする事があります。これにより、変更の導入が遅くなり、困難になります。たとえば、IPv6は20年前から存在していますが、<a href="https://www.google.com/intl/en/ipv6/statistics.html">採用に苦労しています。<span class="fn">https://www.google.com/intl/en/ipv6/statistics.html</span></a>
    </p>
    <figure id="http2-fig-1">
      <div class="big-number">95%</div>
      <figcaption><a href="#http2-fig-1" class="anchor-link">図 1.</a> HTTP/2を使用できるグローバルユーザーの割合。</figcaption>
    </figure>
    <p>
      ただし、HTTP/2はHTTPSで事実上隠されていたため異なってました（少なくともブラウザーの使用例では）、ブラウザーとサーバーの両方がサポートしている限り、採用の障壁を取り除いてきました。ブラウザーのサポートはしばらく前から非常に強力であり、<em>最新バージョン</em>へ自動更新するブラウザーの出現により、<a href="https://caniuse.com/#feat=http2">グローバルユーザーの推定95％がHTTP/2をサポートするようになりました<span class="fn">https://caniuse.com/#feat=http2</span></a
      >。
    </p>
    <p>私たちの分析は、Chromeブラウザで約500万の上位デスクトップおよびモバイルWebサイトをテストするHTTP Archiveから提供されています。(<a href="#methodology">方法論</a>の詳細をご覧ください。)</p>
    <figure id="http2-fig-2">
      <a href="https://almanac.httparchive.org/static/images/2019/http2/ch20_fig2_http2_usage_by_request.png">
        <img alt="図2.要求によるHTTP/2の使用。" aria-labelledby="http2-fig2-caption" aria-describedby="http2-fig2-description" src="/static/images/2019/http2/ch20_fig2_http2_usage_by_request.png" width="600" height="321" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig2-description" data-show-text="{{ show_description(2) }}" data-hide-text="{{ hide_description(2) }}">{{ show_description(2) }}</button>
      <div id="http2-fig2-description" class="visually-hidden">2019年7月現在、デスクトップとモバイルの両方で55％採用されているHTTP/2使用の時系列チャート。傾向は年間約15ポイントで着実に増加しています。</div>
      <figcaption id="http2-fig2-caption">
        <a href="#http2-fig-2" class="anchor-link">図 2.</a>要求によるHTTP/2の使用。(引用: <a href="https://httparchive.org/reports/state-of-the-web#h2">HTTP Archive<span class="fn">https://httparchive.org/reports/state-of-the-web#h2</span></a
        >)
      </figcaption>
    </figure>
    <p>結果は、HTTP/2の使用が、現在過半数のプロトコルであることを示しています。これは、正式な標準化からわずか4年後の目覚しい偉業です。要求ごとのすべてのHTTPバージョンの内訳を見ると、次のことがわかります。</p>
    <figure id="http2-fig-3">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>Protocol</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
                <th>合計</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
                <td>5.60%</td>
                <td>0.57%</td>
                <td>2.97%</td>
              </tr>
              <tr>
                <td>HTTP/0.9</td>
                <td>0.00%</td>
                <td>0.00%</td>
                <td>0.00%</td>
              </tr>
              <tr>
                <td>HTTP/1.0</td>
                <td>0.08%</td>
                <td>0.05%</td>
                <td>0.06%</td>
              </tr>
              <tr>
                <td>HTTP/1.1</td>
                <td>40.36%</td>
                <td>45.01%</td>
                <td>42.79%</td>
              </tr>
              <tr>
                <td>HTTP/2</td>
                <td>53.96%</td>
                <td>54.37%</td>
                <td>54.18%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-3" class="anchor-link">図 3.</a>要求によるHTTPバージョンの使用。</figcaption>
    </figure>
    <p>図3は、HTTP/1.1およびHTTP/2が、予想どおり大部分の要求で使用されるバージョンであることを示しています。古いHTTP/1.0とHTTP/0.9プロトコルでは、ごく少数のリクエストしかありません。面倒なことに、特にデスクトップでHTTP Archiveクロールによってプロトコルは正しく追跡されなかった割合が大きくなっています。これを掘り下げた結果、さまざまな理由が示され、そのいくつかは説明できますが、いくつかは説明できません。スポットチェックに基づいて、それらは概ねHTTP/1.1リクエストであるように見え、それらを想定するとデスクトップとモバイルの使用は似ています。</p>
    <p>私たちが望むよりもノイズの割合が少し大きいにもかかわらず、ここで伝えられるメッセージ全体を変えることはしません。それ以外、モバイル/デスクトップの類似性は予想外ではありません。 HTTP Archiveは、デスクトップとモバイルの両方でHTTP/2をサポートするChromeでテストします。実際の使用状況は、両方のブラウザーの古い使用状況で統計値がわずかに異なる場合がありますが、それでもサポートは広く行われているため、デスクトップとモバイルの間に大きな違いはないでしょう。</p>
    <p>
      現在、HTTP ArchiveはHTTP over <a href="https://www.chromium.org/quic">QUIC<span class="fn">https://www.chromium.org/quic</span></a
      >（もうすぐ<a href="#http2-http3">HTTP/3</a>として標準化される予定）を個別に追跡しないため、これらの要求は現在HTTP/2の下にリストされますが、この章の後半でそれを測定する他の方法を見ていきます。
    </p>
    <p>リクエストの数を見ると、一般的なリクエストのため結果が多少歪んでいます。たとえば、多くのサイトはHTTP/2をサポートするGoogleアナリティクスを読み込むため、埋め込みサイト自体がHTTP/2をサポートしていない場合でもHTTP/2リクエストとして表示されます。一方、人気のあるウェブサイトはHTTP/2をサポートする傾向があり、上記の統計では1回しか測定されないため、過小評価されます（「google.com」と「obscuresite.com」には同じ重みが与えられます）。<em>嘘、いまいましい嘘と統計です。</em></p>
    <p>
      ただし、私たちの調査結果は、Firefoxブラウザーを介した実際の使用状況を調べる<a href="https://telemetry.mozilla.org/new-pipeline/dist.html#!cumulative=0&amp;measure=HTTP_RESPONSE_VERSION">Mozillaのテレメトリ<span class="fn">https://telemetry.mozilla.org/new-pipeline/dist.html#!cumulative=0&amp;measure=HTTP_RESPONSE_VERSION</span></a
      >など、他のソースによって裏付けられています。
    </p>
    <figure id="http2-fig-4">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>プロトコル</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
                <th>合計</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
                <td>0.09%</td>
                <td>0.08%</td>
                <td>0.08%</td>
              </tr>
              <tr>
                <td>HTTP/1.0</td>
                <td>0.09%</td>
                <td>0.08%</td>
                <td>0.09%</td>
              </tr>
              <tr>
                <td>HTTP/1.1</td>
                <td>62.36%</td>
                <td>63.92%</td>
                <td>63.22%</td>
              </tr>
              <tr>
                <td>HTTP/2</td>
                <td>37.46%</td>
                <td>35.92%</td>
                <td>36.61%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-4" class="anchor-link">図 4.</a>ホームページのHTTPバージョンの使用。</figcaption>
    </figure>
    <p>ホームページを見て、HTTP/2をサポートするサイト数の大まかな数字を取得するだけでも（少なくともそのホームページで）おもしろいです。図4は、全体的な要求よりもサポートが少ないことを示しており、予想どおり約36％です。</p>
    <p>HTTP/2は、HTTPSまたは暗号化されていない非HTTPS接続で公式に使用できますが、HTTPS上のブラウザーでのみサポートされます。前述のように、暗号化されたHTTPS接続で新しいプロトコルを非表示にすることで、この新しいプロトコルを理解してないネットワーク機器がその使用を妨げる（拒否する）ことを防ぎます。さらに、HTTPSハンドシェイクにより、クライアントとサーバーがHTTP/2の使用に同意する簡単な方法が可能になります。</p>
    <figure id="http2-fig-5">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>プロトコル</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
                <th>合計</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
                <td>0.09%</td>
                <td>0.10%</td>
                <td>0.09%</td>
              </tr>
              <tr>
                <td>HTTP/1.0</td>
                <td>0.06%</td>
                <td>0.06%</td>
                <td>0.06%</td>
              </tr>
              <tr>
                <td>HTTP/1.1</td>
                <td>45.81%</td>
                <td>44.31%</td>
                <td>45.01%</td>
              </tr>
              <tr>
                <td>HTTP/2</td>
                <td>54.04%</td>
                <td>55.53%</td>
                <td>54.83%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-5" class="anchor-link">図 5.</a> HTTPSホームページのHTTPバージョンの使用。</figcaption>
    </figure>
    <p>WebはHTTPSに移行しており、HTTP/2は、HTTPSがパフォーマンスに悪影響を与えるという従来の議論をほぼ完全に覆しています。すべてのサイトがHTTPSに移行しているわけではないため、HTTP/2を利用できないサイトも利用できません。 HTTPSを使用するサイトのみを見ると、図5では図2の<em>すべてのリクエスト</em>の割合と同様に、HTTP/2の採用率が55％前後です。</p>
    <p>HTTP/2のブラウザサポートは強力であり、採用への安全な方法があることを示しました。なぜすべてのサイト（または少なくともすべてのHTTPSサイト）がHTTP/2をサポートしないのですか？　さて、ここで、まだ測定していないサポートの最終項目であるサーバーサポートに進みます。</p>
    <p>これは、最新のブラウザとは異なり、サーバーが最新バージョンに自動的にアップグレードしないことが多いため、ブラウザのサポートよりも問題が多くなります。サーバーが定期的に保守され、パッチが適用されている場合でも、多くの場合、HTTP/2のような新機能ではなくセキュリティパッチが適用されます。 HTTP/2をサポートするサイトのサーバーのHTTPヘッダーを最初に見てみましょう。</p>
    <figure id="http2-fig-6">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>サーバー</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
                <th>合計</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>nginx</td>
                <td>34.04%</td>
                <td>32.48%</td>
                <td>33.19%</td>
              </tr>
              <tr>
                <td>cloudflare</td>
                <td>23.76%</td>
                <td>22.29%</td>
                <td>22.97%</td>
              </tr>
              <tr>
                <td>Apache</td>
                <td>17.31%</td>
                <td>19.11%</td>
                <td>18.28%</td>
              </tr>
              <tr>
                <td></td>
                <td>4.56%</td>
                <td>5.13%</td>
                <td>4.87%</td>
              </tr>
              <tr>
                <td>LiteSpeed</td>
                <td>4.11%</td>
                <td>4.97%</td>
                <td>4.57%</td>
              </tr>
              <tr>
                <td>GSE</td>
                <td>2.16%</td>
                <td>3.73%</td>
                <td>3.01%</td>
              </tr>
              <tr>
                <td>Microsoft-IIS</td>
                <td>3.09%</td>
                <td>2.66%</td>
                <td>2.86%</td>
              </tr>
              <tr>
                <td>openresty</td>
                <td>2.15%</td>
                <td>2.01%</td>
                <td>2.07%</td>
              </tr>
              <tr>
                <td>…</td>
                <td>…</td>
                <td>…</td>
                <td>…</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-6" class="anchor-link">図 6.</a> HTTP/2に使用されるサーバー。</figcaption>
    </figure>
    <p>
      nginxは、最新バージョンへのインストールまたはアップグレードを容易にするパッケージリポジトリを提供しているため、ここをリードしていることについて驚くことではありません。 cloudflareは最も人気のある<a href="#cdn">CDN</a>で、デフォルトでHTTP/2を有効にしているため、HTTP/2サイトの大部分をホストしていることについて驚くことはありません。ちなみに、cloudflareは、Webサーバーとして<a href="https://blog.cloudflare.com/nginx-structural-enhancements-for-http-2-performance/">大幅にカスタマイズ<span class="fn">https://blog.cloudflare.com/nginx-structural-enhancements-for-http-2-performance/</span></a
      >されたバージョンのnginxを使用しています。その後、Apacheの使用率は約20％であり、次に何が隠されているかを選択するサーバー、LiteSpeed、IIS、Google Servlet Engine、nginxベースのopenrestyなどの小さなプレイヤーが続きます。
    </p>
    <p>さらに興味深いのは、HTTP/2をサポート<em>しない</em>サーバーです。</p>
    <figure id="http2-fig-7">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>サーバー</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
                <th>合計</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Apache</td>
                <td>46.76%</td>
                <td>46.84%</td>
                <td>46.80%</td>
              </tr>
              <tr>
                <td>nginx</td>
                <td>21.12%</td>
                <td>21.33%</td>
                <td>21.24%</td>
              </tr>
              <tr>
                <td>Microsoft-IIS</td>
                <td>11.30%</td>
                <td>9.60%</td>
                <td>10.36%</td>
              </tr>
              <tr>
                <td></td>
                <td>7.96%</td>
                <td>7.59%</td>
                <td>7.75%</td>
              </tr>
              <tr>
                <td>GSE</td>
                <td>1.90%</td>
                <td>3.84%</td>
                <td>2.98%</td>
              </tr>
              <tr>
                <td>cloudflare</td>
                <td>2.44%</td>
                <td>2.48%</td>
                <td>2.46%</td>
              </tr>
              <tr>
                <td>LiteSpeed</td>
                <td>1.02%</td>
                <td>1.63%</td>
                <td>1.36%</td>
              </tr>
              <tr>
                <td>openresty</td>
                <td>1.22%</td>
                <td>1.36%</td>
                <td>1.30%</td>
              </tr>
              <tr>
                <td>…</td>
                <td>…</td>
                <td>…</td>
                <td>…</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-7" class="anchor-link">図 7.</a> HTTP/1.1以前に使用されるサーバー。</figcaption>
    </figure>
    <p>これの一部は、サーバーがHTTP/2をサポートしていてもHTTP/1.1を使用する非HTTPSトラフィックになりますが、より大きな問題はHTTP/2をまったくサポートしないことです。これらの統計では、古いバージョンを実行している可能性が高いApacheとIISのシェアがはるかに大きいことがわかります。</p>
    <p>特にApacheで、既存のインストールにHTTP/2サポートを追加することは簡単でない。これは、ApacheがHTTP/2をインストールするための公式リポジトリを提供していないためです。これは、多くの場合、ソースからのコンパイルやサードパーティのリポジトリの信頼に頼ることを意味しますが、どちらも多くの管理者にとって特に魅力的ではありません。</p>
    <p>Linuxディストリビューションの最新バージョン（RHELおよびCentOS 8、Ubuntu 18、Debian 9）のみがHTTP/2をサポートするApacheのバージョンを備えており、多くのサーバーはまだそれらを実行できていません。 Microsoft側では、Windows Server 2016以降のみがHTTP/2をサポートしているため、古いバージョンを実行しているユーザーはIISでこれをサポートできません。</p>
    <p>これら2つの統計をマージすると、サーバーごとのインストールの割合を見ることができます。</p>
    <figure id="http2-fig-8">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>サーバー</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>cloudflare</td>
                <td>85.40%</td>
                <td>83.46%</td>
              </tr>
              <tr>
                <td>LiteSpeed</td>
                <td>70.80%</td>
                <td>63.08%</td>
              </tr>
              <tr>
                <td>openresty</td>
                <td>51.41%</td>
                <td>45.24%</td>
              </tr>
              <tr>
                <td>nginx</td>
                <td>49.23%</td>
                <td>46.19%</td>
              </tr>
              <tr>
                <td>GSE</td>
                <td>40.54%</td>
                <td>35.25%</td>
              </tr>
              <tr>
                <td></td>
                <td>25.57%</td>
                <td>27.49%</td>
              </tr>
              <tr>
                <td>Apache</td>
                <td>18.09%</td>
                <td>18.56%</td>
              </tr>
              <tr>
                <td>Microsoft-IIS</td>
                <td>14.10%</td>
                <td>13.47%</td>
              </tr>
              <tr>
                <td>…</td>
                <td>…</td>
                <td>…</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-8" class="anchor-link">図 8.</a> HTTP/2を提供するために使用される各サーバーのインストールの割合。</figcaption>
    </figure>
    <p>ApacheとIISがインストールベースのHTTP/2サポートで1​​8％、14％と遅れを取っていることは明らかです。これは（少なくとも部分的に）アップグレードがより困難であるためです。多くのサーバーがこのサポートを簡単に取得するには、多くの場合、OSの完全なアップグレードが必要です。新しいバージョンのOSが標準になると、これが簡単になることを願っています。</p>
    <p>
      ここで、HTTP/2実装に関するコメントはありません（<a href="https://twitter.com/tunetheweb/status/988196156697169920?s=20">Apacheが最高の実装の1つであると思います<span class="fn">https://twitter.com/tunetheweb/status/988196156697169920?s=20</span></a
      >）が、これらの各サーバーでHTTP/2を有効にすることの容易さ、またはその欠如に関する詳細です。
    </p>
    <h2 id="http2-http2の影響"><a href="#http2-http2の影響" class="anchor-link">HTTP/2の影響</a></h2>
    <p>HTTP/2の影響は、特にHTTP Archive<a href="#methodology">方法論</a>を使用して測定するのがはるかに困難です。理想的には、サイトをHTTP/1.1とHTTP/2の両方でクロールし、その差を測定する必要がありますがここで調査している統計では不可能です。さらに、平均的なHTTP/2サイトが平均的なHTTP/1.1サイトよりも高速であるかどうかを測定すると、ここで説明するよりも徹底的な調査を必要とする他の変数が多くなりすぎます。</p>
    <p>測定できる影響の1つは、現在HTTP/2の世界にいるHTTP使用の変化です。複数の接続は、限られた形式の並列化を可能にするHTTP/1.1の回避策でしたが、これは実際、HTTP/2で通常最もよく機能することの反対になります。単一の接続でTCPセットアップ、TCPスロースタート、およびHTTPSネゴシエーションのオーバーヘッドが削減され、クロスリクエストの優先順位付けが可能になります。</p>
    <figure id="http2-fig-9">
      <a href="https://almanac.httparchive.org/static/images/2019/http2/ch20_fig9_num_tcp_connections_trend_over_years.png">
        <img alt="図9.ページごとのTCP接続。" aria-labelledby="http2-fig9-caption" aria-describedby="http2-fig9-description" src="/static/images/2019/http2/ch20_fig9_num_tcp_connections_trend_over_years.png" width="600" height="320" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig9-description" data-show-text="{{ show_description(9) }}" data-hide-text="{{ hide_description(9) }}">{{ show_description(9) }}</button>
      <div id="http2-fig9-description" class="visually-hidden">ページあたりのTCP接続数の時系列グラフ。2019年7月現在、デスクトップページの中央値には14の接続があり、モバイルページの中央値には16の接続があります。</div>
      <figcaption id="http2-fig9-caption">
        <a href="#http2-fig-9" class="anchor-link">図 9.</a>ページごとのTCP接続。 (引用: <a href="https://httparchive.org/reports/state-of-the-web#tcp">HTTP Archive<span class="fn">https://httparchive.org/reports/state-of-the-web#tcp</span></a
        >)
      </figcaption>
    </figure>
    <p>HTTP Archiveは、ページあたりのTCP接続数を測定します。これは、HTTP/2をサポートするサイトが増え、6つの個別の接続の代わりに単一の接続を使用するため、徐々に減少しています。</p>
    <figure id="http2-fig-10">
      <a href="https://almanac.httparchive.org/static/images/2019/http2/ch20_fig10_total_requests_per_page_trend_over_years.png">
        <img alt="図10.ページごとの合計リクエスト。" aria-labelledby="http2-fig10-caption" aria-describedby="http2-fig10-description" src="/static/images/2019/http2/ch20_fig10_total_requests_per_page_trend_over_years.png" width="600" height="321" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig10-description" data-show-text="{{ show_description(10) }}" data-hide-text="{{ hide_description(10) }}">{{ show_description(10) }}</button>
      <div id="http2-fig10-description" class="visually-hidden">ページあたりのリクエスト数の時系列チャート。2019年7月現在、デスクトップページの中央値は74リクエスト、モバイルページの中央値は69リクエストです。傾向は比較的横ばいです。</div>
      <figcaption id="http2-fig10-caption">
        <a href="#http2-fig-10" class="anchor-link">図 10.</a>ページごとの合計リクエスト。 (引用: <a href="https://httparchive.org/reports/state-of-the-web#reqTotal">HTTP Archive<span class="fn">https://httparchive.org/reports/state-of-the-web#reqTotal</span></a
        >)
      </figcaption>
    </figure>
    <p>
      より少ないリクエストを取得するためのアセットのバンドルは、バンドル、連結、パッケージ化、分割など多くの名前で行われた別のHTTP/1.1回避策でした。HTTP/2を使用する場合、リクエストのオーバーヘッドが少ないため、これはあまり必要ありませんが、注意する必要がありますその要求はHTTP/2で無料ではなく、<a href="https://engineering.khanacademy.org/posts/js-packaging-http2.htm">バンドルを完全に削除する実験を行った人はパフォーマンスの低下に気付きました<span class="fn">https://engineering.khanacademy.org/posts/js-packaging-http2.htm</span></a
      >。ページごとにロードされるリクエストの数を時間毎に見ると、予想される増加ではなく、リクエストのわずかな減少が見られます。
    </p>
    <p>この減少は、おそらくパフォーマンスへの悪影響なしにバンドルを削除できない（少なくとも完全にではない）という前述の観察と、HTTP/1.1の推奨事項に基づく歴史的な理由で現在多くのビルドツールがバンドルされていることに起因する可能性があります。また、多くのサイトがHTTP/1.1のパフォーマンスハッキングを戻すことでHTTP/1.1ユーザーにペナルティを課す気がないかもしれません、少なくともこれに価値があると感じる確信（または時間！）を持っていない可能性があります。</p>
    <p>増加する<a href="#page-weight">ページの重み</a>を考えると、リクエストの数がほぼ静的なままであるという事実は興味深いですが、これはおそらくHTTP/2に完全に関連しているわけではありません。</p>
    <h2 id="http2-http2プッシュ"><a href="#http2-http2プッシュ" class="anchor-link">HTTP/2プッシュ</a></h2>
    <p>HTTP/2プッシュは、HTTP/2の大いに宣伝された新機能であるにもかかわらず、複雑な歴史を持っています。他の機能は基本的に内部のパフォーマンスの向上でしたが、プッシュはHTTPの単一の要求から単一の応答への性質を完全に破ったまったく新しい概念で、追加の応答を返すことができました。 Webページを要求すると、サーバーは通常どおりHTMLページで応答しますが、重要なCSSとJavaScriptも送信するため、特定のリソースへ追加の往復が回避されます。理論的には、CSSとJavaScriptをHTMLにインライン化するのをやめ、それでも同じようにパフォーマンスを向上させることができます。それを解決した後、潜在的にあらゆる種類の新しくて興味深いユースケースにつながる可能性があります。</p>
    <p>
      現実は、まあ、少し残念です。 HTTP/2プッシュは、当初想定されていたよりも効果的に使用することがはるかに困難であることが証明されています。これのいくつかは、<a href="https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/">HTTP/2プッシュの動作の複雑さ<span class="fn">https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/</span></a
      >、およびそれによる実装の問題によるものです。
    </p>
    <p>より大きな懸念は、プッシュがパフォーマンスの問題を解決するのではなく、すぐ簡単に問題を引き起こす可能性があることです。過剰な押し込みは、本当のリスクです。多くの場合、ブラウザーは<em>何</em>を要求するかを決定する最適な場所にあり、要求する<em>タイミング</em>と同じくらい重要ですが、HTTP/2プッシュはサーバーにその責任を負わせます。ブラウザが既にキャッシュに持っているリソースをプッシュすることは、帯域幅の浪費です（私の意見ではCSSをインライン化していますが、それについてはHTTP/2プッシュよりも苦労が少ないはずです！）。</p>
    <p>
      <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/2019JanMar/0033.html">ブラウザのキャッシュのステータスについてサーバーに通知する提案は<span class="fn">https://lists.w3.org/Archives/Public/ietf-http-wg/2019JanMar/0033.html</span></a> 、特にプライバシーの問題で行き詰っています。その問題がなくても、プッシュが正しく使用されない場合、他の潜在的な問題があります。たとえば、大きな画像をプッシュして重要なCSSとJavaScriptの送信を保留すると、プッシュしない場合よりもWebサイトが遅くなります。
    </p>
    <p>またプッシュは正しく実装された場合でも、パフォーマンス向上に必ずつながるという証拠はほとんどありませんでした。これも、HTTP Archiveの実行方法（1つの状態でChromeを使用する人気サイトのクロール）の性質により、HTTP Archiveが回答するのに最適な場所ではないため、ここでは詳しく説明しません。 ただし、パフォーマンスの向上は明確でなく、潜在的な問題は現実的であると言えば十分です。</p>
    <p>それはさておき、HTTP/2プッシュの使用方法を見てみましょう。</p>
    <figure id="http2-fig-11">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>クライアント</th>
                <th>HTTP/2プッシュを使用するサイト</th>
                <th>HTTP/2プッシュを使用するサイト(%)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>デスクトップ</td>
                <td>22,581</td>
                <td>0.52%</td>
              </tr>
              <tr>
                <td>モバイル</td>
                <td>31,452</td>
                <td>0.59%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-11" class="anchor-link">図 11.</a> HTTP/2プッシュを使用するサイト。</figcaption>
    </figure>
    <figure id="http2-fig-12">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>クライアント</th>
                <th>プッシュされた平均リクエスト</th>
                <th>プッシュされた平均KB</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>デスクトップ</td>
                <td>7.86</td>
                <td>162.38</td>
              </tr>
              <tr>
                <td>モバイル</td>
                <td>6.35</td>
                <td>122.78</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-12" class="anchor-link">図 12.</a>使用時にプッシュされる量。</figcaption>
    </figure>
    <p>これらの統計は、HTTP/2プッシュの増加が非常に低いことを示しています。これは、おそらく前述の問題が原因です。ただし、サイトがプッシュを使用する場合、図12に示すように1つまたは2つのアセットではなく、プッシュを頻繁に使用する傾向があります。</p>
    <p>
      これは以前のアドバイスでプッシュを控えめにし、「<a href="https://docs.google.com/document/d/1K0NykTXBbbbTlv60t5MyJvXjqKGsCVNYHyLEXIxYMv0/edit">アイドル状態のネットワーク時間を埋めるのに十分なリソースだけをプッシュし、それ以上はプッシュしない<span class="fn">https://docs.google.com/document/d/1K0NykTXBbbbTlv60t5MyJvXjqKGsCVNYHyLEXIxYMv0/edit</span></a
      >」ということでした。上記の統計は、大きなサイズの多くのリソースがプッシュされることを示しています。
    </p>
    <figure id="http2-fig-13">
      <a href="https://almanac.httparchive.org/static/images/2019/http2/ch20_fig13_what_push_is_used_for.png">
        <img src="/static/images/2019/http2/ch20_fig13_what_push_is_used_for.png" aria-labelledby="http2-fig13-caption" alt="図13.プッシュはどのアセットタイプに使用されますか？" aria-describedby="http2-fig13-description" width="600" height="371" data-width="600" data-height="371" data-seamless="" data-frameborder="0" data-scrolling="no" data-iframe="https://docs.google.com/spreadsheets/d/e/2PACX-1vQLxLA5Nojw28P7ceisqti3oTmNSM-HIRIR0bDb2icJS5TzONvRhdqxQcooh_45TmK97XVpot4kEQA0/pubchart?oid=466353517&amp;format=interactive" />
      </a>
      <button hidden="" class="fig-description-button" aria-expanded="false" aria-controls="fig13-description" data-show-text="{{ show_description(13) }}" data-hide-text="{{ hide_description(13) }}">{{ show_description(13) }}</button>
      <div id="http2-fig13-description" class="visually-hidden">プッシュされるアセットタイプの割合を分類する円グラフ。 JavaScriptがアセットのほぼ半分を構成し、次にCSSが約4分の1、画像が約8分の1、残りをテキストベースのさまざまなタイプで構成します。</div>
      <figcaption id="http2-fig13-caption"><a href="#http2-fig-13" class="anchor-link">図 13.</a>プッシュはどの資産タイプに使用されますか？</figcaption>
    </figure>
    <p>図13は、最も一般的にプッシュされるアセットを示しています。 JavaScriptとCSSは、ボリュームとバイトの両方で、プッシュされるアイテムの圧倒的多数です。この後、画像、フォント、およびデータのラグタグの種類があります。最後にビデオをプッシュしているサイトは約100あることがわかりますが、これは意図的なものであるか、間違ったタイプのアセットを過剰にプッシュしている兆候かもしれません！</p>
    <p>一部の人が提起する懸念の1つは、HTTP/2実装が<code>プリロード</code>HTTP<code>リンク</code>ヘッダーをプッシュする信号として再利用したことです。<code>プリロード</code>の最も一般的な使用法の1つは、CSSが要求、ダウンロード、解析されるまでブラウザに表示されない、フォントや画像などの遅れて発見されたリソースをブラウザに通知することです。これらが現在そのヘッダーに基づいてプッシュされる場合、これを再利用すると多くの意図しないプッシュを発生する可能性があるという懸念はありました。</p>
    <p>ただし、フォントと画像の使用率が比較的低いことは、恐れられているほどリスクが見られないことを意味する場合があります。 <code>&lt;link rel="preload" ...&gt;</code>タグは、HTTPリンクヘッダーではなくHTMLでよく使用され、メタタグはプッシュするシグナルではありません。<a href="#resource-hints">リソースヒント</a>の章の統計では、サイトの1％未満がプリロードHTTPリンクヘッダーを使用しており、ほぼ同じ量がHTTP/2で意味のないプリコネクトを使用しているため、これはそれほど問題ではないことが示唆されます。プッシュされているフォントやその他のアセットがいくつかありますが、これはその兆候かもしれません。</p>
    <p>これらの苦情に対する反論として、アセットがプリロードするのに十分に重要である場合、ブラウザはプリロードヒントを非常に高い優先度のリクエストとして処理するため、可能であればこれらのアセットをプッシュする必要があると主張できます。したがって、パフォーマンスの懸念は、（これも間違いなく）このために発生するHTTP/2プッシュではなくプリロードの過剰使用にあります。</p>
    <p>この意図しないプッシュを回避するには、プリロードヘッダーで<code>nopush</code>属性を指定できます。</p>
    <pre><code>link: &lt;/assets/jquery.js&gt;; rel=preload; as=script; nopush</code></pre>
    <p>プリロードHTTPヘッダーの5％はこの属性を使用しますが、これはニッチな最適化と考えていたため、予想よりも高くなります。繰り返しますが、プリロードHTTPヘッダーやHTTP/2プッシュ自体の使用も同様です。</p>
    <h2 id="http2-http2問題"><a href="#http2-http2問題" class="anchor-link">HTTP/2問題</a></h2>
    <p>HTTP/2は主にシームレスなアップグレードであり、サーバーがサポートすると、Webサイトやアプリケーションを変更することなく切り替えることができます。 HTTP/2向けに最適化するか、HTTP/1.1回避策の使用をやめることができますが、一般的にサイトは通常、変更を必要とせずに動作します。ただし、アップグレードに影響を与える可能性のある注意点がいくつかあり、一部のサイトでこれは難しい方法であることがわかりました。</p>
    <p>
      HTTP/2の問題の原因の1つは、HTTP/2の優先順位付けの不十分なサポートです。この機能により、進行中の複数の要求が接続を適切に使用できるようになります。 HTTP/2は同じ接続で実行できるリクエストの数を大幅に増やしているため、これは特に重要です。サーバーの実装では、100または128の並列リクエスト制限が一般的です。以前は、ブラウザにはドメインごとに最大6つの接続があったため、そのスキルと判断を使用してそれらの接続の最適な使用方法を決定しました。現在では、キューに入れる必要はほとんどなく、リクエストを認識するとすぐにすべてのリクエストを送信できます。これにより、優先度の低いリクエストで帯域幅が「無駄」になり、重要なリクエストが遅延する可能性はあります（また<a href="https://www.lucidchart.com/techblog/2019/04/10/why-turning-on-http2-was-a-mistake/">偶発的にバックエンドサーバーが使用されるよりも多くのリクエストでいっぱいになる可能性があります！<span class="fn">https://www.lucidchart.com/techblog/2019/04/10/why-turning-on-http2-was-a-mistake/</span></a
      >）
    </p>
    <p>HTTP/2には複雑な優先順位付けモデルがあります（非常に複雑すぎるため、なぜHTTP/3で再検討されているのでしょう！）が、それを適切に尊重するサーバーはほとんどありません。これはHTTP/2の実装がスクラッチになっていないか、サーバーがより高い優先度の要求であることを認識する前に応答は既に送信されている、いわゆる<em>バッファブロート</em>が原因である可能性も考えられます。サーバー、TCPスタック、および場所の性質が異なるため、ほとんどのサイトでこれを測定することは困難ですがCDNを使用する場合はこれをより一貫させる必要があります。</p>
    <p>
      <a href="https://twitter.com/patmeenan">Patrick Meenan<span class="fn">https://twitter.com/patmeenan</span></a
      >は、優先度の高いオンスクリーンイメージを要求する前に、優先度の低いオフスクリーンイメージのロードを意図的にダウンロードしようとする<a href="https://github.com/pmeenan/http2priorities/tree/master/stand-alone">サンプルテストページ<span class="fn">https://github.com/pmeenan/http2priorities/tree/master/stand-alone</span></a
      >を作成しました。優れたHTTP/2サーバーはこれを認識し、優先度の低い画像を犠牲にして、要求後すぐに優先度の高い画像を送信できるはずです。貧弱なHTTP/2サーバーはリクエストの順番で応答し、優先順位のシグナルを無視します。 <a href="#contributors-andydavies">Andy Davies</a>には、<a href="https://github.com/andydavies/http2-prioritization-issues">Patrickのテスト用にさまざまなCDNのステータスを追跡するページ<span class="fn">https://github.com/andydavies/http2-prioritization-issues</span></a
      >があります。 HTTP Archiveは、クロールの一部としてCDNが使用されるタイミングを識別しこれら2つのデータセットをマージすると、合格または失敗したCDNを使用しているページの割合を知ることができます。
    </p>
    <figure id="http2-fig-14">
      <div class="table-wrap">
        <div class="table-wrap-container">
          <table>
            <thead>
              <tr>
                <th>CDN</th>
                <th>正しい優先順位付け?</th>
                <th>デスクトップ</th>
                <th>モバイル</th>
                <th>合計</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Not using CDN</td>
                <td>Unknown</td>
                <td>57.81%</td>
                <td>60.41%</td>
                <td>59.21%</td>
              </tr>
              <tr>
                <td>Cloudflare</td>
                <td>Pass</td>
                <td>23.15%</td>
                <td>21.77%</td>
                <td>22.40%</td>
              </tr>
              <tr>
                <td>Google</td>
                <td>Fail</td>
                <td>6.67%</td>
                <td>7.11%</td>
                <td>6.90%</td>
              </tr>
              <tr>
                <td>Amazon CloudFront</td>
                <td>Fail</td>
                <td>2.83%</td>
                <td>2.38%</td>
                <td>2.59%</td>
              </tr>
              <tr>
                <td>Fastly</td>
                <td>Pass</td>
                <td>2.40%</td>
                <td>1.77%</td>
                <td>2.06%</td>
              </tr>
              <tr>
                <td>Akamai</td>
                <td>Pass</td>
                <td>1.79%</td>
                <td>1.50%</td>
                <td>1.64%</td>
              </tr>
              <tr>
                <td></td>
                <td>Unknown</td>
                <td>1.32%</td>
                <td>1.58%</td>
                <td>1.46%</td>
              </tr>
              <tr>
                <td>WordPress</td>
                <td>Pass</td>
                <td>1.12%</td>
                <td>0.99%</td>
                <td>1.05%</td>
              </tr>
              <tr>
                <td>Sucuri Firewall</td>
                <td>Fail</td>
                <td>0.88%</td>
                <td>0.75%</td>
                <td>0.81%</td>
              </tr>
              <tr>
                <td>Incapsula</td>
                <td>Fail</td>
                <td>0.39%</td>
                <td>0.34%</td>
                <td>0.36%</td>
              </tr>
              <tr>
                <td>Netlify</td>
                <td>Fail</td>
                <td>0.23%</td>
                <td>0.15%</td>
                <td>0.19%</td>
              </tr>
              <tr>
                <td>OVH CDN</td>
                <td>Unknown</td>
                <td>0.19%</td>
                <td>0.18%</td>
                <td>0.18%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <figcaption><a href="#http2-fig-14" class="anchor-link">図 14.</a>一般的なCDNでのHTTP/2優先順位付けのサポート。</figcaption>
    </figure>
    <p>図14は、トラフィックのかなりの部分が特定された問題の影響を受けていることを示しており、合計はデスクトップで26.82％、モバイルで27.83％です。これがどの程度の問題であるかは、ページの読み込み方法と、影響を受けるサイトの優先度の高いリソースが遅れて検出されるかどうかによって異なります。</p>
    <figure id="http2-fig-15">
      <div class="big-number">27.83%</div>
      <figcaption><a href="#http2-fig-15" class="anchor-link">図 15.</a>準最適なHTTP/2優先順位付けによるモバイル要求の割合。</figcaption>
    </figure>
    <p>別の問題は、<code>アップグレード</code>HTTPヘッダーが誤って使用されていることです。 Webサーバーは、クライアントが使用したいより良いプロトコルをサポートすることを示唆する<code>アップグレード</code>HTTPヘッダーで要求に応答できます（たとえば、HTTP/2をHTTP/1.1のみを使用してクライアントに宣伝します）。これは、サーバーがHTTP/2をサポートすることをブラウザーに通知する方法として役立つと思われるかもしれませんがブラウザーはHTTPSのみをサポートし、HTTP/2の使用はHTTPSハンドシェイクを通じてネゴシエートできるため、HTTP/2を宣伝するための<code>アップグレード</code>ヘッダーはかなり制限されています（少なくともブラウザの場合）。</p>
    <p>それよりも悪いのは、サーバーがエラーで<code>アップグレード</code>ヘッダーを送信する場合です。これは、HTTP/2をサポートするバックエンドサーバーがヘッダーを送信し、HTTP1.1のみのエッジサーバーは盲目的にクライアントに転送していることが原因である可能性を考えます。 Apacheは<code>mod_http2</code>が有効になっているがHTTP/2が使用されていない場合に<code>アップグレード</code>ヘッダーを発行し、そのようなApacheインスタンスの前にあるnginxインスタンスは、nginxがHTTP/2をサポートしない場合でもこのヘッダーを喜んで転送します。この偽の宣伝は、クライアントが推奨されているとおりにHTTP/2を使用しようとする（そして失敗する！）ことにつながります。</p>
    <p>108サイトはHTTP/2を使用していますが、アップグレードヘッダーでHTTP/2に<code>アップグレード</code>することも推奨しています。デスクトップ上のさらに12,767のサイト（モバイルは15,235）では、HTTPSを使用できない場合、または既に使用されていることが明らかな場合、HTTPS経由で配信されるHTTP/1.1接続をHTTP/2にアップグレードすることをお勧めします。これらは、デスクトップでクロールされた430万サイトとモバイルでクロールされた530万サイトのごく少数ですが、依然として多くのサイトに影響を与える問題であることを示しています。ブラウザはこれを一貫して処理しません。Safariは特にアップグレードを試み、混乱してサイトの表示を拒否します。</p>
    <p>これはすべて、<code>http1.0</code>、<code>http：//1.1</code>、または<code>-all、+ TLSv1.3、+ TLSv1.2</code>へのアップグレードを推奨するいくつかのサイトに入る前です。ここで進行中のWebサーバー構成には明らかに間違いがあります！</p>
    <p>
      私たちが見ることのできるさらなる実装の問題があります。たとえば、HTTP/2はHTTPヘッダー名に関してはるかに厳密でありスペース、コロン、またはその他の無効なHTTPヘッダー名で応答するとリクエスト全体を拒否します。ヘッダー名も小文字に変換されます。これは、アプリケーションが特定の大文字化を前提とする場合、驚くことになります。 HTTP/1.1では<a href="https://tools.ietf.org/html/rfc7230#section-3.2">ヘッダー名で大文字と小文字が区別されない<span class="fn">https://tools.ietf.org/html/rfc7230#section-3.2</span></a
      >と明記されているため、これは以前保証されていませんでしたが、一部はこれに依存してます。 HTTP Archiveを使用してこれらの問題を特定することもできます、それらの一部はホームページには表示されませんが、今年は詳しく調査しませんでした。
    </p>
    <h2 id="http2-http3"><a href="#http2-http3" class="anchor-link">HTTP/3</a></h2>
    <p>
      世界はまだ止まっておらず、HTTP/2が5歳の誕生日を迎えてないにも関わらず、人々はすでにそれを古いニュースとみなしており後継者であるHTTP/3にもっと興奮しています。 <a href="https://tools.ietf.org/html/draft-ietf-quic-http">HTTP/3<span class="fn">https://tools.ietf.org/html/draft-ietf-quic-http</span></a
      >はHTTP/2の概念に基づいていますが、HTTPが常に使用しているTCP接続を介した作業から、<a href="https://datatracker.ietf.org/wg/quic/about/">QUIC<span class="fn">https://datatracker.ietf.org/wg/quic/about/</span></a
      >と呼ばれるUDPベースのプロトコルに移行します。これにより、パケット損失が大きくTCPの保証された性質によりすべてのストリームが保持され、すべてのストリームが抑制される場合、HTTP/2がHTTP/1.1より遅い1つのケースを修正できます。また、両方のハンドシェイクで統合するなど、TCPとHTTPSの非効率性に対処することもできます。実際、実装が難しいと証明されているTCPの多くのアイデアをサポートします（TCP高速オープン、0-RTTなど）。
    </p>
    <p>HTTP/3は、TCPとHTTP/2の間のオーバーラップもクリーンアップします（たとえば両方のレイヤーでフロー制御は実装されます）が、概念的にはHTTP/2と非常に似ています。 HTTP/2を理解し、最適化したWeb開発者は、HTTP/3をさらに変更する必要はありません。ただし、TCPとQUICの違いははるかに画期的であるため、サーバーオペレータはさらに多くの作業を行う必要があります。 HTTP/3のロールアウトはHTTP/2よりもかなり長くかかる可能性があり、最初はCDNなどの分野で特定の専門知識を持っている人に限定されます。</p>
    <p>
      QUICは長年にわたってGoogleによって実装されており、SPDYがHTTP/2へ移行する際に行ったのと同様の標準化プロセスを現在行っています。 QUICにはHTTP以外にも野心がありますが、現時点では現在使用中のユースケースです。この章が書かれたように、HTTP/3はまだ正式に完成していないか、まだ標準として承認されていないにもかかわらず、<a href="https://blog.cloudflare.com/http3-the-past-present-and-future/">Cloudflare、Chrome、FirefoxはすべてHTTP/3サポート<span class="fn">https://blog.cloudflare.com/http3-the-past-present-and-future/</span></a
      >を発表しました。これは最近までQUICサポートがGoogleの外部にやや欠けていたため歓迎され、同様の標準化段階からのSPDYおよびHTTP/2サポートに確実に遅れています。
    </p>
    <p>HTTP/3はTCPではなくUDPでQUICを使用するため、HTTP/3の検出はHTTP/2の検出よりも大きな課題になります。 HTTP/2では、主にHTTPSハンドシェイクを使用できますが、HTTP/3は完全に異なる接続となるため、ここは選択肢ではありません。またHTTP/2は<code>アップグレード</code>HTTPヘッダーを使用してブラウザーにHTTP/2サポートを通知します、HTTP/2にはそれほど有用ではありませんでしたが、QUICにはより有用な同様のメカニズムが導入されています。<em>代替サービス</em>HTTPヘッダー（<code>alt-svc</code>）は、この接続で使用できる代替プロトコルとは対照的に、まったく異なる接続で使用できる代替プロトコルを宣伝します。これは、<code>アップグレード</code>HTTPヘッダーの使用目的です。</p>
    <figure id="http2-fig-16">
      <div class="big-number">8.38%</div>
      <figcaption><a href="#http2-fig-16" class="anchor-link">図 16.</a> QUICをサポートするモバイルサイトの割合。</figcaption>
    </figure>
    <p>このヘッダーを分析すると、デスクトップサイトの7.67％とモバイルサイトの8.38％がすでにQUICをサポートしていることがわかります。QUICは、Googleのトラフィックの割合を表します。また、0.04％はすでにHTTP/3をサポートしています。来年のWeb Almanacでは、この数は大幅に増加すると予想しています。</p>
    <h2 id="http2-結論"><a href="#http2-結論" class="anchor-link">結論</a></h2>
    <p>HTTP Archiveプロジェクトで利用可能な統計のこの分析は、HTTPコミュニティの私たちの多くがすでに認識していることを示しています。HTTP/2はここにあり、非常に人気であることが証明されています。リクエスト数の点ではすでに主要なプロトコルですが、それをサポートするサイトの数の点ではHTTP/1.1を完全に追い抜いていません。インターネットのロングテールは、よく知られた大量のサイトよりもメンテナンスの少ないサイトで顕著な利益を得るために指数関数的に長い時間がかかることを意味します。</p>
    <p>また、一部のインストールでHTTP/2サポートを取得するのが（まだ！）簡単ではないことについても説明しました。サーバー開発者、OSディストリビューター、およびエンドカスタマーはすべて、それを容易にするためプッシュすることを関与します。ソフトウェアをOSに関連付けると、常に展開時間が長くなります。実際、QUICのまさにその理由の1つは、TCPの変更を展開することで同様の障壁を破ることです。多くの場合、WebサーバーのバージョンをOSに結び付ける本当の理由はありません。 Apache（より人気のある例の1つを使用する）は、古いOSでHTTP/2サポートを使用して実行されますがサーバーに最新バージョンを取得することは、現在の専門知識やリスクを必要としません。 nginxはここで非常にうまく機能し、一般的なLinuxフレーバーのリポジトリをホストしてインストールを容易にします。Apacheチーム（またはLinuxディストリビューションベンダー）が同様のものを提供しない場合、Apacheの使用は苦労しながら縮小し続けます、最新バージョンには最高のHTTP/2実装の1つがあります、関連性を保持し古くて遅い（古いインストールに基づいて）という評判を揺るがします。 IISは通常、Windows側で優先されるWebサーバーであるため、IISの問題はそれほど多くないと考えています。</p>
    <p>
      それ以外は、HTTP/2は比較的簡単なアップグレードパスであるため、既に見た強力な支持を得ています。ほとんどの場合、これは痛みなく追加が可能で、ほぼ手間をかけずにパフォーマンスが向上し、サーバーでサポートされるとほとんど考慮しなくて済むことが判明しました。しかし、（いつものように）悪魔は細部にいて、サーバー実装間のわずかな違いによりHTTP/2の使用が良くも悪くも最終的にエンドユーザーの体験に影響します。また、新しいプロトコルで予想されるように、多くのバグや<a href="https://github.com/Netflix/security-bulletins/blob/master/advisories/third-party/2019-002.md">セキュリティの問題<span class="fn">https://github.com/Netflix/security-bulletins/blob/master/advisories/third-party/2019-002.md</span></a
      >もありました。
    </p>
    <p>HTTP/2のような新しいプロトコルの強力で最新のメンテナンスされた実装を使用していることを確認することで、これらの問題を確実に把握できます。ただし、それには専門知識と管理が必要です。 QUICとHTTP/3のロールアウトはさらに複雑になり、より多くの専門知識が必要になります。おそらくこれは、この専門知識を持っており、サイトからこれらの機能に簡単にアクセスできるCDNのようなサードパーティのサービスプロバイダーに委ねるのが最善でしょうか？　ただ、専門家に任せたとしても、これは確実でありません（優先順位付けの統計が示すように）。しかし、サーバープロバイダーを賢明に選択して、優先順位が何であるかを確認すれば実装が容易になります。</p>
    <p>その点については、CDNがこれらの問題に優先順位を付ければ素晴らしいと思います（間違いなく意図的です！）、HTTP/3での新しい優先順位付け方法の出現を疑っていますが、多くは固執します。来年は、HTTPの世界でさらに興味深い時代になるでしょう。</p>
  </div>

  <div class="authors">
    {% for author in metadata.get('authors') %} {% if loop.index == 1 %}
    <h2 id="{{ metadata.get('chapter') }}-authors">
      <a href="#{{ metadata.get('chapter') }}-authors" class="anchor-link">
        {% if loop.length == 1 %}{{ self.author() }}{% endif -%} {% if loop.length > 1 and loop.index == 1 %}{{ self.authors() }}{% endif %}
      </a>
    </h2>
    <ul>
      {% endif %} {% set authordata = config.contributors[author] if author in config.contributors else None %}
      <li>
        <a class="avatar-link" href="#contributors-{{ author }}"><img class="avatar" alt="{{ authordata.name }} avatar" src="{{ authordata.avatar_url }}" height="200" width="200" /></a>
        <div class="info">
          <a href="#contributors-{{ author }}"><span class="name">{{ authordata.name }}</span></a>
          {% if authordata.twitter or authordata.github or authordata.website %}
          <span class="social">
            {% if authordata.twitter %}
            <a class="twitter" href="https://twitter.com/{{ authordata.twitter }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-twitter">{{ onTwitter(authordata.twitter) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#twitter"></use>
              </svg>
              <span class="fn">https://twitter.com/{{ authordata.twitter }}</span>
            </a>
            {% endif %} {% if authordata.github %}
            <a class="github" href="https://github.com/{{ authordata.github }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-github">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-github">{{ onGitHub(authordata.github) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use>
              </svg>
              <span class="fn">https://github.com/{{ authordata.github }}</span>
            </a>
            {% endif %} {% if authordata.linkedin %}
            <a class="linkedin" href="https://www.linkedin.com/in/{{ authordata.linkedin }}/" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-linkedin">{{ onLinkedIn(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#linkedin"></use>
              </svg>
              <span class="fn">https://www.linkedin.com/in/{{ authordata.linkedin }}/</span>
            </a>
            {% endif %} {% if authordata.website %}
            <a class="website" href="{{ authordata.website }}" aria-labelledby="{{ metadata.get('chapter') }}-author-{{ author }}-website">
              <svg role="img">
                <title id="{{ metadata.get('chapter') }}-author-{{ author }}-website">{{ website(authordata.name) }}</title>
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#globe"></use>
              </svg>
              <span class="fn">{{ authordata.website }}</span>
            </a>
            {% endif %}
          </span>
          {% endif %} {% if authordata.tagline %}
          <div class="tagline">
            {{ authordata.tagline }}
          </div>
          {% endif %}
          <div class="bio">
            {{ add_footnote_links(localizedContributors[author] if localizedContributors[author]|length) | safe }}
          </div>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>

{% endblock %}
