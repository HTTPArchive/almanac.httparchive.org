{% extends "base.html" %}

{% block dir_attribute %}dir="rtl"{% endblock %}

{% block styles %}
  <link rel="stylesheet" href="/static/css/2019.css">
{% endblock %}

{% block content%}
  {% block header %}
  <header class="alt-bg">
    <div class="top-header">
      <a class="navigation-logo" href="{{ url_for('home', year=year, lang=lang) }}"><img src="/static/images/logo.svg" alt="Web Almanac by HTTP Archive" height="39" width="202"></a>
      <nav title="Desktop header menu">
        <a href="{{ url_for('table_of_contents', year=year, lang=lang) }}">Table of Contents</a>
        <a href="{{ url_for('contributors', year=year, lang=lang) }}">Contributors</a>
        <a href="{{ url_for('methodology', year=year, lang=lang) }}">Methodology</a>
        {% if supported_years | length > 1 %}
          {{ year_switcher() }}
        {% endif %}
      </nav>
      <div class="cta">
        {% if request.endpoint == 'home' %}
          <a href="{{ url_for('table_of_contents', year=year, lang=lang) }}" class="alt btn">
            Start Exploring
          </a>
        {% endif %}
        {{ language_switcher() }}
      </div>
      <button type="button" class="menu-btn" aria-label="Menu">
        <img class="menu-icon" src="/static/images/menu.png" data-src-close="/static/images/close.png" alt="" height="21" width="27" />
      </button>
      <nav title="Mobile header menu" class="menu">
        <a href="{{ url_for('table_of_contents', year=year, lang=lang) }}">Table of Contents</a>
        <a href="{{ url_for('contributors', year=year, lang=lang) }}">Contributors</a>
        <a href="{{ url_for('methodology', year=year, lang=lang) }}">Methodology</a>
        <div class="misc">
          <a href="https://httparchive.org/">
            <img src="/static/images/ha-home.png" alt="HTTP Archive home" height="35" width="70">
          </a>
          <div class="social-media">
            <a href="https://twitter.com/HTTPArchive" class="twitter">
              <img src="/static/images/twitter.png" height="65" width="80" alt="Twitter" loading="lazy" />
            </a>
            <a href="https://github.com/HTTPArchive/almanac.httparchive.org" class="github">
              <img src="/static/images/github.png" height="75" width="80" alt="GitHub" loading="lazy" />
            </a>
          </div>
          {{ language_switcher() }}
        </div>
      </nav>
    </div>
    {% if request.endpoint == 'home' %}
    <div class="intro-container">
      <div id="maincontent" class="intro">
        <div class="intro-year">2019</div>
        <h1 class="title title-lg title-alt">Web Almanac</h1>
        <h2>
          HTTP Archive's annual<br>
          <b>state of the web</b> report
        </h2>
        <p>
          Our mission is to combine the raw stats and trends of the HTTP Archive with the expertise of the web community. The Web Almanac is a comprehensive report on the state of the web, backed by real data and trusted web experts. It is comprised of 20 chapters spanning aspects of page content, user experience, publishing, and distribution.
        </p>
        <a href="{{ url_for('table_of_contents', year=year, lang=lang) }}" class="btn">
          Start exploring
        </a>
      </div>
      <div class="intro-image-2019-wrapper">
        <div class="intro-image-2019"></div>
      </div>
      <div class="intro-image-wrapper">
        <div class="intro-image"></div>
      </div>
    </div>
    {% endif %}
  </header>
  {% endblock %}

  {% block main %}{% endblock %}

  {% block footer %}
    <footer class="alt-bg">
      <a class="navigation-logo home-logo" href="{{ url_for('home', year=year, lang=lang) }}"><img src="/static/images/logo.svg" alt="Web Almanac by HTTP Archive" height="39" width="202"></a>
      <nav title="Footer menu" class="nav-items">
        <a href="{{ url_for('table_of_contents', year=year, lang=lang) }}">Table of Contents</a>
        <a href="{{ url_for('contributors', year=year, lang=lang) }}">Contributors</a>
        <a href="{{ url_for('methodology', year=year, lang=lang) }}">Methodology</a>
        {{ language_switcher() }}
      </nav>
      <p class="copyright"><span>Â© 2019 Web Almanac. Licensed under <a href="https://github.com/HTTPArchive/almanac.httparchive.org/blob/master/LICENSE">Apache 2.0</a>.</span></p>
      <a class="navigation-logo ha-logo" href="https://httparchive.org">
        <img src="/static/images/ha-home.png" alt="HTTP Archive home" height="35" width="70">
      </a>
      <div class="social-media">
        <a href="https://twitter.com/HTTPArchive" class="twitter">
          <img src="/static/images/twitter.png" alt="Twitter" height="65" width="80" loading="lazy" />
        </a>
        <a href="https://github.com/HTTPArchive/almanac.httparchive.org" class="github">
          <img src="/static/images/github.png" alt="GitHub" height="78" width="80" loading="lazy" />
        </a>
      </div>
      <hr>
      <hr>
    </footer>
  {% endblock %}
  {% block scripts %}
    <script nonce="{{ csp_nonce() }}">
      (function() {
        // Language switching
        var languageSwitchers = document.querySelectorAll('.language-switcher select');
        for (var i = 0; i < languageSwitchers.length; i++) {
          languageSwitchers[i].addEventListener('change', function(e) {
            if (e.target.value) {
              window.location = e.target.value;
            }
          });
        }

        // Mobile menu
        var menuIcon = document.querySelector('.menu-icon');
        var menuIconInitialSrc = document.querySelector('.menu-icon').src;
        var menuIconSrcClose = document.querySelector('.menu-icon').dataset.srcClose;

        document.querySelector('.menu-btn').addEventListener('click', function() {
          var menuOpen = document.body.classList.toggle('menu-open');
          menuIcon.src = menuOpen ? menuIconSrcClose : menuIconInitialSrc;
        });

      })();
    </script>
  {% endblock %}
{% endblock %}

{% macro language_switcher() %}
{% if supported_languages | length > 1%}
<div class="language-switcher">
  <select>
    {% for l in supported_languages %}
      <option
        {% if l == language %}selected="selected"{% endif %}
        value="{{ url_for(request.endpoint, **get_view_args(lang=l.lang_code)) }}">
        {{ l }}
      </option>
    {% endfor %}
  </select>
  <img class="dropdown-arrow" src="/static/images/dropdown-arrow.png" alt="open" height="20" width="20" loading="lazy" />
</div>
{% endif %}
{% endmacro %}

{% macro year_switcher() %}
<div class="year-switcher">
  <select>
      {% for y in supported_years %}
        <option
          {% if y == year %}selected="selected"{% endif %}
          value="{{ url_for('table_of_contents', **get_view_args(year=y)) }}">
          {{ y }} Edition
        </option>
      {% endfor %}
  </select>
  <img class="dropdown-arrow" src="/static/images/dropdown-arrow.png" alt="open" height="20" width="20" loading="lazy" />
</div>
{% endmacro %}
