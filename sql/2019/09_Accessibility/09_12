/*
09_12
standard SQL
10TB
headings  <h1> yes or no.
The no sites have *other headings that are not H1.
This query does not account for sites with no headers

only tested on the sample data set
*/
select sum(h1no) noh1, sum(h1yes) yesh1
from(

select
if(h1=false,1,0) h1no,
if(h1=true, 1,0) h1yes
from(

select url, '<h1>' in UNNEST(heading) as h1, array_length(heading) numberofheadings from (
select
url, REGEXP_EXTRACT_ALL(lower(body),r'(<h[1-6]>)') heading
from `response_bodies.2019_07_01_mobile` 

)
where array_length(heading) >1
))